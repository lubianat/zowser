const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/blosc-E49GQuAK.js","assets/chunk-INHXZS53-D3tQiqtZ.js","assets/gzip-CF-9a_hd.js","assets/browser-B-ZyVB-j.js","assets/lz4-BIGKWw27.js","assets/zlib-CBiqHlio.js","assets/zstd-IvP746pw.js"])))=>i.map(i=>d[i]);
var ar=Object.defineProperty;var $n=t=>{throw TypeError(t)};var ur=(t,e,n)=>e in t?ar(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ie=(t,e,n)=>ur(t,typeof e!="symbol"?e+"":e,n),dn=(t,e,n)=>e.has(t)||$n("Cannot "+n);var Z=(t,e,n)=>(dn(t,e,"read from private field"),n?n.call(t):e.get(t)),Ee=(t,e,n)=>e.has(t)?$n("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),pe=(t,e,n,i)=>(dn(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),_n=(t,e,n)=>(dn(t,e,"access private method"),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function ye(){}function cr(t,e){for(const n in e)t[n]=e[n];return t}function Hi(t){return t()}function ei(){return Object.create(null)}function et(t){t.forEach(Hi)}function qi(t){return typeof t=="function"}function xe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let Xt;function Ln(t,e){return t===e?!0:(Xt||(Xt=document.createElement("a")),Xt.href=e,t===Xt.href)}function fr(t){return Object.keys(t).length===0}function hr(t,...e){if(t==null){for(const i of e)i(void 0);return ye}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function en(t){let e;return hr(t,n=>e=n)(),e}function bn(t,e,n,i){if(t){const r=Vi(t,e,n,i);return t[0](r)}}function Vi(t,e,n,i){return t[1]&&i?cr(n.ctx.slice(),t[1](i(e))):n.ctx}function yn(t,e,n,i){if(t[2]&&i){const r=t[2](i(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],o=Math.max(e.dirty.length,r.length);for(let a=0;a<o;a+=1)s[a]=e.dirty[a]|r[a];return s}return e.dirty|r}return e.dirty}function vn(t,e,n,i,r,s){if(r){const o=Vi(e,n,i,s);t.p(o,r)}}function wn(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let i=0;i<n;i++)e[i]=-1;return e}return-1}function ti(t){return t??""}function _(t,e){t.appendChild(e)}function q(t,e,n){t.insertBefore(e,n||null)}function W(t){t.parentNode&&t.parentNode.removeChild(t)}function sn(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function k(t){return document.createElement(t)}function Q(t){return document.createTextNode(t)}function K(){return Q(" ")}function an(){return Q("")}function we(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function w(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function dr(t){return Array.from(t.childNodes)}function Se(t,e){e=""+e,t.data!==e&&(t.data=e)}function Ce(t,e){t.value=e??""}function le(t,e,n,i){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}function _t(t,e,n){for(let i=0;i<t.options.length;i+=1){const r=t.options[i];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function gn(t){const e=t.querySelector(":checked");return e&&e.__value}function nt(t,e,n){t.classList.toggle(e,!!n)}function _r(t,e,{bubbles:n=!1,cancelable:i=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:i})}let Tt;function zt(t){Tt=t}function Mn(){if(!Tt)throw new Error("Function called outside component initialization");return Tt}function Ht(t){Mn().$$.on_mount.push(t)}function Fn(t){Mn().$$.on_destroy.push(t)}function gr(){const t=Mn();return(e,n,{cancelable:i=!1}={})=>{const r=t.$$.callbacks[e];if(r){const s=_r(e,n,{cancelable:i});return r.slice().forEach(o=>{o.call(t,s)}),!s.defaultPrevented}return!0}}const pt=[],wt=[];let bt=[];const ni=[],mr=Promise.resolve();let kn=!1;function pr(){kn||(kn=!0,mr.then(Fe))}function it(t){bt.push(t)}const mn=new Set;let gt=0;function Fe(){if(gt!==0)return;const t=Tt;do{try{for(;gt<pt.length;){const e=pt[gt];gt++,zt(e),br(e.$$)}}catch(e){throw pt.length=0,gt=0,e}for(zt(null),pt.length=0,gt=0;wt.length;)wt.pop()();for(let e=0;e<bt.length;e+=1){const n=bt[e];mn.has(n)||(mn.add(n),n())}bt.length=0}while(pt.length);for(;ni.length;)ni.pop()();kn=!1,mn.clear(),zt(t)}function br(t){if(t.fragment!==null){t.update(),et(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(it)}}function yr(t){const e=[],n=[];bt.forEach(i=>t.indexOf(i)===-1?e.push(i):n.push(i)),n.forEach(i=>i()),bt=e}const tn=new Set;let lt;function qt(){lt={r:0,c:[],p:lt}}function Vt(){lt.r||et(lt.c),lt=lt.p}function ae(t,e){t&&t.i&&(tn.delete(t),t.i(e))}function he(t,e,n,i){if(t&&t.o){if(tn.has(t))return;tn.add(t),lt.c.push(()=>{tn.delete(t),i&&(n&&t.d(1),i())}),t.o(e)}else i&&i()}function Ve(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function vr(t,e){t.d(1),e.delete(t.key)}function wr(t,e){he(t,1,1,()=>{e.delete(t.key)})}function Ki(t,e,n,i,r,s,o,a,l,h,f,m){let b=t.length,p=s.length,g=b;const y={};for(;g--;)y[t[g].key]=g;const x=[],S=new Map,T=new Map,P=[];for(g=p;g--;){const O=m(r,s,g),c=n(O);let u=o.get(c);u?P.push(()=>u.p(O,e)):(u=h(c,O),u.c()),S.set(c,x[g]=u),c in y&&T.set(c,Math.abs(g-y[c]))}const X=new Set,H=new Set;function $(O){ae(O,1),O.m(a,f),o.set(O.key,O),f=O.first,p--}for(;b&&p;){const O=x[p-1],c=t[b-1],u=O.key,d=c.key;O===c?(f=O.first,b--,p--):S.has(d)?!o.has(u)||X.has(u)?$(O):H.has(d)?b--:T.get(u)>T.get(d)?(H.add(u),$(O)):(X.add(d),b--):(l(c,o),b--)}for(;b--;){const O=t[b];S.has(O.key)||l(O,o)}for(;p;)$(x[p-1]);return et(P),x}function Ke(t){t&&t.c()}function We(t,e,n){const{fragment:i,after_update:r}=t.$$;i&&i.m(e,n),it(()=>{const s=t.$$.on_mount.map(Hi).filter(qi);t.$$.on_destroy?t.$$.on_destroy.push(...s):et(s),t.$$.on_mount=[]}),r.forEach(it)}function He(t,e){const n=t.$$;n.fragment!==null&&(yr(n.after_update),et(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function kr(t,e){t.$$.dirty[0]===-1&&(pt.push(t),pr(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Ge(t,e,n,i,r,s,o=null,a=[-1]){const l=Tt;zt(t);const h=t.$$={fragment:null,ctx:[],props:s,update:ye,not_equal:r,bound:ei(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:ei(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(h.root);let f=!1;if(h.ctx=n?n(t,e.props||{},(m,b,...p)=>{const g=p.length?p[0]:b;return h.ctx&&r(h.ctx[m],h.ctx[m]=g)&&(!h.skip_bound&&h.bound[m]&&h.bound[m](g),f&&kr(t,m)),b}):[],h.update(),f=!0,et(h.before_update),h.fragment=i?i(h.ctx):!1,e.target){if(e.hydrate){const m=dr(e.target);h.fragment&&h.fragment.l(m),m.forEach(W)}else h.fragment&&h.fragment.c();e.intro&&ae(t.$$.fragment),We(t,e.target,e.anchor),Fe()}zt(l)}class Je{constructor(){ie(this,"$$");ie(this,"$$set")}$destroy(){He(this,1),this.$destroy=ye}$on(e,n){if(!qi(n))return ye;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(e){this.$$set&&!fr(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Er="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Er);const mt=[];function En(t,e=ye){let n;const i=new Set;function r(a){if(xe(t,a)&&(t=a,n)){const l=!mt.length;for(const h of i)h[1](),mt.push(h,t);if(l){for(let h=0;h<mt.length;h+=2)mt[h][0](mt[h+1]);mt.length=0}}}function s(a){r(a(t))}function o(a,l=ye){const h=[a,l];return i.add(h),i.size===1&&(n=e(r,s)||ye),a(t),()=>{i.delete(h),i.size===0&&n&&(n(),n=null)}}return{set:r,update:s,subscribe:o}}var Cr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ar(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Gi={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){(function(n,i){t.exports=i()})(Cr,function n(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},r=!i.document&&!!i.postMessage,s=i.IS_PAPA_WORKER||!1,o={},a=0,l={parse:function(c,u){var d=(u=u||{}).dynamicTyping||!1;if(O(d)&&(u.dynamicTypingFunction=d,d={}),u.dynamicTyping=d,u.transform=!!O(u.transform)&&u.transform,u.worker&&l.WORKERS_SUPPORTED){var v=function(){if(!l.WORKERS_SUPPORTED)return!1;var F=(re=i.URL||i.webkitURL||null,ee=n.toString(),l.BLOB_URL||(l.BLOB_URL=re.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",ee,")();"],{type:"text/javascript"})))),D=new i.Worker(F),re,ee;return D.onmessage=T,D.id=a++,o[D.id]=D}();return v.userStep=u.step,v.userChunk=u.chunk,v.userComplete=u.complete,v.userError=u.error,u.step=O(u.step),u.chunk=O(u.chunk),u.complete=O(u.complete),u.error=O(u.error),delete u.worker,void v.postMessage({input:c,config:u,workerId:v.id})}var I=null;return l.NODE_STREAM_INPUT,typeof c=="string"?(c=function(F){return F.charCodeAt(0)===65279?F.slice(1):F}(c),I=u.download?new m(u):new p(u)):c.readable===!0&&O(c.read)&&O(c.on)?I=new g(u):(i.File&&c instanceof File||c instanceof Object)&&(I=new b(u)),I.stream(c)},unparse:function(c,u){var d=!1,v=!0,I=",",F=`\r
`,D='"',re=D+D,ee=!1,A=null,N=!1;(function(){if(typeof u=="object"){if(typeof u.delimiter!="string"||l.BAD_DELIMITERS.filter(function(R){return u.delimiter.indexOf(R)!==-1}).length||(I=u.delimiter),(typeof u.quotes=="boolean"||typeof u.quotes=="function"||Array.isArray(u.quotes))&&(d=u.quotes),typeof u.skipEmptyLines!="boolean"&&typeof u.skipEmptyLines!="string"||(ee=u.skipEmptyLines),typeof u.newline=="string"&&(F=u.newline),typeof u.quoteChar=="string"&&(D=u.quoteChar),typeof u.header=="boolean"&&(v=u.header),Array.isArray(u.columns)){if(u.columns.length===0)throw new Error("Option columns is empty");A=u.columns}u.escapeChar!==void 0&&(re=u.escapeChar+D),(typeof u.escapeFormulae=="boolean"||u.escapeFormulae instanceof RegExp)&&(N=u.escapeFormulae instanceof RegExp?u.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var z=new RegExp(x(D),"g");if(typeof c=="string"&&(c=JSON.parse(c)),Array.isArray(c)){if(!c.length||Array.isArray(c[0]))return G(null,c,ee);if(typeof c[0]=="object")return G(A||Object.keys(c[0]),c,ee)}else if(typeof c=="object")return typeof c.data=="string"&&(c.data=JSON.parse(c.data)),Array.isArray(c.data)&&(c.fields||(c.fields=c.meta&&c.meta.fields||A),c.fields||(c.fields=Array.isArray(c.data[0])?c.fields:typeof c.data[0]=="object"?Object.keys(c.data[0]):[]),Array.isArray(c.data[0])||typeof c.data[0]=="object"||(c.data=[c.data])),G(c.fields||[],c.data||[],ee);throw new Error("Unable to serialize unrecognized input");function G(R,J,C){var E="";typeof R=="string"&&(R=JSON.parse(R)),typeof J=="string"&&(J=JSON.parse(J));var B=Array.isArray(R)&&0<R.length,U=!Array.isArray(J[0]);if(B&&v){for(var Y=0;Y<R.length;Y++)0<Y&&(E+=I),E+=V(R[Y],Y);0<J.length&&(E+=F)}for(var M=0;M<J.length;M++){var j=B?R.length:J[M].length,se=!1,ge=B?Object.keys(J[M]).length===0:J[M].length===0;if(C&&!B&&(se=C==="greedy"?J[M].join("").trim()==="":J[M].length===1&&J[M][0].length===0),C==="greedy"&&B){for(var oe=[],ce=0;ce<j;ce++){var de=U?R[ce]:ce;oe.push(J[M][de])}se=oe.join("").trim()===""}if(!se){for(var ue=0;ue<j;ue++){0<ue&&!ge&&(E+=I);var Ie=B&&U?R[ue]:ue;E+=V(J[M][Ie],ue)}M<J.length-1&&(!C||0<j&&!ge)&&(E+=F)}}return E}function V(R,J){if(R==null)return"";if(R.constructor===Date)return JSON.stringify(R).slice(1,25);var C=!1;N&&typeof R=="string"&&N.test(R)&&(R="'"+R,C=!0);var E=R.toString().replace(z,re);return(C=C||d===!0||typeof d=="function"&&d(R,J)||Array.isArray(d)&&d[J]||function(B,U){for(var Y=0;Y<U.length;Y++)if(-1<B.indexOf(U[Y]))return!0;return!1}(E,l.BAD_DELIMITERS)||-1<E.indexOf(I)||E.charAt(0)===" "||E.charAt(E.length-1)===" ")?D+E+D:E}}};if(l.RECORD_SEP="",l.UNIT_SEP="",l.BYTE_ORDER_MARK="\uFEFF",l.BAD_DELIMITERS=["\r",`
`,'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!r&&!!i.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=S,l.ParserHandle=y,l.NetworkStreamer=m,l.FileStreamer=b,l.StringStreamer=p,l.ReadableStreamStreamer=g,i.jQuery){var h=i.jQuery;h.fn.parse=function(c){var u=c.config||{},d=[];return this.each(function(F){if(!(h(this).prop("tagName").toUpperCase()==="INPUT"&&h(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var D=0;D<this.files.length;D++)d.push({file:this.files[D],inputElem:this,instanceConfig:h.extend({},u)})}),v(),this;function v(){if(d.length!==0){var F,D,re,ee,A=d[0];if(O(c.before)){var N=c.before(A.file,A.inputElem);if(typeof N=="object"){if(N.action==="abort")return F="AbortError",D=A.file,re=A.inputElem,ee=N.reason,void(O(c.error)&&c.error({name:F},D,re,ee));if(N.action==="skip")return void I();typeof N.config=="object"&&(A.instanceConfig=h.extend(A.instanceConfig,N.config))}else if(N==="skip")return void I()}var z=A.instanceConfig.complete;A.instanceConfig.complete=function(G){O(z)&&z(G,A.file,A.inputElem),I()},l.parse(A.file,A.instanceConfig)}else O(c.complete)&&c.complete()}function I(){d.splice(0,1),v()}}}function f(c){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(u){var d=H(u);d.chunkSize=parseInt(d.chunkSize),u.step||u.chunk||(d.chunkSize=null),this._handle=new y(d),(this._handle.streamer=this)._config=d}).call(this,c),this.parseChunk=function(u,d){if(this.isFirstChunk&&O(this._config.beforeFirstChunk)){var v=this._config.beforeFirstChunk(u);v!==void 0&&(u=v)}this.isFirstChunk=!1,this._halted=!1;var I=this._partialLine+u;this._partialLine="";var F=this._handle.parse(I,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var D=F.meta.cursor;this._finished||(this._partialLine=I.substring(D-this._baseIndex),this._baseIndex=D),F&&F.data&&(this._rowCount+=F.data.length);var re=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)i.postMessage({results:F,workerId:l.WORKER_ID,finished:re});else if(O(this._config.chunk)&&!d){if(this._config.chunk(F,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);F=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(F.data),this._completeResults.errors=this._completeResults.errors.concat(F.errors),this._completeResults.meta=F.meta),this._completed||!re||!O(this._config.complete)||F&&F.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),re||F&&F.meta.paused||this._nextChunk(),F}this._halted=!0},this._sendError=function(u){O(this._config.error)?this._config.error(u):s&&this._config.error&&i.postMessage({workerId:l.WORKER_ID,error:u,finished:!1})}}function m(c){var u;(c=c||{}).chunkSize||(c.chunkSize=l.RemoteChunkSize),f.call(this,c),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(d){this._input=d,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(u=new XMLHttpRequest,this._config.withCredentials&&(u.withCredentials=this._config.withCredentials),r||(u.onload=$(this._chunkLoaded,this),u.onerror=$(this._chunkError,this)),u.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var d=this._config.downloadRequestHeaders;for(var v in d)u.setRequestHeader(v,d[v])}if(this._config.chunkSize){var I=this._start+this._config.chunkSize-1;u.setRequestHeader("Range","bytes="+this._start+"-"+I)}try{u.send(this._config.downloadRequestBody)}catch(F){this._chunkError(F.message)}r&&u.status===0&&this._chunkError()}},this._chunkLoaded=function(){u.readyState===4&&(u.status<200||400<=u.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:u.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(d){var v=d.getResponseHeader("Content-Range");return v===null?-1:parseInt(v.substring(v.lastIndexOf("/")+1))}(u),this.parseChunk(u.responseText)))},this._chunkError=function(d){var v=u.statusText||d;this._sendError(new Error(v))}}function b(c){var u,d;(c=c||{}).chunkSize||(c.chunkSize=l.LocalChunkSize),f.call(this,c);var v=typeof FileReader<"u";this.stream=function(I){this._input=I,d=I.slice||I.webkitSlice||I.mozSlice,v?((u=new FileReader).onload=$(this._chunkLoaded,this),u.onerror=$(this._chunkError,this)):u=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var I=this._input;if(this._config.chunkSize){var F=Math.min(this._start+this._config.chunkSize,this._input.size);I=d.call(I,this._start,F)}var D=u.readAsText(I,this._config.encoding);v||this._chunkLoaded({target:{result:D}})},this._chunkLoaded=function(I){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(I.target.result)},this._chunkError=function(){this._sendError(u.error)}}function p(c){var u;f.call(this,c=c||{}),this.stream=function(d){return u=d,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var d,v=this._config.chunkSize;return v?(d=u.substring(0,v),u=u.substring(v)):(d=u,u=""),this._finished=!u,this.parseChunk(d)}}}function g(c){f.call(this,c=c||{});var u=[],d=!0,v=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(I){this._input=I,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){v&&u.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),u.length?this.parseChunk(u.shift()):d=!0},this._streamData=$(function(I){try{u.push(typeof I=="string"?I:I.toString(this._config.encoding)),d&&(d=!1,this._checkIsFinished(),this.parseChunk(u.shift()))}catch(F){this._streamError(F)}},this),this._streamError=$(function(I){this._streamCleanUp(),this._sendError(I)},this),this._streamEnd=$(function(){this._streamCleanUp(),v=!0,this._streamData("")},this),this._streamCleanUp=$(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function y(c){var u,d,v,I=Math.pow(2,53),F=-I,D=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,re=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,ee=this,A=0,N=0,z=!1,G=!1,V=[],R={data:[],errors:[],meta:{}};if(O(c.step)){var J=c.step;c.step=function(M){if(R=M,B())E();else{if(E(),R.data.length===0)return;A+=M.data.length,c.preview&&A>c.preview?d.abort():(R.data=R.data[0],J(R,ee))}}}function C(M){return c.skipEmptyLines==="greedy"?M.join("").trim()==="":M.length===1&&M[0].length===0}function E(){return R&&v&&(Y("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),v=!1),c.skipEmptyLines&&(R.data=R.data.filter(function(M){return!C(M)})),B()&&function(){if(!R)return;function M(se,ge){O(c.transformHeader)&&(se=c.transformHeader(se,ge)),V.push(se)}if(Array.isArray(R.data[0])){for(var j=0;B()&&j<R.data.length;j++)R.data[j].forEach(M);R.data.splice(0,1)}else R.data.forEach(M)}(),function(){if(!R||!c.header&&!c.dynamicTyping&&!c.transform)return R;function M(se,ge){var oe,ce=c.header?{}:[];for(oe=0;oe<se.length;oe++){var de=oe,ue=se[oe];c.header&&(de=oe>=V.length?"__parsed_extra":V[oe]),c.transform&&(ue=c.transform(ue,de)),ue=U(de,ue),de==="__parsed_extra"?(ce[de]=ce[de]||[],ce[de].push(ue)):ce[de]=ue}return c.header&&(oe>V.length?Y("FieldMismatch","TooManyFields","Too many fields: expected "+V.length+" fields but parsed "+oe,N+ge):oe<V.length&&Y("FieldMismatch","TooFewFields","Too few fields: expected "+V.length+" fields but parsed "+oe,N+ge)),ce}var j=1;return!R.data.length||Array.isArray(R.data[0])?(R.data=R.data.map(M),j=R.data.length):R.data=M(R.data,0),c.header&&R.meta&&(R.meta.fields=V),N+=j,R}()}function B(){return c.header&&V.length===0}function U(M,j){return se=M,c.dynamicTypingFunction&&c.dynamicTyping[se]===void 0&&(c.dynamicTyping[se]=c.dynamicTypingFunction(se)),(c.dynamicTyping[se]||c.dynamicTyping)===!0?j==="true"||j==="TRUE"||j!=="false"&&j!=="FALSE"&&(function(ge){if(D.test(ge)){var oe=parseFloat(ge);if(F<oe&&oe<I)return!0}return!1}(j)?parseFloat(j):re.test(j)?new Date(j):j===""?null:j):j;var se}function Y(M,j,se,ge){var oe={type:M,code:j,message:se};ge!==void 0&&(oe.row=ge),R.errors.push(oe)}this.parse=function(M,j,se){var ge=c.quoteChar||'"';if(c.newline||(c.newline=function(de,ue){de=de.substring(0,1048576);var Ie=new RegExp(x(ue)+"([^]*?)"+x(ue),"gm"),me=(de=de.replace(Ie,"")).split("\r"),De=de.split(`
`),Ue=1<De.length&&De[0].length<me[0].length;if(me.length===1||Ue)return`
`;for(var ze=0,fe=0;fe<me.length;fe++)me[fe][0]===`
`&&ze++;return ze>=me.length/2?`\r
`:"\r"}(M,ge)),v=!1,c.delimiter)O(c.delimiter)&&(c.delimiter=c.delimiter(M),R.meta.delimiter=c.delimiter);else{var oe=function(de,ue,Ie,me,De){var Ue,ze,fe,_e;De=De||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var Ye=0;Ye<De.length;Ye++){var te=De[Ye],ke=0,Te=0,Ze=0;fe=void 0;for(var qe=new S({comments:me,delimiter:te,newline:ue,preview:10}).parse(de),Oe=0;Oe<qe.data.length;Oe++)if(Ie&&C(qe.data[Oe]))Ze++;else{var Le=qe.data[Oe].length;Te+=Le,fe!==void 0?0<Le&&(ke+=Math.abs(Le-fe),fe=Le):fe=Le}0<qe.data.length&&(Te/=qe.data.length-Ze),(ze===void 0||ke<=ze)&&(_e===void 0||_e<Te)&&1.99<Te&&(ze=ke,Ue=te,_e=Te)}return{successful:!!(c.delimiter=Ue),bestDelimiter:Ue}}(M,c.newline,c.skipEmptyLines,c.comments,c.delimitersToGuess);oe.successful?c.delimiter=oe.bestDelimiter:(v=!0,c.delimiter=l.DefaultDelimiter),R.meta.delimiter=c.delimiter}var ce=H(c);return c.preview&&c.header&&ce.preview++,u=M,d=new S(ce),R=d.parse(u,j,se),E(),z?{meta:{paused:!0}}:R||{meta:{paused:!1}}},this.paused=function(){return z},this.pause=function(){z=!0,d.abort(),u=O(c.chunk)?"":u.substring(d.getCharIndex())},this.resume=function(){ee.streamer._halted?(z=!1,ee.streamer.parseChunk(u,!0)):setTimeout(ee.resume,3)},this.aborted=function(){return G},this.abort=function(){G=!0,d.abort(),R.meta.aborted=!0,O(c.complete)&&c.complete(R),u=""}}function x(c){return c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function S(c){var u,d=(c=c||{}).delimiter,v=c.newline,I=c.comments,F=c.step,D=c.preview,re=c.fastMode,ee=u=c.quoteChar===void 0||c.quoteChar===null?'"':c.quoteChar;if(c.escapeChar!==void 0&&(ee=c.escapeChar),(typeof d!="string"||-1<l.BAD_DELIMITERS.indexOf(d))&&(d=","),I===d)throw new Error("Comment character same as delimiter");I===!0?I="#":(typeof I!="string"||-1<l.BAD_DELIMITERS.indexOf(I))&&(I=!1),v!==`
`&&v!=="\r"&&v!==`\r
`&&(v=`
`);var A=0,N=!1;this.parse=function(z,G,V){if(typeof z!="string")throw new Error("Input must be a string");var R=z.length,J=d.length,C=v.length,E=I.length,B=O(F),U=[],Y=[],M=[],j=A=0;if(!z)return ve();if(c.header&&!G){var se=z.split(v)[0].split(d),ge=[],oe={},ce=!1;for(var de in se){var ue=se[de];O(c.transformHeader)&&(ue=c.transformHeader(ue,de));var Ie=ue,me=oe[ue]||0;for(0<me&&(ce=!0,Ie=ue+"_"+me),oe[ue]=me+1;ge.includes(Ie);)Ie=Ie+"_"+me;ge.push(Ie)}if(ce){var De=z.split(v);De[0]=ge.join(d),z=De.join(v)}}if(re||re!==!1&&z.indexOf(u)===-1){for(var Ue=z.split(v),ze=0;ze<Ue.length;ze++){if(M=Ue[ze],A+=M.length,ze!==Ue.length-1)A+=v.length;else if(V)return ve();if(!I||M.substring(0,E)!==I){if(B){if(U=[],Ze(M.split(d)),st(),N)return ve()}else Ze(M.split(d));if(D&&D<=ze)return U=U.slice(0,D),ve(!0)}}return ve()}for(var fe=z.indexOf(d,A),_e=z.indexOf(v,A),Ye=new RegExp(x(ee)+x(u),"g"),te=z.indexOf(u,A);;)if(z[A]!==u)if(I&&M.length===0&&z.substring(A,A+E)===I){if(_e===-1)return ve();A=_e+C,_e=z.indexOf(v,A),fe=z.indexOf(d,A)}else if(fe!==-1&&(fe<_e||_e===-1))M.push(z.substring(A,fe)),A=fe+J,fe=z.indexOf(d,A);else{if(_e===-1)break;if(M.push(z.substring(A,_e)),Le(_e+C),B&&(st(),N))return ve();if(D&&U.length>=D)return ve(!0)}else for(te=A,A++;;){if((te=z.indexOf(u,te+1))===-1)return V||Y.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:U.length,index:A}),Oe();if(te===R-1)return Oe(z.substring(A,te).replace(Ye,u));if(u!==ee||z[te+1]!==ee){if(u===ee||te===0||z[te-1]!==ee){fe!==-1&&fe<te+1&&(fe=z.indexOf(d,te+1)),_e!==-1&&_e<te+1&&(_e=z.indexOf(v,te+1));var ke=qe(_e===-1?fe:Math.min(fe,_e));if(z.substr(te+1+ke,J)===d){M.push(z.substring(A,te).replace(Ye,u)),z[A=te+1+ke+J]!==u&&(te=z.indexOf(u,A)),fe=z.indexOf(d,A),_e=z.indexOf(v,A);break}var Te=qe(_e);if(z.substring(te+1+Te,te+1+Te+C)===v){if(M.push(z.substring(A,te).replace(Ye,u)),Le(te+1+Te+C),fe=z.indexOf(d,A),te=z.indexOf(u,A),B&&(st(),N))return ve();if(D&&U.length>=D)return ve(!0);break}Y.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:U.length,index:A}),te++}}else te++}return Oe();function Ze(Ae){U.push(Ae),j=A}function qe(Ae){var Qe=0;if(Ae!==-1){var ft=z.substring(te+1,Ae);ft&&ft.trim()===""&&(Qe=ft.length)}return Qe}function Oe(Ae){return V||(Ae===void 0&&(Ae=z.substring(A)),M.push(Ae),A=R,Ze(M),B&&st()),ve()}function Le(Ae){A=Ae,Ze(M),M=[],_e=z.indexOf(v,A)}function ve(Ae){return{data:U,errors:Y,meta:{delimiter:d,linebreak:v,aborted:N,truncated:!!Ae,cursor:j+(G||0)}}}function st(){F(ve()),U=[],Y=[]}},this.abort=function(){N=!0},this.getCharIndex=function(){return A}}function T(c){var u=c.data,d=o[u.workerId],v=!1;if(u.error)d.userError(u.error,u.file);else if(u.results&&u.results.data){var I={abort:function(){v=!0,P(u.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:X,resume:X};if(O(d.userStep)){for(var F=0;F<u.results.data.length&&(d.userStep({data:u.results.data[F],errors:u.results.errors,meta:u.results.meta},I),!v);F++);delete u.results}else O(d.userChunk)&&(d.userChunk(u.results,I,u.file),delete u.results)}u.finished&&!v&&P(u.workerId,u.results)}function P(c,u){var d=o[c];O(d.userComplete)&&d.userComplete(u),d.terminate(),delete o[c]}function X(){throw new Error("Not implemented.")}function H(c){if(typeof c!="object"||c===null)return c;var u=Array.isArray(c)?[]:{};for(var d in c)u[d]=H(c[d]);return u}function $(c,u){return function(){c.apply(u,arguments)}}function O(c){return typeof c=="function"}return s&&(i.onmessage=function(c){var u=c.data;if(l.WORKER_ID===void 0&&u&&(l.WORKER_ID=u.workerId),typeof u.input=="string")i.postMessage({workerId:l.WORKER_ID,results:l.parse(u.input,u.config),finished:!0});else if(i.File&&u.input instanceof File||u.input instanceof Object){var d=l.parse(u.input,u.config);d&&i.postMessage({workerId:l.WORKER_ID,results:d,finished:!0})}}),(m.prototype=Object.create(f.prototype)).constructor=m,(b.prototype=Object.create(f.prototype)).constructor=b,(p.prototype=Object.create(p.prototype)).constructor=p,(g.prototype=Object.create(f.prototype)).constructor=g,l})})(Gi);var Sr=Gi.exports;const Ir=Ar(Sr),Cn="https://raw.githubusercontent.com/ome/ome2024-ngff-challenge/main/samples/ngff_samples.csv";function Ji(t,e,n={}){Ir.parse(t,{header:!1,download:!0,skipEmptyLines:"greedy",complete:function(i){let r=["url"],s=i.data[0];s.length>1&&(r=s,i.data.shift());let o=i.data.map(p=>{let g={...n};for(let y=0;y<r.length;y++)g[r[y]]=p[y];return g}),a=o.filter(p=>{var g;return!((g=p.url)!=null&&g.endsWith(".csv"))}),l={};a.forEach(p=>{if(l[p.url]){console.warn("Removing duplicate URL:",p.url);return}l[p.url]=p}),a=Object.values(l);let h=o.filter(p=>{var g;return(g=p.url)==null?void 0:g.includes(".csv")}),f=a.reduce((p,g)=>g.wells?p+1:p,0),m=a.reduce((p,g)=>p+parseInt(g.written||0),0),b=a.length;f>0&&(b=a.reduce((p,g)=>p+parseInt(g.images||1),0)),e.addCsv(t,h,b,f,m),e.addRows(a),h.forEach(p=>{let g=p.url;p.csv=g,Ji(g,e,p)})}})}async function zr(t){return await fetch(t).then(e=>e.json())}function kt(t){if(!t)return"";const e=2;return t<1024?t+" B":t<1024*1024?(t/1024).toFixed(e)+" KB":t<1024*1024*1024?(t/(1024*1024)).toFixed(e)+" MB":t<1024*1024*1024*1024?(t/(1024*1024*1024)).toFixed(e)+" GB":t<1024*1024*1024*1024*1024?(t/(1024*1024*1024*1024)).toFixed(e)+" TB":(t/(1024*1024*1024*1024*1024)).toFixed(e)+" PB"}function Tr(t,e,n){const i=t[0].shape,r=i[0],s=i[1],o=r*s;e||(e=t.map(Yi));let a=performance.now(),l=new Uint8ClampedArray(4*r*s).fill(0),h=0;for(let f=0;f<o;f++){for(let m=0;m<t.length;m++){let b=n[m],p=t[m].data,g=e[m],x=(p[f]-g[0])/(g[1]-g[0]);for(let S=0;S<3;S++){let T=x*b[S]<<0;l[h*4+S]=Math.max(l[h*4+S],T)}}l[h*4+3]=255,h+=1}return performance.now()-a<100&&Or(l,5)[4]<1&&(l=Rr(l,2)),l}function Rr(t,e){for(let n=0;n<t.length/4;n++)for(let i=0;i<3;i++){let r=t[n*4+i];r=Math.min(255,r*e),t[n*4+i]=r}return t}function Or(t,e=5){let n=new Array(e).fill(0);const i=256/e;let r=t.length/4;for(let s=0;s<r;s++){let o=t[s*4];o=Math.max(t[s*4+1],o),o=Math.max(t[s*4+2],o);let a=Math.floor(o/i);n[a]+=1}return n=n.map(s=>100*s/r),n}function Yi(t){const e=t.data;let n=0,i=1/0,r=t.data.length;for(let s=0;s<r;s++){let o=e[s];n=Math.max(n,o),i=Math.min(i,o)}return[i,n]}const nn=4,rt={cyan:"#00FFFF",yellow:"#FFFF00",magenta:"#FF00FF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",white:"#FFFFFF"},Lr=[rt.magenta,rt.green],Mr=[rt.red,rt.green,rt.blue],ii=Object.values(rt).slice(0,-2);function Fr(t){let e;return t<=nn?e=Array(t).fill(!0):e=[...Array(nn).fill(!0),...Array(t-nn).fill(!1)],e}function Dr(t,e){let n=[];if(t==1)n=[rt.white];else if(t==2)n=Lr;else if(t===3)n=Mr;else if(t<=nn)n=ii.slice(0,t);else{n=Array(t).fill(rt.white);const i=e.flatMap((r,s)=>r?s:[]);for(const[r,s]of i.entries())n[s]=ii[r]}return n.map(Zi)}function Zi(t){t.startsWith("#")&&(t=t.slice(1));const e=parseInt(t.slice(0,2),16),n=parseInt(t.slice(2,4),16),i=parseInt(t.slice(4,6),16);return[e,n,i]}class Qi{constructor(){this.store=En({})}async lookupOntologyTerm(e){let n="",i="";e.includes("NCBITaxon")|e.includes("NCBI:txid")&&(n=e.replace("NCBI:txid",""),n=n.replace("obo:NCBITaxon_",""),i="NCBITaxon"),e.includes("FBbi")&&(n=e.replace("obo:FBbi_",""),n=n.replace("obo:FBbi:",""),n=n.replace("FBbi:",""),i="FBbi"),e.includes("NCIT_")&&(n=e.replace("NCIT_",""),i="NCIT"),e.includes("obo:MI_")&&(n=e.replace("obo:MI_",""),i="MI"),e.includes("obo:OBI_")&&(n=e.replace("obo:OBI_",""),i="OBI");let r=i+"_"+n,o=`https://www.ebi.ac.uk/ols4/api/ontologies/${i.toLowerCase()}/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252F${r}`;return(await zr(o)).label||e}addTerms(e){let n=en(this.store);[...new Set(e)].forEach(r=>{r&&(n[r]||(n[r]="Loading...",setTimeout(()=>{this.lookupOntologyTerm(r).then(s=>{this.addEntry(r,s)})},Math.random()*5e3)))})}addEntry(e,n){this.store.update(i=>(i[e]=n,i))}subscribe(e){return this.store.subscribe(e)}}const Xi=new Qi,$i=new Qi;async function Rt(t,e){var r;let n=await fetch(`${t}/zarr.json`,{signal:e}).then(s=>{if(s.status===404)throw new Error(`${t}/zarr.json not found`);return s.json()}).catch(s=>[void 0,t]);const i=(r=n==null?void 0:n.attributes)==null?void 0:r.ome;if(!i)return[void 0,t];if(i.multiscales)return[i,t];if(i.plate){let s=i.plate.wells[0],o=`${t}/${s.path}/0`,[a,l]=await Rt(o);return[a,l,i.plate]}else if(i["bioformats2raw.layout"]){let s=`${t}/0`;return await Rt(s)}}class Nr{constructor(e="index",n=!0){this.store=En([]),this.selectedRow=En(null),this.sortColumn=e,this.sortAscending=n,this.csvFiles=[]}addCsv(e,n,i,r,s){n=n.map(a=>({...a,child_csv:[]}));let o;for(let a of this.csvFiles){if(a.url===e){o=a;break}for(let l of a.child_csv){if(l.url===e){o=l;break}for(let h of l.child_csv)if(h.url===e){o=h;break}}}o?(o.image_count=i,o.plate_count=r,o.bytes=s,o.child_csv=n):(o={url:e,image_count:i,plate_count:r,bytes:s,child_csv:n},this.csvFiles.push(o))}addRows(e){e=e.map((r,s)=>{if(r.written&&(r.written=parseFloat(r.written)),r.shape){let o=r.shape.split(",").map(l=>parseInt(l)),a;r.dimension_names?a=r.dimension_names.split(","):o.length==5&&(a=["t","c","z","y","x"]),a&&a.length==o.length&&a.forEach((l,h)=>r["size_"+l]=o[h]),r.dim_count=o.reduce((l,h)=>l+(h>1?1:0),0)}if(r.chunks){let o=r.chunks.split(",").map(a=>parseInt(a));r.chunk_pixels=o.reduce((a,l)=>a*l,1)}if(r.shards){let o=r.shards.split(",").map(a=>parseInt(a));r.shard_pixels=o.reduce((a,l)=>a*l,1)}return r.index=Math.random()*(1+s),r}),console.log("Adding rows",e),this.store.update(r=>(r.push(...e),r.sort((s,o)=>this.compareRows(s,o,!0)),r));let n=e.map(r=>r.organismId);Xi.addTerms(n);let i=e.map(r=>r.fbbiId);$i.addTerms(i)}populateRow(e,n){this.store.update(i=>(i=i.map(r=>(r.url===e&&(r={...r,...n}),r)),i))}async loadNgffMetadata(e){var b;const[n,i,r]=await Rt(e);let s=[],o=0,a=0,l=!1,h=!0,f={multiscales:n},m=i;if(r&&(o=r.wells.length,a=r.field_count||1),n){const p=(b=n[0])==null?void 0:b.datasets[0],g=p==null?void 0:p.path;if(g){const y=await fetch(`${i}/${g}/zarr.json`).then(x=>x.json()).catch(x=>{console.log(`----> Failed to parse ${i}/${g}/zarr.json`,x)});s=y==null?void 0:y.shape}}else console.log("No multiscales found"),l=!0,s=[0];this.populateRow(e,{image_attrs:f,image_url:m,shape:s,well_count:o,field_count:a,load_failed:l,loaded:h})}compareRows(e,n,i=!1){let r=e[this.sortColumn],s=n[this.sortColumn];if(i)return r===void 0&&(r=0),s===void 0&&(s=0),r<s?this.sortAscending?-1:1:r>s?this.sortAscending?1:-1:0;r===void 0&&(r=""),s===void 0&&(s="");let o=0;return i?o=r-s:o=r.localeCompare(s),this.sortAscending?o:-o}sortTable(e,n=!0){console.log("sortTable",e,n),this.sortColumn=e,this.sortAscending=n;let i=this.isColumnNumeric(e);this.store.update(r=>(r.sort((s,o)=>this.compareRows(s,o,i)),r))}isColumnNumeric(e){let n=en(this.store);for(let i of n){let r=i[e];if(r!==void 0&&r!=="")return!isNaN(r)}}emptyTable(){this.store.set([])}subscribe(e){return this.store.subscribe(e)}getRows(){return en(this.store)}getRow(e){return en(this.store)[e]}subscribeSelectedRow(e){return this.selectedRow.subscribe(e)}setSelectedRow(e){this.selectedRow.set(e)}}const je=new Nr;function Pr(t){let e,n,i,r,s,o;return{c(){e=k("button"),n=k("span"),n.textContent="^",i=K(),r=k("span"),r.textContent="^",w(n,"class","acc svelte-17vd65t"),nt(n,"strong",t[1]),w(r,"class","dec svelte-17vd65t"),nt(r,"strong",!t[1]),w(e,"class","svelte-17vd65t")},m(a,l){q(a,e,l),_(e,n),_(e,i),_(e,r),s||(o=we(e,"click",t[2]),s=!0)},p(a,[l]){l&2&&nt(n,"strong",a[1]),l&2&&nt(r,"strong",!a[1])},i:ye,o:ye,d(a){a&&W(e),s=!1,o()}}}function xr(t,e,n){let{toggleAscending:i}=e,{sortAscending:r}=e;const s=()=>i();return t.$$set=o=>{"toggleAscending"in o&&n(0,i=o.toggleAscending),"sortAscending"in o&&n(1,r=o.sortAscending)},[i,r,s]}class Ur extends Je{constructor(e){super(),Ge(this,e,xr,Pr,xe,{toggleAscending:0,sortAscending:1})}}const $t={AUTO:"auto",START:"start",CENTER:"center",END:"end"},$e={HORIZONTAL:"horizontal",VERTICAL:"vertical"},At={OBSERVED:0,REQUESTED:1},Br={[$e.VERTICAL]:"top",[$e.HORIZONTAL]:"left"},ri={[$e.VERTICAL]:"scrollTop",[$e.HORIZONTAL]:"scrollLeft"};class jr{constructor({itemSize:e,itemCount:n,estimatedItemSize:i}){this.itemSize=e,this.itemCount=n,this.estimatedItemSize=i,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig({itemSize:e,itemCount:n,estimatedItemSize:i}){n!=null&&(this.itemCount=n),i!=null&&(this.estimatedItemSize=i),e!=null&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!=null?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.itemCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:n}=this;return typeof n=="function"?n(e):Array.isArray(n)?n[e]:n}computeTotalSizeAndPositionData(){let e=0;for(let n=0;n<this.itemCount;n++){const i=this.getSize(n),r=e;e+=i,this.itemSizeAndPositionData[n]={offset:r,size:i}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){if(e<0||e>=this.itemCount)throw Error(`Requested index ${e} is outside of range 0..${this.itemCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const n=this.getSizeAndPositionOfLastMeasuredItem();let i=n.offset+n.size;for(let r=this.lastMeasuredIndex+1;r<=e;r++){const s=this.getSize(r);if(s==null||isNaN(s))throw Error(`Invalid size returned for index ${r} of value ${s}`);this.itemSizeAndPositionData[r]={offset:i,size:s},i+=s}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize}getUpdatedOffsetForIndex({align:e=$t.START,containerSize:n,currentOffset:i,targetIndex:r}){if(n<=0)return 0;const s=this.getSizeAndPositionForIndex(r),o=s.offset,a=o-n+s.size;let l;switch(e){case $t.END:l=a;break;case $t.CENTER:l=o-(n-s.size)/2;break;case $t.START:l=o;break;default:l=Math.max(a,Math.min(o,i))}const h=this.getTotalSize();return Math.max(0,Math.min(h-n,l))}getVisibleRange({containerSize:e=0,offset:n,overscanCount:i}){if(this.getTotalSize()===0)return{};const s=n+e;let o=this.findNearestItem(n);if(o===void 0)throw Error(`Invalid offset ${n} specified`);const a=this.getSizeAndPositionForIndex(o);n=a.offset+a.size;let l=o;for(;n<s&&l<this.itemCount-1;)l++,n+=this.getSizeAndPositionForIndex(l).size;return i&&(o=Math.max(0,o-i),l=Math.min(l+i,this.itemCount-1)),{start:o,stop:l}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const n=this.getSizeAndPositionOfLastMeasuredItem(),i=Math.max(0,this.lastMeasuredIndex);return n.offset>=e?this.binarySearch({high:i,low:0,offset:e}):this.exponentialSearch({index:i,offset:e})}binarySearch({low:e,high:n,offset:i}){let r=0,s=0;for(;e<=n;){if(r=e+Math.floor((n-e)/2),s=this.getSizeAndPositionForIndex(r).offset,s===i)return r;s<i?e=r+1:s>i&&(n=r-1)}return e>0?e-1:0}exponentialSearch({index:e,offset:n}){let i=1;for(;e<this.itemCount&&this.getSizeAndPositionForIndex(e).offset<n;)e+=i,i*=2;return this.binarySearch({high:Math.min(e,this.itemCount-1),low:Math.floor(e/2),offset:n})}}const Wr=t=>({}),si=t=>({});function oi(t,e,n){const i=t.slice();return i[37]=e[n],i}const Hr=t=>({style:t[0]&4,index:t[0]&4}),li=t=>({style:t[37].style,index:t[37].index}),qr=t=>({}),ai=t=>({});function ui(t,e){let n,i;const r=e[21].item,s=bn(r,e,e[20],li);return{key:t,first:null,c(){n=an(),s&&s.c(),this.first=n},m(o,a){q(o,n,a),s&&s.m(o,a),i=!0},p(o,a){e=o,s&&s.p&&(!i||a[0]&1048580)&&vn(s,r,e,e[20],i?yn(r,e[20],a,Hr):wn(e[20]),li)},i(o){i||(ae(s,o),i=!0)},o(o){he(s,o),i=!1},d(o){o&&W(n),s&&s.d(o)}}}function Vr(t){let e,n,i,r=[],s=new Map,o,a;const l=t[21].header,h=bn(l,t,t[20],ai);let f=Ve(t[2]);const m=g=>g[0]?g[0](g[37].index):g[37].index;for(let g=0;g<f.length;g+=1){let y=oi(t,f,g),x=m(y);s.set(x,r[g]=ui(x,y))}const b=t[21].footer,p=bn(b,t,t[20],si);return{c(){e=k("div"),h&&h.c(),n=K(),i=k("div");for(let g=0;g<r.length;g+=1)r[g].c();o=K(),p&&p.c(),w(i,"class","virtual-list-inner svelte-dwpad5"),w(i,"style",t[4]),w(e,"class","virtual-list-wrapper svelte-dwpad5"),w(e,"style",t[3])},m(g,y){q(g,e,y),h&&h.m(e,null),_(e,n),_(e,i);for(let x=0;x<r.length;x+=1)r[x]&&r[x].m(i,null);_(e,o),p&&p.m(e,null),t[22](e),a=!0},p(g,y){h&&h.p&&(!a||y[0]&1048576)&&vn(h,l,g,g[20],a?yn(l,g[20],y,qr):wn(g[20]),ai),y[0]&1048581&&(f=Ve(g[2]),qt(),r=Ki(r,y,m,1,g,f,s,i,wr,ui,null,oi),Vt()),(!a||y[0]&16)&&w(i,"style",g[4]),p&&p.p&&(!a||y[0]&1048576)&&vn(p,b,g,g[20],a?yn(b,g[20],y,Wr):wn(g[20]),si),(!a||y[0]&8)&&w(e,"style",g[3])},i(g){if(!a){ae(h,g);for(let y=0;y<f.length;y+=1)ae(r[y]);ae(p,g),a=!0}},o(g){he(h,g);for(let y=0;y<r.length;y+=1)he(r[y]);he(p,g),a=!1},d(g){g&&W(e),h&&h.d(g);for(let y=0;y<r.length;y+=1)r[y].d();p&&p.d(g),t[22](null)}}}const Kr=(()=>{let t=!1;try{const e=Object.defineProperty({},"passive",{get(){return t={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return t})();function Gr(t,e,n){let{$$slots:i={},$$scope:r}=e,{height:s}=e,{width:o="100%"}=e,{itemCount:a}=e,{itemSize:l}=e,{estimatedItemSize:h=null}=e,{stickyIndices:f=null}=e,{getKey:m=null}=e,{scrollDirection:b=$e.VERTICAL}=e,{scrollOffset:p=null}=e,{scrollToIndex:g=null}=e,{scrollToAlignment:y=null}=e,{scrollToBehaviour:x="instant"}=e,{overscanCount:S=3}=e;const T=gr(),P=new jr({itemCount:a,itemSize:l,estimatedItemSize:V()});let X=!1,H,$=[],O={offset:p||g!=null&&$.length&&N(g)||0,scrollChangeReason:At.REQUESTED},c=O,u={scrollToIndex:g,scrollToAlignment:y,scrollOffset:p,itemCount:a,itemSize:l,estimatedItemSize:h},d={},v="",I="";re(),Ht(()=>{n(18,X=!0),H.addEventListener("scroll",z,Kr),p!=null?ee(p):g!=null&&ee(N(g))}),Fn(()=>{X&&H.removeEventListener("scroll",z)});function F(){if(!X)return;const C=u.scrollToIndex!==g||u.scrollToAlignment!==y,E=u.itemCount!==a||u.itemSize!==l||u.estimatedItemSize!==h;E&&(P.updateConfig({itemSize:l,itemCount:a,estimatedItemSize:V()}),A()),u.scrollOffset!==p?n(19,O={offset:p||0,scrollChangeReason:At.REQUESTED}):typeof g=="number"&&(C||E)&&n(19,O={offset:N(g,y,a),scrollChangeReason:At.REQUESTED}),u={scrollToIndex:g,scrollToAlignment:y,scrollOffset:p,itemCount:a,itemSize:l,estimatedItemSize:h}}function D(){if(!X)return;const{offset:C,scrollChangeReason:E}=O;(c.offset!==C||c.scrollChangeReason!==E)&&re(),c.offset!==C&&E===At.REQUESTED&&ee(C),c=O}function re(){const{offset:C}=O,{start:E,stop:B}=P.getVisibleRange({containerSize:b===$e.VERTICAL?s:o,offset:C,overscanCount:S});let U=[];const Y=P.getTotalSize();b===$e.VERTICAL?(n(3,v=`height:${s}${typeof s=="number"?"px":""};width:${o};`),n(4,I=`flex-direction:column;height:${Y}px;`)):(n(3,v=`height:${s};width:${o}${typeof o=="number"?"px":""}`),n(4,I=`min-height:100%;width:${Y}px;`));const M=f!=null&&f.length!==0;if(M)for(let j=0;j<f.length;j++){const se=f[j];U.push({index:se,style:R(se,!0)})}if(E!==void 0&&B!==void 0){for(let j=E;j<=B;j++)M&&f.includes(j)||U.push({index:j,style:R(j,!1)});T("itemsUpdated",{start:E,end:B})}n(2,$=U)}function ee(C){"scroll"in H?H.scroll({[Br[b]]:C,behavior:x}):n(1,H[ri[b]]=C,H)}function A(C=0){d={},P.resetItem(C),re()}function N(C,E=y,B=a){return(C<0||C>=B)&&(C=0),P.getUpdatedOffsetForIndex({align:E,containerSize:b===$e.VERTICAL?s:o,currentOffset:O.offset||0,targetIndex:C})}function z(C){const E=G();E<0||O.offset===E||C.target!==H||(n(19,O={offset:E,scrollChangeReason:At.OBSERVED}),T("afterScroll",{offset:E,event:C}))}function G(){return H[ri[b]]}function V(){return h||typeof l=="number"&&l||50}function R(C,E){if(d[C])return d[C];const{size:B,offset:U}=P.getSizeAndPositionForIndex(C);let Y;return b===$e.VERTICAL?(Y=`left:0;width:100%;height:${B}px;`,E?Y+=`position:sticky;flex-grow:0;z-index:1;top:0;margin-top:${U}px;margin-bottom:${-(U+B)}px;`:Y+=`position:absolute;top:${U}px;`):(Y=`top:0;width:${B}px;`,E?Y+=`position:sticky;z-index:1;left:0;margin-left:${U}px;margin-right:${-(U+B)}px;`:Y+=`position:absolute;height:100%;left:${U}px;`),d[C]=Y}function J(C){wt[C?"unshift":"push"](()=>{H=C,n(1,H)})}return t.$$set=C=>{"height"in C&&n(5,s=C.height),"width"in C&&n(6,o=C.width),"itemCount"in C&&n(7,a=C.itemCount),"itemSize"in C&&n(8,l=C.itemSize),"estimatedItemSize"in C&&n(9,h=C.estimatedItemSize),"stickyIndices"in C&&n(10,f=C.stickyIndices),"getKey"in C&&n(0,m=C.getKey),"scrollDirection"in C&&n(11,b=C.scrollDirection),"scrollOffset"in C&&n(12,p=C.scrollOffset),"scrollToIndex"in C&&n(13,g=C.scrollToIndex),"scrollToAlignment"in C&&n(14,y=C.scrollToAlignment),"scrollToBehaviour"in C&&n(15,x=C.scrollToBehaviour),"overscanCount"in C&&n(16,S=C.overscanCount),"$$scope"in C&&n(20,r=C.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&29568&&F(),t.$$.dirty[0]&524288&&D(),t.$$.dirty[0]&263264&&X&&A(0)},[m,H,$,v,I,s,o,a,l,h,f,b,p,g,y,x,S,A,X,O,r,i,J]}class Jr extends Je{constructor(e){super(),Ge(this,e,Gr,Vr,xe,{height:5,width:6,itemCount:7,itemSize:8,estimatedItemSize:9,stickyIndices:10,getKey:0,scrollDirection:11,scrollOffset:12,scrollToIndex:13,scrollToAlignment:14,scrollToBehaviour:15,overscanCount:16,recomputeSizes:17},null,[-1,-1])}get height(){return this.$$.ctx[5]}set height(e){this.$$set({height:e}),Fe()}get width(){return this.$$.ctx[6]}set width(e){this.$$set({width:e}),Fe()}get itemCount(){return this.$$.ctx[7]}set itemCount(e){this.$$set({itemCount:e}),Fe()}get itemSize(){return this.$$.ctx[8]}set itemSize(e){this.$$set({itemSize:e}),Fe()}get estimatedItemSize(){return this.$$.ctx[9]}set estimatedItemSize(e){this.$$set({estimatedItemSize:e}),Fe()}get stickyIndices(){return this.$$.ctx[10]}set stickyIndices(e){this.$$set({stickyIndices:e}),Fe()}get getKey(){return this.$$.ctx[0]}set getKey(e){this.$$set({getKey:e}),Fe()}get scrollDirection(){return this.$$.ctx[11]}set scrollDirection(e){this.$$set({scrollDirection:e}),Fe()}get scrollOffset(){return this.$$.ctx[12]}set scrollOffset(e){this.$$set({scrollOffset:e}),Fe()}get scrollToIndex(){return this.$$.ctx[13]}set scrollToIndex(e){this.$$set({scrollToIndex:e}),Fe()}get scrollToAlignment(){return this.$$.ctx[14]}set scrollToAlignment(e){this.$$set({scrollToAlignment:e}),Fe()}get scrollToBehaviour(){return this.$$.ctx[15]}set scrollToBehaviour(e){this.$$set({scrollToBehaviour:e}),Fe()}get overscanCount(){return this.$$.ctx[16]}set overscanCount(e){this.$$set({overscanCount:e}),Fe()}get recomputeSizes(){return this.$$.ctx[17]}}class Kt extends Error{constructor(e,n={}){super(`Node not found: ${e}`,n),this.name="NodeNotFoundError"}}class Dn extends Error{constructor(e){super(`Missing key: ${e}`),this.name="KeyError"}}const Yr="modulepreload",Zr=function(t){return"/zowser/"+t},ci={},St=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));r=Promise.all(n.map(a=>{if(a=Zr(a),a in ci)return;ci[a]=!0;const l=a.endsWith(".css"),h=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${h}`))return;const f=document.createElement("link");if(f.rel=l?"stylesheet":Yr,l||(f.as="script"),f.crossOrigin="",f.href=a,o&&f.setAttribute("nonce",o),document.head.appendChild(f),l)return new Promise((m,b)=>{f.addEventListener("load",m),f.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${a}`)))})}))}return r.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};var Pe;class er{constructor(e,n,i){Ee(this,Pe);typeof e=="number"?pe(this,Pe,new Uint8Array(e)):e instanceof ArrayBuffer?pe(this,Pe,new Uint8Array(e,n,i)):pe(this,Pe,new Uint8Array(Array.from(e,r=>r?1:0)))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return Z(this,Pe).byteOffset}get byteLength(){return Z(this,Pe).byteLength}get buffer(){return Z(this,Pe).buffer}get length(){return Z(this,Pe).length}get(e){let n=Z(this,Pe)[e];return typeof n=="number"?n!==0:n}set(e,n){Z(this,Pe)[e]=n?1:0}fill(e){Z(this,Pe).fill(e?1:0)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}Pe=new WeakMap;var yt;class Nn{constructor(e,n,i,r){ie(this,"_data");ie(this,"chars");Ee(this,yt);if(this.chars=e,pe(this,yt,new TextEncoder),typeof n=="number")this._data=new Uint8Array(n*e);else if(n instanceof ArrayBuffer)r&&(r=r*e),this._data=new Uint8Array(n,i,r);else{let s=Array.from(n);this._data=new Uint8Array(s.length*e);for(let o=0;o<s.length;o++)this.set(o,s[o])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(e){const n=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);return new TextDecoder().decode(n).replace(/\x00/g,"")}set(e,n){const i=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);i.fill(0),i.set(Z(this,yt).encode(n))}fill(e){const n=Z(this,yt).encode(e);for(let i=0;i<this.length;i++)this._data.set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}yt=new WeakMap;var Re;const Wn=class Wn{constructor(e,n,i,r){Ee(this,Re);ie(this,"chars");if(this.chars=e,typeof n=="number")pe(this,Re,new Int32Array(n*e));else if(n instanceof ArrayBuffer)r&&(r*=e),pe(this,Re,new Int32Array(n,i,r));else{const s=n,o=new Wn(e,1);pe(this,Re,new Int32Array(function*(){for(let a of s)o.set(0,a),yield*Z(o,Re)}()))}}get BYTES_PER_ELEMENT(){return Z(this,Re).BYTES_PER_ELEMENT*this.chars}get byteLength(){return Z(this,Re).byteLength}get byteOffset(){return Z(this,Re).byteOffset}get buffer(){return Z(this,Re).buffer}get length(){return Z(this,Re).length/this.chars}get(e){const n=this.chars*e;let i="";for(let r=0;r<this.chars;r++)i+=String.fromCodePoint(Z(this,Re)[n+r]);return i.replace(/\u0000/g,"")}set(e,n){const i=this.chars*e,r=Z(this,Re).subarray(i,i+this.chars);r.fill(0);for(let s=0;s<this.chars;s++)r[s]=n.codePointAt(s)??0}fill(e){this.set(0,e);let n=Z(this,Re).subarray(0,this.chars);for(let i=1;i<this.length;i++)Z(this,Re).set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}};Re=new WeakMap;let Ot=Wn;function Gt(t){const e=new TextDecoder().decode(t);return JSON.parse(e)}function fi(t,e){const n=e/2,i=e-1;let r=0;for(let s=0;s<t.length;s+=e)for(let o=0;o<n;o+=1)r=t[s+o],t[s+o]=t[s+i-o],t[s+i-o]=r}const Qr={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float32:Float32Array,float64:Float64Array,bool:er},Xr=/v2:([US])(\d+)/;function tr(t){if(t==="v2:object")return globalThis.Array;let e=t.match(Xr);if(e){let[,i,r]=e;return(i==="U"?Ot:Nn).bind(null,Number(r))}let n=Qr[t];if(!n)throw new Error(`Unknown or unsupported data_type: ${t}`);return n}function ct(t,e){return(e==="C"?$r:es)(t)}function $r(t){const e=t.length,n=globalThis.Array(e);for(let i=e-1,r=1;i>=0;i--)n[i]=r,r*=t[i];return n}function es(t){const e=t.length,n=globalThis.Array(e);for(let i=0,r=1;i<e;i++)n[i]=r,r*=t[i];return n}function ts({name:t,configuration:e}){if(t==="default"){const n=(e==null?void 0:e.separator)??"/";return i=>["c",...i].join(n)}if(t==="v2"){const n=(e==null?void 0:e.separator)??".";return i=>i.join(n)||"0"}throw new Error(`Unknown chunk key encoding: ${t}`)}function An(t){var n;const e=t.find(i=>i.name==="transpose");return((n=e==null?void 0:e.configuration)==null?void 0:n.order)==="F"?"F":"C"}const ns=/^([<|>])(.*)$/;function is(t){if(t==="|O")return{data_type:"v2:object"};let e=t.match(ns);if(!e)throw new Error(`Invalid dtype: ${t}`);let[,n,i]=e,r={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f4:"float32",f8:"float64"}[i]??(i.startsWith("S")||i.startsWith("U")?`v2:${i}`:void 0);if(!r)throw new Error(`Unsupported or unknown dtype: ${t}`);return n==="|"?{data_type:r}:{data_type:r,endian:n==="<"?"little":"big"}}function rs(t,e={}){let n=[],i=is(t.dtype);t.order==="F"&&n.push({name:"transpose",configuration:{order:"F"}}),"endian"in i&&i.endian==="big"&&n.push({name:"bytes",configuration:{endian:"big"}});for(let{id:r,...s}of t.filters??[])n.push({name:r,configuration:s});if(t.compressor){let{id:r,...s}=t.compressor;n.push({name:r,configuration:s})}return{zarr_format:3,node_type:"array",shape:t.shape,data_type:i.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:t.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:t.dimension_separator??"."}},codecs:n,fill_value:t.fill_value,attributes:e}}function ss(t,e={}){return{zarr_format:3,node_type:"group",attributes:e}}function os(t,e){if(e!=="number"&&e!=="bigint"&&e!=="boolean"&&e!=="object"&&e!=="string")return t===e;let n=t==="bool";if(e==="boolean")return n;let i=t.startsWith("v2:U")||t.startsWith("v2:S");if(e==="string")return i;let r=t==="int64"||t==="uint64";if(e==="bigint")return r;let s=t==="v2:object";return e==="object"?s:!i&&!r&&!n&&!s}function ls(t){return(t==null?void 0:t.name)==="sharding_indexed"}function nr(t){return(t.data_type==="uint64"||t.data_type==="int64")&&t.fill_value!=null?BigInt(t.fill_value):t.fill_value}const hi=as();function as(){const t=new Uint32Array([305419896]);return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)[0]!==18}function di(t){return"BYTES_PER_ELEMENT"in t?t.BYTES_PER_ELEMENT:4}var Lt,tt,Mt,Ft,vt;const Hn=class Hn{constructor(e,n){ie(this,"kind","array_to_bytes");Ee(this,Lt);Ee(this,tt);Ee(this,Mt);Ee(this,Ft);Ee(this,vt);pe(this,vt,e==null?void 0:e.endian),pe(this,tt,tr(n.data_type)),pe(this,Ft,n.shape),pe(this,Lt,ct(n.shape,An(n.codecs)));const i=new(Z(this,tt))(0);pe(this,Mt,i.BYTES_PER_ELEMENT)}static fromConfig(e,n){return new Hn(e,n)}encode(e){let n=new Uint8Array(e.data.buffer);return hi&&Z(this,vt)==="big"&&fi(n,di(Z(this,tt))),n}decode(e){return hi&&Z(this,vt)==="big"&&fi(e,di(Z(this,tt))),{data:new(Z(this,tt))(e.buffer,e.byteOffset,e.byteLength/Z(this,Mt)),shape:Z(this,Ft),stride:Z(this,Lt)}}};Lt=new WeakMap,tt=new WeakMap,Mt=new WeakMap,Ft=new WeakMap,vt=new WeakMap;let on=Hn;class Pn{constructor(){ie(this,"kind","bytes_to_bytes")}static fromConfig(){return new Pn}encode(e){throw new Error("Not implemented")}decode(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength-4)}}function us(t,e){if(Number.isNaN(e))throw new Error("JsonCodec allow_nan is false but NaN was encountered during encoding.");if(e===Number.POSITIVE_INFINITY)throw new Error("JsonCodec allow_nan is false but Infinity was encountered during encoding.");if(e===Number.NEGATIVE_INFINITY)throw new Error("JsonCodec allow_nan is false but -Infinity was encountered during encoding.");return e}function cs(t,e){return e instanceof Object&&!Array.isArray(e)?Object.keys(e).sort().reduce((n,i)=>(n[i]=e[i],n),{}):e}var Dt,Nt;const qn=class qn{constructor(e={}){ie(this,"configuration");ie(this,"kind","array_to_bytes");Ee(this,Dt);Ee(this,Nt);this.configuration=e;const{encoding:n="utf-8",skipkeys:i=!1,ensure_ascii:r=!0,check_circular:s=!0,allow_nan:o=!0,sort_keys:a=!0,indent:l,strict:h=!0}=e;let f=e.separators;f||(l?f=[", ",": "]:f=[",",":"]),pe(this,Dt,{encoding:n,skipkeys:i,ensure_ascii:r,check_circular:s,allow_nan:o,indent:l,separators:f,sort_keys:a}),pe(this,Nt,{strict:h})}static fromConfig(e){return new qn(e)}encode(e){const{indent:n,encoding:i,ensure_ascii:r,check_circular:s,allow_nan:o,sort_keys:a}=Z(this,Dt);if(i!=="utf-8")throw new Error("JsonCodec does not yet support non-utf-8 encoding.");const l=[];if(!s)throw new Error("JsonCodec does not yet support skipping the check for circular references during encoding.");o||l.push(us),a&&l.push(cs);const h=Array.from(e.data);h.push("|O"),h.push(e.shape);let f;l.length&&(f=(b,p)=>{let g=p;for(let y of l)g=y(b,g);return g});let m=JSON.stringify(h,f,n);return r&&(m=m.replace(/[\u007F-\uFFFF]/g,b=>{const p=`0000${b.charCodeAt(0).toString(16)}`;return`\\u${p.substring(p.length-4)}`})),new TextEncoder().encode(m)}decode(e){const{strict:n}=Z(this,Nt);if(!n)throw new Error("JsonCodec does not yet support non-strict decoding.");const i=Gt(e),r=i.pop();if(i.pop(),!r)throw new Error("0D not implemented for JsonCodec.");const s=ct(r,"C");return{data:i,shape:r,stride:s}}};Dt=new WeakMap,Nt=new WeakMap;let Sn=qn;function _i(t){return t instanceof er||t instanceof Nn||t instanceof Ot?new Proxy(t,{get(n,i){return n.get(Number(i))},set(n,i,r){return n.set(Number(i),r),!0}}):t}function fs(t,e){let n;return t.data instanceof Nn||t.data instanceof Ot?n=new t.constructor(t.data.length,t.data.chars):n=new t.constructor(t.data.length),{data:n,shape:t.shape,stride:ct(t.shape,e)}}function hs(t,e){let n=fs(t,e),i=t.shape.length,r=t.data.length,s=Array(i).fill(0),o=_i(t.data),a=_i(n.data);for(let l=0;l<r;l++){let h=0;for(let f=0;f<i;f++)h+=s[f]*n.stride[f];a[h]=o[l],s[0]+=1;for(let f=0;f<i;f++)if(s[f]===t.shape[f]){if(f+1===i)break;s[f]=0,s[f+1]+=1}}return n}function ds(t){if(!t.stride)return"C";let e=ct(t.shape,"C");return t.stride.every((n,i)=>n===e[i])?"C":"F"}class xn{constructor(e){ie(this,"configuration");ie(this,"kind","array_to_array");this.configuration=e}static fromConfig(e){return new xn(e)}encode(e){var n,i;return ds(e)===((n=this.configuration)==null?void 0:n.order)?e:hs(e,((i=this.configuration)==null?void 0:i.order)??"C")}decode(e){return e}}var Pt,xt;const Vn=class Vn{constructor(e){ie(this,"kind","array_to_bytes");Ee(this,Pt);Ee(this,xt);pe(this,Pt,e),pe(this,xt,ct(e,"C"))}static fromConfig(e,n){return new Vn(n.shape)}encode(e){throw new Error("Method not implemented.")}decode(e){let n=new TextDecoder,i=new DataView(e.buffer),r=Array(i.getUint32(0,!0)),s=4;for(let o=0;o<r.length;o++){let a=i.getUint32(s,!0);s+=4,r[o]=n.decode(e.buffer.slice(s,s+a)),s+=a}return{data:r,shape:Z(this,Pt),stride:Z(this,xt)}}};Pt=new WeakMap,xt=new WeakMap;let In=Vn;function _s(){return new Map().set("blosc",()=>St(()=>import("./blosc-E49GQuAK.js"),__vite__mapDeps([0,1])).then(t=>t.default)).set("gzip",()=>St(()=>import("./gzip-CF-9a_hd.js"),__vite__mapDeps([2,3])).then(t=>t.default)).set("lz4",()=>St(()=>import("./lz4-BIGKWw27.js"),__vite__mapDeps([4,1])).then(t=>t.default)).set("zlib",()=>St(()=>import("./zlib-CBiqHlio.js"),__vite__mapDeps([5,3])).then(t=>t.default)).set("zstd",()=>St(()=>import("./zstd-IvP746pw.js"),__vite__mapDeps([6,1])).then(t=>t.default)).set("transpose",()=>xn).set("bytes",()=>on).set("crc32c",()=>Pn).set("vlen-utf8",()=>In).set("json2",()=>Sn)}const gs=_s();function zn(t){let e;return{async encode(n){e||(e=await gi(t));for(const r of e.array_to_array)n=await r.encode(n);let i=await e.array_to_bytes.encode(n);for(const r of e.bytes_to_bytes)i=await r.encode(i);return i},async decode(n){e||(e=await gi(t));for(let r=e.bytes_to_bytes.length-1;r>=0;r--)n=await e.bytes_to_bytes[r].decode(n);let i=await e.array_to_bytes.decode(n);for(let r=e.array_to_array.length-1;r>=0;r--)i=await e.array_to_array[r].decode(i);return i}}}async function gi(t){let e=t.codecs.map(async s=>{var a;let o=await((a=gs.get(s.name))==null?void 0:a());if(!o)throw new Error(`Unknown codec: ${s.name}`);return{Codec:o,meta:s}}),n=[],i,r=[];for await(let{Codec:s,meta:o}of e){let a=s.fromConfig(o.configuration,t);switch(a.kind){case"array_to_array":n.push(a);break;case"array_to_bytes":i=a;break;default:r.push(a)}}if(!i){if(!ms(t))throw new Error(`Cannot encode ${t.data_type} to bytes without a codec`);i=on.fromConfig({endian:"little"},t)}return{array_to_array:n,array_to_bytes:i,bytes_to_bytes:r}}function ms(t){return t.data_type!=="v2:object"}const mi=18446744073709551615n;function ps(t,e,n,i){if(t.store.getRange===void 0)throw new Error("Store does not support range requests");let r=t.store.getRange.bind(t.store),s=e.map((l,h)=>l/i.chunk_shape[h]),o=zn({data_type:"uint64",shape:[...s,2],codecs:i.index_codecs}),a={};return async l=>{let h=l.map((T,P)=>Math.floor(T/s[P])),f=t.resolve(n(h)).path,m;if(f in a)m=a[f];else{let T=4,P=16*s.reduce((H,$)=>H*$,1),X=await r(f,{suffixLength:P+T});m=a[f]=X?await o.decode(X):null}if(m===null)return;let{data:b,shape:p,stride:g}=m,y=l.map((T,P)=>T%p[P]).reduce((T,P,X)=>T+P*g[X],0),x=b[y],S=b[y+1];if(!(x===mi&&S===mi))return r(f,{offset:Number(x),length:Number(S)})}}class Et{constructor(e,n="/"){ie(this,"store");ie(this,"path");this.store=e,this.path=n}resolve(e){let n=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new Et(this.store,new URL(e,n).pathname)}}var Ut;class Un extends Et{constructor(n,i,r){super(n,i);ie(this,"kind","group");Ee(this,Ut);pe(this,Ut,r)}get attrs(){return Z(this,Ut).attributes}}Ut=new WeakMap;const It=Symbol("zarrita.context");function bs(t){return t[It]}function ys(t,e){let{configuration:n}=e.codecs.find(ls)??{},i={encode_chunk_key:ts(e.chunk_key_encoding),TypedArray:tr(e.data_type),fill_value:e.fill_value};if(n){let s=An(n.codecs);return{...i,kind:"sharded",chunk_shape:n.chunk_shape,codec:zn({data_type:e.data_type,shape:n.chunk_shape,codecs:n.codecs}),get_strides(o,a){return ct(o,a??s)},get_chunk_bytes:ps(t,e.chunk_grid.configuration.chunk_shape,i.encode_chunk_key,n)}}let r=An(e.codecs);return{...i,kind:"regular",chunk_shape:e.chunk_grid.configuration.chunk_shape,codec:zn({data_type:e.data_type,shape:e.chunk_grid.configuration.chunk_shape,codecs:e.codecs}),get_strides(s,o){return ct(s,o??r)},async get_chunk_bytes(s,o){let a=i.encode_chunk_key(s),l=t.resolve(a).path;return t.store.get(l,o)}}}var Bi,ji,ut,Wi;let ln=(Wi=class extends(ji=Et,Bi=It,ji){constructor(n,i,r){super(n,i);ie(this,"kind","array");Ee(this,ut);ie(this,Bi);pe(this,ut,{...r,fill_value:nr(r)}),this[It]=ys(this,r)}get attrs(){return Z(this,ut).attributes}get shape(){return Z(this,ut).shape}get chunks(){return this[It].chunk_shape}get dtype(){return Z(this,ut).data_type}async getChunk(n,i){let r=this[It],s=await r.get_chunk_bytes(n,i);if(!s){let o=r.chunk_shape.reduce((l,h)=>l*h,1),a=new r.TypedArray(o);return a.fill(r.fill_value),{data:a,shape:r.chunk_shape,stride:r.get_strides(r.chunk_shape)}}return r.codec.decode(s)}is(n){return os(this.dtype,n)}},ut=new WeakMap,Wi),un=vs();function vs(){let t=new WeakMap;function e(n){let i=t.get(n)??{v2:0,v3:0};return t.set(n,i),i}return{increment(n,i){e(n)[i]+=1},version_max(n){let i=e(n);return i.v3>i.v2?"v3":"v2"}}}async function ws(t){let e=await t.store.get(t.resolve(".zattrs").path);return e?Gt(e):{}}async function ks(t,e={}){let n="store"in t?t:new Et(t),i={};return(e.attrs??!0)&&(i=await ws(n)),e.kind==="array"?pi(n,i):e.kind==="group"?bi(n,i):pi(n,i).catch(r=>{if(r instanceof Kt)return bi(n,i);throw r})}async function pi(t,e){let{path:n}=t.resolve(".zarray"),i=await t.store.get(n);if(!i)throw new Kt("v2 array",{cause:new Dn(n)});return un.increment(t.store,"v2"),new ln(t.store,t.path,rs(Gt(i),e))}async function bi(t,e){let{path:n}=t.resolve(".zgroup"),i=await t.store.get(n);if(!i)throw new Kt("v2 group",{cause:new Dn(n)});return un.increment(t.store,"v2"),new Un(t.store,t.path,ss(Gt(i),e))}async function Es(t){let{store:e,path:n}=t.resolve("zarr.json"),i=await t.store.get(n);if(!i)throw new Kt("v3 array or group",{cause:new Dn(n)});let r=Gt(i);return r.node_type==="array"&&(r.fill_value=nr(r)),r.node_type==="array"?new ln(e,t.path,r):new Un(e,t.path,r)}async function Cs(t,e={}){let n="store"in t?t:new Et(t),i=await Es(n);if(un.increment(n.store,"v3"),e.kind===void 0||e.kind==="array"&&i instanceof ln||e.kind==="group"&&i instanceof Un)return i;let r=i instanceof ln?"array":"group";throw new Error(`Expected node of kind ${e.kind}, found ${r}.`)}async function at(t,e={}){let n="store"in t?t.store:t,i=un.version_max(n),r=i==="v2"?at.v2:at.v3,s=i==="v2"?at.v3:at.v2;return r(t,e).catch(o=>{if(o instanceof Kt)return s(t,e);throw o})}at.v2=ks;at.v3=Cs;function*As(t,e,n=1){e===void 0&&(e=t,t=0);for(let i=t;i<e;i+=n)yield i}function*Ss(...t){if(t.length===0)return;const e=t.map(i=>i[Symbol.iterator]()),n=e.map(i=>i.next());if(n.some(i=>i.done))throw new Error("Input contains an empty iterator.");for(let i=0;;){if(n[i].done){if(e[i]=t[i][Symbol.iterator](),n[i]=e[i].next(),++i>=e.length)return}else yield n.map(({value:r})=>r),i=0;n[i]=e[i].next()}}function Is({start:t,stop:e,step:n},i){if(n===0)throw new Error("slice step cannot be zero");n=n??1;const r=n<0,[s,o]=r?[-1,i-1]:[0,i];return t===null?t=r?o:s:t<0?(t+=i,t<s&&(t=s)):t>o&&(t=o),e===null?e=r?s:o:e<0?(e+=i,e<s&&(e=s)):e>o&&(e=o),[t,e,n]}function Tn(t,e,n=null){return e===void 0&&(e=t,t=null),{start:t,stop:e,step:n}}function zs(){const t=[];return{add:e=>t.push(e()),onIdle:()=>Promise.all(t)}}class Bn extends Error{constructor(e){super(e),this.name="IndexError"}}function Ts(t,e){throw new Bn(`too many indicies for array; expected ${e.length}, got ${t.length}`)}function Rs(t){throw new Bn(`index out of bounds for dimension with length ${t}`)}function Os(){throw new Bn("only slices with step >= 1 are supported")}function Ls(t,e){t.length>e.length&&Ts(t,e)}function Ms(t,e){return t=Math.trunc(t),t<0&&(t=e+t),(t>=e||t<0)&&Rs(e),t}class Fs{constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){ie(this,"dim_sel");ie(this,"dim_len");ie(this,"dim_chunk_len");ie(this,"nitems");e=Ms(e,n),this.dim_sel=e,this.dim_len=n,this.dim_chunk_len=i,this.nitems=1}*[Symbol.iterator](){const e=Math.floor(this.dim_sel/this.dim_chunk_len),n=e*this.dim_chunk_len,i=this.dim_sel-n;yield{dim_chunk_ix:e,dim_chunk_sel:i}}}class yi{constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){ie(this,"start");ie(this,"stop");ie(this,"step");ie(this,"dim_len");ie(this,"dim_chunk_len");ie(this,"nitems");ie(this,"nchunks");const[r,s,o]=Is(e,n);this.start=r,this.stop=s,this.step=o,this.step<1&&Os(),this.dim_len=n,this.dim_chunk_len=i,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const e=Math.floor(this.start/this.dim_chunk_len),n=Math.ceil(this.stop/this.dim_chunk_len);for(const i of As(e,n)){const r=i*this.dim_chunk_len,s=Math.min(this.dim_len,(i+1)*this.dim_chunk_len),o=s-r;let a=0,l=0;if(this.start<r){const p=(r-this.start)%this.step;p&&(l+=this.step-p),a=Math.ceil((r-this.start)/this.step)}else l=this.start-r;const h=this.stop>s?o:this.stop-r,f=[l,h,this.step],m=Math.ceil((h-l)/this.step),b=[a,a+m,1];yield{dim_chunk_ix:i,dim_chunk_sel:f,dim_out_sel:b}}}}function Ds(t,e){let n=[];return t===null?n=e.map(i=>Tn(null)):Array.isArray(t)&&(n=t.map(i=>i??Tn(null))),Ls(n,e),n}class Ns{constructor({selection:e,shape:n,chunk_shape:i}){ie(this,"dim_indexers");ie(this,"shape");this.dim_indexers=Ds(e,n).map((r,s)=>new(typeof r=="number"?Fs:yi)({dim_sel:r,dim_len:n[s],dim_chunk_len:i[s]})),this.shape=this.dim_indexers.filter(r=>r instanceof yi).map(r=>r.nitems)}*[Symbol.iterator](){for(const e of Ss(...this.dim_indexers)){const n=e.map(r=>r.dim_chunk_ix),i=e.map(r=>"dim_out_sel"in r?{from:r.dim_chunk_sel,to:r.dim_out_sel}:{from:r.dim_chunk_sel,to:null});yield{chunk_coords:n,mapping:i}}}}function Ps(t,e){return"get"in t?t.get(e):t[e]}async function xs(t,e,n,i){var l;let r=bs(t),s=new Ns({selection:e,shape:t.shape,chunk_shape:t.chunks}),o=i.prepare(new r.TypedArray(s.shape.reduce((h,f)=>h*f,1)),s.shape,r.get_strides(s.shape,n.order)),a=((l=n.create_queue)==null?void 0:l.call(n))??zs();for(const{chunk_coords:h,mapping:f}of s)a.add(async()=>{let{data:m,shape:b,stride:p}=await t.getChunk(h,n.opts),g=i.prepare(m,b,p);i.set_from_chunk(o,g,f)});return await a.onIdle(),s.shape.length===0?Ps(o.data,0):o}function jn(t,e=0,n){let i=n??t.length-e;return{length:i,subarray(r,s=i){return jn(t,e+r,s-r)},set(r,s=0){for(let o=0;o<r.length;o++)t[e+s+o]=r.get(o)},get(r){return t[e+r]}}}function pn(t){return globalThis.Array.isArray(t.data)?{data:jn(t.data),stride:t.stride,bytes_per_element:1}:{data:new Uint8Array(t.data.buffer,t.data.byteOffset,t.data.byteLength),stride:t.stride,bytes_per_element:t.data.BYTES_PER_ELEMENT}}function Us(t){return"chars"in t?t.constructor.bind(null,t.chars):t.constructor}function Bs(t,e){if(globalThis.Array.isArray(t.data))return jn([e]);let n=Us(t.data),i=new n([e]);return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}const js={prepare(t,e,n){return{data:t,shape:e,stride:n}},set_scalar(t,e,n){let i=pn(t);Rn(i,e,Bs(t,n),i.bytes_per_element)},set_from_chunk(t,e,n){let i=pn(t);rn(i,pn(e),i.bytes_per_element,n)}};async function Ws(t,e=null,n={}){return xs(t,e,n,js)}function ir(t,e,n){return n<0&&e<t?Math.floor((t-e-1)/-n)+1:t<e?Math.floor((e-t-1)/n)+1:0}function Rn(t,e,n,i){if(e.length===0){t.data.set(n,0);return}const[r,...s]=e,[o,...a]=t.stride;if(typeof r=="number"){const b=t.data.subarray(o*r*i);Rn({data:b,stride:a},s,n,i);return}const[l,h,f]=r,m=ir(l,h,f);if(s.length===0){for(let b=0;b<m;b++)t.data.set(n,o*(l+f*b)*i);return}for(let b=0;b<m;b++){const p=t.data.subarray(o*(l+f*b)*i);Rn({data:p,stride:a},s,n,i)}}function rn(t,e,n,i){const[r,...s]=i,[o,...a]=t.stride,[l,...h]=e.stride;if(r.from===null){if(s.length===0){t.data.set(e.data.subarray(0,n),r.to*n);return}rn({data:t.data.subarray(o*r.to*n),stride:a},e,n,s);return}if(r.to===null){if(s.length===0){let S=r.from*n;t.data.set(e.data.subarray(S,S+n),0);return}rn(t,{data:e.data.subarray(l*r.from*n),stride:h},n,s);return}const[f,m,b]=r.to,[p,g,y]=r.from,x=ir(f,m,b);if(s.length===0){if(b===1&&y===1&&o===1&&l===1){let S=p*n,T=x*n;t.data.set(e.data.subarray(S,S+T),f*n);return}for(let S=0;S<x;S++){let T=l*(p+y*S)*n;t.data.set(e.data.subarray(T,T+n),o*(f+b*S)*n)}return}for(let S=0;S<x;S++)rn({data:t.data.subarray(o*(f+S*b)*n),stride:a},{data:e.data.subarray(l*(p+S*y)*n),stride:h},n,s)}function rr(t,e,n,i={}){return e!==void 0&&n!==void 0&&(i={...i,headers:{...i.headers,Range:`bytes=${e}-${e+n-1}`}}),fetch(t,i)}function Hs(t,e){return{...t,...e,headers:{...t.headers,...e.headers}}}function vi(t,e){const n=typeof t=="string"?new URL(t):t;n.pathname.endsWith("/")||(n.pathname+="/");const i=new URL(e.slice(1),n);return i.search=n.search,i}async function wi(t){if(!(t.status===404||t.status===403)){if(t.status===200||t.status===206)return new Uint8Array(await t.arrayBuffer());throw new Error(`Unexpected response status ${t.status} ${t.statusText}`)}}async function qs(t,e,n,i){if(i)return fetch(t,{...n,headers:{...n.headers,Range:`bytes=-${e}`}});let r=await fetch(t,{...n,method:"HEAD"});if(!r.ok)return r;let s=r.headers.get("Content-Length"),o=Number(s);return rr(t,o-e,o,n)}var Bt,jt,Wt,On;class Vs{constructor(e,n={}){Ee(this,Wt);ie(this,"url");Ee(this,Bt);Ee(this,jt);this.url=e,pe(this,Bt,n.overrides??{}),pe(this,jt,n.useSuffixRequest??!1)}async get(e,n={}){let i=vi(this.url,e).href,r=await fetch(i,_n(this,Wt,On).call(this,n));return wi(r)}async getRange(e,n,i={}){let r=vi(this.url,e),s=_n(this,Wt,On).call(this,i),o;return"suffixLength"in n?o=await qs(r,n.suffixLength,s,Z(this,jt)):o=await rr(r,n.offset,n.length,s),wi(o)}}Bt=new WeakMap,jt=new WeakMap,Wt=new WeakSet,On=function(e){return Hs(Z(this,Bt),e)};function Ks(t){let e,n;return{c(){e=k("div"),n=k("canvas"),le(n,"width",t[3]+"px"),le(n,"height",t[4]+"px"),le(n,"background-color","lightgrey"),w(n,"height",t[2]),w(n,"width",t[1]),w(n,"class","svelte-lwhhyg"),w(e,"class","canvasWrapper svelte-lwhhyg"),le(e,"width",t[3]+"px"),le(e,"height",t[4]+"px"),nt(e,"spinner",t[5])},m(i,r){q(i,e,r),_(e,n),t[12](n)},p(i,[r]){r&8&&le(n,"width",i[3]+"px"),r&16&&le(n,"height",i[4]+"px"),r&4&&w(n,"height",i[2]),r&2&&w(n,"width",i[1]),r&8&&le(e,"width",i[3]+"px"),r&16&&le(e,"height",i[4]+"px"),r&32&&nt(e,"spinner",i[5])},i:ye,o:ye,d(i){i&&W(e),t[12](null)}}}function Gs(t,e,n){let{source:i}=e,{attrs:r}=e,{thumbDatasetIndex:s=void 0}=e,{thumbAspectRatio:o=1}=e,{cssSize:a=120}=e,{max_size:l=512}=e,h,f=a,m=a;o>1?m=f/o:o<1&&(f=m*o);let b=f,p=m,g=!0;const y=new AbortController;async function x(){var z;let T=r.multiscales[0].datasets.map(G=>G.path),P=r.multiscales[0].axes.map(G=>G.name),X=T.at(-1);s!=null&&s<T.length&&(X=T[s]);const H=new Vs(i+"/"+X),$=await at.v3(H,{kind:"array"});let O=P.indexOf("c"),c=$.shape;if(c.at(-1)*c.at(-2)>l*l){console.log("Lowest resolution too large for Thumbnail: ",c,i);return}let u=c.length,d=c[O]||1,v,I;(z=r==null?void 0:r.omero)!=null&&z.channels?(v=r.omero.channels.map(G=>G.active),I=r.omero.channels.map(G=>Zi(G.color))):(v=Fr(d),I=Dr(d,v)),I=I.filter((G,V)=>v[V]);let D=v.reduce((G,V,R)=>(V&&G.push(R),G),[]).map(G=>{let V=c.map((R,J)=>J==O?G:J>=u-2?Tn(0,R):P[J]=="z"||P[J]=="t"?parseInt(R/2+""):0);return Ws($,V,{opts:{signal:y.signal}})}),re=await Promise.all(D),ee=re.map(G=>Yi(G)),A=Tr(re,ee,I);n(1,f=c.at(-1)),n(2,m=c.at(-2));let N=f/a;m>f&&(N=m/a),n(3,b=f/N),n(4,p=m/N),setTimeout(()=>{const G=h.getContext("2d");n(5,g=!1),G.putImageData(new ImageData(A,f,m),0,0)},100)}Ht(()=>{x()}),Fn(()=>{y.abort()});function S(T){wt[T?"unshift":"push"](()=>{h=T,n(0,h)})}return t.$$set=T=>{"source"in T&&n(6,i=T.source),"attrs"in T&&n(7,r=T.attrs),"thumbDatasetIndex"in T&&n(8,s=T.thumbDatasetIndex),"thumbAspectRatio"in T&&n(9,o=T.thumbAspectRatio),"cssSize"in T&&n(10,a=T.cssSize),"max_size"in T&&n(11,l=T.max_size)},[h,f,m,b,p,g,i,r,s,o,a,l,S]}class sr extends Je{constructor(e){super(),Ge(this,e,Gs,Ks,xe,{source:6,attrs:7,thumbDatasetIndex:8,thumbAspectRatio:9,cssSize:10,max_size:11})}}const Js="/zowser/copy.png",Ys="/zowser/ome-logomark.svg",Zs="/zowser/original-data.svg";function ki(t,e,n){const i=t.slice();return i[15]=e[n],i}function Ei(t){let e,n;return e=new sr({props:{source:t[4],attrs:t[3],max_size:2e3,thumbDatasetIndex:t[5],thumbAspectRatio:t[6]}}),{c(){Ke(e.$$.fragment)},m(i,r){We(e,i,r),n=!0},p(i,r){const s={};r&16&&(s.source=i[4]),r&8&&(s.attrs=i[3]),r&32&&(s.thumbDatasetIndex=i[5]),r&64&&(s.thumbAspectRatio=i[6]),e.$set(s)},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){He(e,i)}}}function Ci(t){let e,n,i,r,s,o,a,l=t[0].source+"",h,f,m=t[0].csv&&Ai(t);return{c(){e=k("div"),n=k("span"),n.textContent="Data",i=K(),m&&m.c(),r=K(),s=k("span"),s.textContent="provided by",o=K(),a=k("strong"),h=Q(l),f=Q("."),w(n,"class","hideOnSmall svelte-16ztcjr"),w(s,"class","hideOnSmall svelte-16ztcjr"),le(a,"color","grey")},m(b,p){q(b,e,p),_(e,n),_(e,i),m&&m.m(e,null),_(e,r),_(e,s),_(e,o),_(e,a),_(a,h),_(e,f)},p(b,p){b[0].csv?m?m.p(b,p):(m=Ai(b),m.c(),m.m(e,r)):m&&(m.d(1),m=null),p&1&&l!==(l=b[0].source+"")&&Se(h,l)},d(b){b&&W(e),m&&m.d()}}}function Ai(t){var a;let e,n,i,r=((a=t[0].csv)==null?void 0:a.split("/").pop().replace(".csv",""))+"",s,o;return{c(){e=k("span"),e.textContent="from collection",n=K(),i=k("a"),s=Q(r),w(e,"class","hideOnSmall svelte-16ztcjr"),w(i,"title","Show collection in a new tab"),w(i,"href",o=Ti(t[0])),w(i,"target","_blank")},m(l,h){q(l,e,h),q(l,n,h),q(l,i,h),_(i,s)},p(l,h){var f;h&1&&r!==(r=((f=l[0].csv)==null?void 0:f.split("/").pop().replace(".csv",""))+"")&&Se(s,r),h&1&&o!==(o=Ti(l[0]))&&w(i,"href",o)},d(l){l&&(W(e),W(n),W(i))}}}function Si(t){let e,n,i,r,s;return{c(){e=k("a"),n=k("img"),w(n,"class","icon svelte-16ztcjr"),le(n,"opacity","0.9"),Ln(n.src,i=Zs)||w(n,"src",i),w(e,"title",r="Link to original data: "+t[0].origin),w(e,"href",s=t[0].origin),w(e,"target","_blank")},m(o,a){q(o,e,a),_(e,n)},p(o,a){a&1&&r!==(r="Link to original data: "+o[0].origin)&&w(e,"title",r),a&1&&s!==(s=o[0].origin)&&w(e,"href",s)},d(o){o&&W(e)}}}function Ii(t){let e=t[15].toUpperCase()+"",n,i,r=t[0][`size_${t[15]}`]+"",s,o;return{c(){n=Q(e),i=Q(":"),s=Q(r),o=Q("  ")},m(a,l){q(a,n,l),q(a,i,l),q(a,s,l),q(a,o,l)},p(a,l){l&1&&r!==(r=a[0][`size_${a[15]}`]+"")&&Se(s,r)},d(a){a&&(W(n),W(i),W(s),W(o))}}}function zi(t){let e,n=t[0][`size_${t[15]}`]!==void 0&&Ii(t);return{c(){n&&n.c(),e=an()},m(i,r){n&&n.m(i,r),q(i,e,r)},p(i,r){i[0][`size_${i[15]}`]!==void 0?n?n.p(i,r):(n=Ii(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(i){i&&W(e),n&&n.d(i)}}}function Qs(t){let e,n,i=kt(t[0].written)+"",r;return{c(){e=k("div"),n=Q("Data size: "),r=Q(i)},m(s,o){q(s,e,o),_(e,n),_(e,r)},p(s,o){o&1&&i!==(i=kt(s[0].written)+"")&&Se(r,i)},d(s){s&&W(e)}}}function Xs(t){let e,n,i=t[0].shards+"",r;return{c(){e=k("div"),n=Q("Shard shape: "),r=Q(i)},m(s,o){q(s,e,o),_(e,n),_(e,r)},p(s,o){o&1&&i!==(i=s[0].shards+"")&&Se(r,i)},d(s){s&&W(e)}}}function $s(t){let e,n,i=t[0].chunks+"",r;return{c(){e=k("div"),n=Q("Chunk shape: "),r=Q(i)},m(s,o){q(s,e,o),_(e,n),_(e,r)},p(s,o){o&1&&i!==(i=s[0].chunks+"")&&Se(r,i)},d(s){s&&W(e)}}}function eo(t){let e,n,i,r,s,o,a=t[10](t[0].url)+"",l,h,f,m=(t[0].name?t[0].name.replaceAll(t[1],`<mark>${t[1]}</mark>`):"")+"",b,p,g,y=t[8].replaceAll(t[1],`<mark>${t[1]}</mark>`)+"",x,S,T,P,X,H,$,O,c,u,d,v,I,F,D,re,ee,A=t[3]&&Ei(t),N=t[0].source&&Ci(t),z=t[0].origin&&Si(t),G=Ve(["t","c","z","y","x"]),V=[];for(let E=0;E<5;E+=1)V[E]=zi(ki(t,G,E));function R(E,B){return E[2]=="chunk_pixels"?$s:E[2]=="shard_pixels"?Xs:Qs}let J=R(t),C=J(t);return{c(){e=k("div"),n=k("div"),A&&A.c(),i=K(),r=k("div"),s=k("div"),o=k("strong"),h=K(),f=k("div"),p=K(),g=k("div"),x=K(),N&&N.c(),S=K(),T=k("div"),P=k("button"),P.innerHTML=`<img class="icon svelte-16ztcjr" src="${Js}"/>`,X=K(),H=k("a"),$=k("img"),u=K(),z&&z.c(),d=K(),v=k("div"),I=Q(`Image size:
      `);for(let E=0;E<5;E+=1)V[E].c();F=K(),C.c(),w(n,"class","thumbWrapper svelte-16ztcjr"),w(s,"title",l=t[0].url),w(f,"class",b=ti(t[1]==""?"hideOnSmall":"")+" svelte-16ztcjr"),w(P,"class","no_border svelte-16ztcjr"),w(P,"title","Copy S3 URL to clipboard"),nt(P,"shake",t[7]),w($,"class","icon svelte-16ztcjr"),le($,"opacity","0.9"),Ln($.src,O=Ys)||w($,"src",O),w(H,"title","Validate NGFF with 'ome-ngff-validator' in new browser tab"),w(H,"target","_blank"),w(H,"href",c="https://ome.github.io/ome-ngff-validator/?source="+t[0].url),w(e,"class","zarr-list-item svelte-16ztcjr")},m(E,B){q(E,e,B),_(e,n),A&&A.m(n,null),_(e,i),_(e,r),_(r,s),_(s,o),o.innerHTML=a,_(r,h),_(r,f),f.innerHTML=m,_(r,p),_(r,g),g.innerHTML=y,_(r,x),N&&N.m(r,null),_(r,S),_(r,T),_(T,P),_(T,X),_(T,H),_(H,$),_(T,u),z&&z.m(T,null),_(r,d),_(r,v),_(v,I);for(let U=0;U<5;U+=1)V[U]&&V[U].m(v,null);_(r,F),C.m(r,null),D=!0,re||(ee=[we(n,"click",t[9]),we(P,"click",t[12])],re=!0)},p(E,[B]){if(E[3]?A?(A.p(E,B),B&8&&ae(A,1)):(A=Ei(E),A.c(),ae(A,1),A.m(n,null)):A&&(qt(),he(A,1,1,()=>{A=null}),Vt()),(!D||B&1)&&a!==(a=E[10](E[0].url)+"")&&(o.innerHTML=a),(!D||B&1&&l!==(l=E[0].url))&&w(s,"title",l),(!D||B&3)&&m!==(m=(E[0].name?E[0].name.replaceAll(E[1],`<mark>${E[1]}</mark>`):"")+"")&&(f.innerHTML=m),(!D||B&2&&b!==(b=ti(E[1]==""?"hideOnSmall":"")+" svelte-16ztcjr"))&&w(f,"class",b),(!D||B&258)&&y!==(y=E[8].replaceAll(E[1],`<mark>${E[1]}</mark>`)+"")&&(g.innerHTML=y),E[0].source?N?N.p(E,B):(N=Ci(E),N.c(),N.m(r,S)):N&&(N.d(1),N=null),(!D||B&128)&&nt(P,"shake",E[7]),(!D||B&1&&c!==(c="https://ome.github.io/ome-ngff-validator/?source="+E[0].url))&&w(H,"href",c),E[0].origin?z?z.p(E,B):(z=Si(E),z.c(),z.m(T,null)):z&&(z.d(1),z=null),B&1){G=Ve(["t","c","z","y","x"]);let U;for(U=0;U<5;U+=1){const Y=ki(E,G,U);V[U]?V[U].p(Y,B):(V[U]=zi(Y),V[U].c(),V[U].m(v,null))}for(;U<5;U+=1)V[U].d(1)}J===(J=R(E))&&C?C.p(E,B):(C.d(1),C=J(E),C&&(C.c(),C.m(r,null)))},i(E){D||(ae(A),D=!0)},o(E){he(A),D=!1},d(E){E&&W(e),A&&A.d(),N&&N.d(),z&&z.d(),sn(V,E),C.d(),re=!1,et(ee)}}}function Ti(t){return window.location.origin+window.location.pathname+"?csv="+t.csv}function to(t,e,n){let i,{rowData:r}=e,{textFilter:s}=e,{sortedBy:o=void 0}=e,a,l,h,f=1;const m=new AbortController;if(r.size_x&&r.size_y){let S=Math.max(r.size_x,r.size_y);for(h=0;S>256;)h+=1,S=S/2;f=r.size_x/r.size_y}function b(){console.log("Clicked on thumbnail"),je.setSelectedRow(r)}function p(S){if(s&&S.toLowerCase().includes(s.toLowerCase())){let P=S.toLowerCase(),X=s.toLowerCase(),H=P.indexOf(X),$=Math.max(0,Math.min(H,S.length-50)),O=S.substring($,H);return O+="<mark>",O+=S.substring(H,H+X.length),O+="</mark>",O+=S.substring(H+X.length),O}return S.split("/").pop()}Ht(async()=>{let S=r.url;r.series0!==void 0&&(S+="/"+r.series0);let T=await Rt(S,m.signal);n(3,a=T[0]),n(4,l=T[1]),T[2]}),Fn(()=>{m.abort()});let g=!1;function y(S){var T=document.createElement("textarea");T.style.position="fixed",T.value=S,document.body.appendChild(T),T.focus(),T.select();let P=!1;try{P=document.execCommand("copy")}catch{console.log("Oops, unable to copy")}document.body.removeChild(T),P&&(n(7,g=!0),setTimeout(()=>n(7,g=!1),1e3))}const x=S=>y(r.url);return t.$$set=S=>{"rowData"in S&&n(0,r=S.rowData),"textFilter"in S&&n(1,s=S.textFilter),"sortedBy"in S&&n(2,o=S.sortedBy)},t.$$.update=()=>{var S;t.$$.dirty&3&&n(8,i=s!=""&&((S=r.description)!=null&&S.toLowerCase().includes(s.toLowerCase()))?r.description:"")},[r,s,o,a,l,h,f,g,i,b,p,y,x]}class no extends Je{constructor(e){super(),Ge(this,e,to,eo,xe,{rowData:0,textFilter:1,sortedBy:2})}}function io(t){let e,n,i,r;return n=new no({props:{rowData:t[0][t[13]],textFilter:t[1],sortedBy:t[2]}}),{c(){e=k("div"),Ke(n.$$.fragment),w(e,"slot","item"),w(e,"style",i=t[12]),w(e,"class","row svelte-1xlep2t")},m(s,o){q(s,e,o),We(n,e,null),r=!0},p(s,o){const a={};o&8193&&(a.rowData=s[0][s[13]]),o&2&&(a.textFilter=s[1]),o&4&&(a.sortedBy=s[2]),n.$set(a),(!r||o&4096&&i!==(i=s[12]))&&w(e,"style",i)},i(s){r||(ae(n.$$.fragment,s),r=!0)},o(s){he(n.$$.fragment,s),r=!1},d(s){s&&W(e),He(n)}}}function ro(t){let e=!1,n=()=>{e=!1},i,r,s,o=`${t[5]}px`,a,l,h;return it(t[8]),it(t[9]),s=new Jr({props:{width:"100%",height:t[5],itemCount:t[0].length,itemSize:160,getKey:t[6],$$slots:{item:[io,({style:f,index:m})=>({12:f,13:m}),({style:f,index:m})=>(f?4096:0)|(m?8192:0)]},$$scope:{ctx:t}}}),s.$on("afterScroll",t[7]),{c(){r=k("div"),Ke(s.$$.fragment),w(r,"class","imageListContainer svelte-1xlep2t"),le(r,"height",o)},m(f,m){q(f,r,m),We(s,r,null),t[10](r),a=!0,l||(h=[we(window,"resize",t[8]),we(window,"scroll",()=>{e=!0,clearTimeout(i),i=setTimeout(n,100),t[9]()})],l=!0)},p(f,[m]){m&16&&!e&&(e=!0,clearTimeout(i),scrollTo(window.pageXOffset,f[4]),i=setTimeout(n,100));const b={};m&32&&(b.height=f[5]),m&1&&(b.itemCount=f[0].length),m&28679&&(b.$$scope={dirty:m,ctx:f}),s.$set(b),m&32&&o!==(o=`${f[5]}px`)&&le(r,"height",o)},i(f){a||(ae(s.$$.fragment,f),a=!0)},o(f){he(s.$$.fragment,f),a=!1},d(f){f&&W(r),He(s),t[10](null),l=!1,et(h)}}}function so(t,e,n){let i,{tableRows:r}=e,{textFilter:s}=e,{sortedBy:o=void 0}=e;function a(y){return r[y].url}let l,h=0,f=0;function m(y){let S=l.offsetTop-20;y.detail.offset-f<0&&h>S&&n(4,h-=1),f=y.detail.offset}function b(){n(5,i=window.innerHeight)}function p(){n(4,h=window.pageYOffset)}function g(y){wt[y?"unshift":"push"](()=>{l=y,n(3,l)})}return t.$$set=y=>{"tableRows"in y&&n(0,r=y.tableRows),"textFilter"in y&&n(1,s=y.textFilter),"sortedBy"in y&&n(2,o=y.sortedBy)},n(5,i=0),[r,s,o,l,h,i,a,m,b,p,g]}class oo extends Je{constructor(e){super(),Ge(this,e,so,ro,xe,{tableRows:0,textFilter:1,sortedBy:2})}}function Ri(t){let e,n;return e=new sr({props:{source:t[1],attrs:t[0],cssSize:512,max_size:2e3,thumbDatasetIndex:t[2],thumbAspectRatio:t[3]}}),{c(){Ke(e.$$.fragment)},m(i,r){We(e,i,r),n=!0},p(i,r){const s={};r&2&&(s.source=i[1]),r&1&&(s.attrs=i[0]),r&4&&(s.thumbDatasetIndex=i[2]),r&8&&(s.thumbAspectRatio=i[3]),e.$set(s)},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){He(e,i)}}}function lo(t){let e,n,i=t[0]&&Ri(t);return{c(){i&&i.c(),e=an()},m(r,s){i&&i.m(r,s),q(r,e,s),n=!0},p(r,[s]){r[0]?i?(i.p(r,s),s&1&&ae(i,1)):(i=Ri(r),i.c(),ae(i,1),i.m(e.parentNode,e)):i&&(qt(),he(i,1,1,()=>{i=null}),Vt())},i(r){n||(ae(i),n=!0)},o(r){he(i),n=!1},d(r){r&&W(e),i&&i.d(r)}}}function ao(t,e,n){let{rowData:i}=e;console.log("ThumbLoader",i);let r,s,o,a=1;if(i.size_x&&i.size_y){let l=Math.max(i.size_x,i.size_y);for(o=0;l>1024;)o+=1,l=l/2;a=i.size_x/i.size_y}else o=void 0,a=1;return Ht(async()=>{let l=await Rt(i.url);n(0,r=l[0]),n(1,s=l[1]),l[2]}),t.$$set=l=>{"rowData"in l&&n(4,i=l.rowData)},[r,s,o,a,i]}class uo extends Je{constructor(e){super(),Ge(this,e,ao,lo,xe,{rowData:4})}}function Oi(t,e,n){const i=t.slice();return i[5]=e[n][0],i[6]=e[n][1],i}function Li(t){let e,n;return e=new uo({props:{rowData:t[1]}}),{c(){Ke(e.$$.fragment)},m(i,r){We(e,i,r),n=!0},p(i,r){const s={};r&2&&(s.rowData=i[1]),e.$set(s)},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){He(e,i)}}}function Mi(t){let e,n,i=t[2]&&Li(t);return{c(){i&&i.c(),e=an()},m(r,s){i&&i.m(r,s),q(r,e,s),n=!0},p(r,s){r[2]?i?(i.p(r,s),s&4&&ae(i,1)):(i=Li(r),i.c(),ae(i,1),i.m(e.parentNode,e)):i&&(qt(),he(i,1,1,()=>{i=null}),Vt())},i(r){n||(ae(i),n=!0)},o(r){he(i),n=!1},d(r){r&&W(e),i&&i.d(r)}}}function Fi(t){let e,n=Ve(Object.entries(t[1])),i=[];for(let r=0;r<n.length;r+=1)i[r]=Di(Oi(t,n,r));return{c(){e=k("table");for(let r=0;r<i.length;r+=1)i[r].c()},m(r,s){q(r,e,s);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(e,null)},p(r,s){if(s&2){n=Ve(Object.entries(r[1]));let o;for(o=0;o<n.length;o+=1){const a=Oi(r,n,o);i[o]?i[o].p(a,s):(i[o]=Di(a),i[o].c(),i[o].m(e,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}},d(r){r&&W(e),sn(i,r)}}}function Di(t){let e,n,i=t[5]+"",r,s,o=t[6]+"",a;return{c(){e=k("tr"),n=k("td"),r=Q(i),s=k("td"),a=Q(o)},m(l,h){q(l,e,h),_(e,n),_(n,r),_(e,s),_(s,a)},p(l,h){h&2&&i!==(i=l[5]+"")&&Se(r,i),h&2&&o!==(o=l[6]+"")&&Se(a,o)},d(l){l&&W(e)}}}function co(t){let e,n,i,r,s=t[2],o,a,l,h,f=Mi(t),m=t[1]&&Fi(t);return{c(){e=k("div"),n=k("button"),n.textContent="×",i=K(),r=k("div"),f.c(),o=K(),m&&m.c(),w(n,"class","close svelte-1g3sjso"),w(n,"title","Close"),w(r,"class","scrollable svelte-1g3sjso"),w(e,"id","mypopover"),w(e,"popover",""),w(e,"class","svelte-1g3sjso")},m(b,p){q(b,e,p),_(e,n),_(e,i),_(e,r),f.m(r,null),_(r,o),m&&m.m(r,null),t[4](e),a=!0,l||(h=we(n,"click",t[3]),l=!0)},p(b,[p]){p&4&&xe(s,s=b[2])?(qt(),he(f,1,1,ye),Vt(),f=Mi(b),f.c(),ae(f,1),f.m(r,o)):f.p(b,p),b[1]?m?m.p(b,p):(m=Fi(b),m.c(),m.m(r,null)):m&&(m.d(1),m=null)},i(b){a||(ae(f),a=!0)},o(b){he(f),a=!1},d(b){b&&W(e),f.d(b),m&&m.d(),t[4](null),l=!1,h()}}}function fo(t,e,n){let i,r,s;je.subscribeSelectedRow(l=>{console.log("Showing preview for",l),l&&(n(1,r=l),console.log("Showing Thumb preview for",l,r),n(2,s=r.url),i.showPopover())});function o(){i.hidePopover()}Ht(()=>{console.log("Mounted popover",i),i&&i.addEventListener("toggle",l=>{l.newState==="open"||(console.log("Popover has been hidden"),je.setSelectedRow(null))})});function a(l){wt[l?"unshift":"push"](()=>{i=l,n(0,i)})}return[i,r,s,o,a]}class ho extends Je{constructor(e){super(),Ge(this,e,fo,co,xe,{})}}const _o="/zowser/selectCaret.svg",go="/zowser/samples/sample_zarrs_hydrated.csv",mo="/zowser/ome-main-nav.svg";function po(t){let e,n,i,r,s,o,a,l,h,f,m,b,p;return{c(){e=k("base"),n=K(),i=k("nav"),r=k("a"),s=k("img"),a=K(),l=k("a"),h=k("h2"),h.textContent="Zowser — an OME-Zarr browser",f=K(),m=k("div"),b=K(),p=k("a"),p.textContent="About",w(e,"href",t[0]),w(s,"alt","OME Logo"),Ln(s.src,o=mo)||w(s,"src",o),w(s,"class","svelte-qxzspo"),w(r,"class","logolink svelte-qxzspo"),w(r,"href",t[0]),w(h,"class","svelte-qxzspo"),w(l,"href",t[0]),w(l,"class","svelte-qxzspo"),le(m,"flex","1"),w(p,"href","about/"),w(p,"class","svelte-qxzspo"),w(i,"class","svelte-qxzspo")},m(g,y){q(g,e,y),q(g,n,y),q(g,i,y),_(i,r),_(r,s),_(i,a),_(i,l),_(l,h),_(i,f),_(i,m),_(i,b),_(i,p)},p:ye,i:ye,o:ye,d(g){g&&(W(e),W(n),W(i))}}}function bo(t){let e="/zowser/";return console.log("Nav base",e),[e]}class yo extends Je{constructor(e){super(),Ge(this,e,bo,po,xe,{})}}function vo(t,e,n){const i=t.slice();return i[29]=e[n],i}function Ni(t,e,n){const i=t.slice();return i[32]=e[n],i}function Pi(t,e,n){const i=t.slice();return i[32]=e[n],i}function wo(t){let e,n,i,r=t[11].split("/").pop()+"",s,o,a=t[11]!=Cn&&Eo(t);return{c(){e=k("div"),n=Q(`Showing Collection:
          `),i=k("a"),s=Q(r),o=K(),a&&a.c(),w(i,"href",t[11]),le(e,"font-size","90%")},m(l,h){q(l,e,h),_(e,n),_(e,i),_(i,s),_(e,o),a&&a.m(e,null)},p(l,h){l[11]!=Cn&&a.p(l,h)},d(l){l&&W(e),a&&a.d()}}}function ko(t){let e,n=kt(t[2])+"",i,r;return{c(){e=k("strong"),i=Q(n),r=Q(`
        of public bioimage data in Zarr v3 and sharding, with distributed hosting.`),le(e,"font-weight","600")},m(s,o){q(s,e,o),_(e,i),q(s,r,o)},p(s,o){o[0]&4&&n!==(n=kt(s[2])+"")&&Se(i,n)},d(s){s&&(W(e),W(r))}}}function Eo(t){let e,n=kt(t[2])+"",i,r;return{c(){e=Q("("),i=Q(n),r=Q(")")},m(s,o){q(s,e,o),q(s,i,o),q(s,r,o)},p(s,o){o[0]&4&&n!==(n=kt(s[2])+"")&&Se(i,n)},d(s){s&&(W(e),W(i),W(r))}}}function xi(t){let e,n=t[32]+"",i,r;return{c(){e=k("option"),i=Q(n),e.__value=r=t[3][t[32]],Ce(e,e.__value)},m(s,o){q(s,e,o),_(e,i)},p(s,o){o[0]&8&&n!==(n=s[32]+"")&&Se(i,n),o[0]&8&&r!==(r=s[3][s[32]])&&(e.__value=r,Ce(e,e.__value))},d(s){s&&W(e)}}}function Ui(t,e){let n,i=e[32]+"",r,s;return{key:t,first:null,c(){n=k("option"),r=Q(i),n.__value=s=e[4][e[32]],Ce(n,n.__value),this.first=n},m(o,a){q(o,n,a),_(n,r)},p(o,a){e=o,a[0]&16&&i!==(i=e[32]+"")&&Se(r,i),a[0]&16&&s!==(s=e[4][e[32]])&&(n.__value=s,Ce(n,n.__value))},d(o){o&&W(n)}}}function Co(t){let e;return{c(){e=k("option"),e.textContent=`Size: ${t[29].toUpperCase()}`,e.__value="size_"+t[29],Ce(e,e.__value)},m(n,i){q(n,e,i)},p:ye,d(n){n&&W(e)}}}function Ao(t){let e,n,i,r,s,o,a,l,h,f,m,b,p,g,y,x,S,T,P,X,H=t[10]!==""?"All Dimensions":"Dimension Count",$,O,c,u,d,v,I,F,D,re,ee,A,N,z,G=t[9]==""?"Organism":"All Organisms",V,R,J,C,E,B,U,Y,M,j,se=t[8]==""?"Imaging Modality":"All Modalities",ge,oe,ce=[],de=new Map,ue,Ie,me,De,Ue,ze,fe,_e,Ye,te,ke,Te,Ze,qe,Oe,Le,ve,st,Ae,Qe,ft,ht,Xe,Kn,Jt=t[0].length+"",cn,Gn,fn,Jn,Yn,ot,Ne,hn,Zn;e=new ho({});function or(L,ne){return L[11]==Cn?ko:wo}let Yt=or(t)(t),dt=Ve(Object.keys(t[3]).sort()),Me=[];for(let L=0;L<dt.length;L+=1)Me[L]=xi(Pi(t,dt,L));let Zt=Ve(Object.keys(t[4]).sort());const Qn=L=>L[32];for(let L=0;L<Zt.length;L+=1){let ne=Ni(t,Zt,L),be=Qn(ne);de.set(be,ce[L]=Ui(be,ne))}let lr=Ve(["x","y","z","c","t"]),Ct=[];for(let L=0;L<5;L+=1)Ct[L]=Co(vo(t,lr,L));return Qe=new Ur({props:{toggleAscending:t[12],sortAscending:t[6]}}),ot=new oo({props:{tableRows:t[0],textFilter:t[7],sortedBy:t[5]}}),{c(){Ke(e.$$.fragment),n=K(),i=k("main"),r=k("div"),s=k("h3"),Yt.c(),o=K(),a=k("div"),l=k("input"),h=K(),f=k("button"),m=Q("×"),b=K(),p=k("div"),g=k("div"),y=k("div"),x=k("div"),x.textContent="Filter by:",S=K(),T=k("div"),P=k("select"),X=k("option"),$=Q(H),O=k("hr"),c=k("option"),c.textContent="2D",u=k("option"),u.textContent="3D",d=k("option"),d.textContent="4D",v=k("option"),v.textContent="5D",I=K(),F=k("div"),D=k("button"),re=Q("×"),ee=K(),A=k("div"),N=k("select"),z=k("option"),V=Q(G),R=k("hr");for(let L=0;L<Me.length;L+=1)Me[L].c();J=K(),C=k("div"),E=k("button"),B=Q("×"),U=K(),Y=k("div"),M=k("select"),j=k("option"),ge=Q(se),oe=k("hr");for(let L=0;L<ce.length;L+=1)ce[L].c();ue=K(),Ie=k("div"),me=k("button"),De=Q("×"),Ue=K(),ze=k("div"),fe=K(),_e=k("div"),_e.textContent="Sort by:",Ye=K(),te=k("div"),ke=k("select"),Te=k("option"),Te.textContent="--",Ze=k("hr");for(let L=0;L<5;L+=1)Ct[L].c();qe=k("hr"),Oe=k("option"),Oe.textContent="Data Size (bytes)",Le=k("option"),Le.textContent="Chunk Size (pixels)",ve=k("option"),ve.textContent="Shard Size (pixels)",st=K(),Ae=k("div"),Ke(Qe.$$.fragment),ft=K(),ht=k("div"),Xe=k("h3"),Kn=Q("Showing "),cn=Q(Jt),Gn=Q(" out of "),fn=Q(t[1]),Jn=Q(" images"),Yn=K(),Ke(ot.$$.fragment),le(s,"text-align","center"),w(l,"placeholder","Filter by Name or Description"),w(l,"name","textFilter"),w(l,"class","svelte-cmksur"),w(f,"title","Clear Filter"),le(f,"visibility",t[7]!==""?"visible":"hidden"),w(f,"class","svelte-cmksur"),w(a,"class","textInputWrapper svelte-cmksur"),w(r,"class","summary svelte-cmksur"),le(x,"white-space","nowrap"),X.__value="",Ce(X,X.__value),c.__value="2",Ce(c,c.__value),u.__value="3",Ce(u,u.__value),d.__value="4",Ce(d,d.__value),v.__value="5",Ce(v,v.__value),w(P,"class","svelte-cmksur"),t[10]===void 0&&it(()=>t[19].call(P)),w(D,"title","Clear Filter"),le(D,"visibility",t[10]!==""?"visible":"hidden"),w(D,"class","svelte-cmksur"),w(F,"class","svelte-cmksur"),w(T,"class","selectWrapper svelte-cmksur"),z.__value="",Ce(z,z.__value),w(N,"class","svelte-cmksur"),t[9]===void 0&&it(()=>t[20].call(N)),w(E,"title","Clear Filter"),le(E,"visibility",t[9]!==""?"visible":"hidden"),w(E,"class","svelte-cmksur"),w(C,"class","svelte-cmksur"),w(A,"class","selectWrapper svelte-cmksur"),j.__value="",Ce(j,j.__value),w(M,"class","svelte-cmksur"),t[8]===void 0&&it(()=>t[21].call(M)),w(me,"title","Clear Filter"),le(me,"visibility",t[8]!==""?"visible":"hidden"),w(me,"class","svelte-cmksur"),w(Ie,"class","svelte-cmksur"),w(Y,"class","selectWrapper svelte-cmksur"),w(ze,"class","clear"),Te.__value="",Ce(Te,Te.__value),Oe.__value="written",Ce(Oe,Oe.__value),Le.__value="chunk_pixels",Ce(Le,Le.__value),ve.__value="shard_pixels",Ce(ve,ve.__value),w(ke,"class","svelte-cmksur"),w(Ae,"class","svelte-cmksur"),w(te,"class","selectWrapper svelte-cmksur"),w(y,"class","filters svelte-cmksur"),w(g,"class","sidebar svelte-cmksur"),le(Xe,"margin-left","15px"),w(Xe,"class","svelte-cmksur"),w(ht,"class","results svelte-cmksur"),w(p,"class","sidebarContainer svelte-cmksur"),le(i,"--form-select-bg-img","url('"+_o+"')"),w(i,"class","svelte-cmksur")},m(L,ne){We(e,L,ne),q(L,n,ne),q(L,i,ne),_(i,r),_(r,s),Yt.m(s,null),_(r,o),_(r,a),_(a,l),Ce(l,t[7]),_(a,h),_(a,f),_(f,m),_(i,b),_(i,p),_(p,g),_(g,y),_(y,x),_(y,S),_(y,T),_(T,P),_(P,X),_(X,$),_(P,O),_(P,c),_(P,u),_(P,d),_(P,v),_t(P,t[10],!0),_(T,I),_(T,F),_(F,D),_(D,re),_(y,ee),_(y,A),_(A,N),_(N,z),_(z,V),_(N,R);for(let be=0;be<Me.length;be+=1)Me[be]&&Me[be].m(N,null);_t(N,t[9],!0),_(A,J),_(A,C),_(C,E),_(E,B),_(y,U),_(y,Y),_(Y,M),_(M,j),_(j,ge),_(M,oe);for(let be=0;be<ce.length;be+=1)ce[be]&&ce[be].m(M,null);_t(M,t[8],!0),_(Y,ue),_(Y,Ie),_(Ie,me),_(me,De),_(y,Ue),_(y,ze),_(y,fe),_(y,_e),_(y,Ye),_(y,te),_(te,ke),_(ke,Te),_(ke,Ze);for(let be=0;be<5;be+=1)Ct[be]&&Ct[be].m(ke,null);_(ke,qe),_(ke,Oe),_(ke,Le),_(ke,ve),_(te,st),_(te,Ae),We(Qe,Ae,null),_(p,ft),_(p,ht),_(ht,Xe),_(Xe,Kn),_(Xe,cn),_(Xe,Gn),_(Xe,fn),_(Xe,Jn),_(ht,Yn),We(ot,ht,null),Ne=!0,hn||(Zn=[we(l,"input",t[18]),we(l,"input",t[17]),we(f,"click",t[17]),we(P,"change",t[19]),we(P,"change",t[14]),we(D,"click",t[14]),we(N,"change",t[20]),we(N,"change",t[15]),we(E,"click",t[15]),we(M,"change",t[21]),we(M,"change",t[16]),we(me,"click",t[16]),we(ke,"change",t[13])],hn=!0)},p(L,ne){if(Yt.p(L,ne),ne[0]&128&&l.value!==L[7]&&Ce(l,L[7]),(!Ne||ne[0]&128)&&le(f,"visibility",L[7]!==""?"visible":"hidden"),(!Ne||ne[0]&1024)&&H!==(H=L[10]!==""?"All Dimensions":"Dimension Count")&&Se($,H),ne[0]&1024&&_t(P,L[10]),(!Ne||ne[0]&1024)&&le(D,"visibility",L[10]!==""?"visible":"hidden"),(!Ne||ne[0]&512)&&G!==(G=L[9]==""?"Organism":"All Organisms")&&Se(V,G),ne[0]&8){dt=Ve(Object.keys(L[3]).sort());let Be;for(Be=0;Be<dt.length;Be+=1){const Xn=Pi(L,dt,Be);Me[Be]?Me[Be].p(Xn,ne):(Me[Be]=xi(Xn),Me[Be].c(),Me[Be].m(N,null))}for(;Be<Me.length;Be+=1)Me[Be].d(1);Me.length=dt.length}ne[0]&520&&_t(N,L[9]),(!Ne||ne[0]&512)&&le(E,"visibility",L[9]!==""?"visible":"hidden"),(!Ne||ne[0]&256)&&se!==(se=L[8]==""?"Imaging Modality":"All Modalities")&&Se(ge,se),ne[0]&16&&(Zt=Ve(Object.keys(L[4]).sort()),ce=Ki(ce,ne,Qn,1,L,Zt,de,M,vr,Ui,null,Ni)),ne[0]&272&&_t(M,L[8]),(!Ne||ne[0]&256)&&le(me,"visibility",L[8]!==""?"visible":"hidden");const be={};ne[0]&64&&(be.sortAscending=L[6]),Qe.$set(be),(!Ne||ne[0]&1)&&Jt!==(Jt=L[0].length+"")&&Se(cn,Jt),(!Ne||ne[0]&2)&&Se(fn,L[1]);const Qt={};ne[0]&1&&(Qt.tableRows=L[0]),ne[0]&128&&(Qt.textFilter=L[7]),ne[0]&32&&(Qt.sortedBy=L[5]),ot.$set(Qt)},i(L){Ne||(ae(e.$$.fragment,L),ae(Qe.$$.fragment,L),ae(ot.$$.fragment,L),Ne=!0)},o(L){he(e.$$.fragment,L),he(Qe.$$.fragment,L),he(ot.$$.fragment,L),Ne=!1},d(L){L&&(W(n),W(i)),He(e,L),Yt.d(),sn(Me,L);for(let ne=0;ne<ce.length;ne+=1)ce[ne].d();sn(Ct,L),He(Qe),He(ot),hn=!1,et(Zn)}}}function So(t,e,n){let i,r,s,o,a=go,l=[],h=0,f=0,m={},b={};je.subscribe(d=>{n(0,l=S(d)),n(1,h=d.length),n(2,f=d.reduce((v,I)=>v+parseInt(I.written)||0,0))}),Xi.subscribe(d=>{let v={};for(const[I,F]of Object.entries(d))v[F]=I;n(3,m=v)}),$i.subscribe(d=>{let v={};for(const[I,F]of Object.entries(d))v[F]=I;n(4,b=v)}),Ji(a,je);let p="",g=!1;function y(){n(6,g=!g),je.sortTable(p,g)}function x(d){n(5,p=d.target.value),p===""?je.sortTable("index",!0):je.sortTable(p,g)}function S(d){if(i!==""&&(d=d.filter(v=>v.dim_count==i)),r!==""&&(d=d.filter(v=>v.organismId==r)),s!=""&&(d=d.filter(v=>v.fbbiId==s)),o&&o!=""){let v=o.toLowerCase();d=d.filter(I=>{var F,D;return I.url.toLowerCase().includes(v)||((F=I.description)==null?void 0:F.toLowerCase().includes(v))||((D=I.name)==null?void 0:D.toLowerCase().includes(v))})}return d}function T(d){n(10,i=d.target.value||""),n(0,l=S(je.getRows()))}function P(d){n(9,r=d.target.value||""),n(0,l=S(je.getRows()))}function X(d){n(8,s=d.target.value||""),n(0,l=S(je.getRows()))}function H(d){n(7,o=d.target.value),n(0,l=S(je.getRows()))}function $(){o=this.value,n(7,o)}function O(){i=gn(this),n(10,i)}function c(){r=gn(this),n(9,r),n(3,m)}function u(){s=gn(this),n(8,s),n(4,b)}return t.$$.update=()=>{t.$$.dirty[0]&1&&l.some(d=>d.source)},n(10,i=""),n(9,r=""),n(8,s=""),n(7,o=""),[l,h,f,m,b,p,g,o,s,r,i,a,y,x,T,P,X,H,$,O,c,u]}class Io extends Je{constructor(e){super(),Ge(this,e,So,Ao,xe,{},null,[-1,-1])}}const zo="/zowser/nfdi_rgb_Wortmarke_Zusatz_quer.png",To="/zowser/czi-logo-chan-zuckerberg-initiative-logo.png";function Ro(t){let e,n,i;return{c(){e=k("base"),n=K(),i=k("div"),i.innerHTML=`<h2>Introduction</h2> <p>Zowser is an OME-Zarr browser based on the <a href="https://forum.image.sc/t/ome2024-ngff-challenge/97363">2024 OME-NGFF Challenge</a>, conceived at the
    <a href="https://www.openmicroscopy.org/events/ome-community-meeting-2024/">OME Annual Community Meeting</a>
    in Dundee in May 2024.</p> <h2>Acknowledgements</h2> <p>Coordination of the challenge was supported by the <a href="https://www.nfdi.de/">German National Research Data Initiative (NFDI)</a>
    and the
    <a href="https://chanzuckerberg.com/">Chan Zuckerberg Initiative</a>:</p> <table><tr><td><img src="${zo}" alt="NFDI Logo" width="45%"/></td> <td><img src="${To}" alt="Chan Zuckerberg Initiative Logo" width="45%"/></td></tr></table>`,w(e,"href",t[0]),w(i,"class","svelte-zlrnwt")},m(r,s){q(r,e,s),q(r,n,s),q(r,i,s)},p:ye,i:ye,o:ye,d(r){r&&(W(e),W(n),W(i))}}}function Oo(t){return["/zowser/"]}class Lo extends Je{constructor(e){super(),Ge(this,e,Oo,Ro,xe,{})}}function Mo(t){let e,n;return e=new Io({}),{c(){Ke(e.$$.fragment)},m(i,r){We(e,i,r),n=!0},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){He(e,i)}}}function Fo(t){let e,n;return e=new Lo({}),{c(){Ke(e.$$.fragment)},m(i,r){We(e,i,r),n=!0},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){He(e,i)}}}function Do(t){let e,n,i,r,s,o;n=new yo({});const a=[Fo,Mo],l=[];function h(f,m){return f[0].endsWith("/about/")?0:1}return r=h(t),s=l[r]=a[r](t),{c(){e=k("div"),Ke(n.$$.fragment),i=K(),s.c(),w(e,"class","app svelte-1mc4mod")},m(f,m){q(f,e,m),We(n,e,null),_(e,i),l[r].m(e,null),o=!0},p:ye,i(f){o||(ae(n.$$.fragment,f),ae(s),o=!0)},o(f){he(n.$$.fragment,f),he(s),o=!1},d(f){f&&W(e),He(n),l[r].d()}}}function No(t){return[window.location.pathname]}class Po extends Je{constructor(e){super(),Ge(this,e,No,Do,xe,{})}}new Po({target:document.getElementById("app")});
