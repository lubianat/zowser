const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/blosc-E49GQuAK.js","assets/chunk-INHXZS53-D3tQiqtZ.js","assets/gzip-CF-9a_hd.js","assets/browser-B-ZyVB-j.js","assets/lz4-BIGKWw27.js","assets/zlib-CBiqHlio.js","assets/zstd-IvP746pw.js"])))=>i.map(i=>d[i]);
var Ir=Object.defineProperty;var ai=t=>{throw TypeError(t)};var Ar=(t,e,n)=>e in t?Ir(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var oe=(t,e,n)=>Ar(t,typeof e!="symbol"?e+"":e,n),kn=(t,e,n)=>e.has(t)||ai("Cannot "+n);var Y=(t,e,n)=>(kn(t,e,"read from private field"),n?n.call(t):e.get(t)),Ce=(t,e,n)=>e.has(t)?ai("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),be=(t,e,n,i)=>(kn(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),En=(t,e,n)=>(kn(t,e,"access private method"),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function ve(){}function Sr(t,e){for(const n in e)t[n]=e[n];return t}function ir(t){return t()}function ui(){return Object.create(null)}function ot(t){t.forEach(ir)}function rr(t){return typeof t=="function"}function xe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let un;function tt(t,e){return t===e?!0:(un||(un=document.createElement("a")),un.href=e,t===un.href)}function zr(t){return Object.keys(t).length===0}function Tr(t,...e){if(t==null){for(const i of e)i(void 0);return ve}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function fn(t){let e;return Tr(t,n=>e=n)(),e}function zn(t,e,n,i){if(t){const r=sr(t,e,n,i);return t[0](r)}}function sr(t,e,n,i){return t[1]&&i?Sr(n.ctx.slice(),t[1](i(e))):n.ctx}function Tn(t,e,n,i){if(t[2]&&i){const r=t[2](i(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],o=Math.max(e.dirty.length,r.length);for(let l=0;l<o;l+=1)s[l]=e.dirty[l]|r[l];return s}return e.dirty|r}return e.dirty}function Rn(t,e,n,i,r,s){if(r){const o=sr(e,n,i,s);t.p(o,r)}}function On(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let i=0;i<n;i++)e[i]=-1;return e}return-1}function ci(t){return t??""}function _(t,e){t.appendChild(e)}function K(t,e,n){t.insertBefore(e,n||null)}function W(t){t.parentNode&&t.parentNode.removeChild(t)}function It(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function E(t){return document.createElement(t)}function Z(t){return document.createTextNode(t)}function q(){return Z(" ")}function Xt(){return Z("")}function ge(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function p(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Rr(t){return Array.from(t.childNodes)}function Se(t,e){e=""+e,t.data!==e&&(t.data=e)}function Te(t,e){t.value=e??""}function ae(t,e,n,i){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}function wt(t,e,n){for(let i=0;i<t.options.length;i+=1){const r=t.options[i];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Cn(t){const e=t.querySelector(":checked");return e&&e.__value}function je(t,e,n){t.classList.toggle(e,!!n)}function Or(t,e,{bubbles:n=!1,cancelable:i=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:i})}let Bt;function Nt(t){Bt=t}function xn(){if(!Bt)throw new Error("Function called outside component initialization");return Bt}function $t(t){xn().$$.on_mount.push(t)}function Vn(t){xn().$$.on_destroy.push(t)}function Lr(){const t=xn();return(e,n,{cancelable:i=!1}={})=>{const r=t.$$.callbacks[e];if(r){const s=Or(e,n,{cancelable:i});return r.slice().forEach(o=>{o.call(t,s)}),!s.defaultPrevented}return!0}}const Ct=[],ct=[];let At=[];const fi=[],or=Promise.resolve();let Ln=!1;function lr(){Ln||(Ln=!0,or.then(De))}function Mr(){return lr(),or}function at(t){At.push(t)}const In=new Set;let kt=0;function De(){if(kt!==0)return;const t=Bt;do{try{for(;kt<Ct.length;){const e=Ct[kt];kt++,Nt(e),Fr(e.$$)}}catch(e){throw Ct.length=0,kt=0,e}for(Nt(null),Ct.length=0,kt=0;ct.length;)ct.pop()();for(let e=0;e<At.length;e+=1){const n=At[e];In.has(n)||(In.add(n),n())}At.length=0}while(Ct.length);for(;fi.length;)fi.pop()();Ln=!1,In.clear(),Nt(t)}function Fr(t){if(t.fragment!==null){t.update(),ot(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(at)}}function Dr(t){const e=[],n=[];At.forEach(i=>t.indexOf(i)===-1?e.push(i):n.push(i)),n.forEach(i=>i()),At=e}const hn=new Set;let dt;function en(){dt={r:0,c:[],p:dt}}function tn(){dt.r||ot(dt.c),dt=dt.p}function ue(t,e){t&&t.i&&(hn.delete(t),t.i(e))}function he(t,e,n,i){if(t&&t.o){if(hn.has(t))return;hn.add(t),dt.c.push(()=>{hn.delete(t),i&&(n&&t.d(1),i())}),t.o(e)}else i&&i()}function Ne(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Nr(t,e){t.d(1),e.delete(t.key)}function Br(t,e){he(t,1,1,()=>{e.delete(t.key)})}function ar(t,e,n,i,r,s,o,l,a,f,h,m){let b=t.length,g=s.length,d=b;const k={};for(;d--;)k[t[d].key]=d;const z=[],M=new Map,j=new Map,H=[];for(d=g;d--;){const w=m(r,s,d),c=n(w);let u=o.get(c);u?H.push(()=>u.p(w,e)):(u=f(c,w),u.c()),M.set(c,z[d]=u),c in k&&j.set(c,Math.abs(d-k[c]))}const G=new Set,N=new Set;function U(w){ue(w,1),w.m(l,h),o.set(w.key,w),h=w.first,g--}for(;b&&g;){const w=z[g-1],c=t[b-1],u=w.key,y=c.key;w===c?(h=w.first,b--,g--):M.has(y)?!o.has(u)||G.has(u)?U(w):N.has(y)?b--:j.get(u)>j.get(y)?(N.add(u),U(w)):(G.add(y),b--):(a(c,o),b--)}for(;b--;){const w=t[b];M.has(w.key)||a(w,o)}for(;g;)U(z[g-1]);return ot(H),z}function Ye(t){t&&t.c()}function Ke(t,e,n){const{fragment:i,after_update:r}=t.$$;i&&i.m(e,n),at(()=>{const s=t.$$.on_mount.map(ir).filter(rr);t.$$.on_destroy?t.$$.on_destroy.push(...s):ot(s),t.$$.on_mount=[]}),r.forEach(at)}function Ge(t,e){const n=t.$$;n.fragment!==null&&(Dr(n.after_update),ot(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Pr(t,e){t.$$.dirty[0]===-1&&(Ct.push(t),lr(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Ze(t,e,n,i,r,s,o=null,l=[-1]){const a=Bt;Nt(t);const f=t.$$={fragment:null,ctx:[],props:s,update:ve,not_equal:r,bound:ui(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:ui(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(f.root);let h=!1;if(f.ctx=n?n(t,e.props||{},(m,b,...g)=>{const d=g.length?g[0]:b;return f.ctx&&r(f.ctx[m],f.ctx[m]=d)&&(!f.skip_bound&&f.bound[m]&&f.bound[m](d),h&&Pr(t,m)),b}):[],f.update(),h=!0,ot(f.before_update),f.fragment=i?i(f.ctx):!1,e.target){if(e.hydrate){const m=Rr(e.target);f.fragment&&f.fragment.l(m),m.forEach(W)}else f.fragment&&f.fragment.c();e.intro&&ue(t.$$.fragment),Ke(t,e.target,e.anchor),De()}Nt(a)}class Qe{constructor(){oe(this,"$$");oe(this,"$$set")}$destroy(){Ge(this,1),this.$destroy=ve}$on(e,n){if(!rr(n))return ve;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(e){this.$$set&&!zr(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ur="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ur);const Et=[];function Mn(t,e=ve){let n;const i=new Set;function r(l){if(xe(t,l)&&(t=l,n)){const a=!Et.length;for(const f of i)f[1](),Et.push(f,t);if(a){for(let f=0;f<Et.length;f+=2)Et[f][0](Et[f+1]);Et.length=0}}}function s(l){r(l(t))}function o(l,a=ve){const f=[l,a];return i.add(f),i.size===1&&(n=e(r,s)||ve),l(t),()=>{i.delete(f),i.size===0&&n&&(n(),n=null)}}return{set:r,update:s,subscribe:o}}var jr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ur={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){(function(n,i){t.exports=i()})(jr,function n(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},r=!i.document&&!!i.postMessage,s=i.IS_PAPA_WORKER||!1,o={},l=0,a={parse:function(c,u){var y=(u=u||{}).dynamicTyping||!1;if(w(y)&&(u.dynamicTypingFunction=y,y={}),u.dynamicTyping=y,u.transform=!!w(u.transform)&&u.transform,u.worker&&a.WORKERS_SUPPORTED){var C=function(){if(!a.WORKERS_SUPPORTED)return!1;var D=(R=i.URL||i.webkitURL||null,F=n.toString(),a.BLOB_URL||(a.BLOB_URL=R.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",F,")();"],{type:"text/javascript"})))),P=new i.Worker(D),R,F;return P.onmessage=j,P.id=l++,o[P.id]=P}();return C.userStep=u.step,C.userChunk=u.chunk,C.userComplete=u.complete,C.userError=u.error,u.step=w(u.step),u.chunk=w(u.chunk),u.complete=w(u.complete),u.error=w(u.error),delete u.worker,void C.postMessage({input:c,config:u,workerId:C.id})}var T=null;return a.NODE_STREAM_INPUT,typeof c=="string"?(c=function(D){return D.charCodeAt(0)===65279?D.slice(1):D}(c),T=u.download?new m(u):new g(u)):c.readable===!0&&w(c.read)&&w(c.on)?T=new d(u):(i.File&&c instanceof File||c instanceof Object)&&(T=new b(u)),T.stream(c)},unparse:function(c,u){var y=!1,C=!0,T=",",D=`\r
`,P='"',R=P+P,F=!1,I=null,L=!1;(function(){if(typeof u=="object"){if(typeof u.delimiter!="string"||a.BAD_DELIMITERS.filter(function(v){return u.delimiter.indexOf(v)!==-1}).length||(T=u.delimiter),(typeof u.quotes=="boolean"||typeof u.quotes=="function"||Array.isArray(u.quotes))&&(y=u.quotes),typeof u.skipEmptyLines!="boolean"&&typeof u.skipEmptyLines!="string"||(F=u.skipEmptyLines),typeof u.newline=="string"&&(D=u.newline),typeof u.quoteChar=="string"&&(P=u.quoteChar),typeof u.header=="boolean"&&(C=u.header),Array.isArray(u.columns)){if(u.columns.length===0)throw new Error("Option columns is empty");I=u.columns}u.escapeChar!==void 0&&(R=u.escapeChar+P),(typeof u.escapeFormulae=="boolean"||u.escapeFormulae instanceof RegExp)&&(L=u.escapeFormulae instanceof RegExp?u.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var O=new RegExp(z(P),"g");if(typeof c=="string"&&(c=JSON.parse(c)),Array.isArray(c)){if(!c.length||Array.isArray(c[0]))return Q(null,c,F);if(typeof c[0]=="object")return Q(I||Object.keys(c[0]),c,F)}else if(typeof c=="object")return typeof c.data=="string"&&(c.data=JSON.parse(c.data)),Array.isArray(c.data)&&(c.fields||(c.fields=c.meta&&c.meta.fields||I),c.fields||(c.fields=Array.isArray(c.data[0])?c.fields:typeof c.data[0]=="object"?Object.keys(c.data[0]):[]),Array.isArray(c.data[0])||typeof c.data[0]=="object"||(c.data=[c.data])),Q(c.fields||[],c.data||[],F);throw new Error("Unable to serialize unrecognized input");function Q(v,V,A){var x="";typeof v=="string"&&(v=JSON.parse(v)),typeof V=="string"&&(V=JSON.parse(V));var te=Array.isArray(v)&&0<v.length,ne=!Array.isArray(V[0]);if(te&&C){for(var X=0;X<v.length;X++)0<X&&(x+=T),x+=$(v[X],X);0<V.length&&(x+=D)}for(var B=0;B<V.length;B++){var J=te?v.length:V[B].length,ie=!1,se=te?Object.keys(V[B]).length===0:V[B].length===0;if(A&&!te&&(ie=A==="greedy"?V[B].join("").trim()==="":V[B].length===1&&V[B][0].length===0),A==="greedy"&&te){for(var re=[],we=0;we<J;we++){var de=ne?v[we]:we;re.push(V[B][de])}ie=re.join("").trim()===""}if(!ie){for(var ce=0;ce<J;ce++){0<ce&&!se&&(x+=T);var ye=te&&ne?v[ce]:ce;x+=$(V[B][ye],ce)}B<V.length-1&&(!A||0<J&&!se)&&(x+=D)}}return x}function $(v,V){if(v==null)return"";if(v.constructor===Date)return JSON.stringify(v).slice(1,25);var A=!1;L&&typeof v=="string"&&L.test(v)&&(v="'"+v,A=!0);var x=v.toString().replace(O,R);return(A=A||y===!0||typeof y=="function"&&y(v,V)||Array.isArray(y)&&y[V]||function(te,ne){for(var X=0;X<ne.length;X++)if(-1<te.indexOf(ne[X]))return!0;return!1}(x,a.BAD_DELIMITERS)||-1<x.indexOf(T)||x.charAt(0)===" "||x.charAt(x.length-1)===" ")?P+x+P:x}}};if(a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!r&&!!i.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=M,a.ParserHandle=k,a.NetworkStreamer=m,a.FileStreamer=b,a.StringStreamer=g,a.ReadableStreamStreamer=d,i.jQuery){var f=i.jQuery;f.fn.parse=function(c){var u=c.config||{},y=[];return this.each(function(D){if(!(f(this).prop("tagName").toUpperCase()==="INPUT"&&f(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var P=0;P<this.files.length;P++)y.push({file:this.files[P],inputElem:this,instanceConfig:f.extend({},u)})}),C(),this;function C(){if(y.length!==0){var D,P,R,F,I=y[0];if(w(c.before)){var L=c.before(I.file,I.inputElem);if(typeof L=="object"){if(L.action==="abort")return D="AbortError",P=I.file,R=I.inputElem,F=L.reason,void(w(c.error)&&c.error({name:D},P,R,F));if(L.action==="skip")return void T();typeof L.config=="object"&&(I.instanceConfig=f.extend(I.instanceConfig,L.config))}else if(L==="skip")return void T()}var O=I.instanceConfig.complete;I.instanceConfig.complete=function(Q){w(O)&&O(Q,I.file,I.inputElem),T()},a.parse(I.file,I.instanceConfig)}else w(c.complete)&&c.complete()}function T(){y.splice(0,1),C()}}}function h(c){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(u){var y=N(u);y.chunkSize=parseInt(y.chunkSize),u.step||u.chunk||(y.chunkSize=null),this._handle=new k(y),(this._handle.streamer=this)._config=y}).call(this,c),this.parseChunk=function(u,y){if(this.isFirstChunk&&w(this._config.beforeFirstChunk)){var C=this._config.beforeFirstChunk(u);C!==void 0&&(u=C)}this.isFirstChunk=!1,this._halted=!1;var T=this._partialLine+u;this._partialLine="";var D=this._handle.parse(T,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var P=D.meta.cursor;this._finished||(this._partialLine=T.substring(P-this._baseIndex),this._baseIndex=P),D&&D.data&&(this._rowCount+=D.data.length);var R=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)i.postMessage({results:D,workerId:a.WORKER_ID,finished:R});else if(w(this._config.chunk)&&!y){if(this._config.chunk(D,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);D=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(D.data),this._completeResults.errors=this._completeResults.errors.concat(D.errors),this._completeResults.meta=D.meta),this._completed||!R||!w(this._config.complete)||D&&D.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),R||D&&D.meta.paused||this._nextChunk(),D}this._halted=!0},this._sendError=function(u){w(this._config.error)?this._config.error(u):s&&this._config.error&&i.postMessage({workerId:a.WORKER_ID,error:u,finished:!1})}}function m(c){var u;(c=c||{}).chunkSize||(c.chunkSize=a.RemoteChunkSize),h.call(this,c),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(y){this._input=y,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(u=new XMLHttpRequest,this._config.withCredentials&&(u.withCredentials=this._config.withCredentials),r||(u.onload=U(this._chunkLoaded,this),u.onerror=U(this._chunkError,this)),u.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var y=this._config.downloadRequestHeaders;for(var C in y)u.setRequestHeader(C,y[C])}if(this._config.chunkSize){var T=this._start+this._config.chunkSize-1;u.setRequestHeader("Range","bytes="+this._start+"-"+T)}try{u.send(this._config.downloadRequestBody)}catch(D){this._chunkError(D.message)}r&&u.status===0&&this._chunkError()}},this._chunkLoaded=function(){u.readyState===4&&(u.status<200||400<=u.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:u.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(y){var C=y.getResponseHeader("Content-Range");return C===null?-1:parseInt(C.substring(C.lastIndexOf("/")+1))}(u),this.parseChunk(u.responseText)))},this._chunkError=function(y){var C=u.statusText||y;this._sendError(new Error(C))}}function b(c){var u,y;(c=c||{}).chunkSize||(c.chunkSize=a.LocalChunkSize),h.call(this,c);var C=typeof FileReader<"u";this.stream=function(T){this._input=T,y=T.slice||T.webkitSlice||T.mozSlice,C?((u=new FileReader).onload=U(this._chunkLoaded,this),u.onerror=U(this._chunkError,this)):u=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var T=this._input;if(this._config.chunkSize){var D=Math.min(this._start+this._config.chunkSize,this._input.size);T=y.call(T,this._start,D)}var P=u.readAsText(T,this._config.encoding);C||this._chunkLoaded({target:{result:P}})},this._chunkLoaded=function(T){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(T.target.result)},this._chunkError=function(){this._sendError(u.error)}}function g(c){var u;h.call(this,c=c||{}),this.stream=function(y){return u=y,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var y,C=this._config.chunkSize;return C?(y=u.substring(0,C),u=u.substring(C)):(y=u,u=""),this._finished=!u,this.parseChunk(y)}}}function d(c){h.call(this,c=c||{});var u=[],y=!0,C=!1;this.pause=function(){h.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){h.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(T){this._input=T,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){C&&u.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),u.length?this.parseChunk(u.shift()):y=!0},this._streamData=U(function(T){try{u.push(typeof T=="string"?T:T.toString(this._config.encoding)),y&&(y=!1,this._checkIsFinished(),this.parseChunk(u.shift()))}catch(D){this._streamError(D)}},this),this._streamError=U(function(T){this._streamCleanUp(),this._sendError(T)},this),this._streamEnd=U(function(){this._streamCleanUp(),C=!0,this._streamData("")},this),this._streamCleanUp=U(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function k(c){var u,y,C,T=Math.pow(2,53),D=-T,P=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,R=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,F=this,I=0,L=0,O=!1,Q=!1,$=[],v={data:[],errors:[],meta:{}};if(w(c.step)){var V=c.step;c.step=function(B){if(v=B,te())x();else{if(x(),v.data.length===0)return;I+=B.data.length,c.preview&&I>c.preview?y.abort():(v.data=v.data[0],V(v,F))}}}function A(B){return c.skipEmptyLines==="greedy"?B.join("").trim()==="":B.length===1&&B[0].length===0}function x(){return v&&C&&(X("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),C=!1),c.skipEmptyLines&&(v.data=v.data.filter(function(B){return!A(B)})),te()&&function(){if(!v)return;function B(ie,se){w(c.transformHeader)&&(ie=c.transformHeader(ie,se)),$.push(ie)}if(Array.isArray(v.data[0])){for(var J=0;te()&&J<v.data.length;J++)v.data[J].forEach(B);v.data.splice(0,1)}else v.data.forEach(B)}(),function(){if(!v||!c.header&&!c.dynamicTyping&&!c.transform)return v;function B(ie,se){var re,we=c.header?{}:[];for(re=0;re<ie.length;re++){var de=re,ce=ie[re];c.header&&(de=re>=$.length?"__parsed_extra":$[re]),c.transform&&(ce=c.transform(ce,de)),ce=ne(de,ce),de==="__parsed_extra"?(we[de]=we[de]||[],we[de].push(ce)):we[de]=ce}return c.header&&(re>$.length?X("FieldMismatch","TooManyFields","Too many fields: expected "+$.length+" fields but parsed "+re,L+se):re<$.length&&X("FieldMismatch","TooFewFields","Too few fields: expected "+$.length+" fields but parsed "+re,L+se)),we}var J=1;return!v.data.length||Array.isArray(v.data[0])?(v.data=v.data.map(B),J=v.data.length):v.data=B(v.data,0),c.header&&v.meta&&(v.meta.fields=$),L+=J,v}()}function te(){return c.header&&$.length===0}function ne(B,J){return ie=B,c.dynamicTypingFunction&&c.dynamicTyping[ie]===void 0&&(c.dynamicTyping[ie]=c.dynamicTypingFunction(ie)),(c.dynamicTyping[ie]||c.dynamicTyping)===!0?J==="true"||J==="TRUE"||J!=="false"&&J!=="FALSE"&&(function(se){if(P.test(se)){var re=parseFloat(se);if(D<re&&re<T)return!0}return!1}(J)?parseFloat(J):R.test(J)?new Date(J):J===""?null:J):J;var ie}function X(B,J,ie,se){var re={type:B,code:J,message:ie};se!==void 0&&(re.row=se),v.errors.push(re)}this.parse=function(B,J,ie){var se=c.quoteChar||'"';if(c.newline||(c.newline=function(de,ce){de=de.substring(0,1048576);var ye=new RegExp(z(ce)+"([^]*?)"+z(ce),"gm"),Re=(de=de.replace(ye,"")).split("\r"),Ve=de.split(`
`),Be=1<Ve.length&&Ve[0].length<Re[0].length;if(Re.length===1||Be)return`
`;for(var ke=0,fe=0;fe<Re.length;fe++)Re[fe][0]===`
`&&ke++;return ke>=Re.length/2?`\r
`:"\r"}(B,se)),C=!1,c.delimiter)w(c.delimiter)&&(c.delimiter=c.delimiter(B),v.meta.delimiter=c.delimiter);else{var re=function(de,ce,ye,Re,Ve){var Be,ke,fe,pe;Ve=Ve||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var Xe=0;Xe<Ve.length;Xe++){var le=Ve[Xe],nt=0,Je=0,Pe=0;fe=void 0;for(var Ee=new M({comments:Re,delimiter:le,newline:ce,preview:10}).parse(de),Oe=0;Oe<Ee.data.length;Oe++)if(ye&&A(Ee.data[Oe]))Pe++;else{var $e=Ee.data[Oe].length;Je+=$e,fe!==void 0?0<$e&&(nt+=Math.abs($e-fe),fe=$e):fe=$e}0<Ee.data.length&&(Je/=Ee.data.length-Pe),(ke===void 0||nt<=ke)&&(pe===void 0||pe<Je)&&1.99<Je&&(ke=nt,Be=le,pe=Je)}return{successful:!!(c.delimiter=Be),bestDelimiter:Be}}(B,c.newline,c.skipEmptyLines,c.comments,c.delimitersToGuess);re.successful?c.delimiter=re.bestDelimiter:(C=!0,c.delimiter=a.DefaultDelimiter),v.meta.delimiter=c.delimiter}var we=N(c);return c.preview&&c.header&&we.preview++,u=B,y=new M(we),v=y.parse(u,J,ie),x(),O?{meta:{paused:!0}}:v||{meta:{paused:!1}}},this.paused=function(){return O},this.pause=function(){O=!0,y.abort(),u=w(c.chunk)?"":u.substring(y.getCharIndex())},this.resume=function(){F.streamer._halted?(O=!1,F.streamer.parseChunk(u,!0)):setTimeout(F.resume,3)},this.aborted=function(){return Q},this.abort=function(){Q=!0,y.abort(),v.meta.aborted=!0,w(c.complete)&&c.complete(v),u=""}}function z(c){return c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function M(c){var u,y=(c=c||{}).delimiter,C=c.newline,T=c.comments,D=c.step,P=c.preview,R=c.fastMode,F=u=c.quoteChar===void 0||c.quoteChar===null?'"':c.quoteChar;if(c.escapeChar!==void 0&&(F=c.escapeChar),(typeof y!="string"||-1<a.BAD_DELIMITERS.indexOf(y))&&(y=","),T===y)throw new Error("Comment character same as delimiter");T===!0?T="#":(typeof T!="string"||-1<a.BAD_DELIMITERS.indexOf(T))&&(T=!1),C!==`
`&&C!=="\r"&&C!==`\r
`&&(C=`
`);var I=0,L=!1;this.parse=function(O,Q,$){if(typeof O!="string")throw new Error("Input must be a string");var v=O.length,V=y.length,A=C.length,x=T.length,te=w(D),ne=[],X=[],B=[],J=I=0;if(!O)return Le();if(c.header&&!Q){var ie=O.split(C)[0].split(y),se=[],re={},we=!1;for(var de in ie){var ce=ie[de];w(c.transformHeader)&&(ce=c.transformHeader(ce,de));var ye=ce,Re=re[ce]||0;for(0<Re&&(we=!0,ye=ce+"_"+Re),re[ce]=Re+1;se.includes(ye);)ye=ye+"_"+Re;se.push(ye)}if(we){var Ve=O.split(C);Ve[0]=se.join(y),O=Ve.join(C)}}if(R||R!==!1&&O.indexOf(u)===-1){for(var Be=O.split(C),ke=0;ke<Be.length;ke++){if(B=Be[ke],I+=B.length,ke!==Be.length-1)I+=C.length;else if($)return Le();if(!T||B.substring(0,x)!==T){if(te){if(ne=[],Pe(B.split(y)),et(),L)return Le()}else Pe(B.split(y));if(P&&P<=ke)return ne=ne.slice(0,P),Le(!0)}}return Le()}for(var fe=O.indexOf(y,I),pe=O.indexOf(C,I),Xe=new RegExp(z(F)+z(u),"g"),le=O.indexOf(u,I);;)if(O[I]!==u)if(T&&B.length===0&&O.substring(I,I+x)===T){if(pe===-1)return Le();I=pe+A,pe=O.indexOf(C,I),fe=O.indexOf(y,I)}else if(fe!==-1&&(fe<pe||pe===-1))B.push(O.substring(I,fe)),I=fe+V,fe=O.indexOf(y,I);else{if(pe===-1)break;if(B.push(O.substring(I,pe)),$e(pe+A),te&&(et(),L))return Le();if(P&&ne.length>=P)return Le(!0)}else for(le=I,I++;;){if((le=O.indexOf(u,le+1))===-1)return $||X.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ne.length,index:I}),Oe();if(le===v-1)return Oe(O.substring(I,le).replace(Xe,u));if(u!==F||O[le+1]!==F){if(u===F||le===0||O[le-1]!==F){fe!==-1&&fe<le+1&&(fe=O.indexOf(y,le+1)),pe!==-1&&pe<le+1&&(pe=O.indexOf(C,le+1));var nt=Ee(pe===-1?fe:Math.min(fe,pe));if(O.substr(le+1+nt,V)===y){B.push(O.substring(I,le).replace(Xe,u)),O[I=le+1+nt+V]!==u&&(le=O.indexOf(u,I)),fe=O.indexOf(y,I),pe=O.indexOf(C,I);break}var Je=Ee(pe);if(O.substring(le+1+Je,le+1+Je+A)===C){if(B.push(O.substring(I,le).replace(Xe,u)),$e(le+1+Je+A),fe=O.indexOf(y,I),le=O.indexOf(u,I),te&&(et(),L))return Le();if(P&&ne.length>=P)return Le(!0);break}X.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ne.length,index:I}),le++}}else le++}return Oe();function Pe(Ie){ne.push(Ie),J=I}function Ee(Ie){var it=0;if(Ie!==-1){var pt=O.substring(le+1,Ie);pt&&pt.trim()===""&&(it=pt.length)}return it}function Oe(Ie){return $||(Ie===void 0&&(Ie=O.substring(I)),B.push(Ie),I=v,Pe(B),te&&et()),Le()}function $e(Ie){I=Ie,Pe(B),B=[],pe=O.indexOf(C,I)}function Le(Ie){return{data:ne,errors:X,meta:{delimiter:y,linebreak:C,aborted:L,truncated:!!Ie,cursor:J+(Q||0)}}}function et(){D(Le()),ne=[],X=[]}},this.abort=function(){L=!0},this.getCharIndex=function(){return I}}function j(c){var u=c.data,y=o[u.workerId],C=!1;if(u.error)y.userError(u.error,u.file);else if(u.results&&u.results.data){var T={abort:function(){C=!0,H(u.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:G,resume:G};if(w(y.userStep)){for(var D=0;D<u.results.data.length&&(y.userStep({data:u.results.data[D],errors:u.results.errors,meta:u.results.meta},T),!C);D++);delete u.results}else w(y.userChunk)&&(y.userChunk(u.results,T,u.file),delete u.results)}u.finished&&!C&&H(u.workerId,u.results)}function H(c,u){var y=o[c];w(y.userComplete)&&y.userComplete(u),y.terminate(),delete o[c]}function G(){throw new Error("Not implemented.")}function N(c){if(typeof c!="object"||c===null)return c;var u=Array.isArray(c)?[]:{};for(var y in c)u[y]=N(c[y]);return u}function U(c,u){return function(){c.apply(u,arguments)}}function w(c){return typeof c=="function"}return s&&(i.onmessage=function(c){var u=c.data;if(a.WORKER_ID===void 0&&u&&(a.WORKER_ID=u.workerId),typeof u.input=="string")i.postMessage({workerId:a.WORKER_ID,results:a.parse(u.input,u.config),finished:!0});else if(i.File&&u.input instanceof File||u.input instanceof Object){var y=a.parse(u.input,u.config);y&&i.postMessage({workerId:a.WORKER_ID,results:y,finished:!0})}}),(m.prototype=Object.create(h.prototype)).constructor=m,(b.prototype=Object.create(h.prototype)).constructor=b,(g.prototype=Object.create(g.prototype)).constructor=g,(d.prototype=Object.create(h.prototype)).constructor=d,a})})(ur);var Vr=ur.exports;const Wr=xr(Vr);function Hr(t){const e=t.data;let n=0,i=1/0;for(let r=0;r<e.length;r++){const s=e[r];s>n&&(n=s),s<i&&(i=s)}return[i,n]}function cr(t){t.startsWith("#")&&(t=t.slice(1));const e=parseInt(t.slice(0,2),16),n=parseInt(t.slice(2,4),16),i=parseInt(t.slice(4,6),16);return[e,n,i]}const dn=4,ut={cyan:"#00FFFF",yellow:"#FFFF00",magenta:"#FF00FF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",white:"#FFFFFF"},qr=[ut.magenta,ut.green],Kr=[ut.red,ut.green,ut.blue],hi=Object.values(ut).slice(0,-2);function Gr(t){return t<=dn?Array(t).fill(!0):[...Array(dn).fill(!0),...Array(t-dn).fill(!1)]}function Jr(t,e){let n=[];if(t==1)n=[ut.white];else if(t==2)n=qr;else if(t==3)n=Kr;else if(t<=dn)n=hi.slice(0,t);else{n=Array(t).fill(ut.white);const i=e.flatMap((r,s)=>r?s:[]);for(const[r,s]of i.entries())n[s]=hi[r]}return n.map(cr)}function Yr(t,e,n){const i=t[0].shape,r=i[0],s=i[1],o=r*s,l=new Uint8ClampedArray(4*o).fill(0);let a=0;for(let f=0;f<o;f++){for(let h=0;h<t.length;h++){const m=n[h],b=t[h].data,g=e[h],k=(b[f]-g[0])/(g[1]-g[0]);for(let z=0;z<3;z++){const M=k*m[z]<<0;l[a*4+z]=Math.max(l[a*4+z],M)}}l[a*4+3]=255,a++}return l}function fr(t,e,n={}){Wr.parse(t,{header:!1,download:!0,skipEmptyLines:"greedy",complete:i=>{let r=["url"],s=i.data[0];s.length>1&&(r=s,i.data.shift());const o=i.data.map(g=>{const d={...n};for(let k=0;k<r.length;k++)d[r[k]]=g[k];return d});let l=o.filter(g=>{var d;return!((d=g.url)!=null&&d.endsWith(".csv"))});const a=o.filter(g=>{var d;return(d=g.url)==null?void 0:d.endsWith(".csv")}),f={};l.forEach(g=>{f[g.url]||(f[g.url]=g)}),l=Object.values(f);const h=l.reduce((g,d)=>d.wells?g+1:g,0),m=l.reduce((g,d)=>g+parseInt(d.written||0),0);let b=l.length;h>0&&(b=l.reduce((g,d)=>g+parseInt(d.images||1),0)),e.addCsv(t,a,b,h,m),e.addRows(l),a.forEach(g=>{const d=g.url;g.csv=d,fr(d,e,g)})}})}async function Zr(t){return await fetch(t).then(e=>e.json())}function mn(t){if(!t)return"";const e=2;return t<1024?`${t} B`:t<1024**2?`${(t/1024).toFixed(e)} KB`:t<1024**3?`${(t/1024**2).toFixed(e)} MB`:t<1024**4?`${(t/1024**3).toFixed(e)} GB`:t<1024**5?`${(t/1024**4).toFixed(e)} TB`:`${(t/1024**5).toFixed(e)} PB`}class hr{constructor(){this.store=Mn({})}async lookupOntologyTerm(e){let n="",i="";e.includes("NCBITaxon")|e.includes("NCBI:txid")&&(n=e.replace("NCBI:txid",""),n=n.replace("obo:NCBITaxon_",""),i="NCBITaxon"),e.includes("FBbi")&&(n=e.replace("obo:FBbi_",""),n=n.replace("obo:FBbi:",""),n=n.replace("FBbi:",""),i="FBbi"),e.includes("NCIT_")&&(n=e.replace("NCIT_",""),i="NCIT"),e.includes("obo:MI_")&&(n=e.replace("obo:MI_",""),i="MI"),e.includes("obo:OBI_")&&(n=e.replace("obo:OBI_",""),i="OBI");let r=i+"_"+n,o=`https://www.ebi.ac.uk/ols4/api/ontologies/${i.toLowerCase()}/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252F${r}`;return(await Zr(o)).label||e}addTerms(e){let n=fn(this.store);[...new Set(e)].forEach(r=>{r&&(n[r]||(n[r]="Loading...",setTimeout(()=>{this.lookupOntologyTerm(r).then(s=>{this.addEntry(r,s)})},Math.random()*5e3)))})}addEntry(e,n){this.store.update(i=>(i[e]=n,i))}subscribe(e){return this.store.subscribe(e)}}const dr=new hr,_r=new hr;class nn extends Error{constructor(e,n={}){super(`Node not found: ${e}`,n),this.name="NodeNotFoundError"}}class Wn extends Error{constructor(e){super(`Missing key: ${e}`),this.name="KeyError"}}var qe;class mr{constructor(e,n,i){Ce(this,qe);typeof e=="number"?be(this,qe,new Uint8Array(e)):e instanceof ArrayBuffer?be(this,qe,new Uint8Array(e,n,i)):be(this,qe,new Uint8Array(Array.from(e,r=>r?1:0)))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return Y(this,qe).byteOffset}get byteLength(){return Y(this,qe).byteLength}get buffer(){return Y(this,qe).buffer}get length(){return Y(this,qe).length}get(e){let n=Y(this,qe)[e];return typeof n=="number"?n!==0:n}set(e,n){Y(this,qe)[e]=n?1:0}fill(e){Y(this,qe).fill(e?1:0)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}qe=new WeakMap;var St;class Hn{constructor(e,n,i,r){oe(this,"_data");oe(this,"chars");Ce(this,St);if(this.chars=e,be(this,St,new TextEncoder),typeof n=="number")this._data=new Uint8Array(n*e);else if(n instanceof ArrayBuffer)r&&(r=r*e),this._data=new Uint8Array(n,i,r);else{let s=Array.from(n);this._data=new Uint8Array(s.length*e);for(let o=0;o<s.length;o++)this.set(o,s[o])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(e){const n=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);return new TextDecoder().decode(n).replace(/\x00/g,"")}set(e,n){const i=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);i.fill(0),i.set(Y(this,St).encode(n))}fill(e){const n=Y(this,St).encode(e);for(let i=0;i<this.length;i++)this._data.set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}St=new WeakMap;var ze;const Zn=class Zn{constructor(e,n,i,r){Ce(this,ze);oe(this,"chars");if(this.chars=e,typeof n=="number")be(this,ze,new Int32Array(n*e));else if(n instanceof ArrayBuffer)r&&(r*=e),be(this,ze,new Int32Array(n,i,r));else{const s=n,o=new Zn(e,1);be(this,ze,new Int32Array(function*(){for(let l of s)o.set(0,l),yield*Y(o,ze)}()))}}get BYTES_PER_ELEMENT(){return Y(this,ze).BYTES_PER_ELEMENT*this.chars}get byteLength(){return Y(this,ze).byteLength}get byteOffset(){return Y(this,ze).byteOffset}get buffer(){return Y(this,ze).buffer}get length(){return Y(this,ze).length/this.chars}get(e){const n=this.chars*e;let i="";for(let r=0;r<this.chars;r++)i+=String.fromCodePoint(Y(this,ze)[n+r]);return i.replace(/\u0000/g,"")}set(e,n){const i=this.chars*e,r=Y(this,ze).subarray(i,i+this.chars);r.fill(0);for(let s=0;s<this.chars;s++)r[s]=n.codePointAt(s)??0}fill(e){this.set(0,e);let n=Y(this,ze).subarray(0,this.chars);for(let i=1;i<this.length;i++)Y(this,ze).set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}};ze=new WeakMap;let Pt=Zn;const Qr="modulepreload",Xr=function(t){return"/zowser/"+t},di={},Mt=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(n.map(a=>{if(a=Xr(a),a in di)return;di[a]=!0;const f=a.endsWith(".css"),h=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${h}`))return;const m=document.createElement("link");if(m.rel=f?"stylesheet":Qr,f||(m.as="script"),m.crossOrigin="",m.href=a,l&&m.setAttribute("nonce",l),document.head.appendChild(m),f)return new Promise((b,g)=>{m.addEventListener("load",b),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${a}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};function rn(t){const e=new TextDecoder().decode(t);return JSON.parse(e)}function _i(t,e){const n=e/2,i=e-1;let r=0;for(let s=0;s<t.length;s+=e)for(let o=0;o<n;o+=1)r=t[s+o],t[s+o]=t[s+i-o],t[s+i-o]=r}function gr(t){if(t==="v2:object")return globalThis.Array;let e=t.match(/v2:([US])(\d+)/);if(e){let[,i,r]=e;return(i==="U"?Pt:Hn).bind(null,Number(r))}let n={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float16:globalThis.Float16Array,float32:Float32Array,float64:Float64Array,bool:mr}[t];return Ae(n,`Unknown or unsupported data_type: ${t}`),n}function gt(t,e){const n=t.length;typeof e=="string"&&(e=e==="C"?Array.from({length:n},(s,o)=>o):Array.from({length:n},(s,o)=>n-1-o)),Ae(n===e.length,"Order length must match the number of dimensions.");let i=1,r=new Array(n);for(let s=e.length-1;s>=0;s--)r[e[s]]=i,i*=t[e[s]];return r}function $r({name:t,configuration:e}){if(t==="default"){const n=(e==null?void 0:e.separator)??"/";return i=>["c",...i].join(n)}if(t==="v2"){const n=(e==null?void 0:e.separator)??".";return i=>i.join(n)||"0"}throw new Error(`Unknown chunk key encoding: ${t}`)}function es(t){if(t==="|O")return{data_type:"v2:object"};let e=t.match(/^([<|>])(.*)$/);Ae(e,`Invalid dtype: ${t}`);let[,n,i]=e,r={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f2:"float16",f4:"float32",f8:"float64"}[i]??(i.startsWith("S")||i.startsWith("U")?`v2:${i}`:void 0);return Ae(r,`Unsupported or unknown dtype: ${t}`),n==="|"?{data_type:r}:{data_type:r,endian:n==="<"?"little":"big"}}function ts(t,e={}){let n=[],i=es(t.dtype);t.order==="F"&&n.push({name:"transpose",configuration:{order:"F"}}),"endian"in i&&i.endian==="big"&&n.push({name:"bytes",configuration:{endian:"big"}});for(let{id:r,...s}of t.filters??[])n.push({name:r,configuration:s});if(t.compressor){let{id:r,...s}=t.compressor;n.push({name:r,configuration:s})}return{zarr_format:3,node_type:"array",shape:t.shape,data_type:i.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:t.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:t.dimension_separator??"."}},codecs:n,fill_value:t.fill_value,attributes:e}}function ns(t,e={}){return{zarr_format:3,node_type:"group",attributes:e}}function is(t,e){if(e!=="number"&&e!=="bigint"&&e!=="boolean"&&e!=="object"&&e!=="string")return t===e;let n=t==="bool";if(e==="boolean")return n;let i=t.startsWith("v2:U")||t.startsWith("v2:S");if(e==="string")return i;let r=t==="int64"||t==="uint64";if(e==="bigint")return r;let s=t==="v2:object";return e==="object"?s:!i&&!r&&!n&&!s}function rs(t){return(t==null?void 0:t.name)==="sharding_indexed"}function pr(t){return(t.data_type==="uint64"||t.data_type==="int64")&&t.fill_value!=null?BigInt(t.fill_value):t.fill_value}function br(t,...e){if(!e.some(n=>t instanceof n))throw t}function Ae(t,e=""){if(!t)throw new Error(e)}class qn{constructor(e,n){oe(this,"kind","array_to_array");Ae(e.keepbits>=0,"keepbits must be zero or positive")}static fromConfig(e,n){return new qn(e,n)}encode(e){throw new Error("`BitroundCodec.encode` is not implemented. Please open an issue at https://github.com/manzt/zarrita.js/issues.")}decode(e){return e}}const mi=ss();function ss(){const t=new Uint32Array([305419896]);return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)[0]!==18}function gi(t){return"BYTES_PER_ELEMENT"in t?t.BYTES_PER_ELEMENT:4}var jt,lt,xt,Vt,zt;const Qn=class Qn{constructor(e,n){oe(this,"kind","array_to_bytes");Ce(this,jt);Ce(this,lt);Ce(this,xt);Ce(this,Vt);Ce(this,zt);be(this,zt,e==null?void 0:e.endian),be(this,lt,gr(n.data_type)),be(this,Vt,n.shape),be(this,jt,gt(n.shape,"C"));const i=new(Y(this,lt))(0);be(this,xt,i.BYTES_PER_ELEMENT)}static fromConfig(e,n){return new Qn(e,n)}encode(e){let n=new Uint8Array(e.data.buffer);return mi&&Y(this,zt)==="big"&&_i(n,gi(Y(this,lt))),n}decode(e){return mi&&Y(this,zt)==="big"&&_i(e,gi(Y(this,lt))),{data:new(Y(this,lt))(e.buffer,e.byteOffset,e.byteLength/Y(this,xt)),shape:Y(this,Vt),stride:Y(this,jt)}}};jt=new WeakMap,lt=new WeakMap,xt=new WeakMap,Vt=new WeakMap,zt=new WeakMap;let gn=Qn;class Kn{constructor(){oe(this,"kind","bytes_to_bytes")}static fromConfig(){return new Kn}encode(e){throw new Error("Not implemented")}decode(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength-4)}}function os(t,e){return Ae(!Number.isNaN(e),"JsonCodec allow_nan is false but NaN was encountered during encoding."),Ae(e!==Number.POSITIVE_INFINITY,"JsonCodec allow_nan is false but Infinity was encountered during encoding."),Ae(e!==Number.NEGATIVE_INFINITY,"JsonCodec allow_nan is false but -Infinity was encountered during encoding."),e}function ls(t,e){return e instanceof Object&&!Array.isArray(e)?Object.keys(e).sort().reduce((n,i)=>(n[i]=e[i],n),{}):e}var Wt,Ht;const Xn=class Xn{constructor(e={}){oe(this,"configuration");oe(this,"kind","array_to_bytes");Ce(this,Wt);Ce(this,Ht);this.configuration=e;const{encoding:n="utf-8",skipkeys:i=!1,ensure_ascii:r=!0,check_circular:s=!0,allow_nan:o=!0,sort_keys:l=!0,indent:a,strict:f=!0}=e;let h=e.separators;h||(a?h=[", ",": "]:h=[",",":"]),be(this,Wt,{encoding:n,skipkeys:i,ensure_ascii:r,check_circular:s,allow_nan:o,indent:a,separators:h,sort_keys:l}),be(this,Ht,{strict:f})}static fromConfig(e){return new Xn(e)}encode(e){const{indent:n,encoding:i,ensure_ascii:r,check_circular:s,allow_nan:o,sort_keys:l}=Y(this,Wt);Ae(i==="utf-8","JsonCodec does not yet support non-utf-8 encoding.");const a=[];Ae(s,"JsonCodec does not yet support skipping the check for circular references during encoding."),o||a.push(os),l&&a.push(ls);const f=Array.from(e.data);f.push("|O"),f.push(e.shape);let h;a.length&&(h=(b,g)=>{let d=g;for(let k of a)d=k(b,d);return d});let m=JSON.stringify(f,h,n);return r&&(m=m.replace(/[\u007F-\uFFFF]/g,b=>{const g=`0000${b.charCodeAt(0).toString(16)}`;return`\\u${g.substring(g.length-4)}`})),new TextEncoder().encode(m)}decode(e){const{strict:n}=Y(this,Ht);Ae(n,"JsonCodec does not yet support non-strict decoding.");const i=rn(e),r=i.pop();i.pop(),Ae(r,"0D not implemented for JsonCodec.");const s=gt(r,"C");return{data:i,shape:r,stride:s}}};Wt=new WeakMap,Ht=new WeakMap;let Fn=Xn;function pi(t){return t instanceof mr||t instanceof Hn||t instanceof Pt?new Proxy(t,{get(n,i){return n.get(Number(i))},set(n,i,r){return n.set(Number(i),r),!0}}):t}function as(t,e){let n;return t.data instanceof Hn||t.data instanceof Pt?n=new t.constructor(t.data.length,t.data.chars):n=new t.constructor(t.data.length),{data:n,shape:t.shape,stride:gt(t.shape,e)}}function us(t,e){let n=as(t,e),i=t.shape.length,r=t.data.length,s=Array(i).fill(0),o=pi(t.data),l=pi(n.data);for(let a=0;a<r;a++){let f=0;for(let h=0;h<i;h++)f+=s[h]*n.stride[h];l[f]=o[a],s[0]+=1;for(let h=0;h<i;h++)if(s[h]===t.shape[h]){if(h+1===i)break;s[h]=0,s[h+1]+=1}}return n}function cs(t){let e=t.shape.length;return Ae(e===t.stride.length,"Shape and stride must have the same length."),t.stride.map((n,i)=>({stride:n,index:i})).sort((n,i)=>i.stride-n.stride).map(n=>n.index)}function fs(t,e){let n=cs(t);return Ae(n.length===e.length,"Orders must match"),n.every((i,r)=>i===e[r])}var qt,Tt;const $n=class $n{constructor(e,n){oe(this,"kind","array_to_array");Ce(this,qt);Ce(this,Tt);let i=e.order??"C",r=n.shape.length,s=new Array(r),o=new Array(r);if(i==="C")for(let l=0;l<r;++l)s[l]=l,o[l]=l;else if(i==="F")for(let l=0;l<r;++l)s[l]=r-l-1,o[l]=r-l-1;else s=i,s.forEach((l,a)=>{Ae(o[l]===void 0,`Invalid permutation: ${JSON.stringify(i)}`),o[l]=a});be(this,qt,s),be(this,Tt,o)}static fromConfig(e,n){return new $n(e,n)}encode(e){return fs(e,Y(this,Tt))?e:us(e,Y(this,Tt))}decode(e){return{data:e.data,shape:e.shape,stride:gt(e.shape,Y(this,qt))}}};qt=new WeakMap,Tt=new WeakMap;let Dn=$n;var Kt,Gt;const ei=class ei{constructor(e){oe(this,"kind","array_to_bytes");Ce(this,Kt);Ce(this,Gt);be(this,Kt,e),be(this,Gt,gt(e,"C"))}static fromConfig(e,n){return new ei(n.shape)}encode(e){throw new Error("Method not implemented.")}decode(e){let n=new TextDecoder,i=new DataView(e.buffer),r=Array(i.getUint32(0,!0)),s=4;for(let o=0;o<r.length;o++){let l=i.getUint32(s,!0);s+=4,r[o]=n.decode(e.buffer.slice(s,s+l)),s+=l}return{data:r,shape:Y(this,Kt),stride:Y(this,Gt)}}};Kt=new WeakMap,Gt=new WeakMap;let Nn=ei;function hs(){return new Map().set("blosc",()=>Mt(()=>import("./blosc-E49GQuAK.js"),__vite__mapDeps([0,1])).then(t=>t.default)).set("gzip",()=>Mt(()=>import("./gzip-CF-9a_hd.js"),__vite__mapDeps([2,3])).then(t=>t.default)).set("lz4",()=>Mt(()=>import("./lz4-BIGKWw27.js"),__vite__mapDeps([4,1])).then(t=>t.default)).set("zlib",()=>Mt(()=>import("./zlib-CBiqHlio.js"),__vite__mapDeps([5,3])).then(t=>t.default)).set("zstd",()=>Mt(()=>import("./zstd-IvP746pw.js"),__vite__mapDeps([6,1])).then(t=>t.default)).set("transpose",()=>Dn).set("bytes",()=>gn).set("crc32c",()=>Kn).set("vlen-utf8",()=>Nn).set("json2",()=>Fn).set("bitround",()=>qn)}const ds=hs();function Bn(t){let e;return{async encode(n){e||(e=await bi(t));for(const r of e.array_to_array)n=await r.encode(n);let i=await e.array_to_bytes.encode(n);for(const r of e.bytes_to_bytes)i=await r.encode(i);return i},async decode(n){e||(e=await bi(t));for(let r=e.bytes_to_bytes.length-1;r>=0;r--)n=await e.bytes_to_bytes[r].decode(n);let i=await e.array_to_bytes.decode(n);for(let r=e.array_to_array.length-1;r>=0;r--)i=await e.array_to_array[r].decode(i);return i}}}async function bi(t){let e=t.codecs.map(async s=>{var l;let o=await((l=ds.get(s.name))==null?void 0:l());return Ae(o,`Unknown codec: ${s.name}`),{Codec:o,meta:s}}),n=[],i,r=[];for await(let{Codec:s,meta:o}of e){let l=s.fromConfig(o.configuration,t);switch(l.kind){case"array_to_array":n.push(l);break;case"array_to_bytes":i=l;break;default:r.push(l)}}return i||(Ae(_s(t),`Cannot encode ${t.data_type} to bytes without a codec`),i=gn.fromConfig({endian:"little"},t)),{array_to_array:n,array_to_bytes:i,bytes_to_bytes:r}}function _s(t){return t.data_type!=="v2:object"}const yi=18446744073709551615n;function ms(t,e,n,i){Ae(t.store.getRange,"Store does not support range requests");let r=t.store.getRange.bind(t.store),s=e.map((a,f)=>a/i.chunk_shape[f]),o=Bn({data_type:"uint64",shape:[...s,2],codecs:i.index_codecs}),l={};return async a=>{let f=a.map((j,H)=>Math.floor(j/s[H])),h=t.resolve(n(f)).path,m;if(h in l)m=l[h];else{let j=4,H=16*s.reduce((N,U)=>N*U,1),G=await r(h,{suffixLength:H+j});m=l[h]=G?await o.decode(G):null}if(m===null)return;let{data:b,shape:g,stride:d}=m,k=a.map((j,H)=>j%g[H]).reduce((j,H,G)=>j+H*d[G],0),z=b[k],M=b[k+1];if(!(z===yi&&M===yi))return r(h,{offset:Number(z),length:Number(M)})}}class Rt{constructor(e,n="/"){oe(this,"store");oe(this,"path");this.store=e,this.path=n}resolve(e){let n=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new Rt(this.store,new URL(e,n).pathname)}}var Jt;class Gn extends Rt{constructor(n,i,r){super(n,i);oe(this,"kind","group");Ce(this,Jt);be(this,Jt,r)}get attrs(){return Y(this,Jt).attributes}}Jt=new WeakMap;function vi(t){var n;const e=t.find(i=>i.name==="transpose");return((n=e==null?void 0:e.configuration)==null?void 0:n.order)??"C"}const Dt=Symbol("zarrita.context");function gs(t){return t[Dt]}function ps(t,e){let{configuration:n}=e.codecs.find(rs)??{},i={encode_chunk_key:$r(e.chunk_key_encoding),TypedArray:gr(e.data_type),fill_value:e.fill_value};if(n){let s=vi(n.codecs);return{...i,kind:"sharded",chunk_shape:n.chunk_shape,codec:Bn({data_type:e.data_type,shape:n.chunk_shape,codecs:n.codecs}),get_strides(o){return gt(o,s)},get_chunk_bytes:ms(t,e.chunk_grid.configuration.chunk_shape,i.encode_chunk_key,n)}}let r=vi(e.codecs);return{...i,kind:"regular",chunk_shape:e.chunk_grid.configuration.chunk_shape,codec:Bn({data_type:e.data_type,shape:e.chunk_grid.configuration.chunk_shape,codecs:e.codecs}),get_strides(s){return gt(s,r)},async get_chunk_bytes(s,o){let l=i.encode_chunk_key(s),a=t.resolve(l).path;return t.store.get(a,o)}}}var er,tr,mt,nr;let pn=(nr=class extends(tr=Rt,er=Dt,tr){constructor(n,i,r){super(n,i);oe(this,"kind","array");Ce(this,mt);oe(this,er);be(this,mt,{...r,fill_value:pr(r)}),this[Dt]=ps(this,r)}get attrs(){return Y(this,mt).attributes}get shape(){return Y(this,mt).shape}get chunks(){return this[Dt].chunk_shape}get dtype(){return Y(this,mt).data_type}async getChunk(n,i){let r=this[Dt],s=await r.get_chunk_bytes(n,i);if(!s){let o=r.chunk_shape.reduce((a,f)=>a*f,1),l=new r.TypedArray(o);return l.fill(r.fill_value),{data:l,shape:r.chunk_shape,stride:r.get_strides(r.chunk_shape)}}return r.codec.decode(s)}is(n){return is(this.dtype,n)}},mt=new WeakMap,nr),bn=bs();function bs(){let t=new WeakMap;function e(n){let i=t.get(n)??{v2:0,v3:0};return t.set(n,i),i}return{increment(n,i){e(n)[i]+=1},version_max(n){let i=e(n);return i.v3>i.v2?"v3":"v2"}}}async function ys(t){let e=await t.store.get(t.resolve(".zattrs").path);return e?rn(e):{}}async function vs(t,e={}){let n="store"in t?t:new Rt(t),i={};return(e.attrs??!0)&&(i=await ys(n)),e.kind==="array"?wi(n,i):e.kind==="group"?ki(n,i):wi(n,i).catch(r=>(br(r,nn),ki(n,i)))}async function wi(t,e){let{path:n}=t.resolve(".zarray"),i=await t.store.get(n);if(!i)throw new nn("v2 array",{cause:new Wn(n)});return bn.increment(t.store,"v2"),new pn(t.store,t.path,ts(rn(i),e))}async function ki(t,e){let{path:n}=t.resolve(".zgroup"),i=await t.store.get(n);if(!i)throw new nn("v2 group",{cause:new Wn(n)});return bn.increment(t.store,"v2"),new Gn(t.store,t.path,ns(rn(i),e))}async function ws(t){let{store:e,path:n}=t.resolve("zarr.json"),i=await t.store.get(n);if(!i)throw new nn("v3 array or group",{cause:new Wn(n)});let r=rn(i);return r.node_type==="array"&&(r.fill_value=pr(r)),r.node_type==="array"?new pn(e,t.path,r):new Gn(e,t.path,r)}async function ks(t,e={}){let n="store"in t?t:new Rt(t),i=await ws(n);if(bn.increment(n.store,"v3"),e.kind===void 0||e.kind==="array"&&i instanceof pn||e.kind==="group"&&i instanceof Gn)return i;let r=i instanceof pn?"array":"group";throw new Error(`Expected node of kind ${e.kind}, found ${r}.`)}async function _t(t,e={}){let n="store"in t?t.store:t,i=bn.version_max(n),r=i==="v2"?_t.v2:_t.v3,s=i==="v2"?_t.v3:_t.v2;return r(t,e).catch(o=>(br(o,nn),s(t,e)))}_t.v2=vs;_t.v3=ks;function*Es(t,e,n=1){e===void 0&&(e=t,t=0);for(let i=t;i<e;i+=n)yield i}function*Cs(...t){if(t.length===0)return;const e=t.map(i=>i[Symbol.iterator]()),n=e.map(i=>i.next());if(n.some(i=>i.done))throw new Error("Input contains an empty iterator.");for(let i=0;;){if(n[i].done){if(e[i]=t[i][Symbol.iterator](),n[i]=e[i].next(),++i>=e.length)return}else yield n.map(({value:r})=>r),i=0;n[i]=e[i].next()}}function Is({start:t,stop:e,step:n},i){if(n===0)throw new Error("slice step cannot be zero");n=n??1;const r=n<0,[s,o]=r?[-1,i-1]:[0,i];return t===null?t=r?o:s:t<0?(t+=i,t<s&&(t=s)):t>o&&(t=o),e===null?e=r?s:o:e<0?(e+=i,e<s&&(e=s)):e>o&&(e=o),[t,e,n]}function Pn(t,e,n=null){return e===void 0&&(e=t,t=null),{start:t,stop:e,step:n}}function As(){const t=[];return{add:e=>t.push(e()),onIdle:()=>Promise.all(t)}}class Jn extends Error{constructor(e){super(e),this.name="IndexError"}}function Ss(t,e){throw new Jn(`too many indicies for array; expected ${e.length}, got ${t.length}`)}function zs(t){throw new Jn(`index out of bounds for dimension with length ${t}`)}function Ts(){throw new Jn("only slices with step >= 1 are supported")}function Rs(t,e){t.length>e.length&&Ss(t,e)}function Os(t,e){return t=Math.trunc(t),t<0&&(t=e+t),(t>=e||t<0)&&zs(e),t}class Ls{constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){oe(this,"dim_sel");oe(this,"dim_len");oe(this,"dim_chunk_len");oe(this,"nitems");e=Os(e,n),this.dim_sel=e,this.dim_len=n,this.dim_chunk_len=i,this.nitems=1}*[Symbol.iterator](){const e=Math.floor(this.dim_sel/this.dim_chunk_len),n=e*this.dim_chunk_len,i=this.dim_sel-n;yield{dim_chunk_ix:e,dim_chunk_sel:i}}}class Ei{constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){oe(this,"start");oe(this,"stop");oe(this,"step");oe(this,"dim_len");oe(this,"dim_chunk_len");oe(this,"nitems");oe(this,"nchunks");const[r,s,o]=Is(e,n);this.start=r,this.stop=s,this.step=o,this.step<1&&Ts(),this.dim_len=n,this.dim_chunk_len=i,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const e=Math.floor(this.start/this.dim_chunk_len),n=Math.ceil(this.stop/this.dim_chunk_len);for(const i of Es(e,n)){const r=i*this.dim_chunk_len,s=Math.min(this.dim_len,(i+1)*this.dim_chunk_len),o=s-r;let l=0,a=0;if(this.start<r){const g=(r-this.start)%this.step;g&&(a+=this.step-g),l=Math.ceil((r-this.start)/this.step)}else a=this.start-r;const f=this.stop>s?o:this.stop-r,h=[a,f,this.step],m=Math.ceil((f-a)/this.step),b=[l,l+m,1];yield{dim_chunk_ix:i,dim_chunk_sel:h,dim_out_sel:b}}}}function Ms(t,e){let n=[];return t===null?n=e.map(i=>Pn(null)):Array.isArray(t)&&(n=t.map(i=>i??Pn(null))),Rs(n,e),n}class Fs{constructor({selection:e,shape:n,chunk_shape:i}){oe(this,"dim_indexers");oe(this,"shape");this.dim_indexers=Ms(e,n).map((r,s)=>new(typeof r=="number"?Ls:Ei)({dim_sel:r,dim_len:n[s],dim_chunk_len:i[s]})),this.shape=this.dim_indexers.filter(r=>r instanceof Ei).map(r=>r.nitems)}*[Symbol.iterator](){for(const e of Cs(...this.dim_indexers)){const n=e.map(r=>r.dim_chunk_ix),i=e.map(r=>"dim_out_sel"in r?{from:r.dim_chunk_sel,to:r.dim_out_sel}:{from:r.dim_chunk_sel,to:null});yield{chunk_coords:n,mapping:i}}}}function Ds(t,e){return"get"in t?t.get(e):t[e]}async function Ns(t,e,n,i){var a;let r=gs(t),s=new Fs({selection:e,shape:t.shape,chunk_shape:t.chunks}),o=i.prepare(new r.TypedArray(s.shape.reduce((f,h)=>f*h,1)),s.shape,r.get_strides(s.shape)),l=((a=n.create_queue)==null?void 0:a.call(n))??As();for(const{chunk_coords:f,mapping:h}of s)l.add(async()=>{let{data:m,shape:b,stride:g}=await t.getChunk(f,n.opts),d=i.prepare(m,b,g);i.set_from_chunk(o,d,h)});return await l.onIdle(),s.shape.length===0?Ds(o.data,0):o}function Yn(t,e=0,n){let i=n??t.length-e;return{length:i,subarray(r,s=i){return Yn(t,e+r,s-r)},set(r,s=0){for(let o=0;o<r.length;o++)t[e+s+o]=r.get(o)},get(r){return t[e+r]}}}function An(t){return globalThis.Array.isArray(t.data)?{data:Yn(t.data),stride:t.stride,bytes_per_element:1}:{data:new Uint8Array(t.data.buffer,t.data.byteOffset,t.data.byteLength),stride:t.stride,bytes_per_element:t.data.BYTES_PER_ELEMENT}}function Bs(t){return"chars"in t?t.constructor.bind(null,t.chars):t.constructor}function Ps(t,e){if(globalThis.Array.isArray(t.data))return Yn([e]);let n=Bs(t.data),i=new n([e]);return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}const Us={prepare(t,e,n){return{data:t,shape:e,stride:n}},set_scalar(t,e,n){let i=An(t);Un(i,e,Ps(t,n),i.bytes_per_element)},set_from_chunk(t,e,n){let i=An(t);_n(i,An(e),i.bytes_per_element,n)}};async function js(t,e=null,n={}){return Ns(t,e,n,Us)}function yr(t,e,n){return n<0&&e<t?Math.floor((t-e-1)/-n)+1:t<e?Math.floor((e-t-1)/n)+1:0}function Un(t,e,n,i){if(e.length===0){t.data.set(n,0);return}const[r,...s]=e,[o,...l]=t.stride;if(typeof r=="number"){const b=t.data.subarray(o*r*i);Un({data:b,stride:l},s,n,i);return}const[a,f,h]=r,m=yr(a,f,h);if(s.length===0){for(let b=0;b<m;b++)t.data.set(n,o*(a+h*b)*i);return}for(let b=0;b<m;b++){const g=t.data.subarray(o*(a+h*b)*i);Un({data:g,stride:l},s,n,i)}}function _n(t,e,n,i){const[r,...s]=i,[o,...l]=t.stride,[a,...f]=e.stride;if(r.from===null){if(s.length===0){t.data.set(e.data.subarray(0,n),r.to*n);return}_n({data:t.data.subarray(o*r.to*n),stride:l},e,n,s);return}if(r.to===null){if(s.length===0){let M=r.from*n;t.data.set(e.data.subarray(M,M+n),0);return}_n(t,{data:e.data.subarray(a*r.from*n),stride:f},n,s);return}const[h,m,b]=r.to,[g,d,k]=r.from,z=yr(h,m,b);if(s.length===0){if(b===1&&k===1&&o===1&&a===1){let M=g*n,j=z*n;t.data.set(e.data.subarray(M,M+j),h*n);return}for(let M=0;M<z;M++){let j=a*(g+k*M)*n;t.data.set(e.data.subarray(j,j+n),o*(h+b*M)*n)}return}for(let M=0;M<z;M++)_n({data:t.data.subarray(o*(h+M*b)*n),stride:l},{data:e.data.subarray(a*(g+M*k)*n),stride:f},n,s)}function vr(t,e,n,i={}){return e!==void 0&&n!==void 0&&(i={...i,headers:{...i.headers,Range:`bytes=${e}-${e+n-1}`}}),fetch(t,i)}function xs(t,e){return{...t,...e,headers:{...t.headers,...e.headers}}}function Ci(t,e){const n=typeof t=="string"?new URL(t):t;n.pathname.endsWith("/")||(n.pathname+="/");const i=new URL(e.slice(1),n);return i.search=n.search,i}async function Ii(t){if(t.status!==404){if(t.status===200||t.status===206)return new Uint8Array(await t.arrayBuffer());throw new Error(`Unexpected response status ${t.status} ${t.statusText}`)}}async function Vs(t,e,n,i){if(i)return fetch(t,{...n,headers:{...n.headers,Range:`bytes=-${e}`}});let r=await fetch(t,{...n,method:"HEAD"});if(!r.ok)return r;let s=r.headers.get("Content-Length"),o=Number(s);return vr(t,o-e,o,n)}var Yt,Zt,Qt,jn;class Ws{constructor(e,n={}){Ce(this,Qt);oe(this,"url");Ce(this,Yt);Ce(this,Zt);this.url=e,be(this,Yt,n.overrides??{}),be(this,Zt,n.useSuffixRequest??!1)}async get(e,n={}){let i=Ci(this.url,e).href,r=await fetch(i,En(this,Qt,jn).call(this,n));return Ii(r)}async getRange(e,n,i={}){let r=Ci(this.url,e),s=En(this,Qt,jn).call(this,i),o;return"suffixLength"in n?o=await Vs(r,n.suffixLength,s,Y(this,Zt)):o=await vr(r,n.offset,n.length,s),Ii(o)}}Yt=new WeakMap,Zt=new WeakMap,Qt=new WeakSet,jn=function(e){return xs(Y(this,Yt),e)};async function Ut(t,e){var r;let n;try{const s=await fetch(`${t}/zarr.json`,{signal:e});if(!s.ok)throw new Error(`HTTP ${s.status} for ${t}/zarr.json`);n=await s.json()}catch(s){return console.warn(`[ngffLoader] ${t}/zarr.json not found or invalid`,s.message),[void 0,t]}const i=(r=n==null?void 0:n.attributes)==null?void 0:r.ome;if(!i)return[void 0,t];if(i.multiscales)return[i,t];if(i.plate){const s=i.plate.wells[0],o=`${t}/${s.path}/0`,[l,a]=await Ut(o,e);return[l,a,i.plate]}if(i["bioformats2raw.layout"]){const s=`${t}/0`;return await Ut(s,e)}return[void 0,t]}async function Hs(t,e,n,i=512,r){var G,N,U;if(!((G=e==null?void 0:e.multiscales)!=null&&G.length))return null;const s=e.multiscales[0].datasets.map(w=>w.path),o=e.multiscales[0].axes.map(w=>w.name);let l=s.at(-1);n!==void 0&&n<s.length&&(l=s[n]);const a=new Ws(`${t}/${l}`),f=await _t.v3(a,{kind:"array"}),h=o.indexOf("c"),m=f.shape;if(m.at(-1)*m.at(-2)>i*i)return console.log("Thumbnail skipped, too large:",m,t),null;const b=m[h]||1,g=(N=e==null?void 0:e.omero)!=null&&N.channels?e.omero.channels.map(w=>w.active):Gr(b),d=(U=e==null?void 0:e.omero)!=null&&U.channels?e.omero.channels.map(w=>cr(w.color)):Jr(b,g),k=g.reduce((w,c,u)=>c?[...w,u]:w,[]),z=w=>m.map((c,u)=>u===h?w:u>=m.length-2?Pn(0,c):parseInt(c/2)),M=await Promise.all(k.map(w=>js(f,z(w),{opts:{signal:r}}))),j=M.map(Hr);return{rgb:Yr(M,j,d),width:m.at(-1),height:m.at(-2)}}class qs{constructor(e="index",n=!0){this.store=Mn([]),this.selectedRow=Mn(null),this.sortColumn=e,this.sortAscending=n,this.csvFiles=[]}addCsv(e,n,i,r,s){n=n.map(l=>({...l,child_csv:[]}));let o;for(let l of this.csvFiles){if(l.url===e){o=l;break}for(let a of l.child_csv){if(a.url===e){o=a;break}for(let f of a.child_csv)if(f.url===e){o=f;break}}}o?(o.image_count=i,o.plate_count=r,o.bytes=s,o.child_csv=n):(o={url:e,image_count:i,plate_count:r,bytes:s,child_csv:n},this.csvFiles.push(o))}addRows(e){e=e.map((r,s)=>{if(r.written&&(r.written=parseFloat(r.written)),r.shape){let o=r.shape.split(",").map(a=>parseInt(a)),l;r.dimension_names?l=r.dimension_names.split(","):o.length==5&&(l=["t","c","z","y","x"]),l&&l.length==o.length&&l.forEach((a,f)=>r["size_"+a]=o[f]),r.dim_count=o.reduce((a,f)=>a+(f>1?1:0),0)}if(r.chunks){let o=r.chunks.split(",").map(l=>parseInt(l));r.chunk_pixels=o.reduce((l,a)=>l*a,1)}if(r.shards){let o=r.shards.split(",").map(l=>parseInt(l));r.shard_pixels=o.reduce((l,a)=>l*a,1)}return r.index=Math.random()*(1+s),r}),console.log("Adding rows",e),this.store.update(r=>(r.push(...e),r.sort((s,o)=>this.compareRows(s,o,!0)),r));let n=e.map(r=>r.organismId);dr.addTerms(n);let i=e.map(r=>r.fbbiId);_r.addTerms(i)}populateRow(e,n){this.store.update(i=>(i=i.map(r=>(r.url===e&&(r={...r,...n}),r)),i))}async loadNgffMetadata(e){var b;const[n,i,r]=await Ut(e);let s=[],o=0,l=0,a=!1,f=!0,h={multiscales:n},m=i;if(r&&(o=r.wells.length,l=r.field_count||1),n){const g=(b=n[0])==null?void 0:b.datasets[0],d=g==null?void 0:g.path;if(d){const k=await fetch(`${i}/${d}/zarr.json`).then(z=>z.json()).catch(z=>{console.log(`----> Failed to parse ${i}/${d}/zarr.json`,z)});s=k==null?void 0:k.shape}}else console.log("No multiscales found"),a=!0,s=[0];this.populateRow(e,{image_attrs:h,image_url:m,shape:s,well_count:o,field_count:l,load_failed:a,loaded:f})}compareRows(e,n,i=!1){let r=e[this.sortColumn],s=n[this.sortColumn];if(i)return r===void 0&&(r=0),s===void 0&&(s=0),r<s?this.sortAscending?-1:1:r>s?this.sortAscending?1:-1:0;r===void 0&&(r=""),s===void 0&&(s="");let o=0;return i?o=r-s:o=r.localeCompare(s),this.sortAscending?o:-o}sortTable(e,n=!0){console.log("sortTable",e,n),this.sortColumn=e,this.sortAscending=n;let i=this.isColumnNumeric(e);this.store.update(r=>(r.sort((s,o)=>this.compareRows(s,o,i)),r))}isColumnNumeric(e){let n=fn(this.store);for(let i of n){let r=i[e];if(r!==void 0&&r!=="")return!isNaN(r)}}emptyTable(){this.store.set([])}subscribe(e){return this.store.subscribe(e)}getRows(){return fn(this.store)}getRow(e){return fn(this.store)[e]}subscribeSelectedRow(e){return this.selectedRow.subscribe(e)}setSelectedRow(e){this.selectedRow.set(e)}}const He=new qs;function Ks(t){let e,n,i,r,s,o;return{c(){e=E("button"),n=E("span"),n.textContent="^",i=q(),r=E("span"),r.textContent="^",p(n,"class","acc svelte-17vd65t"),je(n,"strong",t[1]),p(r,"class","dec svelte-17vd65t"),je(r,"strong",!t[1]),p(e,"class","svelte-17vd65t")},m(l,a){K(l,e,a),_(e,n),_(e,i),_(e,r),s||(o=ge(e,"click",t[2]),s=!0)},p(l,[a]){a&2&&je(n,"strong",l[1]),a&2&&je(r,"strong",!l[1])},i:ve,o:ve,d(l){l&&W(e),s=!1,o()}}}function Gs(t,e,n){let{toggleAscending:i}=e,{sortAscending:r}=e;const s=()=>i();return t.$$set=o=>{"toggleAscending"in o&&n(0,i=o.toggleAscending),"sortAscending"in o&&n(1,r=o.sortAscending)},[i,r,s]}class Js extends Qe{constructor(e){super(),Ze(this,e,Gs,Ks,xe,{toggleAscending:0,sortAscending:1})}}const cn={AUTO:"auto",START:"start",CENTER:"center",END:"end"},st={HORIZONTAL:"horizontal",VERTICAL:"vertical"},Ft={OBSERVED:0,REQUESTED:1},Ys={[st.VERTICAL]:"top",[st.HORIZONTAL]:"left"},Ai={[st.VERTICAL]:"scrollTop",[st.HORIZONTAL]:"scrollLeft"};class Zs{constructor({itemSize:e,itemCount:n,estimatedItemSize:i}){this.itemSize=e,this.itemCount=n,this.estimatedItemSize=i,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig({itemSize:e,itemCount:n,estimatedItemSize:i}){n!=null&&(this.itemCount=n),i!=null&&(this.estimatedItemSize=i),e!=null&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!=null?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.itemCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:n}=this;return typeof n=="function"?n(e):Array.isArray(n)?n[e]:n}computeTotalSizeAndPositionData(){let e=0;for(let n=0;n<this.itemCount;n++){const i=this.getSize(n),r=e;e+=i,this.itemSizeAndPositionData[n]={offset:r,size:i}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){if(e<0||e>=this.itemCount)throw Error(`Requested index ${e} is outside of range 0..${this.itemCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const n=this.getSizeAndPositionOfLastMeasuredItem();let i=n.offset+n.size;for(let r=this.lastMeasuredIndex+1;r<=e;r++){const s=this.getSize(r);if(s==null||isNaN(s))throw Error(`Invalid size returned for index ${r} of value ${s}`);this.itemSizeAndPositionData[r]={offset:i,size:s},i+=s}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize}getUpdatedOffsetForIndex({align:e=cn.START,containerSize:n,currentOffset:i,targetIndex:r}){if(n<=0)return 0;const s=this.getSizeAndPositionForIndex(r),o=s.offset,l=o-n+s.size;let a;switch(e){case cn.END:a=l;break;case cn.CENTER:a=o-(n-s.size)/2;break;case cn.START:a=o;break;default:a=Math.max(l,Math.min(o,i))}const f=this.getTotalSize();return Math.max(0,Math.min(f-n,a))}getVisibleRange({containerSize:e=0,offset:n,overscanCount:i}){if(this.getTotalSize()===0)return{};const s=n+e;let o=this.findNearestItem(n);if(o===void 0)throw Error(`Invalid offset ${n} specified`);const l=this.getSizeAndPositionForIndex(o);n=l.offset+l.size;let a=o;for(;n<s&&a<this.itemCount-1;)a++,n+=this.getSizeAndPositionForIndex(a).size;return i&&(o=Math.max(0,o-i),a=Math.min(a+i,this.itemCount-1)),{start:o,stop:a}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const n=this.getSizeAndPositionOfLastMeasuredItem(),i=Math.max(0,this.lastMeasuredIndex);return n.offset>=e?this.binarySearch({high:i,low:0,offset:e}):this.exponentialSearch({index:i,offset:e})}binarySearch({low:e,high:n,offset:i}){let r=0,s=0;for(;e<=n;){if(r=e+Math.floor((n-e)/2),s=this.getSizeAndPositionForIndex(r).offset,s===i)return r;s<i?e=r+1:s>i&&(n=r-1)}return e>0?e-1:0}exponentialSearch({index:e,offset:n}){let i=1;for(;e<this.itemCount&&this.getSizeAndPositionForIndex(e).offset<n;)e+=i,i*=2;return this.binarySearch({high:Math.min(e,this.itemCount-1),low:Math.floor(e/2),offset:n})}}const Qs=t=>({}),Si=t=>({});function zi(t,e,n){const i=t.slice();return i[37]=e[n],i}const Xs=t=>({style:t[0]&4,index:t[0]&4}),Ti=t=>({style:t[37].style,index:t[37].index}),$s=t=>({}),Ri=t=>({});function Oi(t,e){let n,i;const r=e[21].item,s=zn(r,e,e[20],Ti);return{key:t,first:null,c(){n=Xt(),s&&s.c(),this.first=n},m(o,l){K(o,n,l),s&&s.m(o,l),i=!0},p(o,l){e=o,s&&s.p&&(!i||l[0]&1048580)&&Rn(s,r,e,e[20],i?Tn(r,e[20],l,Xs):On(e[20]),Ti)},i(o){i||(ue(s,o),i=!0)},o(o){he(s,o),i=!1},d(o){o&&W(n),s&&s.d(o)}}}function eo(t){let e,n,i,r=[],s=new Map,o,l;const a=t[21].header,f=zn(a,t,t[20],Ri);let h=Ne(t[2]);const m=d=>d[0]?d[0](d[37].index):d[37].index;for(let d=0;d<h.length;d+=1){let k=zi(t,h,d),z=m(k);s.set(z,r[d]=Oi(z,k))}const b=t[21].footer,g=zn(b,t,t[20],Si);return{c(){e=E("div"),f&&f.c(),n=q(),i=E("div");for(let d=0;d<r.length;d+=1)r[d].c();o=q(),g&&g.c(),p(i,"class","virtual-list-inner svelte-dwpad5"),p(i,"style",t[4]),p(e,"class","virtual-list-wrapper svelte-dwpad5"),p(e,"style",t[3])},m(d,k){K(d,e,k),f&&f.m(e,null),_(e,n),_(e,i);for(let z=0;z<r.length;z+=1)r[z]&&r[z].m(i,null);_(e,o),g&&g.m(e,null),t[22](e),l=!0},p(d,k){f&&f.p&&(!l||k[0]&1048576)&&Rn(f,a,d,d[20],l?Tn(a,d[20],k,$s):On(d[20]),Ri),k[0]&1048581&&(h=Ne(d[2]),en(),r=ar(r,k,m,1,d,h,s,i,Br,Oi,null,zi),tn()),(!l||k[0]&16)&&p(i,"style",d[4]),g&&g.p&&(!l||k[0]&1048576)&&Rn(g,b,d,d[20],l?Tn(b,d[20],k,Qs):On(d[20]),Si),(!l||k[0]&8)&&p(e,"style",d[3])},i(d){if(!l){ue(f,d);for(let k=0;k<h.length;k+=1)ue(r[k]);ue(g,d),l=!0}},o(d){he(f,d);for(let k=0;k<r.length;k+=1)he(r[k]);he(g,d),l=!1},d(d){d&&W(e),f&&f.d(d);for(let k=0;k<r.length;k+=1)r[k].d();g&&g.d(d),t[22](null)}}}const to=(()=>{let t=!1;try{const e=Object.defineProperty({},"passive",{get(){return t={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return t})();function no(t,e,n){let{$$slots:i={},$$scope:r}=e,{height:s}=e,{width:o="100%"}=e,{itemCount:l}=e,{itemSize:a}=e,{estimatedItemSize:f=null}=e,{stickyIndices:h=null}=e,{getKey:m=null}=e,{scrollDirection:b=st.VERTICAL}=e,{scrollOffset:g=null}=e,{scrollToIndex:d=null}=e,{scrollToAlignment:k=null}=e,{scrollToBehaviour:z="instant"}=e,{overscanCount:M=3}=e;const j=Lr(),H=new Zs({itemCount:l,itemSize:a,estimatedItemSize:$()});let G=!1,N,U=[],w={offset:g||d!=null&&U.length&&L(d)||0,scrollChangeReason:Ft.REQUESTED},c=w,u={scrollToIndex:d,scrollToAlignment:k,scrollOffset:g,itemCount:l,itemSize:a,estimatedItemSize:f},y={},C="",T="";R(),$t(()=>{n(18,G=!0),N.addEventListener("scroll",O,to),g!=null?F(g):d!=null&&F(L(d))}),Vn(()=>{G&&N.removeEventListener("scroll",O)});function D(){if(!G)return;const A=u.scrollToIndex!==d||u.scrollToAlignment!==k,x=u.itemCount!==l||u.itemSize!==a||u.estimatedItemSize!==f;x&&(H.updateConfig({itemSize:a,itemCount:l,estimatedItemSize:$()}),I()),u.scrollOffset!==g?n(19,w={offset:g||0,scrollChangeReason:Ft.REQUESTED}):typeof d=="number"&&(A||x)&&n(19,w={offset:L(d,k,l),scrollChangeReason:Ft.REQUESTED}),u={scrollToIndex:d,scrollToAlignment:k,scrollOffset:g,itemCount:l,itemSize:a,estimatedItemSize:f}}function P(){if(!G)return;const{offset:A,scrollChangeReason:x}=w;(c.offset!==A||c.scrollChangeReason!==x)&&R(),c.offset!==A&&x===Ft.REQUESTED&&F(A),c=w}function R(){const{offset:A}=w,{start:x,stop:te}=H.getVisibleRange({containerSize:b===st.VERTICAL?s:o,offset:A,overscanCount:M});let ne=[];const X=H.getTotalSize();b===st.VERTICAL?(n(3,C=`height:${s}${typeof s=="number"?"px":""};width:${o};`),n(4,T=`flex-direction:column;height:${X}px;`)):(n(3,C=`height:${s};width:${o}${typeof o=="number"?"px":""}`),n(4,T=`min-height:100%;width:${X}px;`));const B=h!=null&&h.length!==0;if(B)for(let J=0;J<h.length;J++){const ie=h[J];ne.push({index:ie,style:v(ie,!0)})}if(x!==void 0&&te!==void 0){for(let J=x;J<=te;J++)B&&h.includes(J)||ne.push({index:J,style:v(J,!1)});j("itemsUpdated",{start:x,end:te})}n(2,U=ne)}function F(A){"scroll"in N?N.scroll({[Ys[b]]:A,behavior:z}):n(1,N[Ai[b]]=A,N)}function I(A=0){y={},H.resetItem(A),R()}function L(A,x=k,te=l){return(A<0||A>=te)&&(A=0),H.getUpdatedOffsetForIndex({align:x,containerSize:b===st.VERTICAL?s:o,currentOffset:w.offset||0,targetIndex:A})}function O(A){const x=Q();x<0||w.offset===x||A.target!==N||(n(19,w={offset:x,scrollChangeReason:Ft.OBSERVED}),j("afterScroll",{offset:x,event:A}))}function Q(){return N[Ai[b]]}function $(){return f||typeof a=="number"&&a||50}function v(A,x){if(y[A])return y[A];const{size:te,offset:ne}=H.getSizeAndPositionForIndex(A);let X;return b===st.VERTICAL?(X=`left:0;width:100%;height:${te}px;`,x?X+=`position:sticky;flex-grow:0;z-index:1;top:0;margin-top:${ne}px;margin-bottom:${-(ne+te)}px;`:X+=`position:absolute;top:${ne}px;`):(X=`top:0;width:${te}px;`,x?X+=`position:sticky;z-index:1;left:0;margin-left:${ne}px;margin-right:${-(ne+te)}px;`:X+=`position:absolute;height:100%;left:${ne}px;`),y[A]=X}function V(A){ct[A?"unshift":"push"](()=>{N=A,n(1,N)})}return t.$$set=A=>{"height"in A&&n(5,s=A.height),"width"in A&&n(6,o=A.width),"itemCount"in A&&n(7,l=A.itemCount),"itemSize"in A&&n(8,a=A.itemSize),"estimatedItemSize"in A&&n(9,f=A.estimatedItemSize),"stickyIndices"in A&&n(10,h=A.stickyIndices),"getKey"in A&&n(0,m=A.getKey),"scrollDirection"in A&&n(11,b=A.scrollDirection),"scrollOffset"in A&&n(12,g=A.scrollOffset),"scrollToIndex"in A&&n(13,d=A.scrollToIndex),"scrollToAlignment"in A&&n(14,k=A.scrollToAlignment),"scrollToBehaviour"in A&&n(15,z=A.scrollToBehaviour),"overscanCount"in A&&n(16,M=A.overscanCount),"$$scope"in A&&n(20,r=A.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&29568&&D(),t.$$.dirty[0]&524288&&P(),t.$$.dirty[0]&263264&&G&&I(0)},[m,N,U,C,T,s,o,l,a,f,h,b,g,d,k,z,M,I,G,w,r,i,V]}class io extends Qe{constructor(e){super(),Ze(this,e,no,eo,xe,{height:5,width:6,itemCount:7,itemSize:8,estimatedItemSize:9,stickyIndices:10,getKey:0,scrollDirection:11,scrollOffset:12,scrollToIndex:13,scrollToAlignment:14,scrollToBehaviour:15,overscanCount:16,recomputeSizes:17},null,[-1,-1])}get height(){return this.$$.ctx[5]}set height(e){this.$$set({height:e}),De()}get width(){return this.$$.ctx[6]}set width(e){this.$$set({width:e}),De()}get itemCount(){return this.$$.ctx[7]}set itemCount(e){this.$$set({itemCount:e}),De()}get itemSize(){return this.$$.ctx[8]}set itemSize(e){this.$$set({itemSize:e}),De()}get estimatedItemSize(){return this.$$.ctx[9]}set estimatedItemSize(e){this.$$set({estimatedItemSize:e}),De()}get stickyIndices(){return this.$$.ctx[10]}set stickyIndices(e){this.$$set({stickyIndices:e}),De()}get getKey(){return this.$$.ctx[0]}set getKey(e){this.$$set({getKey:e}),De()}get scrollDirection(){return this.$$.ctx[11]}set scrollDirection(e){this.$$set({scrollDirection:e}),De()}get scrollOffset(){return this.$$.ctx[12]}set scrollOffset(e){this.$$set({scrollOffset:e}),De()}get scrollToIndex(){return this.$$.ctx[13]}set scrollToIndex(e){this.$$set({scrollToIndex:e}),De()}get scrollToAlignment(){return this.$$.ctx[14]}set scrollToAlignment(e){this.$$set({scrollToAlignment:e}),De()}get scrollToBehaviour(){return this.$$.ctx[15]}set scrollToBehaviour(e){this.$$set({scrollToBehaviour:e}),De()}get overscanCount(){return this.$$.ctx[16]}set overscanCount(e){this.$$set({overscanCount:e}),De()}get recomputeSizes(){return this.$$.ctx[17]}}function ro(t){let e,n,i,r,s;return{c(){e=E("div"),n=E("img"),r=q(),s=E("canvas"),ae(n,"width",t[4]+"px"),ae(n,"height",t[5]+"px"),ae(n,"object-fit","cover"),p(n,"alt",""),p(n,"aria-hidden",i=t[7]!=="cached"),p(n,"class","svelte-12dtn57"),je(n,"hidden",t[7]!=="cached"),ae(s,"width",t[4]+"px"),ae(s,"height",t[5]+"px"),ae(s,"background-color","lightgrey"),p(s,"width",t[2]),p(s,"height",t[3]),p(s,"class","svelte-12dtn57"),je(s,"hidden",t[7]!=="live"),p(e,"class","canvasWrapper svelte-12dtn57"),ae(e,"width",t[4]+"px"),ae(e,"height",t[5]+"px"),je(e,"spinner",t[6])},m(o,l){K(o,e,l),_(e,n),t[14](n),_(e,r),_(e,s),t[15](s)},p(o,[l]){l&16&&ae(n,"width",o[4]+"px"),l&32&&ae(n,"height",o[5]+"px"),l&128&&i!==(i=o[7]!=="cached")&&p(n,"aria-hidden",i),l&128&&je(n,"hidden",o[7]!=="cached"),l&16&&ae(s,"width",o[4]+"px"),l&32&&ae(s,"height",o[5]+"px"),l&4&&p(s,"width",o[2]),l&8&&p(s,"height",o[3]),l&128&&je(s,"hidden",o[7]!=="live"),l&16&&ae(e,"width",o[4]+"px"),l&32&&ae(e,"height",o[5]+"px"),l&64&&je(e,"spinner",o[6])},i:ve,o:ve,d(o){o&&W(e),t[14](null),t[15](null)}}}function so(t){try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n[n.length-1]}catch{const e=t.split("?")[0].split("/");return e[e.length-1]}}function oo(t,e,n){let{source:i}=e,{attrs:r}=e,{thumbDatasetIndex:s=void 0}=e,{thumbAspectRatio:o=1}=e,{cssSize:l=120}=e,{max_size:a=512}=e;const f="/zowser/";let h,m,b=l,g=l;o>1?g=b/o:o<1&&(b=g*o);let d=b,k=g,z=!0,M="none";const j=new AbortController;async function H(){const w=so(i);console.log(f);const c=`${f}thumbs/${w}.jpg`,u=new Image;return u.decoding="async",u.referrerPolicy="no-referrer",new Promise(y=>{u.onload=()=>{n(7,M="cached"),n(6,z=!1),n(1,m.src=c,m),y(!0)},u.onerror=()=>y(!1),u.src=c})}async function G(){n(7,M="live");const w=await Hs(i,r,s,a,j.signal);if(!w){console.warn("Thumbnail generation skipped/failed:",i);return}const{rgb:c,width:u,height:y}=w;n(2,b=u),n(3,g=y);let C=Math.max(b,g)/l;C<1&&(C=1),n(4,d=b/C),n(5,k=g/C),await Mr(),h.getContext("2d").putImageData(new ImageData(c,b,g),0,0),n(6,z=!1)}$t(async()=>{await H()||await G()}),Vn(()=>j.abort());function N(w){ct[w?"unshift":"push"](()=>{m=w,n(1,m)})}function U(w){ct[w?"unshift":"push"](()=>{h=w,n(0,h)})}return t.$$set=w=>{"source"in w&&n(8,i=w.source),"attrs"in w&&n(9,r=w.attrs),"thumbDatasetIndex"in w&&n(10,s=w.thumbDatasetIndex),"thumbAspectRatio"in w&&n(11,o=w.thumbAspectRatio),"cssSize"in w&&n(12,l=w.cssSize),"max_size"in w&&n(13,a=w.max_size)},[h,m,b,g,d,k,z,M,i,r,s,o,l,a,N,U]}class wr extends Qe{constructor(e){super(),Ze(this,e,oo,ro,xe,{source:8,attrs:9,thumbDatasetIndex:10,thumbAspectRatio:11,cssSize:12,max_size:13})}}const kr="/zowser/ome-logomark.svg",lo=[{name:"vizarr",logo:"/vizarr_logo.png",href:"https://hms-dbmi.github.io/vizarr/?source="},{name:"itk-vtk-viewer",logo:"/itkvtk_logo.png",href:"https://kitware.github.io/itk-vtk-viewer/app/?rotate=false&fileToLoad="},{name:"neuroglancer",logo:"/neuroglancer.png","//":"NB: The {URL} in the href is replaced with NGFF image URL",href:"https://neuroglancer-demo.appspot.com/#!{%22layers%22:[{%22source%22:%22{URL}%22,%22name%22:%22OME-NGFF%22}]}"},{name:"Vol-E viewer",logo:"/aics_website-3d-cell-viewer.png",href:"https://volumeviewer.allencell.org/viewer?url="},{name:"napari",logo:"/napari.png",html:"<p>See <a href='https://napari.org/'>napari.org</a> for install instructions.</p><p>Then <code>napari {URL}</code>"},{name:"MoBIE",logo:"/MoBIE.jpeg",html:"<p><a href='https://github.com/mobie/mobie-viewer-fiji/'>MoBIE</a> plugin for ImageJ/Fiji. See <a href='https://omero-guides.readthedocs.io/en/latest/fiji/docs/view_mobie_zarr.html'>MoBIE guide</a> for installation. Plugins > BigDataViewer > OME ZARR > <br> Open OME ZARR from S3…. <code>{URL}</code>"}],ao={viewers:lo},Sn="/zowser/vizarr_logo.png",Er="/zowser/copy.png";function Li(t,e,n){const i=t.slice();return i[21]=e[n],i[23]=n,i}function uo(t){let e,n,i,r,s,o,l,a;function f(){return t[18](t[23])}return{c(){e=E("button"),n=E("img"),r=q(),s=E("img"),p(n,"class","viewer_icon"),tt(n.src,i=t[21].logo_path)||p(n,"src",i),p(n,"alt","Viewer Icon"),p(s,"class","smallCopyBtn"),tt(s.src,o=Er)||p(s,"src",o),p(s,"alt","Copy Icon"),je(s,"shaking",t[2][t[23]]),p(e,"class","inlineButton"),p(e,"title","Copy URL")},m(h,m){K(h,e,m),_(e,n),_(e,r),_(e,s),l||(a=ge(e,"click",f),l=!0)},p(h,m){t=h,m&8&&!tt(n.src,i=t[21].logo_path)&&p(n,"src",i),m&4&&je(s,"shaking",t[2][t[23]])},d(h){h&&W(e),l=!1,a()}}}function co(t){let e,n,i,r,s,o,l;function a(){return t[17](t[21])}return{c(){e=E("button"),n=E("img"),p(n,"class","viewer_icon"),tt(n.src,i=t[21].logo_path)||p(n,"src",i),p(n,"alt",r=t[21].name),p(e,"class","inlineButton"),p(e,"title",s="View "+t[1]+" in "+t[21].name)},m(f,h){K(f,e,h),_(e,n),o||(l=ge(e,"click",a),o=!0)},p(f,h){t=f,h&8&&!tt(n.src,i=t[21].logo_path)&&p(n,"src",i),h&8&&r!==(r=t[21].name)&&p(n,"alt",r),h&10&&s!==(s="View "+t[1]+" in "+t[21].name)&&p(e,"title",s)},d(f){f&&W(e),o=!1,l()}}}function Mi(t){let e,n=t[21].html.replace("{URL}",t[0])+"";return{c(){e=E("div"),p(e,"class","viewer_html")},m(i,r){K(i,e,r),e.innerHTML=n},p(i,r){r&9&&n!==(n=i[21].html.replace("{URL}",i[0])+"")&&(e.innerHTML=n)},d(i){i&&W(e)}}}function Fi(t){let e,n,i;function r(a,f){return a[21].href?co:uo}let s=r(t),o=s(t),l=t[21].html&&Mi(t);return{c(){e=E("div"),o.c(),n=q(),l&&l.c(),i=q(),p(e,"class","viewerItem")},m(a,f){K(a,e,f),o.m(e,null),_(e,n),l&&l.m(e,null),_(e,i)},p(a,f){s===(s=r(a))&&o?o.p(a,f):(o.d(1),o=s(a),o&&(o.c(),o.m(e,n))),a[21].html?l?l.p(a,f):(l=Mi(a),l.c(),l.m(e,i)):l&&(l.d(1),l=null)},d(a){a&&W(e),o.d(),l&&l.d()}}}function Di(t){let e,n,i;return{c(){e=E("span"),n=Z("— "),i=Z(t[8]),p(e,"class","file-info")},m(r,s){K(r,e,s),_(e,n),_(e,i)},p(r,s){s&256&&Se(i,r[8])},d(r){r&&W(e)}}}function fo(t){let e,n,i,r,s,o,l,a,f,h,m,b,g,d,k,z,M,j,H,G,N,U,w,c,u,y,C,T,D,P,R=Ne(t[3]),F=[];for(let L=0;L<R.length;L+=1)F[L]=Fi(Li(t,R,L));let I=t[8]&&Di(t);return{c(){e=E("div"),n=E("div"),i=E("div"),r=E("button"),s=E("img"),l=q(),a=E("div"),f=E("button"),f.innerHTML=`<img class="viewer_icon" src="${kr}" alt="Validator"/>`,h=q();for(let L=0;L<F.length;L+=1)F[L].c();m=q(),b=E("div"),g=E("div"),d=E("div"),k=E("img"),M=q(),j=E("span"),H=Z(t[6]),G=q(),I&&I.c(),N=q(),U=E("div"),w=E("button"),w.textContent="↗",c=q(),u=E("button"),u.textContent="×",y=q(),C=E("iframe"),p(s,"class","viewer_icon"),tt(s.src,o=Er)||p(s,"src",o),p(s,"alt","Copy Icon"),je(s,"shaking",t[2].bigCopyButton),p(r,"class","inlineButton"),p(r,"title","Copy URL"),p(i,"class","viewerItem"),p(f,"class","inlineButton"),p(f,"title","Validate NGFF"),p(a,"class","viewerItem"),p(n,"class","viewerRow"),p(e,"class","openwith"),tt(k.src,z=t[7])||p(k,"src",z),p(k,"alt",""),p(k,"class","viewer_header_logo"),p(d,"class","vh-left"),p(w,"class","external"),p(w,"title","Open externally"),p(u,"class","close"),p(u,"title","Close"),p(U,"class","popover-buttons inline"),p(g,"class","viewer-header"),tt(C.src,T=t[5])||p(C,"src",T),p(C,"frameborder","0"),p(C,"title",t[6]),p(b,"id","viewer-popover"),p(b,"popover","")},m(L,O){K(L,e,O),_(e,n),_(n,i),_(i,r),_(r,s),_(n,l),_(n,a),_(a,f),_(n,h);for(let Q=0;Q<F.length;Q+=1)F[Q]&&F[Q].m(n,null);K(L,m,O),K(L,b,O),_(b,g),_(g,d),_(d,k),_(d,M),_(d,j),_(j,H),_(d,G),I&&I.m(d,null),_(g,N),_(g,U),_(U,w),_(U,c),_(U,u),_(b,y),_(b,C),t[19](b),D||(P=[ge(r,"click",t[15]),ge(f,"click",t[16]),ge(w,"click",t[12]),ge(u,"click",t[11])],D=!0)},p(L,[O]){if(O&4&&je(s,"shaking",L[2].bigCopyButton),O&1551){R=Ne(L[3]);let Q;for(Q=0;Q<R.length;Q+=1){const $=Li(L,R,Q);F[Q]?F[Q].p($,O):(F[Q]=Fi($),F[Q].c(),F[Q].m(n,null))}for(;Q<F.length;Q+=1)F[Q].d(1);F.length=R.length}O&128&&!tt(k.src,z=L[7])&&p(k,"src",z),O&64&&Se(H,L[6]),L[8]?I?I.p(L,O):(I=Di(L),I.c(),I.m(d,null)):I&&(I.d(1),I=null),O&32&&!tt(C.src,T=L[5])&&p(C,"src",T),O&64&&p(C,"title",L[6])},i:ve,o:ve,d(L){L&&(W(e),W(m),W(b)),It(F,L),I&&I.d(),t[19](null),D=!1,ot(P)}}}function ho(t){try{const e=new URL(t).pathname.split("/");return decodeURIComponent(e.pop()||"")}catch{return decodeURIComponent(t.split("/").pop()||t)}}function _o(t,e,n){let{source:i}=e,{dtype:r}=e,{version:s}=e,{rowData:o=void 0}=e,l={};function a(c,u){const y=document.createElement("textarea");y.value=c,document.body.appendChild(y),y.select(),document.execCommand("copy"),document.body.removeChild(y),n(2,l[u]=!0,l),setTimeout(()=>n(2,l[u]=!1,l),1e3)}let f=ao.viewers.map(c=>{let u=c.href?c.href.includes("{URL}")?c.href.replace("{URL}",i):c.href+i:void 0;const y=Sn.replace("/vizarr_logo.png",c.logo);return{...c,href:u,logo_path:y}});s==="0.5"&&(f=f.filter(c=>c.name!=="itk-vtk-viewer"));let h,m="",b="",g="",d=Sn,k="";function z(c,u,y=Sn){m=c,n(5,b=c),n(6,g=u),n(7,d=y),n(8,k=(o==null?void 0:o.name)||ho(i)),h==null||h.showPopover()}function M(){h==null||h.hidePopover(),n(5,b="about:blank")}function j(){window.open(m,"_blank"),M()}const H=()=>a(i,"bigCopyButton"),G=()=>z(`https://ome.github.io/ome-ngff-validator/?source=${i}`,"NGFF Validator",kr),N=c=>z(c.href,c.name,c.logo_path),U=c=>a(i,c);function w(c){ct[c?"unshift":"push"](()=>{h=c,n(4,h)})}return t.$$set=c=>{"source"in c&&n(0,i=c.source),"dtype"in c&&n(1,r=c.dtype),"version"in c&&n(13,s=c.version),"rowData"in c&&n(14,o=c.rowData)},[i,r,l,f,h,b,g,d,k,a,z,M,j,s,o,H,G,N,U,w]}class mo extends Qe{constructor(e){super(),Ze(this,e,_o,fo,xe,{source:0,dtype:1,version:13,rowData:14})}}function Ni(t,e,n){const i=t.slice();return i[14]=e[n],i}function Bi(t){let e,n;return e=new wr({props:{source:t[4],attrs:t[3],max_size:2e3,thumbDatasetIndex:t[5],thumbAspectRatio:t[6]}}),{c(){Ye(e.$$.fragment)},m(i,r){Ke(e,i,r),n=!0},p(i,r){const s={};r&16&&(s.source=i[4]),r&8&&(s.attrs=i[3]),r&32&&(s.thumbDatasetIndex=i[5]),r&64&&(s.thumbAspectRatio=i[6]),e.$set(s)},i(i){n||(ue(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){Ge(e,i)}}}function Pi(t){let e=t[14].toUpperCase()+"",n,i,r=t[0][`size_${t[14]}`]+"",s,o;return{c(){n=Z(e),i=Z(":"),s=Z(r),o=Z("  ")},m(l,a){K(l,n,a),K(l,i,a),K(l,s,a),K(l,o,a)},p(l,a){a&1&&r!==(r=l[0][`size_${l[14]}`]+"")&&Se(s,r)},d(l){l&&(W(n),W(i),W(s),W(o))}}}function Ui(t){let e,n=t[0][`size_${t[14]}`]!==void 0&&Pi(t);return{c(){n&&n.c(),e=Xt()},m(i,r){n&&n.m(i,r),K(i,e,r)},p(i,r){i[0][`size_${i[14]}`]!==void 0?n?n.p(i,r):(n=Pi(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(i){i&&W(e),n&&n.d(i)}}}function go(t){let e,n,i=mn(t[0].written)+"",r;return{c(){e=E("div"),n=Z("Data size: "),r=Z(i)},m(s,o){K(s,e,o),_(e,n),_(e,r)},p(s,o){o&1&&i!==(i=mn(s[0].written)+"")&&Se(r,i)},d(s){s&&W(e)}}}function po(t){let e,n,i=t[0].shards+"",r;return{c(){e=E("div"),n=Z("Shard shape: "),r=Z(i)},m(s,o){K(s,e,o),_(e,n),_(e,r)},p(s,o){o&1&&i!==(i=s[0].shards+"")&&Se(r,i)},d(s){s&&W(e)}}}function bo(t){let e,n,i=t[0].chunks+"",r;return{c(){e=E("div"),n=Z("Chunk shape: "),r=Z(i)},m(s,o){K(s,e,o),_(e,n),_(e,r)},p(s,o){o&1&&i!==(i=s[0].chunks+"")&&Se(r,i)},d(s){s&&W(e)}}}function yo(t){let e,n,i,r,s,o,l=t[9](t[0].url)+"",a,f,h,m=(t[0].name?t[0].name.replaceAll(t[1],`<mark>${t[1]}</mark>`):"")+"",b,g,d,k=t[7].replaceAll(t[1],`<mark>${t[1]}</mark>`)+"",z,M,j,H,G,N,U,w,c,u=t[3]&&Bi(t);M=new mo({props:{source:t[0].url,dtype:vo,version:wo}});let y=Ne(["t","c","z","y","x"]),C=[];for(let R=0;R<5;R+=1)C[R]=Ui(Ni(t,y,R));function T(R,F){return R[2]=="chunk_pixels"?bo:R[2]=="shard_pixels"?po:go}let D=T(t),P=D(t);return{c(){e=E("div"),n=E("div"),u&&u.c(),i=q(),r=E("div"),s=E("div"),o=E("strong"),f=q(),h=E("div"),g=q(),d=E("div"),z=q(),Ye(M.$$.fragment),j=q(),H=E("div"),G=Z(`Image size:
      `);for(let R=0;R<5;R+=1)C[R].c();N=q(),P.c(),p(n,"class","thumbWrapper svelte-gffxyg"),p(s,"title",a=t[0].url),p(h,"class",b=ci(t[1]==""?"hideOnSmall":"")+" svelte-gffxyg"),p(e,"class","zarr-list-item svelte-gffxyg")},m(R,F){K(R,e,F),_(e,n),u&&u.m(n,null),_(e,i),_(e,r),_(r,s),_(s,o),o.innerHTML=l,_(r,f),_(r,h),h.innerHTML=m,_(r,g),_(r,d),d.innerHTML=k,_(r,z),Ke(M,r,null),_(r,j),_(r,H),_(H,G);for(let I=0;I<5;I+=1)C[I]&&C[I].m(H,null);_(r,N),P.m(r,null),U=!0,w||(c=ge(n,"click",t[8]),w=!0)},p(R,[F]){R[3]?u?(u.p(R,F),F&8&&ue(u,1)):(u=Bi(R),u.c(),ue(u,1),u.m(n,null)):u&&(en(),he(u,1,1,()=>{u=null}),tn()),(!U||F&1)&&l!==(l=R[9](R[0].url)+"")&&(o.innerHTML=l),(!U||F&1&&a!==(a=R[0].url))&&p(s,"title",a),(!U||F&3)&&m!==(m=(R[0].name?R[0].name.replaceAll(R[1],`<mark>${R[1]}</mark>`):"")+"")&&(h.innerHTML=m),(!U||F&2&&b!==(b=ci(R[1]==""?"hideOnSmall":"")+" svelte-gffxyg"))&&p(h,"class",b),(!U||F&130)&&k!==(k=R[7].replaceAll(R[1],`<mark>${R[1]}</mark>`)+"")&&(d.innerHTML=k);const I={};if(F&1&&(I.source=R[0].url),M.$set(I),F&1){y=Ne(["t","c","z","y","x"]);let L;for(L=0;L<5;L+=1){const O=Ni(R,y,L);C[L]?C[L].p(O,F):(C[L]=Ui(O),C[L].c(),C[L].m(H,null))}for(;L<5;L+=1)C[L].d(1)}D===(D=T(R))&&P?P.p(R,F):(P.d(1),P=D(R),P&&(P.c(),P.m(r,null)))},i(R){U||(ue(u),ue(M.$$.fragment,R),U=!0)},o(R){he(u),he(M.$$.fragment,R),U=!1},d(R){R&&W(e),u&&u.d(),Ge(M),It(C,R),P.d(),w=!1,c()}}}let vo="image",wo="0.5";function ko(t,e,n){let i,{rowData:r}=e,{textFilter:s}=e,{sortedBy:o=void 0}=e,l,a,f,h=1;const m=new AbortController;if(r.size_x&&r.size_y){let d=Math.max(r.size_x,r.size_y);for(f=0;d>256;)f+=1,d=d/2;h=r.size_x/r.size_y}function b(){console.log("Clicked on thumbnail"),He.setSelectedRow(r)}function g(d){if(s&&d.toLowerCase().includes(s.toLowerCase())){let z=d.toLowerCase(),M=s.toLowerCase(),j=z.indexOf(M),H=Math.max(0,Math.min(j,d.length-50)),G=d.substring(H,j);return G+="<mark>",G+=d.substring(j,j+M.length),G+="</mark>",G+=d.substring(j+M.length),G}return d.split("/").pop()}return $t(async()=>{let d=r.url;r.series0!==void 0&&(d+="/"+r.series0);let k=await Ut(d,m.signal);n(3,l=k[0]),n(4,a=k[1]),k[2]}),Vn(()=>{m.abort()}),t.$$set=d=>{"rowData"in d&&n(0,r=d.rowData),"textFilter"in d&&n(1,s=d.textFilter),"sortedBy"in d&&n(2,o=d.sortedBy)},t.$$.update=()=>{var d;t.$$.dirty&3&&n(7,i=s!=""&&((d=r.description)!=null&&d.toLowerCase().includes(s.toLowerCase()))?r.description:"")},[r,s,o,l,a,f,h,i,b,g]}class Eo extends Qe{constructor(e){super(),Ze(this,e,ko,yo,xe,{rowData:0,textFilter:1,sortedBy:2})}}function Co(t){let e,n,i,r;return n=new Eo({props:{rowData:t[0][t[13]],textFilter:t[1],sortedBy:t[2]}}),{c(){e=E("div"),Ye(n.$$.fragment),p(e,"slot","item"),p(e,"style",i=t[12]),p(e,"class","row svelte-1xlep2t")},m(s,o){K(s,e,o),Ke(n,e,null),r=!0},p(s,o){const l={};o&8193&&(l.rowData=s[0][s[13]]),o&2&&(l.textFilter=s[1]),o&4&&(l.sortedBy=s[2]),n.$set(l),(!r||o&4096&&i!==(i=s[12]))&&p(e,"style",i)},i(s){r||(ue(n.$$.fragment,s),r=!0)},o(s){he(n.$$.fragment,s),r=!1},d(s){s&&W(e),Ge(n)}}}function Io(t){let e=!1,n=()=>{e=!1},i,r,s,o=`${t[5]}px`,l,a,f;return at(t[8]),at(t[9]),s=new io({props:{width:"100%",height:t[5],itemCount:t[0].length,itemSize:160,getKey:t[6],$$slots:{item:[Co,({style:h,index:m})=>({12:h,13:m}),({style:h,index:m})=>(h?4096:0)|(m?8192:0)]},$$scope:{ctx:t}}}),s.$on("afterScroll",t[7]),{c(){r=E("div"),Ye(s.$$.fragment),p(r,"class","imageListContainer svelte-1xlep2t"),ae(r,"height",o)},m(h,m){K(h,r,m),Ke(s,r,null),t[10](r),l=!0,a||(f=[ge(window,"resize",t[8]),ge(window,"scroll",()=>{e=!0,clearTimeout(i),i=setTimeout(n,100),t[9]()})],a=!0)},p(h,[m]){m&16&&!e&&(e=!0,clearTimeout(i),scrollTo(window.pageXOffset,h[4]),i=setTimeout(n,100));const b={};m&32&&(b.height=h[5]),m&1&&(b.itemCount=h[0].length),m&28679&&(b.$$scope={dirty:m,ctx:h}),s.$set(b),m&32&&o!==(o=`${h[5]}px`)&&ae(r,"height",o)},i(h){l||(ue(s.$$.fragment,h),l=!0)},o(h){he(s.$$.fragment,h),l=!1},d(h){h&&W(r),Ge(s),t[10](null),a=!1,ot(f)}}}function Ao(t,e,n){let i,{tableRows:r}=e,{textFilter:s}=e,{sortedBy:o=void 0}=e;function l(k){return r[k].url}let a,f=0,h=0;function m(k){let M=a.offsetTop-20;k.detail.offset-h<0&&f>M&&n(4,f-=1),h=k.detail.offset}function b(){n(5,i=window.innerHeight)}function g(){n(4,f=window.pageYOffset)}function d(k){ct[k?"unshift":"push"](()=>{a=k,n(3,a)})}return t.$$set=k=>{"tableRows"in k&&n(0,r=k.tableRows),"textFilter"in k&&n(1,s=k.textFilter),"sortedBy"in k&&n(2,o=k.sortedBy)},n(5,i=0),[r,s,o,a,f,i,l,m,b,g,d]}class So extends Qe{constructor(e){super(),Ze(this,e,Ao,Io,xe,{tableRows:0,textFilter:1,sortedBy:2})}}function ji(t){let e,n;return e=new wr({props:{source:t[1],attrs:t[0],cssSize:512,max_size:2e3,thumbDatasetIndex:t[2],thumbAspectRatio:t[3]}}),{c(){Ye(e.$$.fragment)},m(i,r){Ke(e,i,r),n=!0},p(i,r){const s={};r&2&&(s.source=i[1]),r&1&&(s.attrs=i[0]),r&4&&(s.thumbDatasetIndex=i[2]),r&8&&(s.thumbAspectRatio=i[3]),e.$set(s)},i(i){n||(ue(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){Ge(e,i)}}}function zo(t){let e,n,i=t[0]&&ji(t);return{c(){i&&i.c(),e=Xt()},m(r,s){i&&i.m(r,s),K(r,e,s),n=!0},p(r,[s]){r[0]?i?(i.p(r,s),s&1&&ue(i,1)):(i=ji(r),i.c(),ue(i,1),i.m(e.parentNode,e)):i&&(en(),he(i,1,1,()=>{i=null}),tn())},i(r){n||(ue(i),n=!0)},o(r){he(i),n=!1},d(r){r&&W(e),i&&i.d(r)}}}function To(t,e,n){let{rowData:i}=e;console.log("ThumbLoader",i);let r,s,o,l=1;if(i.size_x&&i.size_y){let a=Math.max(i.size_x,i.size_y);for(o=0;a>1024;)o+=1,a=a/2;l=i.size_x/i.size_y}else o=void 0,l=1;return $t(async()=>{let a=await Ut(i.url);n(0,r=a[0]),n(1,s=a[1]),a[2]}),t.$$set=a=>{"rowData"in a&&n(4,i=a.rowData)},[r,s,o,l,i]}class Ro extends Qe{constructor(e){super(),Ze(this,e,To,zo,xe,{rowData:4})}}function xi(t,e,n){const i=t.slice();return i[5]=e[n][0],i[6]=e[n][1],i}function Vi(t){let e,n;return e=new Ro({props:{rowData:t[1]}}),{c(){Ye(e.$$.fragment)},m(i,r){Ke(e,i,r),n=!0},p(i,r){const s={};r&2&&(s.rowData=i[1]),e.$set(s)},i(i){n||(ue(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){Ge(e,i)}}}function Wi(t){let e,n,i=t[2]&&Vi(t);return{c(){i&&i.c(),e=Xt()},m(r,s){i&&i.m(r,s),K(r,e,s),n=!0},p(r,s){r[2]?i?(i.p(r,s),s&4&&ue(i,1)):(i=Vi(r),i.c(),ue(i,1),i.m(e.parentNode,e)):i&&(en(),he(i,1,1,()=>{i=null}),tn())},i(r){n||(ue(i),n=!0)},o(r){he(i),n=!1},d(r){r&&W(e),i&&i.d(r)}}}function Hi(t){let e,n=Ne(Object.entries(t[1])),i=[];for(let r=0;r<n.length;r+=1)i[r]=qi(xi(t,n,r));return{c(){e=E("table");for(let r=0;r<i.length;r+=1)i[r].c()},m(r,s){K(r,e,s);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(e,null)},p(r,s){if(s&2){n=Ne(Object.entries(r[1]));let o;for(o=0;o<n.length;o+=1){const l=xi(r,n,o);i[o]?i[o].p(l,s):(i[o]=qi(l),i[o].c(),i[o].m(e,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}},d(r){r&&W(e),It(i,r)}}}function qi(t){let e,n,i=t[5]+"",r,s,o=t[6]+"",l;return{c(){e=E("tr"),n=E("td"),r=Z(i),s=E("td"),l=Z(o)},m(a,f){K(a,e,f),_(e,n),_(n,r),_(e,s),_(s,l)},p(a,f){f&2&&i!==(i=a[5]+"")&&Se(r,i),f&2&&o!==(o=a[6]+"")&&Se(l,o)},d(a){a&&W(e)}}}function Oo(t){let e,n,i,r,s=t[2],o,l,a,f,h=Wi(t),m=t[1]&&Hi(t);return{c(){e=E("div"),n=E("button"),n.textContent="×",i=q(),r=E("div"),h.c(),o=q(),m&&m.c(),p(n,"class","close svelte-1g3sjso"),p(n,"title","Close"),p(r,"class","scrollable svelte-1g3sjso"),p(e,"id","mypopover"),p(e,"popover",""),p(e,"class","svelte-1g3sjso")},m(b,g){K(b,e,g),_(e,n),_(e,i),_(e,r),h.m(r,null),_(r,o),m&&m.m(r,null),t[4](e),l=!0,a||(f=ge(n,"click",t[3]),a=!0)},p(b,[g]){g&4&&xe(s,s=b[2])?(en(),he(h,1,1,ve),tn(),h=Wi(b),h.c(),ue(h,1),h.m(r,o)):h.p(b,g),b[1]?m?m.p(b,g):(m=Hi(b),m.c(),m.m(r,null)):m&&(m.d(1),m=null)},i(b){l||(ue(h),l=!0)},o(b){he(h),l=!1},d(b){b&&W(e),h.d(b),m&&m.d(),t[4](null),a=!1,f()}}}function Lo(t,e,n){let i,r,s;He.subscribeSelectedRow(a=>{console.log("Showing preview for",a),a&&(n(1,r=a),console.log("Showing Thumb preview for",a,r),n(2,s=r.url),i.showPopover())});function o(){i.hidePopover()}$t(()=>{console.log("Mounted popover",i),i&&i.addEventListener("toggle",a=>{a.newState==="open"||(console.log("Popover has been hidden"),He.setSelectedRow(null))})});function l(a){ct[a?"unshift":"push"](()=>{i=a,n(0,i)})}return[i,r,s,o,l]}class Mo extends Qe{constructor(e){super(),Ze(this,e,Lo,Oo,xe,{})}}const Fo="/zowser/selectCaret.svg",Do="/zowser/samples/sample_zarrs_hydrated.csv",No="/zowser/ome-main-nav.svg";function Bo(t){let e,n,i,r,s,o,l,a,f,h,m,b,g;return{c(){e=E("base"),n=q(),i=E("nav"),r=E("a"),s=E("img"),l=q(),a=E("a"),f=E("h2"),f.textContent="Zowser — an OME-Zarr browser",h=q(),m=E("div"),b=q(),g=E("a"),g.textContent="About",p(e,"href",t[0]),p(s,"alt","OME Logo"),tt(s.src,o=No)||p(s,"src",o),p(s,"class","svelte-1jru7l8"),p(r,"class","logolink svelte-1jru7l8"),p(r,"href",t[0]),p(f,"class","svelte-1jru7l8"),p(a,"href",t[0]),p(a,"class","svelte-1jru7l8"),ae(m,"flex","1"),p(g,"href","about/"),p(g,"class","svelte-1jru7l8"),p(i,"class","svelte-1jru7l8")},m(d,k){K(d,e,k),K(d,n,k),K(d,i,k),_(i,r),_(r,s),_(i,l),_(i,a),_(a,f),_(i,h),_(i,m),_(i,b),_(i,g)},p:ve,i:ve,o:ve,d(d){d&&(W(e),W(n),W(i))}}}function Po(t){let e="/zowser/";return console.log("Nav base",e),[e]}class Uo extends Qe{constructor(e){super(),Ze(this,e,Po,Bo,xe,{})}}function jo(t,e,n){const i=t.slice();return i[36]=e[n],i}function Ki(t,e,n){const i=t.slice();return i[39]=e[n],i}function Gi(t,e,n){const i=t.slice();return i[39]=e[n],i}function Ji(t,e,n){const i=t.slice();return i[36]=e[n],i}function Yi(t){let e,n=mn(t[8])+"",i,r,s,o,l;return{c(){e=Z("("),i=Z(n),r=Z(`) [Explore in
          `),s=E("a"),o=Z("BioFile Finder ↗"),l=Z("]"),p(s,"href",t[15]),p(s,"target","_blank"),p(s,"rel","noopener")},m(a,f){K(a,e,f),K(a,i,f),K(a,r,f),K(a,s,f),_(s,o),K(a,l,f)},p(a,f){f[0]&256&&n!==(n=mn(a[8])+"")&&Se(i,n),f[0]&32768&&p(s,"href",a[15])},d(a){a&&(W(e),W(i),W(r),W(s),W(l))}}}function Zi(t){let e,n=t[36]+"",i,r,s;return{c(){e=E("option"),i=Z(n),r=Z("D"),e.__value=s=t[36],Te(e,e.__value)},m(o,l){K(o,e,l),_(e,i),_(e,r)},p(o,l){l[0]&64&&n!==(n=o[36]+"")&&Se(i,n),l[0]&64&&s!==(s=o[36])&&(e.__value=s,Te(e,e.__value))},d(o){o&&W(e)}}}function Qi(t){let e=t[13].includes(t[36]),n,i=e&&Zi(t);return{c(){i&&i.c(),n=Xt()},m(r,s){i&&i.m(r,s),K(r,n,s)},p(r,s){s[0]&8256&&(e=r[13].includes(r[36])),e?i?i.p(r,s):(i=Zi(r),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(r){r&&W(n),i&&i.d(r)}}}function Xi(t){let e,n=t[39]+"",i,r;return{c(){e=E("option"),i=Z(n),e.__value=r=t[1][t[39]],Te(e,e.__value)},m(s,o){K(s,e,o),_(e,i)},p(s,o){o[0]&4098&&n!==(n=s[39]+"")&&Se(i,n),o[0]&4098&&r!==(r=s[1][s[39]])&&(e.__value=r,Te(e,e.__value))},d(s){s&&W(e)}}}function $i(t,e){let n,i=e[39]+"",r,s;return{key:t,first:null,c(){n=E("option"),r=Z(i),n.__value=s=e[2][e[39]],Te(n,n.__value),this.first=n},m(o,l){K(o,n,l),_(n,r)},p(o,l){e=o,l[0]&2052&&i!==(i=e[39]+"")&&Se(r,i),l[0]&2052&&s!==(s=e[2][e[39]])&&(n.__value=s,Te(n,n.__value))},d(o){o&&W(n)}}}function xo(t){let e;return{c(){e=E("option"),e.textContent=`Size: ${t[36].toUpperCase()}`,e.__value="size_"+t[36],Te(e,e.__value)},m(n,i){K(n,e,i)},p:ve,d(n){n&&W(e)}}}function Vo(t){let e,n,i,r,s,o,l,a,f=t[16].split("/").pop()+"",h,m,b,g,d,k,z,M,j,H,G,N,U,w,c,u,y,C=t[3]!==""?"All Dimensions":"Dimension Count",T,D,P,R,F,I,L,O,Q,$,v,V=t[4]==""?"Organism":"All Organisms",A,x,te,ne,X,B,J,ie,se,re,we=t[5]==""?"Imaging Modality":"All Modalities",de,ce,ye=[],Re=new Map,Ve,Be,ke,fe,pe,Xe,le,nt,Je,Pe,Ee,Oe,$e,Le,et,Ie,it,pt,sn,ft,ti,bt,rt,ni,on=t[0].length+"",yn,ii,vn,ri,si,ht,We,wn,oi;e=new Mo({});let Ue=t[15]&&Yi(t),yt=Ne(t[6]),Me=[];for(let S=0;S<yt.length;S+=1)Me[S]=Qi(Ji(t,yt,S));let vt=Ne(Object.keys(t[1]).sort().filter(t[30])),Fe=[];for(let S=0;S<vt.length;S+=1)Fe[S]=Xi(Gi(t,vt,S));let ln=Ne(Object.keys(t[2]).sort().filter(t[32]));const li=S=>S[39];for(let S=0;S<ln.length;S+=1){let ee=Ki(t,ln,S),_e=li(ee);Re.set(_e,ye[S]=$i(_e,ee))}let Cr=Ne(["x","y","z","c","t"]),Ot=[];for(let S=0;S<5;S+=1)Ot[S]=xo(jo(t,Cr,S));return ft=new Js({props:{toggleAscending:t[17],sortAscending:t[10]}}),ht=new So({props:{tableRows:t[0],textFilter:t[14],sortedBy:t[9]}}),{c(){Ye(e.$$.fragment),n=q(),i=E("main"),r=E("div"),s=E("h3"),o=E("div"),l=Z(`Showing Collection:
        `),a=E("a"),h=Z(f),m=q(),Ue&&Ue.c(),b=q(),g=E("div"),d=E("input"),k=q(),z=E("button"),M=Z("×"),j=q(),H=E("div"),G=E("div"),N=E("div"),U=E("div"),U.textContent="Filter by:",w=q(),c=E("div"),u=E("select"),y=E("option"),T=Z(C),D=q(),P=E("hr");for(let S=0;S<Me.length;S+=1)Me[S].c();R=q(),F=E("div"),I=E("button"),L=Z("×"),O=q(),Q=E("div"),$=E("select"),v=E("option"),A=Z(V),x=E("hr");for(let S=0;S<Fe.length;S+=1)Fe[S].c();te=q(),ne=E("div"),X=E("button"),B=Z("×"),J=q(),ie=E("div"),se=E("select"),re=E("option"),de=Z(we),ce=E("hr");for(let S=0;S<ye.length;S+=1)ye[S].c();Ve=q(),Be=E("div"),ke=E("button"),fe=Z("×"),pe=q(),Xe=E("div"),le=q(),nt=E("div"),nt.textContent="Sort by:",Je=q(),Pe=E("div"),Ee=E("select"),Oe=E("option"),Oe.textContent="--",$e=E("hr");for(let S=0;S<5;S+=1)Ot[S].c();Le=E("hr"),et=E("option"),et.textContent="Data Size (bytes)",Ie=E("option"),Ie.textContent="Chunk Size (pixels)",it=E("option"),it.textContent="Shard Size (pixels)",pt=q(),sn=E("div"),Ye(ft.$$.fragment),ti=q(),bt=E("div"),rt=E("h3"),ni=Z("Showing "),yn=Z(on),ii=Z(" out of "),vn=Z(t[7]),ri=Z(" images"),si=q(),Ye(ht.$$.fragment),p(a,"href",t[16]),ae(o,"font-size","90%"),ae(s,"text-align","center"),p(d,"placeholder","Filter by Name or Description"),p(d,"name","textFilter"),p(d,"class","svelte-cmksur"),p(z,"title","Clear Filter"),ae(z,"visibility",t[14]!==""?"visible":"hidden"),p(z,"class","svelte-cmksur"),p(g,"class","textInputWrapper svelte-cmksur"),p(r,"class","summary svelte-cmksur"),ae(U,"white-space","nowrap"),y.__value="",Te(y,y.__value),p(u,"class","svelte-cmksur"),t[3]===void 0&&at(()=>t[29].call(u)),p(I,"title","Clear Filter"),ae(I,"visibility",t[3]!==""?"visible":"hidden"),p(I,"class","svelte-cmksur"),p(F,"class","svelte-cmksur"),p(c,"class","selectWrapper svelte-cmksur"),v.__value="",Te(v,v.__value),p($,"class","svelte-cmksur"),t[4]===void 0&&at(()=>t[31].call($)),p(X,"title","Clear Filter"),ae(X,"visibility",t[4]!==""?"visible":"hidden"),p(X,"class","svelte-cmksur"),p(ne,"class","svelte-cmksur"),p(Q,"class","selectWrapper svelte-cmksur"),re.__value="",Te(re,re.__value),p(se,"class","svelte-cmksur"),t[5]===void 0&&at(()=>t[33].call(se)),p(ke,"title","Clear Filter"),ae(ke,"visibility",t[5]!==""?"visible":"hidden"),p(ke,"class","svelte-cmksur"),p(Be,"class","svelte-cmksur"),p(ie,"class","selectWrapper svelte-cmksur"),p(Xe,"class","clear"),Oe.__value="",Te(Oe,Oe.__value),et.__value="written",Te(et,et.__value),Ie.__value="chunk_pixels",Te(Ie,Ie.__value),it.__value="shard_pixels",Te(it,it.__value),p(Ee,"class","svelte-cmksur"),p(sn,"class","svelte-cmksur"),p(Pe,"class","selectWrapper svelte-cmksur"),p(N,"class","filters svelte-cmksur"),p(G,"class","sidebar svelte-cmksur"),ae(rt,"margin-left","15px"),p(rt,"class","svelte-cmksur"),p(bt,"class","results svelte-cmksur"),p(H,"class","sidebarContainer svelte-cmksur"),ae(i,"--form-select-bg-img","url('"+Fo+"')"),p(i,"class","svelte-cmksur")},m(S,ee){Ke(e,S,ee),K(S,n,ee),K(S,i,ee),_(i,r),_(r,s),_(s,o),_(o,l),_(o,a),_(a,h),_(o,m),Ue&&Ue.m(o,null),_(r,b),_(r,g),_(g,d),Te(d,t[14]),_(g,k),_(g,z),_(z,M),_(i,j),_(i,H),_(H,G),_(G,N),_(N,U),_(N,w),_(N,c),_(c,u),_(u,y),_(y,T),_(y,D),_(u,P);for(let _e=0;_e<Me.length;_e+=1)Me[_e]&&Me[_e].m(u,null);wt(u,t[3],!0),_(c,R),_(c,F),_(F,I),_(I,L),_(N,O),_(N,Q),_(Q,$),_($,v),_(v,A),_($,x);for(let _e=0;_e<Fe.length;_e+=1)Fe[_e]&&Fe[_e].m($,null);wt($,t[4],!0),_(Q,te),_(Q,ne),_(ne,X),_(X,B),_(N,J),_(N,ie),_(ie,se),_(se,re),_(re,de),_(se,ce);for(let _e=0;_e<ye.length;_e+=1)ye[_e]&&ye[_e].m(se,null);wt(se,t[5],!0),_(ie,Ve),_(ie,Be),_(Be,ke),_(ke,fe),_(N,pe),_(N,Xe),_(N,le),_(N,nt),_(N,Je),_(N,Pe),_(Pe,Ee),_(Ee,Oe),_(Ee,$e);for(let _e=0;_e<5;_e+=1)Ot[_e]&&Ot[_e].m(Ee,null);_(Ee,Le),_(Ee,et),_(Ee,Ie),_(Ee,it),_(Pe,pt),_(Pe,sn),Ke(ft,sn,null),_(H,ti),_(H,bt),_(bt,rt),_(rt,ni),_(rt,yn),_(rt,ii),_(rt,vn),_(rt,ri),_(bt,si),Ke(ht,bt,null),We=!0,wn||(oi=[ge(d,"input",t[28]),ge(d,"input",t[22]),ge(z,"click",t[22]),ge(u,"change",t[29]),ge(u,"change",t[19]),ge(I,"click",t[19]),ge($,"change",t[31]),ge($,"change",t[20]),ge(X,"click",t[20]),ge(se,"change",t[33]),ge(se,"change",t[21]),ge(ke,"click",t[21]),ge(Ee,"change",t[18])],wn=!0)},p(S,ee){if(S[15]?Ue?Ue.p(S,ee):(Ue=Yi(S),Ue.c(),Ue.m(o,null)):Ue&&(Ue.d(1),Ue=null),ee[0]&16384&&d.value!==S[14]&&Te(d,S[14]),(!We||ee[0]&16384)&&ae(z,"visibility",S[14]!==""?"visible":"hidden"),(!We||ee[0]&8)&&C!==(C=S[3]!==""?"All Dimensions":"Dimension Count")&&Se(T,C),ee[0]&8256){yt=Ne(S[6]);let me;for(me=0;me<yt.length;me+=1){const Lt=Ji(S,yt,me);Me[me]?Me[me].p(Lt,ee):(Me[me]=Qi(Lt),Me[me].c(),Me[me].m(u,null))}for(;me<Me.length;me+=1)Me[me].d(1);Me.length=yt.length}if(ee[0]&72&&wt(u,S[3]),(!We||ee[0]&8)&&ae(I,"visibility",S[3]!==""?"visible":"hidden"),(!We||ee[0]&16)&&V!==(V=S[4]==""?"Organism":"All Organisms")&&Se(A,V),ee[0]&4098){vt=Ne(Object.keys(S[1]).sort().filter(S[30]));let me;for(me=0;me<vt.length;me+=1){const Lt=Gi(S,vt,me);Fe[me]?Fe[me].p(Lt,ee):(Fe[me]=Xi(Lt),Fe[me].c(),Fe[me].m($,null))}for(;me<Fe.length;me+=1)Fe[me].d(1);Fe.length=vt.length}ee[0]&4114&&wt($,S[4]),(!We||ee[0]&16)&&ae(X,"visibility",S[4]!==""?"visible":"hidden"),(!We||ee[0]&32)&&we!==(we=S[5]==""?"Imaging Modality":"All Modalities")&&Se(de,we),ee[0]&2052&&(ln=Ne(Object.keys(S[2]).sort().filter(S[32])),ye=ar(ye,ee,li,1,S,ln,Re,se,Nr,$i,null,Ki)),ee[0]&2084&&wt(se,S[5]),(!We||ee[0]&32)&&ae(ke,"visibility",S[5]!==""?"visible":"hidden");const _e={};ee[0]&1024&&(_e.sortAscending=S[10]),ft.$set(_e),(!We||ee[0]&1)&&on!==(on=S[0].length+"")&&Se(yn,on),(!We||ee[0]&128)&&Se(vn,S[7]);const an={};ee[0]&1&&(an.tableRows=S[0]),ee[0]&16384&&(an.textFilter=S[14]),ee[0]&512&&(an.sortedBy=S[9]),ht.$set(an)},i(S){We||(ue(e.$$.fragment,S),ue(ft.$$.fragment,S),ue(ht.$$.fragment,S),We=!0)},o(S){he(e.$$.fragment,S),he(ft.$$.fragment,S),he(ht.$$.fragment,S),We=!1},d(S){S&&(W(n),W(i)),Ge(e,S),Ue&&Ue.d(),It(Me,S),It(Fe,S);for(let ee=0;ee<ye.length;ee+=1)ye[ee].d();It(Ot,S),Ge(ft),Ge(ht),wn=!1,ot(oi)}}}function Wo(t){try{const e=new URL(t);return e.protocol="https:",e.toString()}catch{return t.replace(/^http:/,"https:")}}function Ho(t,e,n){let i,r,s,o,l,a,f,h,m,b,g,d,k,z=Do,M=[],j=[],H=0,G=0,N={},U={};He.subscribe(v=>{n(23,M=v),n(0,j=C(v)),n(7,H=v.length),n(8,G=v.reduce((V,A)=>V+parseInt(A.written)||0,0))}),dr.subscribe(v=>{let V={};for(const[A,x]of Object.entries(v))V[x]=A;n(1,N=V)}),_r.subscribe(v=>{let V={};for(const[A,x]of Object.entries(v))V[x]=A;n(2,U=V)}),fr(z,He);let w="",c=!1;function u(){n(10,c=!c),He.sortTable(w,c)}function y(v){n(9,w=v.target.value),w===""?He.sortTable("index",!0):He.sortTable(w,c)}function C(v){if(i!==""&&(v=v.filter(V=>V.dim_count==i)),r!==""&&(v=v.filter(V=>V.organismId==r)),s!=""&&(v=v.filter(V=>V.fbbiId==s)),o&&o!=""){let V=o.toLowerCase();v=v.filter(A=>{var x,te;return A.url.toLowerCase().includes(V)||((x=A.description)==null?void 0:x.toLowerCase().includes(V))||((te=A.name)==null?void 0:te.toLowerCase().includes(V))})}return v}function T(v){n(3,i=v.target.value||""),n(0,j=C(He.getRows()))}function D(v){n(4,r=v.target.value||""),n(0,j=C(He.getRows()))}function P(v){n(5,s=v.target.value||""),n(0,j=C(He.getRows()))}function R(v){n(14,o=v.target.value),n(0,j=C(He.getRows()))}function F(){o=this.value,n(14,o)}function I(){i=Cn(this),n(3,i),n(6,b),n(24,m)}const L=v=>d.includes(N[v]);function O(){r=Cn(this),n(4,r),n(1,N),n(12,d),n(24,m),n(1,N),n(5,s),n(3,i)}const Q=v=>k.includes(U[v]);function $(){s=Cn(this),n(5,s),n(2,U),n(11,k),n(24,m),n(2,U),n(4,r),n(3,i)}return t.$$.update=()=>{t.$$.dirty[0]&8388608&&n(27,l=M.length?Object.keys(M[0]):[]),t.$$.dirty[0]&134217728&&n(26,a=encodeURIComponent(l.join(","))),t.$$.dirty[0]&234881024&&n(15,h=l.length?`https://bff.allencell.org/app?c=${a}&source=${encodeURIComponent(JSON.stringify(f))}`:null),t.$$.dirty[0]&1&&j.some(v=>v.source),t.$$.dirty[0]&16777216&&n(6,b=Array.from(new Set(m.map(v=>String(v.dim_count)).filter(Boolean))).sort()),t.$$.dirty[0]&16777328&&n(13,g=m.length===0?b:Array.from(new Set(m.filter(v=>(r?v.organismId===r:!0)&&(s?v.fbbiId===s:!0)).map(v=>String(v.dim_count)).filter(Boolean))).sort()),t.$$.dirty[0]&16777258&&n(12,d=m.length===0?Object.values(N):Array.from(new Set(m.filter(v=>(s?v.fbbiId===s:!0)&&(i?String(v.dim_count)===i:!0)).map(v=>v.organismId).filter(Boolean)))),t.$$.dirty[0]&16777244&&n(11,k=m.length===0?Object.values(U):Array.from(new Set(m.filter(v=>(r?v.organismId===r:!0)&&(i?String(v.dim_count)===i:!0)).map(v=>v.fbbiId).filter(Boolean))))},n(3,i=""),n(4,r=""),n(5,s=""),n(14,o=""),n(25,f={name:(z==null?void 0:z.split("/").pop())||"data.csv",type:"csv",uri:Wo(z)}),n(24,m=He.getRows()),[j,N,U,i,r,s,b,H,G,w,c,k,d,g,o,h,z,u,y,T,D,P,R,M,m,f,a,l,F,I,L,O,Q,$]}class qo extends Qe{constructor(e){super(),Ze(this,e,Ho,Vo,xe,{},null,[-1,-1])}}const Ko="/zowser/nfdi_rgb_Wortmarke_Zusatz_quer.png",Go="/zowser/czi-logo-chan-zuckerberg-initiative-logo.png";function Jo(t){let e,n,i;return{c(){e=E("base"),n=q(),i=E("div"),i.innerHTML=`<h2>Introduction</h2> <p>Zowser is an OME-Zarr browser based on the <a href="https://forum.image.sc/t/ome2024-ngff-challenge/97363">2024 OME-NGFF Challenge</a>, conceived at the
    <a href="https://www.openmicroscopy.org/events/ome-community-meeting-2024/">OME Annual Community Meeting</a>
    in Dundee in May 2024.</p> <h2>Acknowledgements</h2> <p>Coordination of the challenge was supported by the <a href="https://www.nfdi.de/">German National Research Data Initiative (NFDI)</a>
    and the
    <a href="https://chanzuckerberg.com/">Chan Zuckerberg Initiative</a>:</p> <table><tr><td><img src="${Ko}" alt="NFDI Logo" width="45%"/></td> <td><img src="${Go}" alt="Chan Zuckerberg Initiative Logo" width="45%"/></td></tr></table>`,p(e,"href",t[0]),p(i,"class","svelte-zlrnwt")},m(r,s){K(r,e,s),K(r,n,s),K(r,i,s)},p:ve,i:ve,o:ve,d(r){r&&(W(e),W(n),W(i))}}}function Yo(t){return["/zowser/"]}class Zo extends Qe{constructor(e){super(),Ze(this,e,Yo,Jo,xe,{})}}function Qo(t){let e,n;return e=new qo({}),{c(){Ye(e.$$.fragment)},m(i,r){Ke(e,i,r),n=!0},i(i){n||(ue(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){Ge(e,i)}}}function Xo(t){let e,n;return e=new Zo({}),{c(){Ye(e.$$.fragment)},m(i,r){Ke(e,i,r),n=!0},i(i){n||(ue(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){Ge(e,i)}}}function $o(t){let e,n,i,r,s,o;n=new Uo({});const l=[Xo,Qo],a=[];function f(h,m){return h[0].endsWith("/about/")?0:1}return r=f(t),s=a[r]=l[r](t),{c(){e=E("div"),Ye(n.$$.fragment),i=q(),s.c(),p(e,"class","app svelte-1mc4mod")},m(h,m){K(h,e,m),Ke(n,e,null),_(e,i),a[r].m(e,null),o=!0},p:ve,i(h){o||(ue(n.$$.fragment,h),ue(s),o=!0)},o(h){he(n.$$.fragment,h),he(s),o=!1},d(h){h&&W(e),Ge(n),a[r].d()}}}function el(t){return[window.location.pathname]}class tl extends Qe{constructor(e){super(),Ze(this,e,el,$o,xe,{})}}new tl({target:document.getElementById("app")});
