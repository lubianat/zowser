const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/blosc-E49GQuAK.js","assets/chunk-INHXZS53-D3tQiqtZ.js","assets/gzip-CF-9a_hd.js","assets/browser-B-ZyVB-j.js","assets/lz4-BIGKWw27.js","assets/zlib-CBiqHlio.js","assets/zstd-IvP746pw.js"])))=>i.map(i=>d[i]);
var wr=Object.defineProperty;var ci=t=>{throw TypeError(t)};var kr=(t,e,n)=>e in t?wr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var te=(t,e,n)=>kr(t,typeof e!="symbol"?e+"":e,n),wn=(t,e,n)=>e.has(t)||ci("Cannot "+n);var q=(t,e,n)=>(wn(t,e,"read from private field"),n?n.call(t):e.get(t)),ve=(t,e,n)=>e.has(t)?ci("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),_e=(t,e,n,i)=>(wn(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),kn=(t,e,n)=>(wn(t,e,"access private method"),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function pe(){}function Er(t,e){for(const n in e)t[n]=e[n];return t}function er(t){return t()}function fi(){return Object.create(null)}function lt(t){t.forEach(er)}function tr(t){return typeof t=="function"}function Be(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let ln;function rt(t,e){return t===e?!0:(ln||(ln=document.createElement("a")),ln.href=e,t===ln.href)}function Cr(t){return Object.keys(t).length===0}function Ar(t,...e){if(t==null){for(const i of e)i(void 0);return pe}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function un(t){let e;return Ar(t,n=>e=n)(),e}function In(t,e,n,i){if(t){const r=nr(t,e,n,i);return t[0](r)}}function nr(t,e,n,i){return t[1]&&i?Er(n.ctx.slice(),t[1](i(e))):n.ctx}function Sn(t,e,n,i){if(t[2]&&i){const r=t[2](i(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],o=Math.max(e.dirty.length,r.length);for(let l=0;l<o;l+=1)s[l]=e.dirty[l]|r[l];return s}return e.dirty|r}return e.dirty}function zn(t,e,n,i,r,s){if(r){const o=nr(e,n,i,s);t.p(o,r)}}function Tn(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let i=0;i<n;i++)e[i]=-1;return e}return-1}function hi(t){return t??""}function g(t,e){t.appendChild(e)}function G(t,e,n){t.insertBefore(e,n||null)}function K(t){t.parentNode&&t.parentNode.removeChild(t)}function Dt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function E(t){return document.createElement(t)}function X(t){return document.createTextNode(t)}function H(){return X(" ")}function mn(){return X("")}function we(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function y(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Ir(t){return Array.from(t.childNodes)}function Ne(t,e){e=""+e,t.data!==e&&(t.data=e)}function Ae(t,e){t.value=e??""}function se(t,e,n,i){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}function wt(t,e,n){for(let i=0;i<t.options.length;i+=1){const r=t.options[i];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function En(t){const e=t.querySelector(":checked");return e&&e.__value}function Pe(t,e,n){t.classList.toggle(e,!!n)}function Sr(t,e,{bubbles:n=!1,cancelable:i=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:i})}let Nt;function Ft(t){Nt=t}function Un(){if(!Nt)throw new Error("Function called outside component initialization");return Nt}function Qt(t){Un().$$.on_mount.push(t)}function xn(t){Un().$$.on_destroy.push(t)}function zr(){const t=Un();return(e,n,{cancelable:i=!1}={})=>{const r=t.$$.callbacks[e];if(r){const s=Sr(e,n,{cancelable:i});return r.slice().forEach(o=>{o.call(t,s)}),!s.defaultPrevented}return!0}}const Ct=[],_t=[];let At=[];const di=[],ir=Promise.resolve();let Rn=!1;function rr(){Rn||(Rn=!0,ir.then(Le))}function Tr(){return rr(),ir}function st(t){At.push(t)}const Cn=new Set;let kt=0;function Le(){if(kt!==0)return;const t=Nt;do{try{for(;kt<Ct.length;){const e=Ct[kt];kt++,Ft(e),Rr(e.$$)}}catch(e){throw Ct.length=0,kt=0,e}for(Ft(null),Ct.length=0,kt=0;_t.length;)_t.pop()();for(let e=0;e<At.length;e+=1){const n=At[e];Cn.has(n)||(Cn.add(n),n())}At.length=0}while(Ct.length);for(;di.length;)di.pop()();Rn=!1,Cn.clear(),Ft(t)}function Rr(t){if(t.fragment!==null){t.update(),lt(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(st)}}function Or(t){const e=[],n=[];At.forEach(i=>t.indexOf(i)===-1?e.push(i):n.push(i)),n.forEach(i=>i()),At=e}const cn=new Set;let ft;function Xt(){ft={r:0,c:[],p:ft}}function $t(){ft.r||lt(ft.c),ft=ft.p}function oe(t,e){t&&t.i&&(cn.delete(t),t.i(e))}function ce(t,e,n,i){if(t&&t.o){if(cn.has(t))return;cn.add(t),ft.c.push(()=>{cn.delete(t),i&&(n&&t.d(1),i())}),t.o(e)}else i&&i()}function xe(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Lr(t,e){t.d(1),e.delete(t.key)}function Mr(t,e){ce(t,1,1,()=>{e.delete(t.key)})}function sr(t,e,n,i,r,s,o,l,a,h,f,_){let b=t.length,p=s.length,d=b;const v={};for(;d--;)v[t[d].key]=d;const A=[],I=new Map,F=new Map,P=[];for(d=p;d--;){const w=_(r,s,d),c=n(w);let u=o.get(c);u?P.push(()=>u.p(w,e)):(u=h(c,w),u.c()),I.set(c,A[d]=u),c in v&&F.set(c,Math.abs(d-v[c]))}const J=new Set,$=new Set;function V(w){oe(w,1),w.m(l,f),o.set(w.key,w),f=w.first,p--}for(;b&&p;){const w=A[p-1],c=t[b-1],u=w.key,m=c.key;w===c?(f=w.first,b--,p--):I.has(m)?!o.has(u)||J.has(u)?V(w):$.has(m)?b--:F.get(u)>F.get(m)?($.add(u),V(w)):(J.add(m),b--):(a(c,o),b--)}for(;b--;){const w=t[b];I.has(w.key)||a(w,o)}for(;p;)V(A[p-1]);return lt(P),A}function Ke(t){t&&t.c()}function je(t,e,n){const{fragment:i,after_update:r}=t.$$;i&&i.m(e,n),st(()=>{const s=t.$$.on_mount.map(er).filter(tr);t.$$.on_destroy?t.$$.on_destroy.push(...s):lt(s),t.$$.on_mount=[]}),r.forEach(st)}function Ve(t,e){const n=t.$$;n.fragment!==null&&(Or(n.after_update),lt(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Fr(t,e){t.$$.dirty[0]===-1&&(Ct.push(t),rr(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Ge(t,e,n,i,r,s,o=null,l=[-1]){const a=Nt;Ft(t);const h=t.$$={fragment:null,ctx:[],props:s,update:pe,not_equal:r,bound:fi(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:fi(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(h.root);let f=!1;if(h.ctx=n?n(t,e.props||{},(_,b,...p)=>{const d=p.length?p[0]:b;return h.ctx&&r(h.ctx[_],h.ctx[_]=d)&&(!h.skip_bound&&h.bound[_]&&h.bound[_](d),f&&Fr(t,_)),b}):[],h.update(),f=!0,lt(h.before_update),h.fragment=i?i(h.ctx):!1,e.target){if(e.hydrate){const _=Ir(e.target);h.fragment&&h.fragment.l(_),_.forEach(K)}else h.fragment&&h.fragment.c();e.intro&&oe(t.$$.fragment),je(t,e.target,e.anchor),Le()}Ft(a)}class Je{constructor(){te(this,"$$");te(this,"$$set")}$destroy(){Ve(this,1),this.$destroy=pe}$on(e,n){if(!tr(n))return pe;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(e){this.$$set&&!Cr(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Dr="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Dr);const Et=[];function On(t,e=pe){let n;const i=new Set;function r(l){if(Be(t,l)&&(t=l,n)){const a=!Et.length;for(const h of i)h[1](),Et.push(h,t);if(a){for(let h=0;h<Et.length;h+=2)Et[h][0](Et[h+1]);Et.length=0}}}function s(l){r(l(t))}function o(l,a=pe){const h=[l,a];return i.add(h),i.size===1&&(n=e(r,s)||pe),l(t),()=>{i.delete(h),i.size===0&&n&&(n(),n=null)}}return{set:r,update:s,subscribe:o}}var Nr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var or={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){(function(n,i){t.exports=i()})(Nr,function n(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},r=!i.document&&!!i.postMessage,s=i.IS_PAPA_WORKER||!1,o={},l=0,a={parse:function(c,u){var m=(u=u||{}).dynamicTyping||!1;if(w(m)&&(u.dynamicTypingFunction=m,m={}),u.dynamicTyping=m,u.transform=!!w(u.transform)&&u.transform,u.worker&&a.WORKERS_SUPPORTED){var k=function(){if(!a.WORKERS_SUPPORTED)return!1;var L=(O=i.URL||i.webkitURL||null,j=n.toString(),a.BLOB_URL||(a.BLOB_URL=O.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",j,")();"],{type:"text/javascript"})))),N=new i.Worker(L),O,j;return N.onmessage=F,N.id=l++,o[N.id]=N}();return k.userStep=u.step,k.userChunk=u.chunk,k.userComplete=u.complete,k.userError=u.error,u.step=w(u.step),u.chunk=w(u.chunk),u.complete=w(u.complete),u.error=w(u.error),delete u.worker,void k.postMessage({input:c,config:u,workerId:k.id})}var C=null;return a.NODE_STREAM_INPUT,typeof c=="string"?(c=function(L){return L.charCodeAt(0)===65279?L.slice(1):L}(c),C=u.download?new _(u):new p(u)):c.readable===!0&&w(c.read)&&w(c.on)?C=new d(u):(i.File&&c instanceof File||c instanceof Object)&&(C=new b(u)),C.stream(c)},unparse:function(c,u){var m=!1,k=!0,C=",",L=`\r
`,N='"',O=N+N,j=!1,z=null,B=!1;(function(){if(typeof u=="object"){if(typeof u.delimiter!="string"||a.BAD_DELIMITERS.filter(function(R){return u.delimiter.indexOf(R)!==-1}).length||(C=u.delimiter),(typeof u.quotes=="boolean"||typeof u.quotes=="function"||Array.isArray(u.quotes))&&(m=u.quotes),typeof u.skipEmptyLines!="boolean"&&typeof u.skipEmptyLines!="string"||(j=u.skipEmptyLines),typeof u.newline=="string"&&(L=u.newline),typeof u.quoteChar=="string"&&(N=u.quoteChar),typeof u.header=="boolean"&&(k=u.header),Array.isArray(u.columns)){if(u.columns.length===0)throw new Error("Option columns is empty");z=u.columns}u.escapeChar!==void 0&&(O=u.escapeChar+N),(typeof u.escapeFormulae=="boolean"||u.escapeFormulae instanceof RegExp)&&(B=u.escapeFormulae instanceof RegExp?u.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var M=new RegExp(A(N),"g");if(typeof c=="string"&&(c=JSON.parse(c)),Array.isArray(c)){if(!c.length||Array.isArray(c[0]))return be(null,c,j);if(typeof c[0]=="object")return be(z||Object.keys(c[0]),c,j)}else if(typeof c=="object")return typeof c.data=="string"&&(c.data=JSON.parse(c.data)),Array.isArray(c.data)&&(c.fields||(c.fields=c.meta&&c.meta.fields||z),c.fields||(c.fields=Array.isArray(c.data[0])?c.fields:typeof c.data[0]=="object"?Object.keys(c.data[0]):[]),Array.isArray(c.data[0])||typeof c.data[0]=="object"||(c.data=[c.data])),be(c.fields||[],c.data||[],j);throw new Error("Unable to serialize unrecognized input");function be(R,Z,S){var U="";typeof R=="string"&&(R=JSON.parse(R)),typeof Z=="string"&&(Z=JSON.parse(Z));var Q=Array.isArray(R)&&0<R.length,W=!Array.isArray(Z[0]);if(Q&&k){for(var Y=0;Y<R.length;Y++)0<Y&&(U+=C),U+=ge(R[Y],Y);0<Z.length&&(U+=L)}for(var D=0;D<Z.length;D++){var x=Q?R.length:Z[D].length,le=!1,me=Q?Object.keys(Z[D]).length===0:Z[D].length===0;if(S&&!Q&&(le=S==="greedy"?Z[D].join("").trim()==="":Z[D].length===1&&Z[D][0].length===0),S==="greedy"&&Q){for(var ne=[],fe=0;fe<x;fe++){var de=W?R[fe]:fe;ne.push(Z[D][de])}le=ne.join("").trim()===""}if(!le){for(var ae=0;ae<x;ae++){0<ae&&!me&&(U+=C);var Ee=Q&&W?R[ae]:ae;U+=ge(Z[D][Ee],ae)}D<Z.length-1&&(!S||0<x&&!me)&&(U+=L)}}return U}function ge(R,Z){if(R==null)return"";if(R.constructor===Date)return JSON.stringify(R).slice(1,25);var S=!1;B&&typeof R=="string"&&B.test(R)&&(R="'"+R,S=!0);var U=R.toString().replace(M,O);return(S=S||m===!0||typeof m=="function"&&m(R,Z)||Array.isArray(m)&&m[Z]||function(Q,W){for(var Y=0;Y<W.length;Y++)if(-1<Q.indexOf(W[Y]))return!0;return!1}(U,a.BAD_DELIMITERS)||-1<U.indexOf(C)||U.charAt(0)===" "||U.charAt(U.length-1)===" ")?N+U+N:U}}};if(a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!r&&!!i.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=I,a.ParserHandle=v,a.NetworkStreamer=_,a.FileStreamer=b,a.StringStreamer=p,a.ReadableStreamStreamer=d,i.jQuery){var h=i.jQuery;h.fn.parse=function(c){var u=c.config||{},m=[];return this.each(function(L){if(!(h(this).prop("tagName").toUpperCase()==="INPUT"&&h(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var N=0;N<this.files.length;N++)m.push({file:this.files[N],inputElem:this,instanceConfig:h.extend({},u)})}),k(),this;function k(){if(m.length!==0){var L,N,O,j,z=m[0];if(w(c.before)){var B=c.before(z.file,z.inputElem);if(typeof B=="object"){if(B.action==="abort")return L="AbortError",N=z.file,O=z.inputElem,j=B.reason,void(w(c.error)&&c.error({name:L},N,O,j));if(B.action==="skip")return void C();typeof B.config=="object"&&(z.instanceConfig=h.extend(z.instanceConfig,B.config))}else if(B==="skip")return void C()}var M=z.instanceConfig.complete;z.instanceConfig.complete=function(be){w(M)&&M(be,z.file,z.inputElem),C()},a.parse(z.file,z.instanceConfig)}else w(c.complete)&&c.complete()}function C(){m.splice(0,1),k()}}}function f(c){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(u){var m=$(u);m.chunkSize=parseInt(m.chunkSize),u.step||u.chunk||(m.chunkSize=null),this._handle=new v(m),(this._handle.streamer=this)._config=m}).call(this,c),this.parseChunk=function(u,m){if(this.isFirstChunk&&w(this._config.beforeFirstChunk)){var k=this._config.beforeFirstChunk(u);k!==void 0&&(u=k)}this.isFirstChunk=!1,this._halted=!1;var C=this._partialLine+u;this._partialLine="";var L=this._handle.parse(C,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var N=L.meta.cursor;this._finished||(this._partialLine=C.substring(N-this._baseIndex),this._baseIndex=N),L&&L.data&&(this._rowCount+=L.data.length);var O=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)i.postMessage({results:L,workerId:a.WORKER_ID,finished:O});else if(w(this._config.chunk)&&!m){if(this._config.chunk(L,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);L=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(L.data),this._completeResults.errors=this._completeResults.errors.concat(L.errors),this._completeResults.meta=L.meta),this._completed||!O||!w(this._config.complete)||L&&L.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),O||L&&L.meta.paused||this._nextChunk(),L}this._halted=!0},this._sendError=function(u){w(this._config.error)?this._config.error(u):s&&this._config.error&&i.postMessage({workerId:a.WORKER_ID,error:u,finished:!1})}}function _(c){var u;(c=c||{}).chunkSize||(c.chunkSize=a.RemoteChunkSize),f.call(this,c),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(m){this._input=m,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(u=new XMLHttpRequest,this._config.withCredentials&&(u.withCredentials=this._config.withCredentials),r||(u.onload=V(this._chunkLoaded,this),u.onerror=V(this._chunkError,this)),u.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var m=this._config.downloadRequestHeaders;for(var k in m)u.setRequestHeader(k,m[k])}if(this._config.chunkSize){var C=this._start+this._config.chunkSize-1;u.setRequestHeader("Range","bytes="+this._start+"-"+C)}try{u.send(this._config.downloadRequestBody)}catch(L){this._chunkError(L.message)}r&&u.status===0&&this._chunkError()}},this._chunkLoaded=function(){u.readyState===4&&(u.status<200||400<=u.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:u.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(m){var k=m.getResponseHeader("Content-Range");return k===null?-1:parseInt(k.substring(k.lastIndexOf("/")+1))}(u),this.parseChunk(u.responseText)))},this._chunkError=function(m){var k=u.statusText||m;this._sendError(new Error(k))}}function b(c){var u,m;(c=c||{}).chunkSize||(c.chunkSize=a.LocalChunkSize),f.call(this,c);var k=typeof FileReader<"u";this.stream=function(C){this._input=C,m=C.slice||C.webkitSlice||C.mozSlice,k?((u=new FileReader).onload=V(this._chunkLoaded,this),u.onerror=V(this._chunkError,this)):u=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var C=this._input;if(this._config.chunkSize){var L=Math.min(this._start+this._config.chunkSize,this._input.size);C=m.call(C,this._start,L)}var N=u.readAsText(C,this._config.encoding);k||this._chunkLoaded({target:{result:N}})},this._chunkLoaded=function(C){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(C.target.result)},this._chunkError=function(){this._sendError(u.error)}}function p(c){var u;f.call(this,c=c||{}),this.stream=function(m){return u=m,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var m,k=this._config.chunkSize;return k?(m=u.substring(0,k),u=u.substring(k)):(m=u,u=""),this._finished=!u,this.parseChunk(m)}}}function d(c){f.call(this,c=c||{});var u=[],m=!0,k=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(C){this._input=C,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){k&&u.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),u.length?this.parseChunk(u.shift()):m=!0},this._streamData=V(function(C){try{u.push(typeof C=="string"?C:C.toString(this._config.encoding)),m&&(m=!1,this._checkIsFinished(),this.parseChunk(u.shift()))}catch(L){this._streamError(L)}},this),this._streamError=V(function(C){this._streamCleanUp(),this._sendError(C)},this),this._streamEnd=V(function(){this._streamCleanUp(),k=!0,this._streamData("")},this),this._streamCleanUp=V(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function v(c){var u,m,k,C=Math.pow(2,53),L=-C,N=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,O=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,j=this,z=0,B=0,M=!1,be=!1,ge=[],R={data:[],errors:[],meta:{}};if(w(c.step)){var Z=c.step;c.step=function(D){if(R=D,Q())U();else{if(U(),R.data.length===0)return;z+=D.data.length,c.preview&&z>c.preview?m.abort():(R.data=R.data[0],Z(R,j))}}}function S(D){return c.skipEmptyLines==="greedy"?D.join("").trim()==="":D.length===1&&D[0].length===0}function U(){return R&&k&&(Y("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),k=!1),c.skipEmptyLines&&(R.data=R.data.filter(function(D){return!S(D)})),Q()&&function(){if(!R)return;function D(le,me){w(c.transformHeader)&&(le=c.transformHeader(le,me)),ge.push(le)}if(Array.isArray(R.data[0])){for(var x=0;Q()&&x<R.data.length;x++)R.data[x].forEach(D);R.data.splice(0,1)}else R.data.forEach(D)}(),function(){if(!R||!c.header&&!c.dynamicTyping&&!c.transform)return R;function D(le,me){var ne,fe=c.header?{}:[];for(ne=0;ne<le.length;ne++){var de=ne,ae=le[ne];c.header&&(de=ne>=ge.length?"__parsed_extra":ge[ne]),c.transform&&(ae=c.transform(ae,de)),ae=W(de,ae),de==="__parsed_extra"?(fe[de]=fe[de]||[],fe[de].push(ae)):fe[de]=ae}return c.header&&(ne>ge.length?Y("FieldMismatch","TooManyFields","Too many fields: expected "+ge.length+" fields but parsed "+ne,B+me):ne<ge.length&&Y("FieldMismatch","TooFewFields","Too few fields: expected "+ge.length+" fields but parsed "+ne,B+me)),fe}var x=1;return!R.data.length||Array.isArray(R.data[0])?(R.data=R.data.map(D),x=R.data.length):R.data=D(R.data,0),c.header&&R.meta&&(R.meta.fields=ge),B+=x,R}()}function Q(){return c.header&&ge.length===0}function W(D,x){return le=D,c.dynamicTypingFunction&&c.dynamicTyping[le]===void 0&&(c.dynamicTyping[le]=c.dynamicTypingFunction(le)),(c.dynamicTyping[le]||c.dynamicTyping)===!0?x==="true"||x==="TRUE"||x!=="false"&&x!=="FALSE"&&(function(me){if(N.test(me)){var ne=parseFloat(me);if(L<ne&&ne<C)return!0}return!1}(x)?parseFloat(x):O.test(x)?new Date(x):x===""?null:x):x;var le}function Y(D,x,le,me){var ne={type:D,code:x,message:le};me!==void 0&&(ne.row=me),R.errors.push(ne)}this.parse=function(D,x,le){var me=c.quoteChar||'"';if(c.newline||(c.newline=function(de,ae){de=de.substring(0,1048576);var Ee=new RegExp(A(ae)+"([^]*?)"+A(ae),"gm"),he=(de=de.replace(Ee,"")).split("\r"),Se=de.split(`
`),Me=1<Se.length&&Se[0].length<he[0].length;if(he.length===1||Me)return`
`;for(var ze=0,ue=0;ue<he.length;ue++)he[ue][0]===`
`&&ze++;return ze>=he.length/2?`\r
`:"\r"}(D,me)),k=!1,c.delimiter)w(c.delimiter)&&(c.delimiter=c.delimiter(D),R.meta.delimiter=c.delimiter);else{var ne=function(de,ae,Ee,he,Se){var Me,ze,ue,ie;Se=Se||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var Xe=0;Xe<Se.length;Xe++){var re=Se[Xe],Ye=0,Ce=0,$e=0;ue=void 0;for(var Ze=new I({comments:he,delimiter:re,newline:ae,preview:10}).parse(de),We=0;We<Ze.data.length;We++)if(Ee&&S(Ze.data[We]))$e++;else{var Qe=Ze.data[We].length;Ce+=Qe,ue!==void 0?0<Qe&&(Ye+=Math.abs(Qe-ue),ue=Qe):ue=Qe}0<Ze.data.length&&(Ce/=Ze.data.length-$e),(ze===void 0||Ye<=ze)&&(ie===void 0||ie<Ce)&&1.99<Ce&&(ze=Ye,Me=re,ie=Ce)}return{successful:!!(c.delimiter=Me),bestDelimiter:Me}}(D,c.newline,c.skipEmptyLines,c.comments,c.delimitersToGuess);ne.successful?c.delimiter=ne.bestDelimiter:(k=!0,c.delimiter=a.DefaultDelimiter),R.meta.delimiter=c.delimiter}var fe=$(c);return c.preview&&c.header&&fe.preview++,u=D,m=new I(fe),R=m.parse(u,x,le),U(),M?{meta:{paused:!0}}:R||{meta:{paused:!1}}},this.paused=function(){return M},this.pause=function(){M=!0,m.abort(),u=w(c.chunk)?"":u.substring(m.getCharIndex())},this.resume=function(){j.streamer._halted?(M=!1,j.streamer.parseChunk(u,!0)):setTimeout(j.resume,3)},this.aborted=function(){return be},this.abort=function(){be=!0,m.abort(),R.meta.aborted=!0,w(c.complete)&&c.complete(R),u=""}}function A(c){return c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function I(c){var u,m=(c=c||{}).delimiter,k=c.newline,C=c.comments,L=c.step,N=c.preview,O=c.fastMode,j=u=c.quoteChar===void 0||c.quoteChar===null?'"':c.quoteChar;if(c.escapeChar!==void 0&&(j=c.escapeChar),(typeof m!="string"||-1<a.BAD_DELIMITERS.indexOf(m))&&(m=","),C===m)throw new Error("Comment character same as delimiter");C===!0?C="#":(typeof C!="string"||-1<a.BAD_DELIMITERS.indexOf(C))&&(C=!1),k!==`
`&&k!=="\r"&&k!==`\r
`&&(k=`
`);var z=0,B=!1;this.parse=function(M,be,ge){if(typeof M!="string")throw new Error("Input must be a string");var R=M.length,Z=m.length,S=k.length,U=C.length,Q=w(L),W=[],Y=[],D=[],x=z=0;if(!M)return Te();if(c.header&&!be){var le=M.split(k)[0].split(m),me=[],ne={},fe=!1;for(var de in le){var ae=le[de];w(c.transformHeader)&&(ae=c.transformHeader(ae,de));var Ee=ae,he=ne[ae]||0;for(0<he&&(fe=!0,Ee=ae+"_"+he),ne[ae]=he+1;me.includes(Ee);)Ee=Ee+"_"+he;me.push(Ee)}if(fe){var Se=M.split(k);Se[0]=me.join(m),M=Se.join(k)}}if(O||O!==!1&&M.indexOf(u)===-1){for(var Me=M.split(k),ze=0;ze<Me.length;ze++){if(D=Me[ze],z+=D.length,ze!==Me.length-1)z+=k.length;else if(ge)return Te();if(!C||D.substring(0,U)!==C){if(Q){if(W=[],$e(D.split(m)),at(),B)return Te()}else $e(D.split(m));if(N&&N<=ze)return W=W.slice(0,N),Te(!0)}}return Te()}for(var ue=M.indexOf(m,z),ie=M.indexOf(k,z),Xe=new RegExp(A(j)+A(u),"g"),re=M.indexOf(u,z);;)if(M[z]!==u)if(C&&D.length===0&&M.substring(z,z+U)===C){if(ie===-1)return Te();z=ie+S,ie=M.indexOf(k,z),ue=M.indexOf(m,z)}else if(ue!==-1&&(ue<ie||ie===-1))D.push(M.substring(z,ue)),z=ue+Z,ue=M.indexOf(m,z);else{if(ie===-1)break;if(D.push(M.substring(z,ie)),Qe(ie+S),Q&&(at(),B))return Te();if(N&&W.length>=N)return Te(!0)}else for(re=z,z++;;){if((re=M.indexOf(u,re+1))===-1)return ge||Y.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:W.length,index:z}),We();if(re===R-1)return We(M.substring(z,re).replace(Xe,u));if(u!==j||M[re+1]!==j){if(u===j||re===0||M[re-1]!==j){ue!==-1&&ue<re+1&&(ue=M.indexOf(m,re+1)),ie!==-1&&ie<re+1&&(ie=M.indexOf(k,re+1));var Ye=Ze(ie===-1?ue:Math.min(ue,ie));if(M.substr(re+1+Ye,Z)===m){D.push(M.substring(z,re).replace(Xe,u)),M[z=re+1+Ye+Z]!==u&&(re=M.indexOf(u,z)),ue=M.indexOf(m,z),ie=M.indexOf(k,z);break}var Ce=Ze(ie);if(M.substring(re+1+Ce,re+1+Ce+S)===k){if(D.push(M.substring(z,re).replace(Xe,u)),Qe(re+1+Ce+S),ue=M.indexOf(m,z),re=M.indexOf(u,z),Q&&(at(),B))return Te();if(N&&W.length>=N)return Te(!0);break}Y.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:W.length,index:z}),re++}}else re++}return We();function $e(ke){W.push(ke),x=z}function Ze(ke){var Fe=0;if(ke!==-1){var et=M.substring(re+1,ke);et&&et.trim()===""&&(Fe=et.length)}return Fe}function We(ke){return ge||(ke===void 0&&(ke=M.substring(z)),D.push(ke),z=R,$e(D),Q&&at()),Te()}function Qe(ke){z=ke,$e(D),D=[],ie=M.indexOf(k,z)}function Te(ke){return{data:W,errors:Y,meta:{delimiter:m,linebreak:k,aborted:B,truncated:!!ke,cursor:x+(be||0)}}}function at(){L(Te()),W=[],Y=[]}},this.abort=function(){B=!0},this.getCharIndex=function(){return z}}function F(c){var u=c.data,m=o[u.workerId],k=!1;if(u.error)m.userError(u.error,u.file);else if(u.results&&u.results.data){var C={abort:function(){k=!0,P(u.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:J,resume:J};if(w(m.userStep)){for(var L=0;L<u.results.data.length&&(m.userStep({data:u.results.data[L],errors:u.results.errors,meta:u.results.meta},C),!k);L++);delete u.results}else w(m.userChunk)&&(m.userChunk(u.results,C,u.file),delete u.results)}u.finished&&!k&&P(u.workerId,u.results)}function P(c,u){var m=o[c];w(m.userComplete)&&m.userComplete(u),m.terminate(),delete o[c]}function J(){throw new Error("Not implemented.")}function $(c){if(typeof c!="object"||c===null)return c;var u=Array.isArray(c)?[]:{};for(var m in c)u[m]=$(c[m]);return u}function V(c,u){return function(){c.apply(u,arguments)}}function w(c){return typeof c=="function"}return s&&(i.onmessage=function(c){var u=c.data;if(a.WORKER_ID===void 0&&u&&(a.WORKER_ID=u.workerId),typeof u.input=="string")i.postMessage({workerId:a.WORKER_ID,results:a.parse(u.input,u.config),finished:!0});else if(i.File&&u.input instanceof File||u.input instanceof Object){var m=a.parse(u.input,u.config);m&&i.postMessage({workerId:a.WORKER_ID,results:m,finished:!0})}}),(_.prototype=Object.create(f.prototype)).constructor=_,(b.prototype=Object.create(f.prototype)).constructor=b,(p.prototype=Object.create(p.prototype)).constructor=p,(d.prototype=Object.create(f.prototype)).constructor=d,a})})(or);var Br=or.exports;const Ur=Pr(Br);function xr(t){const e=t.data;let n=0,i=1/0;for(let r=0;r<e.length;r++){const s=e[r];s>n&&(n=s),s<i&&(i=s)}return[i,n]}function lr(t){t.startsWith("#")&&(t=t.slice(1));const e=parseInt(t.slice(0,2),16),n=parseInt(t.slice(2,4),16),i=parseInt(t.slice(4,6),16);return[e,n,i]}const fn=4,ot={cyan:"#00FFFF",yellow:"#FFFF00",magenta:"#FF00FF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",white:"#FFFFFF"},jr=[ot.magenta,ot.green],Vr=[ot.red,ot.green,ot.blue],_i=Object.values(ot).slice(0,-2);function Wr(t){return t<=fn?Array(t).fill(!0):[...Array(fn).fill(!0),...Array(t-fn).fill(!1)]}function qr(t,e){let n=[];if(t==1)n=[ot.white];else if(t==2)n=jr;else if(t==3)n=Vr;else if(t<=fn)n=_i.slice(0,t);else{n=Array(t).fill(ot.white);const i=e.flatMap((r,s)=>r?s:[]);for(const[r,s]of i.entries())n[s]=_i[r]}return n.map(lr)}function Hr(t,e,n){const i=t[0].shape,r=i[0],s=i[1],o=r*s,l=new Uint8ClampedArray(4*o).fill(0);let a=0;for(let h=0;h<o;h++){for(let f=0;f<t.length;f++){const _=n[f],b=t[f].data,p=e[f],v=(b[h]-p[0])/(p[1]-p[0]);for(let A=0;A<3;A++){const I=v*_[A]<<0;l[a*4+A]=Math.max(l[a*4+A],I)}}l[a*4+3]=255,a++}return l}function ar(t,e,n={}){Ur.parse(t,{header:!1,download:!0,skipEmptyLines:"greedy",complete:i=>{let r=["url"],s=i.data[0];s.length>1&&(r=s,i.data.shift());const o=i.data.map(p=>{const d={...n};for(let v=0;v<r.length;v++)d[r[v]]=p[v];return d});let l=o.filter(p=>{var d;return!((d=p.url)!=null&&d.endsWith(".csv"))});const a=o.filter(p=>{var d;return(d=p.url)==null?void 0:d.endsWith(".csv")}),h={};l.forEach(p=>{h[p.url]||(h[p.url]=p)}),l=Object.values(h);const f=l.reduce((p,d)=>d.wells?p+1:p,0),_=l.reduce((p,d)=>p+parseInt(d.written||0),0);let b=l.length;f>0&&(b=l.reduce((p,d)=>p+parseInt(d.images||1),0)),e.addCsv(t,a,b,f,_),e.addRows(l),a.forEach(p=>{const d=p.url;p.csv=d,ar(d,e,p)})}})}async function Kr(t){return await fetch(t).then(e=>e.json())}function dn(t){if(!t)return"";const e=2;return t<1024?`${t} B`:t<1024**2?`${(t/1024).toFixed(e)} KB`:t<1024**3?`${(t/1024**2).toFixed(e)} MB`:t<1024**4?`${(t/1024**3).toFixed(e)} GB`:t<1024**5?`${(t/1024**4).toFixed(e)} TB`:`${(t/1024**5).toFixed(e)} PB`}class ur{constructor(){this.store=On({})}async lookupOntologyTerm(e){let n="",i="";e.includes("NCBITaxon")|e.includes("NCBI:txid")&&(n=e.replace("NCBI:txid",""),n=n.replace("obo:NCBITaxon_",""),i="NCBITaxon"),e.includes("FBbi")&&(n=e.replace("obo:FBbi_",""),n=n.replace("obo:FBbi:",""),n=n.replace("FBbi:",""),i="FBbi"),e.includes("NCIT_")&&(n=e.replace("NCIT_",""),i="NCIT"),e.includes("obo:MI_")&&(n=e.replace("obo:MI_",""),i="MI"),e.includes("obo:OBI_")&&(n=e.replace("obo:OBI_",""),i="OBI");let r=i+"_"+n,o=`https://www.ebi.ac.uk/ols4/api/ontologies/${i.toLowerCase()}/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252F${r}`;return(await Kr(o)).label||e}addTerms(e){let n=un(this.store);[...new Set(e)].forEach(r=>{r&&(n[r]||(n[r]="Loading...",setTimeout(()=>{this.lookupOntologyTerm(r).then(s=>{this.addEntry(r,s)})},Math.random()*5e3)))})}addEntry(e,n){this.store.update(i=>(i[e]=n,i))}subscribe(e){return this.store.subscribe(e)}}const cr=new ur,fr=new ur;class en extends Error{constructor(e,n={}){super(`Node not found: ${e}`,n),this.name="NodeNotFoundError"}}class jn extends Error{constructor(e){super(`Missing key: ${e}`),this.name="KeyError"}}var Ue;class hr{constructor(e,n,i){ve(this,Ue);typeof e=="number"?_e(this,Ue,new Uint8Array(e)):e instanceof ArrayBuffer?_e(this,Ue,new Uint8Array(e,n,i)):_e(this,Ue,new Uint8Array(Array.from(e,r=>r?1:0)))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return q(this,Ue).byteOffset}get byteLength(){return q(this,Ue).byteLength}get buffer(){return q(this,Ue).buffer}get length(){return q(this,Ue).length}get(e){let n=q(this,Ue)[e];return typeof n=="number"?n!==0:n}set(e,n){q(this,Ue)[e]=n?1:0}fill(e){q(this,Ue).fill(e?1:0)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}Ue=new WeakMap;var It;class Vn{constructor(e,n,i,r){te(this,"_data");te(this,"chars");ve(this,It);if(this.chars=e,_e(this,It,new TextEncoder),typeof n=="number")this._data=new Uint8Array(n*e);else if(n instanceof ArrayBuffer)r&&(r=r*e),this._data=new Uint8Array(n,i,r);else{let s=Array.from(n);this._data=new Uint8Array(s.length*e);for(let o=0;o<s.length;o++)this.set(o,s[o])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(e){const n=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);return new TextDecoder().decode(n).replace(/\x00/g,"")}set(e,n){const i=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);i.fill(0),i.set(q(this,It).encode(n))}fill(e){const n=q(this,It).encode(e);for(let i=0;i<this.length;i++)this._data.set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}It=new WeakMap;var Re;const Jn=class Jn{constructor(e,n,i,r){ve(this,Re);te(this,"chars");if(this.chars=e,typeof n=="number")_e(this,Re,new Int32Array(n*e));else if(n instanceof ArrayBuffer)r&&(r*=e),_e(this,Re,new Int32Array(n,i,r));else{const s=n,o=new Jn(e,1);_e(this,Re,new Int32Array(function*(){for(let l of s)o.set(0,l),yield*q(o,Re)}()))}}get BYTES_PER_ELEMENT(){return q(this,Re).BYTES_PER_ELEMENT*this.chars}get byteLength(){return q(this,Re).byteLength}get byteOffset(){return q(this,Re).byteOffset}get buffer(){return q(this,Re).buffer}get length(){return q(this,Re).length/this.chars}get(e){const n=this.chars*e;let i="";for(let r=0;r<this.chars;r++)i+=String.fromCodePoint(q(this,Re)[n+r]);return i.replace(/\u0000/g,"")}set(e,n){const i=this.chars*e,r=q(this,Re).subarray(i,i+this.chars);r.fill(0);for(let s=0;s<this.chars;s++)r[s]=n.codePointAt(s)??0}fill(e){this.set(0,e);let n=q(this,Re).subarray(0,this.chars);for(let i=1;i<this.length;i++)q(this,Re).set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}};Re=new WeakMap;let Pt=Jn;const Gr="modulepreload",Jr=function(t){return"/zowser/"+t},gi={},Ot=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(n.map(a=>{if(a=Jr(a),a in gi)return;gi[a]=!0;const h=a.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${f}`))return;const _=document.createElement("link");if(_.rel=h?"stylesheet":Gr,h||(_.as="script"),_.crossOrigin="",_.href=a,l&&_.setAttribute("nonce",l),document.head.appendChild(_),h)return new Promise((b,p)=>{_.addEventListener("load",b),_.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${a}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};function tn(t){const e=new TextDecoder().decode(t);return JSON.parse(e)}function mi(t,e){const n=e/2,i=e-1;let r=0;for(let s=0;s<t.length;s+=e)for(let o=0;o<n;o+=1)r=t[s+o],t[s+o]=t[s+i-o],t[s+i-o]=r}function dr(t){if(t==="v2:object")return globalThis.Array;let e=t.match(/v2:([US])(\d+)/);if(e){let[,i,r]=e;return(i==="U"?Pt:Vn).bind(null,Number(r))}let n={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float16:globalThis.Float16Array,float32:Float32Array,float64:Float64Array,bool:hr}[t];return Ie(n,`Unknown or unsupported data_type: ${t}`),n}function gt(t,e){const n=t.length;typeof e=="string"&&(e=e==="C"?Array.from({length:n},(s,o)=>o):Array.from({length:n},(s,o)=>n-1-o)),Ie(n===e.length,"Order length must match the number of dimensions.");let i=1,r=new Array(n);for(let s=e.length-1;s>=0;s--)r[e[s]]=i,i*=t[e[s]];return r}function Yr({name:t,configuration:e}){if(t==="default"){const n=(e==null?void 0:e.separator)??"/";return i=>["c",...i].join(n)}if(t==="v2"){const n=(e==null?void 0:e.separator)??".";return i=>i.join(n)||"0"}throw new Error(`Unknown chunk key encoding: ${t}`)}function Zr(t){if(t==="|O")return{data_type:"v2:object"};let e=t.match(/^([<|>])(.*)$/);Ie(e,`Invalid dtype: ${t}`);let[,n,i]=e,r={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f2:"float16",f4:"float32",f8:"float64"}[i]??(i.startsWith("S")||i.startsWith("U")?`v2:${i}`:void 0);return Ie(r,`Unsupported or unknown dtype: ${t}`),n==="|"?{data_type:r}:{data_type:r,endian:n==="<"?"little":"big"}}function Qr(t,e={}){let n=[],i=Zr(t.dtype);t.order==="F"&&n.push({name:"transpose",configuration:{order:"F"}}),"endian"in i&&i.endian==="big"&&n.push({name:"bytes",configuration:{endian:"big"}});for(let{id:r,...s}of t.filters??[])n.push({name:r,configuration:s});if(t.compressor){let{id:r,...s}=t.compressor;n.push({name:r,configuration:s})}return{zarr_format:3,node_type:"array",shape:t.shape,data_type:i.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:t.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:t.dimension_separator??"."}},codecs:n,fill_value:t.fill_value,attributes:e}}function Xr(t,e={}){return{zarr_format:3,node_type:"group",attributes:e}}function $r(t,e){if(e!=="number"&&e!=="bigint"&&e!=="boolean"&&e!=="object"&&e!=="string")return t===e;let n=t==="bool";if(e==="boolean")return n;let i=t.startsWith("v2:U")||t.startsWith("v2:S");if(e==="string")return i;let r=t==="int64"||t==="uint64";if(e==="bigint")return r;let s=t==="v2:object";return e==="object"?s:!i&&!r&&!n&&!s}function es(t){return(t==null?void 0:t.name)==="sharding_indexed"}function _r(t){return(t.data_type==="uint64"||t.data_type==="int64")&&t.fill_value!=null?BigInt(t.fill_value):t.fill_value}function gr(t,...e){if(!e.some(n=>t instanceof n))throw t}function Ie(t,e=""){if(!t)throw new Error(e)}class Wn{constructor(e,n){te(this,"kind","array_to_array");Ie(e.keepbits>=0,"keepbits must be zero or positive")}static fromConfig(e,n){return new Wn(e,n)}encode(e){throw new Error("`BitroundCodec.encode` is not implemented. Please open an issue at https://github.com/manzt/zarrita.js/issues.")}decode(e){return e}}const pi=ts();function ts(){const t=new Uint32Array([305419896]);return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)[0]!==18}function bi(t){return"BYTES_PER_ELEMENT"in t?t.BYTES_PER_ELEMENT:4}var Ut,it,xt,jt,St;const Yn=class Yn{constructor(e,n){te(this,"kind","array_to_bytes");ve(this,Ut);ve(this,it);ve(this,xt);ve(this,jt);ve(this,St);_e(this,St,e==null?void 0:e.endian),_e(this,it,dr(n.data_type)),_e(this,jt,n.shape),_e(this,Ut,gt(n.shape,"C"));const i=new(q(this,it))(0);_e(this,xt,i.BYTES_PER_ELEMENT)}static fromConfig(e,n){return new Yn(e,n)}encode(e){let n=new Uint8Array(e.data.buffer);return pi&&q(this,St)==="big"&&mi(n,bi(q(this,it))),n}decode(e){return pi&&q(this,St)==="big"&&mi(e,bi(q(this,it))),{data:new(q(this,it))(e.buffer,e.byteOffset,e.byteLength/q(this,xt)),shape:q(this,jt),stride:q(this,Ut)}}};Ut=new WeakMap,it=new WeakMap,xt=new WeakMap,jt=new WeakMap,St=new WeakMap;let _n=Yn;class qn{constructor(){te(this,"kind","bytes_to_bytes")}static fromConfig(){return new qn}encode(e){throw new Error("Not implemented")}decode(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength-4)}}function ns(t,e){return Ie(!Number.isNaN(e),"JsonCodec allow_nan is false but NaN was encountered during encoding."),Ie(e!==Number.POSITIVE_INFINITY,"JsonCodec allow_nan is false but Infinity was encountered during encoding."),Ie(e!==Number.NEGATIVE_INFINITY,"JsonCodec allow_nan is false but -Infinity was encountered during encoding."),e}function is(t,e){return e instanceof Object&&!Array.isArray(e)?Object.keys(e).sort().reduce((n,i)=>(n[i]=e[i],n),{}):e}var Vt,Wt;const Zn=class Zn{constructor(e={}){te(this,"configuration");te(this,"kind","array_to_bytes");ve(this,Vt);ve(this,Wt);this.configuration=e;const{encoding:n="utf-8",skipkeys:i=!1,ensure_ascii:r=!0,check_circular:s=!0,allow_nan:o=!0,sort_keys:l=!0,indent:a,strict:h=!0}=e;let f=e.separators;f||(a?f=[", ",": "]:f=[",",":"]),_e(this,Vt,{encoding:n,skipkeys:i,ensure_ascii:r,check_circular:s,allow_nan:o,indent:a,separators:f,sort_keys:l}),_e(this,Wt,{strict:h})}static fromConfig(e){return new Zn(e)}encode(e){const{indent:n,encoding:i,ensure_ascii:r,check_circular:s,allow_nan:o,sort_keys:l}=q(this,Vt);Ie(i==="utf-8","JsonCodec does not yet support non-utf-8 encoding.");const a=[];Ie(s,"JsonCodec does not yet support skipping the check for circular references during encoding."),o||a.push(ns),l&&a.push(is);const h=Array.from(e.data);h.push("|O"),h.push(e.shape);let f;a.length&&(f=(b,p)=>{let d=p;for(let v of a)d=v(b,d);return d});let _=JSON.stringify(h,f,n);return r&&(_=_.replace(/[\u007F-\uFFFF]/g,b=>{const p=`0000${b.charCodeAt(0).toString(16)}`;return`\\u${p.substring(p.length-4)}`})),new TextEncoder().encode(_)}decode(e){const{strict:n}=q(this,Wt);Ie(n,"JsonCodec does not yet support non-strict decoding.");const i=tn(e),r=i.pop();i.pop(),Ie(r,"0D not implemented for JsonCodec.");const s=gt(r,"C");return{data:i,shape:r,stride:s}}};Vt=new WeakMap,Wt=new WeakMap;let Ln=Zn;function yi(t){return t instanceof hr||t instanceof Vn||t instanceof Pt?new Proxy(t,{get(n,i){return n.get(Number(i))},set(n,i,r){return n.set(Number(i),r),!0}}):t}function rs(t,e){let n;return t.data instanceof Vn||t.data instanceof Pt?n=new t.constructor(t.data.length,t.data.chars):n=new t.constructor(t.data.length),{data:n,shape:t.shape,stride:gt(t.shape,e)}}function ss(t,e){let n=rs(t,e),i=t.shape.length,r=t.data.length,s=Array(i).fill(0),o=yi(t.data),l=yi(n.data);for(let a=0;a<r;a++){let h=0;for(let f=0;f<i;f++)h+=s[f]*n.stride[f];l[h]=o[a],s[0]+=1;for(let f=0;f<i;f++)if(s[f]===t.shape[f]){if(f+1===i)break;s[f]=0,s[f+1]+=1}}return n}function os(t){let e=t.shape.length;return Ie(e===t.stride.length,"Shape and stride must have the same length."),t.stride.map((n,i)=>({stride:n,index:i})).sort((n,i)=>i.stride-n.stride).map(n=>n.index)}function ls(t,e){let n=os(t);return Ie(n.length===e.length,"Orders must match"),n.every((i,r)=>i===e[r])}var qt,zt;const Qn=class Qn{constructor(e,n){te(this,"kind","array_to_array");ve(this,qt);ve(this,zt);let i=e.order??"C",r=n.shape.length,s=new Array(r),o=new Array(r);if(i==="C")for(let l=0;l<r;++l)s[l]=l,o[l]=l;else if(i==="F")for(let l=0;l<r;++l)s[l]=r-l-1,o[l]=r-l-1;else s=i,s.forEach((l,a)=>{Ie(o[l]===void 0,`Invalid permutation: ${JSON.stringify(i)}`),o[l]=a});_e(this,qt,s),_e(this,zt,o)}static fromConfig(e,n){return new Qn(e,n)}encode(e){return ls(e,q(this,zt))?e:ss(e,q(this,zt))}decode(e){return{data:e.data,shape:e.shape,stride:gt(e.shape,q(this,qt))}}};qt=new WeakMap,zt=new WeakMap;let Mn=Qn;var Ht,Kt;const Xn=class Xn{constructor(e){te(this,"kind","array_to_bytes");ve(this,Ht);ve(this,Kt);_e(this,Ht,e),_e(this,Kt,gt(e,"C"))}static fromConfig(e,n){return new Xn(n.shape)}encode(e){throw new Error("Method not implemented.")}decode(e){let n=new TextDecoder,i=new DataView(e.buffer),r=Array(i.getUint32(0,!0)),s=4;for(let o=0;o<r.length;o++){let l=i.getUint32(s,!0);s+=4,r[o]=n.decode(e.buffer.slice(s,s+l)),s+=l}return{data:r,shape:q(this,Ht),stride:q(this,Kt)}}};Ht=new WeakMap,Kt=new WeakMap;let Fn=Xn;function as(){return new Map().set("blosc",()=>Ot(()=>import("./blosc-E49GQuAK.js"),__vite__mapDeps([0,1])).then(t=>t.default)).set("gzip",()=>Ot(()=>import("./gzip-CF-9a_hd.js"),__vite__mapDeps([2,3])).then(t=>t.default)).set("lz4",()=>Ot(()=>import("./lz4-BIGKWw27.js"),__vite__mapDeps([4,1])).then(t=>t.default)).set("zlib",()=>Ot(()=>import("./zlib-CBiqHlio.js"),__vite__mapDeps([5,3])).then(t=>t.default)).set("zstd",()=>Ot(()=>import("./zstd-IvP746pw.js"),__vite__mapDeps([6,1])).then(t=>t.default)).set("transpose",()=>Mn).set("bytes",()=>_n).set("crc32c",()=>qn).set("vlen-utf8",()=>Fn).set("json2",()=>Ln).set("bitround",()=>Wn)}const us=as();function Dn(t){let e;return{async encode(n){e||(e=await vi(t));for(const r of e.array_to_array)n=await r.encode(n);let i=await e.array_to_bytes.encode(n);for(const r of e.bytes_to_bytes)i=await r.encode(i);return i},async decode(n){e||(e=await vi(t));for(let r=e.bytes_to_bytes.length-1;r>=0;r--)n=await e.bytes_to_bytes[r].decode(n);let i=await e.array_to_bytes.decode(n);for(let r=e.array_to_array.length-1;r>=0;r--)i=await e.array_to_array[r].decode(i);return i}}}async function vi(t){let e=t.codecs.map(async s=>{var l;let o=await((l=us.get(s.name))==null?void 0:l());return Ie(o,`Unknown codec: ${s.name}`),{Codec:o,meta:s}}),n=[],i,r=[];for await(let{Codec:s,meta:o}of e){let l=s.fromConfig(o.configuration,t);switch(l.kind){case"array_to_array":n.push(l);break;case"array_to_bytes":i=l;break;default:r.push(l)}}return i||(Ie(cs(t),`Cannot encode ${t.data_type} to bytes without a codec`),i=_n.fromConfig({endian:"little"},t)),{array_to_array:n,array_to_bytes:i,bytes_to_bytes:r}}function cs(t){return t.data_type!=="v2:object"}const wi=18446744073709551615n;function fs(t,e,n,i){Ie(t.store.getRange,"Store does not support range requests");let r=t.store.getRange.bind(t.store),s=e.map((a,h)=>a/i.chunk_shape[h]),o=Dn({data_type:"uint64",shape:[...s,2],codecs:i.index_codecs}),l={};return async a=>{let h=a.map((F,P)=>Math.floor(F/s[P])),f=t.resolve(n(h)).path,_;if(f in l)_=l[f];else{let F=4,P=16*s.reduce(($,V)=>$*V,1),J=await r(f,{suffixLength:P+F});_=l[f]=J?await o.decode(J):null}if(_===null)return;let{data:b,shape:p,stride:d}=_,v=a.map((F,P)=>F%p[P]).reduce((F,P,J)=>F+P*d[J],0),A=b[v],I=b[v+1];if(!(A===wi&&I===wi))return r(f,{offset:Number(A),length:Number(I)})}}class Tt{constructor(e,n="/"){te(this,"store");te(this,"path");this.store=e,this.path=n}resolve(e){let n=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new Tt(this.store,new URL(e,n).pathname)}}var Gt;class Hn extends Tt{constructor(n,i,r){super(n,i);te(this,"kind","group");ve(this,Gt);_e(this,Gt,r)}get attrs(){return q(this,Gt).attributes}}Gt=new WeakMap;function ki(t){var n;const e=t.find(i=>i.name==="transpose");return((n=e==null?void 0:e.configuration)==null?void 0:n.order)??"C"}const Mt=Symbol("zarrita.context");function hs(t){return t[Mt]}function ds(t,e){let{configuration:n}=e.codecs.find(es)??{},i={encode_chunk_key:Yr(e.chunk_key_encoding),TypedArray:dr(e.data_type),fill_value:e.fill_value};if(n){let s=ki(n.codecs);return{...i,kind:"sharded",chunk_shape:n.chunk_shape,codec:Dn({data_type:e.data_type,shape:n.chunk_shape,codecs:n.codecs}),get_strides(o){return gt(o,s)},get_chunk_bytes:fs(t,e.chunk_grid.configuration.chunk_shape,i.encode_chunk_key,n)}}let r=ki(e.codecs);return{...i,kind:"regular",chunk_shape:e.chunk_grid.configuration.chunk_shape,codec:Dn({data_type:e.data_type,shape:e.chunk_grid.configuration.chunk_shape,codecs:e.codecs}),get_strides(s){return gt(s,r)},async get_chunk_bytes(s,o){let l=i.encode_chunk_key(s),a=t.resolve(l).path;return t.store.get(a,o)}}}var Qi,Xi,dt,$i;let gn=($i=class extends(Xi=Tt,Qi=Mt,Xi){constructor(n,i,r){super(n,i);te(this,"kind","array");ve(this,dt);te(this,Qi);_e(this,dt,{...r,fill_value:_r(r)}),this[Mt]=ds(this,r)}get attrs(){return q(this,dt).attributes}get shape(){return q(this,dt).shape}get chunks(){return this[Mt].chunk_shape}get dtype(){return q(this,dt).data_type}async getChunk(n,i){let r=this[Mt],s=await r.get_chunk_bytes(n,i);if(!s){let o=r.chunk_shape.reduce((a,h)=>a*h,1),l=new r.TypedArray(o);return l.fill(r.fill_value),{data:l,shape:r.chunk_shape,stride:r.get_strides(r.chunk_shape)}}return r.codec.decode(s)}is(n){return $r(this.dtype,n)}},dt=new WeakMap,$i),pn=_s();function _s(){let t=new WeakMap;function e(n){let i=t.get(n)??{v2:0,v3:0};return t.set(n,i),i}return{increment(n,i){e(n)[i]+=1},version_max(n){let i=e(n);return i.v3>i.v2?"v3":"v2"}}}async function gs(t){let e=await t.store.get(t.resolve(".zattrs").path);return e?tn(e):{}}async function ms(t,e={}){let n="store"in t?t:new Tt(t),i={};return(e.attrs??!0)&&(i=await gs(n)),e.kind==="array"?Ei(n,i):e.kind==="group"?Ci(n,i):Ei(n,i).catch(r=>(gr(r,en),Ci(n,i)))}async function Ei(t,e){let{path:n}=t.resolve(".zarray"),i=await t.store.get(n);if(!i)throw new en("v2 array",{cause:new jn(n)});return pn.increment(t.store,"v2"),new gn(t.store,t.path,Qr(tn(i),e))}async function Ci(t,e){let{path:n}=t.resolve(".zgroup"),i=await t.store.get(n);if(!i)throw new en("v2 group",{cause:new jn(n)});return pn.increment(t.store,"v2"),new Hn(t.store,t.path,Xr(tn(i),e))}async function ps(t){let{store:e,path:n}=t.resolve("zarr.json"),i=await t.store.get(n);if(!i)throw new en("v3 array or group",{cause:new jn(n)});let r=tn(i);return r.node_type==="array"&&(r.fill_value=_r(r)),r.node_type==="array"?new gn(e,t.path,r):new Hn(e,t.path,r)}async function bs(t,e={}){let n="store"in t?t:new Tt(t),i=await ps(n);if(pn.increment(n.store,"v3"),e.kind===void 0||e.kind==="array"&&i instanceof gn||e.kind==="group"&&i instanceof Hn)return i;let r=i instanceof gn?"array":"group";throw new Error(`Expected node of kind ${e.kind}, found ${r}.`)}async function ht(t,e={}){let n="store"in t?t.store:t,i=pn.version_max(n),r=i==="v2"?ht.v2:ht.v3,s=i==="v2"?ht.v3:ht.v2;return r(t,e).catch(o=>(gr(o,en),s(t,e)))}ht.v2=ms;ht.v3=bs;function*ys(t,e,n=1){e===void 0&&(e=t,t=0);for(let i=t;i<e;i+=n)yield i}function*vs(...t){if(t.length===0)return;const e=t.map(i=>i[Symbol.iterator]()),n=e.map(i=>i.next());if(n.some(i=>i.done))throw new Error("Input contains an empty iterator.");for(let i=0;;){if(n[i].done){if(e[i]=t[i][Symbol.iterator](),n[i]=e[i].next(),++i>=e.length)return}else yield n.map(({value:r})=>r),i=0;n[i]=e[i].next()}}function ws({start:t,stop:e,step:n},i){if(n===0)throw new Error("slice step cannot be zero");n=n??1;const r=n<0,[s,o]=r?[-1,i-1]:[0,i];return t===null?t=r?o:s:t<0?(t+=i,t<s&&(t=s)):t>o&&(t=o),e===null?e=r?s:o:e<0?(e+=i,e<s&&(e=s)):e>o&&(e=o),[t,e,n]}function Nn(t,e,n=null){return e===void 0&&(e=t,t=null),{start:t,stop:e,step:n}}function ks(){const t=[];return{add:e=>t.push(e()),onIdle:()=>Promise.all(t)}}class Kn extends Error{constructor(e){super(e),this.name="IndexError"}}function Es(t,e){throw new Kn(`too many indicies for array; expected ${e.length}, got ${t.length}`)}function Cs(t){throw new Kn(`index out of bounds for dimension with length ${t}`)}function As(){throw new Kn("only slices with step >= 1 are supported")}function Is(t,e){t.length>e.length&&Es(t,e)}function Ss(t,e){return t=Math.trunc(t),t<0&&(t=e+t),(t>=e||t<0)&&Cs(e),t}class zs{constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){te(this,"dim_sel");te(this,"dim_len");te(this,"dim_chunk_len");te(this,"nitems");e=Ss(e,n),this.dim_sel=e,this.dim_len=n,this.dim_chunk_len=i,this.nitems=1}*[Symbol.iterator](){const e=Math.floor(this.dim_sel/this.dim_chunk_len),n=e*this.dim_chunk_len,i=this.dim_sel-n;yield{dim_chunk_ix:e,dim_chunk_sel:i}}}class Ai{constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){te(this,"start");te(this,"stop");te(this,"step");te(this,"dim_len");te(this,"dim_chunk_len");te(this,"nitems");te(this,"nchunks");const[r,s,o]=ws(e,n);this.start=r,this.stop=s,this.step=o,this.step<1&&As(),this.dim_len=n,this.dim_chunk_len=i,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const e=Math.floor(this.start/this.dim_chunk_len),n=Math.ceil(this.stop/this.dim_chunk_len);for(const i of ys(e,n)){const r=i*this.dim_chunk_len,s=Math.min(this.dim_len,(i+1)*this.dim_chunk_len),o=s-r;let l=0,a=0;if(this.start<r){const p=(r-this.start)%this.step;p&&(a+=this.step-p),l=Math.ceil((r-this.start)/this.step)}else a=this.start-r;const h=this.stop>s?o:this.stop-r,f=[a,h,this.step],_=Math.ceil((h-a)/this.step),b=[l,l+_,1];yield{dim_chunk_ix:i,dim_chunk_sel:f,dim_out_sel:b}}}}function Ts(t,e){let n=[];return t===null?n=e.map(i=>Nn(null)):Array.isArray(t)&&(n=t.map(i=>i??Nn(null))),Is(n,e),n}class Rs{constructor({selection:e,shape:n,chunk_shape:i}){te(this,"dim_indexers");te(this,"shape");this.dim_indexers=Ts(e,n).map((r,s)=>new(typeof r=="number"?zs:Ai)({dim_sel:r,dim_len:n[s],dim_chunk_len:i[s]})),this.shape=this.dim_indexers.filter(r=>r instanceof Ai).map(r=>r.nitems)}*[Symbol.iterator](){for(const e of vs(...this.dim_indexers)){const n=e.map(r=>r.dim_chunk_ix),i=e.map(r=>"dim_out_sel"in r?{from:r.dim_chunk_sel,to:r.dim_out_sel}:{from:r.dim_chunk_sel,to:null});yield{chunk_coords:n,mapping:i}}}}function Os(t,e){return"get"in t?t.get(e):t[e]}async function Ls(t,e,n,i){var a;let r=hs(t),s=new Rs({selection:e,shape:t.shape,chunk_shape:t.chunks}),o=i.prepare(new r.TypedArray(s.shape.reduce((h,f)=>h*f,1)),s.shape,r.get_strides(s.shape)),l=((a=n.create_queue)==null?void 0:a.call(n))??ks();for(const{chunk_coords:h,mapping:f}of s)l.add(async()=>{let{data:_,shape:b,stride:p}=await t.getChunk(h,n.opts),d=i.prepare(_,b,p);i.set_from_chunk(o,d,f)});return await l.onIdle(),s.shape.length===0?Os(o.data,0):o}function Gn(t,e=0,n){let i=n??t.length-e;return{length:i,subarray(r,s=i){return Gn(t,e+r,s-r)},set(r,s=0){for(let o=0;o<r.length;o++)t[e+s+o]=r.get(o)},get(r){return t[e+r]}}}function An(t){return globalThis.Array.isArray(t.data)?{data:Gn(t.data),stride:t.stride,bytes_per_element:1}:{data:new Uint8Array(t.data.buffer,t.data.byteOffset,t.data.byteLength),stride:t.stride,bytes_per_element:t.data.BYTES_PER_ELEMENT}}function Ms(t){return"chars"in t?t.constructor.bind(null,t.chars):t.constructor}function Fs(t,e){if(globalThis.Array.isArray(t.data))return Gn([e]);let n=Ms(t.data),i=new n([e]);return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}const Ds={prepare(t,e,n){return{data:t,shape:e,stride:n}},set_scalar(t,e,n){let i=An(t);Pn(i,e,Fs(t,n),i.bytes_per_element)},set_from_chunk(t,e,n){let i=An(t);hn(i,An(e),i.bytes_per_element,n)}};async function Ns(t,e=null,n={}){return Ls(t,e,n,Ds)}function mr(t,e,n){return n<0&&e<t?Math.floor((t-e-1)/-n)+1:t<e?Math.floor((e-t-1)/n)+1:0}function Pn(t,e,n,i){if(e.length===0){t.data.set(n,0);return}const[r,...s]=e,[o,...l]=t.stride;if(typeof r=="number"){const b=t.data.subarray(o*r*i);Pn({data:b,stride:l},s,n,i);return}const[a,h,f]=r,_=mr(a,h,f);if(s.length===0){for(let b=0;b<_;b++)t.data.set(n,o*(a+f*b)*i);return}for(let b=0;b<_;b++){const p=t.data.subarray(o*(a+f*b)*i);Pn({data:p,stride:l},s,n,i)}}function hn(t,e,n,i){const[r,...s]=i,[o,...l]=t.stride,[a,...h]=e.stride;if(r.from===null){if(s.length===0){t.data.set(e.data.subarray(0,n),r.to*n);return}hn({data:t.data.subarray(o*r.to*n),stride:l},e,n,s);return}if(r.to===null){if(s.length===0){let I=r.from*n;t.data.set(e.data.subarray(I,I+n),0);return}hn(t,{data:e.data.subarray(a*r.from*n),stride:h},n,s);return}const[f,_,b]=r.to,[p,d,v]=r.from,A=mr(f,_,b);if(s.length===0){if(b===1&&v===1&&o===1&&a===1){let I=p*n,F=A*n;t.data.set(e.data.subarray(I,I+F),f*n);return}for(let I=0;I<A;I++){let F=a*(p+v*I)*n;t.data.set(e.data.subarray(F,F+n),o*(f+b*I)*n)}return}for(let I=0;I<A;I++)hn({data:t.data.subarray(o*(f+I*b)*n),stride:l},{data:e.data.subarray(a*(p+I*v)*n),stride:h},n,s)}function pr(t,e,n,i={}){return e!==void 0&&n!==void 0&&(i={...i,headers:{...i.headers,Range:`bytes=${e}-${e+n-1}`}}),fetch(t,i)}function Ps(t,e){return{...t,...e,headers:{...t.headers,...e.headers}}}function Ii(t,e){const n=typeof t=="string"?new URL(t):t;n.pathname.endsWith("/")||(n.pathname+="/");const i=new URL(e.slice(1),n);return i.search=n.search,i}async function Si(t){if(t.status!==404){if(t.status===200||t.status===206)return new Uint8Array(await t.arrayBuffer());throw new Error(`Unexpected response status ${t.status} ${t.statusText}`)}}async function Bs(t,e,n,i){if(i)return fetch(t,{...n,headers:{...n.headers,Range:`bytes=-${e}`}});let r=await fetch(t,{...n,method:"HEAD"});if(!r.ok)return r;let s=r.headers.get("Content-Length"),o=Number(s);return pr(t,o-e,o,n)}var Jt,Yt,Zt,Bn;class Us{constructor(e,n={}){ve(this,Zt);te(this,"url");ve(this,Jt);ve(this,Yt);this.url=e,_e(this,Jt,n.overrides??{}),_e(this,Yt,n.useSuffixRequest??!1)}async get(e,n={}){let i=Ii(this.url,e).href,r=await fetch(i,kn(this,Zt,Bn).call(this,n));return Si(r)}async getRange(e,n,i={}){let r=Ii(this.url,e),s=kn(this,Zt,Bn).call(this,i),o;return"suffixLength"in n?o=await Bs(r,n.suffixLength,s,q(this,Yt)):o=await pr(r,n.offset,n.length,s),Si(o)}}Jt=new WeakMap,Yt=new WeakMap,Zt=new WeakSet,Bn=function(e){return Ps(q(this,Jt),e)};async function Bt(t,e){var r;let n;try{const s=await fetch(`${t}/zarr.json`,{signal:e});if(!s.ok)throw new Error(`HTTP ${s.status} for ${t}/zarr.json`);n=await s.json()}catch(s){return console.warn(`[ngffLoader] ${t}/zarr.json not found or invalid`,s.message),[void 0,t]}const i=(r=n==null?void 0:n.attributes)==null?void 0:r.ome;if(!i)return[void 0,t];if(i.multiscales)return[i,t];if(i.plate){const s=i.plate.wells[0],o=`${t}/${s.path}/0`,[l,a]=await Bt(o,e);return[l,a,i.plate]}if(i["bioformats2raw.layout"]){const s=`${t}/0`;return await Bt(s,e)}return[void 0,t]}async function xs(t,e,n,i=512,r){var J,$,V;if(!((J=e==null?void 0:e.multiscales)!=null&&J.length))return null;const s=e.multiscales[0].datasets.map(w=>w.path),o=e.multiscales[0].axes.map(w=>w.name);let l=s.at(-1);n!==void 0&&n<s.length&&(l=s[n]);const a=new Us(`${t}/${l}`),h=await ht.v3(a,{kind:"array"}),f=o.indexOf("c"),_=h.shape;if(_.at(-1)*_.at(-2)>i*i)return console.log("Thumbnail skipped, too large:",_,t),null;const b=_[f]||1,p=($=e==null?void 0:e.omero)!=null&&$.channels?e.omero.channels.map(w=>w.active):Wr(b),d=(V=e==null?void 0:e.omero)!=null&&V.channels?e.omero.channels.map(w=>lr(w.color)):qr(b,p),v=p.reduce((w,c,u)=>c?[...w,u]:w,[]),A=w=>_.map((c,u)=>u===f?w:u>=_.length-2?Nn(0,c):parseInt(c/2)),I=await Promise.all(v.map(w=>Ns(h,A(w),{opts:{signal:r}}))),F=I.map(xr);return{rgb:Hr(I,F,d),width:_.at(-1),height:_.at(-2)}}class js{constructor(e="index",n=!0){this.store=On([]),this.selectedRow=On(null),this.sortColumn=e,this.sortAscending=n,this.csvFiles=[]}addCsv(e,n,i,r,s){n=n.map(l=>({...l,child_csv:[]}));let o;for(let l of this.csvFiles){if(l.url===e){o=l;break}for(let a of l.child_csv){if(a.url===e){o=a;break}for(let h of a.child_csv)if(h.url===e){o=h;break}}}o?(o.image_count=i,o.plate_count=r,o.bytes=s,o.child_csv=n):(o={url:e,image_count:i,plate_count:r,bytes:s,child_csv:n},this.csvFiles.push(o))}addRows(e){e=e.map((r,s)=>{if(r.written&&(r.written=parseFloat(r.written)),r.shape){let o=r.shape.split(",").map(a=>parseInt(a)),l;r.dimension_names?l=r.dimension_names.split(","):o.length==5&&(l=["t","c","z","y","x"]),l&&l.length==o.length&&l.forEach((a,h)=>r["size_"+a]=o[h]),r.dim_count=o.reduce((a,h)=>a+(h>1?1:0),0)}if(r.chunks){let o=r.chunks.split(",").map(l=>parseInt(l));r.chunk_pixels=o.reduce((l,a)=>l*a,1)}if(r.shards){let o=r.shards.split(",").map(l=>parseInt(l));r.shard_pixels=o.reduce((l,a)=>l*a,1)}return r.index=Math.random()*(1+s),r}),console.log("Adding rows",e),this.store.update(r=>(r.push(...e),r.sort((s,o)=>this.compareRows(s,o,!0)),r));let n=e.map(r=>r.organismId);cr.addTerms(n);let i=e.map(r=>r.fbbiId);fr.addTerms(i)}populateRow(e,n){this.store.update(i=>(i=i.map(r=>(r.url===e&&(r={...r,...n}),r)),i))}async loadNgffMetadata(e){var b;const[n,i,r]=await Bt(e);let s=[],o=0,l=0,a=!1,h=!0,f={multiscales:n},_=i;if(r&&(o=r.wells.length,l=r.field_count||1),n){const p=(b=n[0])==null?void 0:b.datasets[0],d=p==null?void 0:p.path;if(d){const v=await fetch(`${i}/${d}/zarr.json`).then(A=>A.json()).catch(A=>{console.log(`----> Failed to parse ${i}/${d}/zarr.json`,A)});s=v==null?void 0:v.shape}}else console.log("No multiscales found"),a=!0,s=[0];this.populateRow(e,{image_attrs:f,image_url:_,shape:s,well_count:o,field_count:l,load_failed:a,loaded:h})}compareRows(e,n,i=!1){let r=e[this.sortColumn],s=n[this.sortColumn];if(i)return r===void 0&&(r=0),s===void 0&&(s=0),r<s?this.sortAscending?-1:1:r>s?this.sortAscending?1:-1:0;r===void 0&&(r=""),s===void 0&&(s="");let o=0;return i?o=r-s:o=r.localeCompare(s),this.sortAscending?o:-o}sortTable(e,n=!0){console.log("sortTable",e,n),this.sortColumn=e,this.sortAscending=n;let i=this.isColumnNumeric(e);this.store.update(r=>(r.sort((s,o)=>this.compareRows(s,o,i)),r))}isColumnNumeric(e){let n=un(this.store);for(let i of n){let r=i[e];if(r!==void 0&&r!=="")return!isNaN(r)}}emptyTable(){this.store.set([])}subscribe(e){return this.store.subscribe(e)}getRows(){return un(this.store)}getRow(e){return un(this.store)[e]}subscribeSelectedRow(e){return this.selectedRow.subscribe(e)}setSelectedRow(e){this.selectedRow.set(e)}}const He=new js;function Vs(t){let e,n,i,r,s,o;return{c(){e=E("button"),n=E("span"),n.textContent="^",i=H(),r=E("span"),r.textContent="^",y(n,"class","acc svelte-17vd65t"),Pe(n,"strong",t[1]),y(r,"class","dec svelte-17vd65t"),Pe(r,"strong",!t[1]),y(e,"class","svelte-17vd65t")},m(l,a){G(l,e,a),g(e,n),g(e,i),g(e,r),s||(o=we(e,"click",t[2]),s=!0)},p(l,[a]){a&2&&Pe(n,"strong",l[1]),a&2&&Pe(r,"strong",!l[1])},i:pe,o:pe,d(l){l&&K(e),s=!1,o()}}}function Ws(t,e,n){let{toggleAscending:i}=e,{sortAscending:r}=e;const s=()=>i();return t.$$set=o=>{"toggleAscending"in o&&n(0,i=o.toggleAscending),"sortAscending"in o&&n(1,r=o.sortAscending)},[i,r,s]}class qs extends Je{constructor(e){super(),Ge(this,e,Ws,Vs,Be,{toggleAscending:0,sortAscending:1})}}const an={AUTO:"auto",START:"start",CENTER:"center",END:"end"},nt={HORIZONTAL:"horizontal",VERTICAL:"vertical"},Lt={OBSERVED:0,REQUESTED:1},Hs={[nt.VERTICAL]:"top",[nt.HORIZONTAL]:"left"},zi={[nt.VERTICAL]:"scrollTop",[nt.HORIZONTAL]:"scrollLeft"};class Ks{constructor({itemSize:e,itemCount:n,estimatedItemSize:i}){this.itemSize=e,this.itemCount=n,this.estimatedItemSize=i,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig({itemSize:e,itemCount:n,estimatedItemSize:i}){n!=null&&(this.itemCount=n),i!=null&&(this.estimatedItemSize=i),e!=null&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!=null?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.itemCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:n}=this;return typeof n=="function"?n(e):Array.isArray(n)?n[e]:n}computeTotalSizeAndPositionData(){let e=0;for(let n=0;n<this.itemCount;n++){const i=this.getSize(n),r=e;e+=i,this.itemSizeAndPositionData[n]={offset:r,size:i}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){if(e<0||e>=this.itemCount)throw Error(`Requested index ${e} is outside of range 0..${this.itemCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const n=this.getSizeAndPositionOfLastMeasuredItem();let i=n.offset+n.size;for(let r=this.lastMeasuredIndex+1;r<=e;r++){const s=this.getSize(r);if(s==null||isNaN(s))throw Error(`Invalid size returned for index ${r} of value ${s}`);this.itemSizeAndPositionData[r]={offset:i,size:s},i+=s}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize}getUpdatedOffsetForIndex({align:e=an.START,containerSize:n,currentOffset:i,targetIndex:r}){if(n<=0)return 0;const s=this.getSizeAndPositionForIndex(r),o=s.offset,l=o-n+s.size;let a;switch(e){case an.END:a=l;break;case an.CENTER:a=o-(n-s.size)/2;break;case an.START:a=o;break;default:a=Math.max(l,Math.min(o,i))}const h=this.getTotalSize();return Math.max(0,Math.min(h-n,a))}getVisibleRange({containerSize:e=0,offset:n,overscanCount:i}){if(this.getTotalSize()===0)return{};const s=n+e;let o=this.findNearestItem(n);if(o===void 0)throw Error(`Invalid offset ${n} specified`);const l=this.getSizeAndPositionForIndex(o);n=l.offset+l.size;let a=o;for(;n<s&&a<this.itemCount-1;)a++,n+=this.getSizeAndPositionForIndex(a).size;return i&&(o=Math.max(0,o-i),a=Math.min(a+i,this.itemCount-1)),{start:o,stop:a}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const n=this.getSizeAndPositionOfLastMeasuredItem(),i=Math.max(0,this.lastMeasuredIndex);return n.offset>=e?this.binarySearch({high:i,low:0,offset:e}):this.exponentialSearch({index:i,offset:e})}binarySearch({low:e,high:n,offset:i}){let r=0,s=0;for(;e<=n;){if(r=e+Math.floor((n-e)/2),s=this.getSizeAndPositionForIndex(r).offset,s===i)return r;s<i?e=r+1:s>i&&(n=r-1)}return e>0?e-1:0}exponentialSearch({index:e,offset:n}){let i=1;for(;e<this.itemCount&&this.getSizeAndPositionForIndex(e).offset<n;)e+=i,i*=2;return this.binarySearch({high:Math.min(e,this.itemCount-1),low:Math.floor(e/2),offset:n})}}const Gs=t=>({}),Ti=t=>({});function Ri(t,e,n){const i=t.slice();return i[37]=e[n],i}const Js=t=>({style:t[0]&4,index:t[0]&4}),Oi=t=>({style:t[37].style,index:t[37].index}),Ys=t=>({}),Li=t=>({});function Mi(t,e){let n,i;const r=e[21].item,s=In(r,e,e[20],Oi);return{key:t,first:null,c(){n=mn(),s&&s.c(),this.first=n},m(o,l){G(o,n,l),s&&s.m(o,l),i=!0},p(o,l){e=o,s&&s.p&&(!i||l[0]&1048580)&&zn(s,r,e,e[20],i?Sn(r,e[20],l,Js):Tn(e[20]),Oi)},i(o){i||(oe(s,o),i=!0)},o(o){ce(s,o),i=!1},d(o){o&&K(n),s&&s.d(o)}}}function Zs(t){let e,n,i,r=[],s=new Map,o,l;const a=t[21].header,h=In(a,t,t[20],Li);let f=xe(t[2]);const _=d=>d[0]?d[0](d[37].index):d[37].index;for(let d=0;d<f.length;d+=1){let v=Ri(t,f,d),A=_(v);s.set(A,r[d]=Mi(A,v))}const b=t[21].footer,p=In(b,t,t[20],Ti);return{c(){e=E("div"),h&&h.c(),n=H(),i=E("div");for(let d=0;d<r.length;d+=1)r[d].c();o=H(),p&&p.c(),y(i,"class","virtual-list-inner svelte-dwpad5"),y(i,"style",t[4]),y(e,"class","virtual-list-wrapper svelte-dwpad5"),y(e,"style",t[3])},m(d,v){G(d,e,v),h&&h.m(e,null),g(e,n),g(e,i);for(let A=0;A<r.length;A+=1)r[A]&&r[A].m(i,null);g(e,o),p&&p.m(e,null),t[22](e),l=!0},p(d,v){h&&h.p&&(!l||v[0]&1048576)&&zn(h,a,d,d[20],l?Sn(a,d[20],v,Ys):Tn(d[20]),Li),v[0]&1048581&&(f=xe(d[2]),Xt(),r=sr(r,v,_,1,d,f,s,i,Mr,Mi,null,Ri),$t()),(!l||v[0]&16)&&y(i,"style",d[4]),p&&p.p&&(!l||v[0]&1048576)&&zn(p,b,d,d[20],l?Sn(b,d[20],v,Gs):Tn(d[20]),Ti),(!l||v[0]&8)&&y(e,"style",d[3])},i(d){if(!l){oe(h,d);for(let v=0;v<f.length;v+=1)oe(r[v]);oe(p,d),l=!0}},o(d){ce(h,d);for(let v=0;v<r.length;v+=1)ce(r[v]);ce(p,d),l=!1},d(d){d&&K(e),h&&h.d(d);for(let v=0;v<r.length;v+=1)r[v].d();p&&p.d(d),t[22](null)}}}const Qs=(()=>{let t=!1;try{const e=Object.defineProperty({},"passive",{get(){return t={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return t})();function Xs(t,e,n){let{$$slots:i={},$$scope:r}=e,{height:s}=e,{width:o="100%"}=e,{itemCount:l}=e,{itemSize:a}=e,{estimatedItemSize:h=null}=e,{stickyIndices:f=null}=e,{getKey:_=null}=e,{scrollDirection:b=nt.VERTICAL}=e,{scrollOffset:p=null}=e,{scrollToIndex:d=null}=e,{scrollToAlignment:v=null}=e,{scrollToBehaviour:A="instant"}=e,{overscanCount:I=3}=e;const F=zr(),P=new Ks({itemCount:l,itemSize:a,estimatedItemSize:ge()});let J=!1,$,V=[],w={offset:p||d!=null&&V.length&&B(d)||0,scrollChangeReason:Lt.REQUESTED},c=w,u={scrollToIndex:d,scrollToAlignment:v,scrollOffset:p,itemCount:l,itemSize:a,estimatedItemSize:h},m={},k="",C="";O(),Qt(()=>{n(18,J=!0),$.addEventListener("scroll",M,Qs),p!=null?j(p):d!=null&&j(B(d))}),xn(()=>{J&&$.removeEventListener("scroll",M)});function L(){if(!J)return;const S=u.scrollToIndex!==d||u.scrollToAlignment!==v,U=u.itemCount!==l||u.itemSize!==a||u.estimatedItemSize!==h;U&&(P.updateConfig({itemSize:a,itemCount:l,estimatedItemSize:ge()}),z()),u.scrollOffset!==p?n(19,w={offset:p||0,scrollChangeReason:Lt.REQUESTED}):typeof d=="number"&&(S||U)&&n(19,w={offset:B(d,v,l),scrollChangeReason:Lt.REQUESTED}),u={scrollToIndex:d,scrollToAlignment:v,scrollOffset:p,itemCount:l,itemSize:a,estimatedItemSize:h}}function N(){if(!J)return;const{offset:S,scrollChangeReason:U}=w;(c.offset!==S||c.scrollChangeReason!==U)&&O(),c.offset!==S&&U===Lt.REQUESTED&&j(S),c=w}function O(){const{offset:S}=w,{start:U,stop:Q}=P.getVisibleRange({containerSize:b===nt.VERTICAL?s:o,offset:S,overscanCount:I});let W=[];const Y=P.getTotalSize();b===nt.VERTICAL?(n(3,k=`height:${s}${typeof s=="number"?"px":""};width:${o};`),n(4,C=`flex-direction:column;height:${Y}px;`)):(n(3,k=`height:${s};width:${o}${typeof o=="number"?"px":""}`),n(4,C=`min-height:100%;width:${Y}px;`));const D=f!=null&&f.length!==0;if(D)for(let x=0;x<f.length;x++){const le=f[x];W.push({index:le,style:R(le,!0)})}if(U!==void 0&&Q!==void 0){for(let x=U;x<=Q;x++)D&&f.includes(x)||W.push({index:x,style:R(x,!1)});F("itemsUpdated",{start:U,end:Q})}n(2,V=W)}function j(S){"scroll"in $?$.scroll({[Hs[b]]:S,behavior:A}):n(1,$[zi[b]]=S,$)}function z(S=0){m={},P.resetItem(S),O()}function B(S,U=v,Q=l){return(S<0||S>=Q)&&(S=0),P.getUpdatedOffsetForIndex({align:U,containerSize:b===nt.VERTICAL?s:o,currentOffset:w.offset||0,targetIndex:S})}function M(S){const U=be();U<0||w.offset===U||S.target!==$||(n(19,w={offset:U,scrollChangeReason:Lt.OBSERVED}),F("afterScroll",{offset:U,event:S}))}function be(){return $[zi[b]]}function ge(){return h||typeof a=="number"&&a||50}function R(S,U){if(m[S])return m[S];const{size:Q,offset:W}=P.getSizeAndPositionForIndex(S);let Y;return b===nt.VERTICAL?(Y=`left:0;width:100%;height:${Q}px;`,U?Y+=`position:sticky;flex-grow:0;z-index:1;top:0;margin-top:${W}px;margin-bottom:${-(W+Q)}px;`:Y+=`position:absolute;top:${W}px;`):(Y=`top:0;width:${Q}px;`,U?Y+=`position:sticky;z-index:1;left:0;margin-left:${W}px;margin-right:${-(W+Q)}px;`:Y+=`position:absolute;height:100%;left:${W}px;`),m[S]=Y}function Z(S){_t[S?"unshift":"push"](()=>{$=S,n(1,$)})}return t.$$set=S=>{"height"in S&&n(5,s=S.height),"width"in S&&n(6,o=S.width),"itemCount"in S&&n(7,l=S.itemCount),"itemSize"in S&&n(8,a=S.itemSize),"estimatedItemSize"in S&&n(9,h=S.estimatedItemSize),"stickyIndices"in S&&n(10,f=S.stickyIndices),"getKey"in S&&n(0,_=S.getKey),"scrollDirection"in S&&n(11,b=S.scrollDirection),"scrollOffset"in S&&n(12,p=S.scrollOffset),"scrollToIndex"in S&&n(13,d=S.scrollToIndex),"scrollToAlignment"in S&&n(14,v=S.scrollToAlignment),"scrollToBehaviour"in S&&n(15,A=S.scrollToBehaviour),"overscanCount"in S&&n(16,I=S.overscanCount),"$$scope"in S&&n(20,r=S.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&29568&&L(),t.$$.dirty[0]&524288&&N(),t.$$.dirty[0]&263264&&J&&z(0)},[_,$,V,k,C,s,o,l,a,h,f,b,p,d,v,A,I,z,J,w,r,i,Z]}class $s extends Je{constructor(e){super(),Ge(this,e,Xs,Zs,Be,{height:5,width:6,itemCount:7,itemSize:8,estimatedItemSize:9,stickyIndices:10,getKey:0,scrollDirection:11,scrollOffset:12,scrollToIndex:13,scrollToAlignment:14,scrollToBehaviour:15,overscanCount:16,recomputeSizes:17},null,[-1,-1])}get height(){return this.$$.ctx[5]}set height(e){this.$$set({height:e}),Le()}get width(){return this.$$.ctx[6]}set width(e){this.$$set({width:e}),Le()}get itemCount(){return this.$$.ctx[7]}set itemCount(e){this.$$set({itemCount:e}),Le()}get itemSize(){return this.$$.ctx[8]}set itemSize(e){this.$$set({itemSize:e}),Le()}get estimatedItemSize(){return this.$$.ctx[9]}set estimatedItemSize(e){this.$$set({estimatedItemSize:e}),Le()}get stickyIndices(){return this.$$.ctx[10]}set stickyIndices(e){this.$$set({stickyIndices:e}),Le()}get getKey(){return this.$$.ctx[0]}set getKey(e){this.$$set({getKey:e}),Le()}get scrollDirection(){return this.$$.ctx[11]}set scrollDirection(e){this.$$set({scrollDirection:e}),Le()}get scrollOffset(){return this.$$.ctx[12]}set scrollOffset(e){this.$$set({scrollOffset:e}),Le()}get scrollToIndex(){return this.$$.ctx[13]}set scrollToIndex(e){this.$$set({scrollToIndex:e}),Le()}get scrollToAlignment(){return this.$$.ctx[14]}set scrollToAlignment(e){this.$$set({scrollToAlignment:e}),Le()}get scrollToBehaviour(){return this.$$.ctx[15]}set scrollToBehaviour(e){this.$$set({scrollToBehaviour:e}),Le()}get overscanCount(){return this.$$.ctx[16]}set overscanCount(e){this.$$set({overscanCount:e}),Le()}get recomputeSizes(){return this.$$.ctx[17]}}function eo(t){let e,n,i,r,s;return{c(){e=E("div"),n=E("img"),r=H(),s=E("canvas"),se(n,"width",t[4]+"px"),se(n,"height",t[5]+"px"),se(n,"object-fit","cover"),y(n,"alt",""),y(n,"aria-hidden",i=t[7]!=="cached"),y(n,"class","svelte-12dtn57"),Pe(n,"hidden",t[7]!=="cached"),se(s,"width",t[4]+"px"),se(s,"height",t[5]+"px"),se(s,"background-color","lightgrey"),y(s,"width",t[2]),y(s,"height",t[3]),y(s,"class","svelte-12dtn57"),Pe(s,"hidden",t[7]!=="live"),y(e,"class","canvasWrapper svelte-12dtn57"),se(e,"width",t[4]+"px"),se(e,"height",t[5]+"px"),Pe(e,"spinner",t[6])},m(o,l){G(o,e,l),g(e,n),t[14](n),g(e,r),g(e,s),t[15](s)},p(o,[l]){l&16&&se(n,"width",o[4]+"px"),l&32&&se(n,"height",o[5]+"px"),l&128&&i!==(i=o[7]!=="cached")&&y(n,"aria-hidden",i),l&128&&Pe(n,"hidden",o[7]!=="cached"),l&16&&se(s,"width",o[4]+"px"),l&32&&se(s,"height",o[5]+"px"),l&4&&y(s,"width",o[2]),l&8&&y(s,"height",o[3]),l&128&&Pe(s,"hidden",o[7]!=="live"),l&16&&se(e,"width",o[4]+"px"),l&32&&se(e,"height",o[5]+"px"),l&64&&Pe(e,"spinner",o[6])},i:pe,o:pe,d(o){o&&K(e),t[14](null),t[15](null)}}}function to(t){try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n[n.length-1]}catch{const e=t.split("?")[0].split("/");return e[e.length-1]}}function no(t,e,n){let{source:i}=e,{attrs:r}=e,{thumbDatasetIndex:s=void 0}=e,{thumbAspectRatio:o=1}=e,{cssSize:l=120}=e,{max_size:a=512}=e;const h="/zowser/";let f,_,b=l,p=l;o>1?p=b/o:o<1&&(b=p*o);let d=b,v=p,A=!0,I="none";const F=new AbortController;async function P(){const w=to(i);console.log(h);const c=`${h}thumbs/${w}.jpg`,u=new Image;return u.decoding="async",u.referrerPolicy="no-referrer",new Promise(m=>{u.onload=()=>{n(7,I="cached"),n(6,A=!1),n(1,_.src=c,_),m(!0)},u.onerror=()=>m(!1),u.src=c})}async function J(){n(7,I="live");const w=await xs(i,r,s,a,F.signal);if(!w){console.warn("Thumbnail generation skipped/failed:",i);return}const{rgb:c,width:u,height:m}=w;n(2,b=u),n(3,p=m);let k=Math.max(b,p)/l;k<1&&(k=1),n(4,d=b/k),n(5,v=p/k),await Tr(),f.getContext("2d").putImageData(new ImageData(c,b,p),0,0),n(6,A=!1)}Qt(async()=>{await P()||await J()}),xn(()=>F.abort());function $(w){_t[w?"unshift":"push"](()=>{_=w,n(1,_)})}function V(w){_t[w?"unshift":"push"](()=>{f=w,n(0,f)})}return t.$$set=w=>{"source"in w&&n(8,i=w.source),"attrs"in w&&n(9,r=w.attrs),"thumbDatasetIndex"in w&&n(10,s=w.thumbDatasetIndex),"thumbAspectRatio"in w&&n(11,o=w.thumbAspectRatio),"cssSize"in w&&n(12,l=w.cssSize),"max_size"in w&&n(13,a=w.max_size)},[f,_,b,p,d,v,A,I,i,r,s,o,l,a,$,V]}class br extends Je{constructor(e){super(),Ge(this,e,no,eo,Be,{source:8,attrs:9,thumbDatasetIndex:10,thumbAspectRatio:11,cssSize:12,max_size:13})}}const io="/zowser/ome-logomark.svg",ro=[{name:"vizarr",logo:"/vizarr_logo.png",href:"https://hms-dbmi.github.io/vizarr/?source="},{name:"itk-vtk-viewer",logo:"/itkvtk_logo.png",href:"https://kitware.github.io/itk-vtk-viewer/app/?rotate=false&fileToLoad="},{name:"neuroglancer",logo:"/neuroglancer.png","//":"NB: The {URL} in the href is replaced with NGFF image URL",href:"https://neuroglancer-demo.appspot.com/#!{%22layers%22:[{%22source%22:%22{URL}%22,%22name%22:%22OME-NGFF%22}]}"},{name:"Vol-E viewer",logo:"/aics_website-3d-cell-viewer.png",href:"https://volumeviewer.allencell.org/viewer?url="},{name:"napari",logo:"/napari.png",html:"<p>See <a href='https://napari.org/'>napari.org</a> for install instructions.</p><p>Then <code>napari {URL}</code>"},{name:"MoBIE",logo:"/MoBIE.jpeg",html:"<p><a href='https://github.com/mobie/mobie-viewer-fiji/'>MoBIE</a> plugin for ImageJ/Fiji. See <a href='https://omero-guides.readthedocs.io/en/latest/fiji/docs/view_mobie_zarr.html'>MoBIE guide</a> for installation. Plugins > BigDataViewer > OME ZARR > <br> Open OME ZARR from S3…. <code>{URL}</code>"}],so={viewers:ro},oo="/zowser/vizarr_logo.png",yr="/zowser/copy.png";function Fi(t,e,n){const i=t.slice();return i[8]=e[n],i[10]=n,i}function lo(t){let e,n,i,r,s,o,l,a;function h(){return t[7](t[10])}return{c(){e=E("button"),n=E("img"),r=H(),s=E("img"),y(n,"class","viewer_icon"),rt(n.src,i=t[8].logo_path)||y(n,"src",i),y(n,"alt","Viewer Icon"),y(s,"class","smallCopyBtn"),rt(s.src,o=yr)||y(s,"src",o),y(s,"alt","Copy Icon"),Pe(s,"shaking",t[3][t[10]]),y(e,"class","inlineButton"),y(e,"title","Copy URL")},m(f,_){G(f,e,_),g(e,n),g(e,r),g(e,s),l||(a=we(e,"click",h),l=!0)},p(f,_){t=f,_&4&&!rt(n.src,i=t[8].logo_path)&&y(n,"src",i),_&8&&Pe(s,"shaking",t[3][t[10]])},d(f){f&&K(e),l=!1,a()}}}function ao(t){let e,n,i,r,s;return{c(){e=E("a"),n=E("img"),y(n,"class","viewer_icon"),rt(n.src,i=t[8].logo_path)||y(n,"src",i),y(n,"alt","Viewer logo"),y(e,"class","inlineButton"),y(e,"title",r="View "+t[1]+" in "+t[8].name),y(e,"target","_blank"),y(e,"href",s=t[8].href)},m(o,l){G(o,e,l),g(e,n)},p(o,l){l&4&&!rt(n.src,i=o[8].logo_path)&&y(n,"src",i),l&6&&r!==(r="View "+o[1]+" in "+o[8].name)&&y(e,"title",r),l&4&&s!==(s=o[8].href)&&y(e,"href",s)},d(o){o&&K(e)}}}function Di(t){let e,n=t[8].html.replace("{URL}",t[0])+"";return{c(){e=E("div"),y(e,"class","viewer_html")},m(i,r){G(i,e,r),e.innerHTML=n},p(i,r){r&5&&n!==(n=i[8].html.replace("{URL}",i[0])+"")&&(e.innerHTML=n)},d(i){i&&K(e)}}}function Ni(t){let e,n,i;function r(a,h){return a[8].href?ao:lo}let s=r(t),o=s(t),l=t[8].html&&Di(t);return{c(){e=E("div"),o.c(),n=H(),l&&l.c(),i=H(),y(e,"class","viewerItem")},m(a,h){G(a,e,h),o.m(e,null),g(e,n),l&&l.m(e,null),g(e,i)},p(a,h){s===(s=r(a))&&o?o.p(a,h):(o.d(1),o=s(a),o&&(o.c(),o.m(e,n))),a[8].html?l?l.p(a,h):(l=Di(a),l.c(),l.m(e,i)):l&&(l.d(1),l=null)},d(a){a&&K(e),o.d(),l&&l.d()}}}function uo(t){let e,n,i,r,s,o,l,a,h,f,_,b,p,d=xe(t[2]),v=[];for(let A=0;A<d.length;A+=1)v[A]=Ni(Fi(t,d,A));return{c(){e=E("div"),n=E("div"),i=E("button"),r=E("img"),o=H(),l=E("a"),a=E("img"),_=H();for(let A=0;A<v.length;A+=1)v[A].c();y(r,"class","viewer_icon"),rt(r.src,s=yr)||y(r,"src",s),Pe(r,"shaking",t[3].bigCopyButton),y(i,"class","inlineButton"),y(i,"title","Copy URL"),y(a,"class","viewer_icon"),rt(a.src,h=io)||y(a,"src",h),y(a,"alt","Validator"),y(l,"class","inlineButton"),y(l,"title","Validate NGFF"),y(l,"target","_blank"),y(l,"href",f=`https://ome.github.io/ome-ngff-validator/?source=${t[0]}`),y(n,"class","viewerRow"),y(e,"class","openwith")},m(A,I){G(A,e,I),g(e,n),g(n,i),g(i,r),g(n,o),g(n,l),g(l,a),g(n,_);for(let F=0;F<v.length;F+=1)v[F]&&v[F].m(n,null);b||(p=we(i,"click",t[6]),b=!0)},p(A,[I]){if(I&8&&Pe(r,"shaking",A[3].bigCopyButton),I&1&&f!==(f=`https://ome.github.io/ome-ngff-validator/?source=${A[0]}`)&&y(l,"href",f),I&31){d=xe(A[2]);let F;for(F=0;F<d.length;F+=1){const P=Fi(A,d,F);v[F]?v[F].p(P,I):(v[F]=Ni(P),v[F].c(),v[F].m(n,null))}for(;F<v.length;F+=1)v[F].d(1);v.length=d.length}},i:pe,o:pe,d(A){A&&K(e),Dt(v,A),b=!1,p()}}}function co(t,e,n){let{source:i}=e,{dtype:r}=e,{version:s}=e,o=so.viewers.map(_=>{let b=_.href;b&&(b=b.includes("{URL}")?b.replace("{URL}",i):b+i);const p=oo.replace("/vizarr_logo.png",_.logo);return{..._,href:b,logo_path:p}});s==="0.5"&&(o=o.filter(_=>_.name!=="itk-vtk-viewer"));let l={};function a(_,b){const p=document.createElement("textarea");p.value=_,document.body.appendChild(p),p.select(),document.execCommand("copy"),document.body.removeChild(p),n(3,l[b]=!0,l),setTimeout(()=>n(3,l[b]=!1,l),1e3)}const h=()=>a(i,"bigCopyButton"),f=_=>a(i,_);return t.$$set=_=>{"source"in _&&n(0,i=_.source),"dtype"in _&&n(1,r=_.dtype),"version"in _&&n(5,s=_.version)},[i,r,o,l,a,s,h,f]}class fo extends Je{constructor(e){super(),Ge(this,e,co,uo,Be,{source:0,dtype:1,version:5})}}function Pi(t,e,n){const i=t.slice();return i[14]=e[n],i}function Bi(t){let e,n;return e=new br({props:{source:t[4],attrs:t[3],max_size:2e3,thumbDatasetIndex:t[5],thumbAspectRatio:t[6]}}),{c(){Ke(e.$$.fragment)},m(i,r){je(e,i,r),n=!0},p(i,r){const s={};r&16&&(s.source=i[4]),r&8&&(s.attrs=i[3]),r&32&&(s.thumbDatasetIndex=i[5]),r&64&&(s.thumbAspectRatio=i[6]),e.$set(s)},i(i){n||(oe(e.$$.fragment,i),n=!0)},o(i){ce(e.$$.fragment,i),n=!1},d(i){Ve(e,i)}}}function Ui(t){let e=t[14].toUpperCase()+"",n,i,r=t[0][`size_${t[14]}`]+"",s,o;return{c(){n=X(e),i=X(":"),s=X(r),o=X("  ")},m(l,a){G(l,n,a),G(l,i,a),G(l,s,a),G(l,o,a)},p(l,a){a&1&&r!==(r=l[0][`size_${l[14]}`]+"")&&Ne(s,r)},d(l){l&&(K(n),K(i),K(s),K(o))}}}function xi(t){let e,n=t[0][`size_${t[14]}`]!==void 0&&Ui(t);return{c(){n&&n.c(),e=mn()},m(i,r){n&&n.m(i,r),G(i,e,r)},p(i,r){i[0][`size_${i[14]}`]!==void 0?n?n.p(i,r):(n=Ui(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(i){i&&K(e),n&&n.d(i)}}}function ho(t){let e,n,i=dn(t[0].written)+"",r;return{c(){e=E("div"),n=X("Data size: "),r=X(i)},m(s,o){G(s,e,o),g(e,n),g(e,r)},p(s,o){o&1&&i!==(i=dn(s[0].written)+"")&&Ne(r,i)},d(s){s&&K(e)}}}function _o(t){let e,n,i=t[0].shards+"",r;return{c(){e=E("div"),n=X("Shard shape: "),r=X(i)},m(s,o){G(s,e,o),g(e,n),g(e,r)},p(s,o){o&1&&i!==(i=s[0].shards+"")&&Ne(r,i)},d(s){s&&K(e)}}}function go(t){let e,n,i=t[0].chunks+"",r;return{c(){e=E("div"),n=X("Chunk shape: "),r=X(i)},m(s,o){G(s,e,o),g(e,n),g(e,r)},p(s,o){o&1&&i!==(i=s[0].chunks+"")&&Ne(r,i)},d(s){s&&K(e)}}}function mo(t){let e,n,i,r,s,o,l=t[9](t[0].url)+"",a,h,f,_=(t[0].name?t[0].name.replaceAll(t[1],`<mark>${t[1]}</mark>`):"")+"",b,p,d,v=t[7].replaceAll(t[1],`<mark>${t[1]}</mark>`)+"",A,I,F,P,J,$,V,w,c,u=t[3]&&Bi(t);I=new fo({props:{source:t[0].url,dtype:po,version:bo}});let m=xe(["t","c","z","y","x"]),k=[];for(let O=0;O<5;O+=1)k[O]=xi(Pi(t,m,O));function C(O,j){return O[2]=="chunk_pixels"?go:O[2]=="shard_pixels"?_o:ho}let L=C(t),N=L(t);return{c(){e=E("div"),n=E("div"),u&&u.c(),i=H(),r=E("div"),s=E("div"),o=E("strong"),h=H(),f=E("div"),p=H(),d=E("div"),A=H(),Ke(I.$$.fragment),F=H(),P=E("div"),J=X(`Image size:
      `);for(let O=0;O<5;O+=1)k[O].c();$=H(),N.c(),y(n,"class","thumbWrapper svelte-e0c7t6"),y(s,"title",a=t[0].url),y(f,"class",b=hi(t[1]==""?"hideOnSmall":"")+" svelte-e0c7t6"),y(e,"class","zarr-list-item svelte-e0c7t6")},m(O,j){G(O,e,j),g(e,n),u&&u.m(n,null),g(e,i),g(e,r),g(r,s),g(s,o),o.innerHTML=l,g(r,h),g(r,f),f.innerHTML=_,g(r,p),g(r,d),d.innerHTML=v,g(r,A),je(I,r,null),g(r,F),g(r,P),g(P,J);for(let z=0;z<5;z+=1)k[z]&&k[z].m(P,null);g(r,$),N.m(r,null),V=!0,w||(c=we(n,"click",t[8]),w=!0)},p(O,[j]){O[3]?u?(u.p(O,j),j&8&&oe(u,1)):(u=Bi(O),u.c(),oe(u,1),u.m(n,null)):u&&(Xt(),ce(u,1,1,()=>{u=null}),$t()),(!V||j&1)&&l!==(l=O[9](O[0].url)+"")&&(o.innerHTML=l),(!V||j&1&&a!==(a=O[0].url))&&y(s,"title",a),(!V||j&3)&&_!==(_=(O[0].name?O[0].name.replaceAll(O[1],`<mark>${O[1]}</mark>`):"")+"")&&(f.innerHTML=_),(!V||j&2&&b!==(b=hi(O[1]==""?"hideOnSmall":"")+" svelte-e0c7t6"))&&y(f,"class",b),(!V||j&130)&&v!==(v=O[7].replaceAll(O[1],`<mark>${O[1]}</mark>`)+"")&&(d.innerHTML=v);const z={};if(j&1&&(z.source=O[0].url),I.$set(z),j&1){m=xe(["t","c","z","y","x"]);let B;for(B=0;B<5;B+=1){const M=Pi(O,m,B);k[B]?k[B].p(M,j):(k[B]=xi(M),k[B].c(),k[B].m(P,null))}for(;B<5;B+=1)k[B].d(1)}L===(L=C(O))&&N?N.p(O,j):(N.d(1),N=L(O),N&&(N.c(),N.m(r,null)))},i(O){V||(oe(u),oe(I.$$.fragment,O),V=!0)},o(O){ce(u),ce(I.$$.fragment,O),V=!1},d(O){O&&K(e),u&&u.d(),Ve(I),Dt(k,O),N.d(),w=!1,c()}}}let po="image",bo="0.5";function yo(t,e,n){let i,{rowData:r}=e,{textFilter:s}=e,{sortedBy:o=void 0}=e,l,a,h,f=1;const _=new AbortController;if(r.size_x&&r.size_y){let d=Math.max(r.size_x,r.size_y);for(h=0;d>256;)h+=1,d=d/2;f=r.size_x/r.size_y}function b(){console.log("Clicked on thumbnail"),He.setSelectedRow(r)}function p(d){if(s&&d.toLowerCase().includes(s.toLowerCase())){let A=d.toLowerCase(),I=s.toLowerCase(),F=A.indexOf(I),P=Math.max(0,Math.min(F,d.length-50)),J=d.substring(P,F);return J+="<mark>",J+=d.substring(F,F+I.length),J+="</mark>",J+=d.substring(F+I.length),J}return d.split("/").pop()}return Qt(async()=>{let d=r.url;r.series0!==void 0&&(d+="/"+r.series0);let v=await Bt(d,_.signal);n(3,l=v[0]),n(4,a=v[1]),v[2]}),xn(()=>{_.abort()}),t.$$set=d=>{"rowData"in d&&n(0,r=d.rowData),"textFilter"in d&&n(1,s=d.textFilter),"sortedBy"in d&&n(2,o=d.sortedBy)},t.$$.update=()=>{var d;t.$$.dirty&3&&n(7,i=s!=""&&((d=r.description)!=null&&d.toLowerCase().includes(s.toLowerCase()))?r.description:"")},[r,s,o,l,a,h,f,i,b,p]}class vo extends Je{constructor(e){super(),Ge(this,e,yo,mo,Be,{rowData:0,textFilter:1,sortedBy:2})}}function wo(t){let e,n,i,r;return n=new vo({props:{rowData:t[0][t[13]],textFilter:t[1],sortedBy:t[2]}}),{c(){e=E("div"),Ke(n.$$.fragment),y(e,"slot","item"),y(e,"style",i=t[12]),y(e,"class","row svelte-1xlep2t")},m(s,o){G(s,e,o),je(n,e,null),r=!0},p(s,o){const l={};o&8193&&(l.rowData=s[0][s[13]]),o&2&&(l.textFilter=s[1]),o&4&&(l.sortedBy=s[2]),n.$set(l),(!r||o&4096&&i!==(i=s[12]))&&y(e,"style",i)},i(s){r||(oe(n.$$.fragment,s),r=!0)},o(s){ce(n.$$.fragment,s),r=!1},d(s){s&&K(e),Ve(n)}}}function ko(t){let e=!1,n=()=>{e=!1},i,r,s,o=`${t[5]}px`,l,a,h;return st(t[8]),st(t[9]),s=new $s({props:{width:"100%",height:t[5],itemCount:t[0].length,itemSize:160,getKey:t[6],$$slots:{item:[wo,({style:f,index:_})=>({12:f,13:_}),({style:f,index:_})=>(f?4096:0)|(_?8192:0)]},$$scope:{ctx:t}}}),s.$on("afterScroll",t[7]),{c(){r=E("div"),Ke(s.$$.fragment),y(r,"class","imageListContainer svelte-1xlep2t"),se(r,"height",o)},m(f,_){G(f,r,_),je(s,r,null),t[10](r),l=!0,a||(h=[we(window,"resize",t[8]),we(window,"scroll",()=>{e=!0,clearTimeout(i),i=setTimeout(n,100),t[9]()})],a=!0)},p(f,[_]){_&16&&!e&&(e=!0,clearTimeout(i),scrollTo(window.pageXOffset,f[4]),i=setTimeout(n,100));const b={};_&32&&(b.height=f[5]),_&1&&(b.itemCount=f[0].length),_&28679&&(b.$$scope={dirty:_,ctx:f}),s.$set(b),_&32&&o!==(o=`${f[5]}px`)&&se(r,"height",o)},i(f){l||(oe(s.$$.fragment,f),l=!0)},o(f){ce(s.$$.fragment,f),l=!1},d(f){f&&K(r),Ve(s),t[10](null),a=!1,lt(h)}}}function Eo(t,e,n){let i,{tableRows:r}=e,{textFilter:s}=e,{sortedBy:o=void 0}=e;function l(v){return r[v].url}let a,h=0,f=0;function _(v){let I=a.offsetTop-20;v.detail.offset-f<0&&h>I&&n(4,h-=1),f=v.detail.offset}function b(){n(5,i=window.innerHeight)}function p(){n(4,h=window.pageYOffset)}function d(v){_t[v?"unshift":"push"](()=>{a=v,n(3,a)})}return t.$$set=v=>{"tableRows"in v&&n(0,r=v.tableRows),"textFilter"in v&&n(1,s=v.textFilter),"sortedBy"in v&&n(2,o=v.sortedBy)},n(5,i=0),[r,s,o,a,h,i,l,_,b,p,d]}class Co extends Je{constructor(e){super(),Ge(this,e,Eo,ko,Be,{tableRows:0,textFilter:1,sortedBy:2})}}function ji(t){let e,n;return e=new br({props:{source:t[1],attrs:t[0],cssSize:512,max_size:2e3,thumbDatasetIndex:t[2],thumbAspectRatio:t[3]}}),{c(){Ke(e.$$.fragment)},m(i,r){je(e,i,r),n=!0},p(i,r){const s={};r&2&&(s.source=i[1]),r&1&&(s.attrs=i[0]),r&4&&(s.thumbDatasetIndex=i[2]),r&8&&(s.thumbAspectRatio=i[3]),e.$set(s)},i(i){n||(oe(e.$$.fragment,i),n=!0)},o(i){ce(e.$$.fragment,i),n=!1},d(i){Ve(e,i)}}}function Ao(t){let e,n,i=t[0]&&ji(t);return{c(){i&&i.c(),e=mn()},m(r,s){i&&i.m(r,s),G(r,e,s),n=!0},p(r,[s]){r[0]?i?(i.p(r,s),s&1&&oe(i,1)):(i=ji(r),i.c(),oe(i,1),i.m(e.parentNode,e)):i&&(Xt(),ce(i,1,1,()=>{i=null}),$t())},i(r){n||(oe(i),n=!0)},o(r){ce(i),n=!1},d(r){r&&K(e),i&&i.d(r)}}}function Io(t,e,n){let{rowData:i}=e;console.log("ThumbLoader",i);let r,s,o,l=1;if(i.size_x&&i.size_y){let a=Math.max(i.size_x,i.size_y);for(o=0;a>1024;)o+=1,a=a/2;l=i.size_x/i.size_y}else o=void 0,l=1;return Qt(async()=>{let a=await Bt(i.url);n(0,r=a[0]),n(1,s=a[1]),a[2]}),t.$$set=a=>{"rowData"in a&&n(4,i=a.rowData)},[r,s,o,l,i]}class So extends Je{constructor(e){super(),Ge(this,e,Io,Ao,Be,{rowData:4})}}function Vi(t,e,n){const i=t.slice();return i[5]=e[n][0],i[6]=e[n][1],i}function Wi(t){let e,n;return e=new So({props:{rowData:t[1]}}),{c(){Ke(e.$$.fragment)},m(i,r){je(e,i,r),n=!0},p(i,r){const s={};r&2&&(s.rowData=i[1]),e.$set(s)},i(i){n||(oe(e.$$.fragment,i),n=!0)},o(i){ce(e.$$.fragment,i),n=!1},d(i){Ve(e,i)}}}function qi(t){let e,n,i=t[2]&&Wi(t);return{c(){i&&i.c(),e=mn()},m(r,s){i&&i.m(r,s),G(r,e,s),n=!0},p(r,s){r[2]?i?(i.p(r,s),s&4&&oe(i,1)):(i=Wi(r),i.c(),oe(i,1),i.m(e.parentNode,e)):i&&(Xt(),ce(i,1,1,()=>{i=null}),$t())},i(r){n||(oe(i),n=!0)},o(r){ce(i),n=!1},d(r){r&&K(e),i&&i.d(r)}}}function Hi(t){let e,n=xe(Object.entries(t[1])),i=[];for(let r=0;r<n.length;r+=1)i[r]=Ki(Vi(t,n,r));return{c(){e=E("table");for(let r=0;r<i.length;r+=1)i[r].c()},m(r,s){G(r,e,s);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(e,null)},p(r,s){if(s&2){n=xe(Object.entries(r[1]));let o;for(o=0;o<n.length;o+=1){const l=Vi(r,n,o);i[o]?i[o].p(l,s):(i[o]=Ki(l),i[o].c(),i[o].m(e,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}},d(r){r&&K(e),Dt(i,r)}}}function Ki(t){let e,n,i=t[5]+"",r,s,o=t[6]+"",l;return{c(){e=E("tr"),n=E("td"),r=X(i),s=E("td"),l=X(o)},m(a,h){G(a,e,h),g(e,n),g(n,r),g(e,s),g(s,l)},p(a,h){h&2&&i!==(i=a[5]+"")&&Ne(r,i),h&2&&o!==(o=a[6]+"")&&Ne(l,o)},d(a){a&&K(e)}}}function zo(t){let e,n,i,r,s=t[2],o,l,a,h,f=qi(t),_=t[1]&&Hi(t);return{c(){e=E("div"),n=E("button"),n.textContent="×",i=H(),r=E("div"),f.c(),o=H(),_&&_.c(),y(n,"class","close svelte-1g3sjso"),y(n,"title","Close"),y(r,"class","scrollable svelte-1g3sjso"),y(e,"id","mypopover"),y(e,"popover",""),y(e,"class","svelte-1g3sjso")},m(b,p){G(b,e,p),g(e,n),g(e,i),g(e,r),f.m(r,null),g(r,o),_&&_.m(r,null),t[4](e),l=!0,a||(h=we(n,"click",t[3]),a=!0)},p(b,[p]){p&4&&Be(s,s=b[2])?(Xt(),ce(f,1,1,pe),$t(),f=qi(b),f.c(),oe(f,1),f.m(r,o)):f.p(b,p),b[1]?_?_.p(b,p):(_=Hi(b),_.c(),_.m(r,null)):_&&(_.d(1),_=null)},i(b){l||(oe(f),l=!0)},o(b){ce(f),l=!1},d(b){b&&K(e),f.d(b),_&&_.d(),t[4](null),a=!1,h()}}}function To(t,e,n){let i,r,s;He.subscribeSelectedRow(a=>{console.log("Showing preview for",a),a&&(n(1,r=a),console.log("Showing Thumb preview for",a,r),n(2,s=r.url),i.showPopover())});function o(){i.hidePopover()}Qt(()=>{console.log("Mounted popover",i),i&&i.addEventListener("toggle",a=>{a.newState==="open"||(console.log("Popover has been hidden"),He.setSelectedRow(null))})});function l(a){_t[a?"unshift":"push"](()=>{i=a,n(0,i)})}return[i,r,s,o,l]}class Ro extends Je{constructor(e){super(),Ge(this,e,To,zo,Be,{})}}const Oo="/zowser/selectCaret.svg",Lo="/zowser/samples/sample_zarrs_hydrated.csv",Mo="/zowser/ome-main-nav.svg";function Fo(t){let e,n,i,r,s,o,l,a,h,f,_,b,p;return{c(){e=E("base"),n=H(),i=E("nav"),r=E("a"),s=E("img"),l=H(),a=E("a"),h=E("h2"),h.textContent="Zowser — an OME-Zarr browser",f=H(),_=E("div"),b=H(),p=E("a"),p.textContent="About",y(e,"href",t[0]),y(s,"alt","OME Logo"),rt(s.src,o=Mo)||y(s,"src",o),y(s,"class","svelte-qxzspo"),y(r,"class","logolink svelte-qxzspo"),y(r,"href",t[0]),y(h,"class","svelte-qxzspo"),y(a,"href",t[0]),y(a,"class","svelte-qxzspo"),se(_,"flex","1"),y(p,"href","about/"),y(p,"class","svelte-qxzspo"),y(i,"class","svelte-qxzspo")},m(d,v){G(d,e,v),G(d,n,v),G(d,i,v),g(i,r),g(r,s),g(i,l),g(i,a),g(a,h),g(i,f),g(i,_),g(i,b),g(i,p)},p:pe,i:pe,o:pe,d(d){d&&(K(e),K(n),K(i))}}}function Do(t){let e="/zowser/";return console.log("Nav base",e),[e]}class No extends Je{constructor(e){super(),Ge(this,e,Do,Fo,Be,{})}}function Po(t,e,n){const i=t.slice();return i[28]=e[n],i}function Gi(t,e,n){const i=t.slice();return i[31]=e[n],i}function Ji(t,e,n){const i=t.slice();return i[31]=e[n],i}function Yi(t){let e,n=t[31]+"",i,r;return{c(){e=E("option"),i=X(n),e.__value=r=t[3][t[31]],Ae(e,e.__value)},m(s,o){G(s,e,o),g(e,i)},p(s,o){o[0]&8&&n!==(n=s[31]+"")&&Ne(i,n),o[0]&8&&r!==(r=s[3][s[31]])&&(e.__value=r,Ae(e,e.__value))},d(s){s&&K(e)}}}function Zi(t,e){let n,i=e[31]+"",r,s;return{key:t,first:null,c(){n=E("option"),r=X(i),n.__value=s=e[4][e[31]],Ae(n,n.__value),this.first=n},m(o,l){G(o,n,l),g(n,r)},p(o,l){e=o,l[0]&16&&i!==(i=e[31]+"")&&Ne(r,i),l[0]&16&&s!==(s=e[4][e[31]])&&(n.__value=s,Ae(n,n.__value))},d(o){o&&K(n)}}}function Bo(t){let e;return{c(){e=E("option"),e.textContent=`Size: ${t[28].toUpperCase()}`,e.__value="size_"+t[28],Ae(e,e.__value)},m(n,i){G(n,e,i)},p:pe,d(n){n&&K(e)}}}function Uo(t){let e,n,i,r,s,o,l,a,h=t[11].split("/").pop()+"",f,_,b=dn(t[2])+"",p,d,v,A,I,F,P,J,$,V,w,c,u,m,k,C,L,N=t[10]!==""?"All Dimensions":"Dimension Count",O,j,z,B,M,be,ge,R,Z,S,U,Q,W,Y,D=t[9]==""?"Organism":"All Organisms",x,le,me,ne,fe,de,ae,Ee,he,Se,Me=t[8]==""?"Imaging Modality":"All Modalities",ze,ue,ie=[],Xe=new Map,re,Ye,Ce,$e,Ze,We,Qe,Te,at,ke,Fe,et,$n,ei,mt,pt,bt,ti,nn,ut,ni,yt,tt,ii,rn=t[0].length+"",bn,ri,yn,si,oi,ct,De,vn,li;e=new Ro({});let vt=xe(Object.keys(t[3]).sort()),Oe=[];for(let T=0;T<vt.length;T+=1)Oe[T]=Yi(Ji(t,vt,T));let sn=xe(Object.keys(t[4]).sort());const ai=T=>T[31];for(let T=0;T<sn.length;T+=1){let ee=Gi(t,sn,T),ye=ai(ee);Xe.set(ye,ie[T]=Zi(ye,ee))}let vr=xe(["x","y","z","c","t"]),Rt=[];for(let T=0;T<5;T+=1)Rt[T]=Bo(Po(t,vr,T));return ut=new qs({props:{toggleAscending:t[12],sortAscending:t[6]}}),ct=new Co({props:{tableRows:t[0],textFilter:t[7],sortedBy:t[5]}}),{c(){Ke(e.$$.fragment),n=H(),i=E("main"),r=E("div"),s=E("h3"),o=E("div"),l=X(`Showing Collection:
        `),a=E("a"),f=X(h),_=X(`
        (`),p=X(b),d=X(")"),v=H(),A=E("div"),I=E("input"),F=H(),P=E("button"),J=X("×"),$=H(),V=E("div"),w=E("div"),c=E("div"),u=E("div"),u.textContent="Filter by:",m=H(),k=E("div"),C=E("select"),L=E("option"),O=X(N),j=E("hr"),z=E("option"),z.textContent="2D",B=E("option"),B.textContent="3D",M=E("option"),M.textContent="4D",be=E("option"),be.textContent="5D",ge=H(),R=E("div"),Z=E("button"),S=X("×"),U=H(),Q=E("div"),W=E("select"),Y=E("option"),x=X(D),le=E("hr");for(let T=0;T<Oe.length;T+=1)Oe[T].c();me=H(),ne=E("div"),fe=E("button"),de=X("×"),ae=H(),Ee=E("div"),he=E("select"),Se=E("option"),ze=X(Me),ue=E("hr");for(let T=0;T<ie.length;T+=1)ie[T].c();re=H(),Ye=E("div"),Ce=E("button"),$e=X("×"),Ze=H(),We=E("div"),Qe=H(),Te=E("div"),Te.textContent="Sort by:",at=H(),ke=E("div"),Fe=E("select"),et=E("option"),et.textContent="--",$n=E("hr");for(let T=0;T<5;T+=1)Rt[T].c();ei=E("hr"),mt=E("option"),mt.textContent="Data Size (bytes)",pt=E("option"),pt.textContent="Chunk Size (pixels)",bt=E("option"),bt.textContent="Shard Size (pixels)",ti=H(),nn=E("div"),Ke(ut.$$.fragment),ni=H(),yt=E("div"),tt=E("h3"),ii=X("Showing "),bn=X(rn),ri=X(" out of "),yn=X(t[1]),si=X(" images"),oi=H(),Ke(ct.$$.fragment),y(a,"href",t[11]),se(o,"font-size","90%"),se(s,"text-align","center"),y(I,"placeholder","Filter by Name or Description"),y(I,"name","textFilter"),y(I,"class","svelte-cmksur"),y(P,"title","Clear Filter"),se(P,"visibility",t[7]!==""?"visible":"hidden"),y(P,"class","svelte-cmksur"),y(A,"class","textInputWrapper svelte-cmksur"),y(r,"class","summary svelte-cmksur"),se(u,"white-space","nowrap"),L.__value="",Ae(L,L.__value),z.__value="2",Ae(z,z.__value),B.__value="3",Ae(B,B.__value),M.__value="4",Ae(M,M.__value),be.__value="5",Ae(be,be.__value),y(C,"class","svelte-cmksur"),t[10]===void 0&&st(()=>t[19].call(C)),y(Z,"title","Clear Filter"),se(Z,"visibility",t[10]!==""?"visible":"hidden"),y(Z,"class","svelte-cmksur"),y(R,"class","svelte-cmksur"),y(k,"class","selectWrapper svelte-cmksur"),Y.__value="",Ae(Y,Y.__value),y(W,"class","svelte-cmksur"),t[9]===void 0&&st(()=>t[20].call(W)),y(fe,"title","Clear Filter"),se(fe,"visibility",t[9]!==""?"visible":"hidden"),y(fe,"class","svelte-cmksur"),y(ne,"class","svelte-cmksur"),y(Q,"class","selectWrapper svelte-cmksur"),Se.__value="",Ae(Se,Se.__value),y(he,"class","svelte-cmksur"),t[8]===void 0&&st(()=>t[21].call(he)),y(Ce,"title","Clear Filter"),se(Ce,"visibility",t[8]!==""?"visible":"hidden"),y(Ce,"class","svelte-cmksur"),y(Ye,"class","svelte-cmksur"),y(Ee,"class","selectWrapper svelte-cmksur"),y(We,"class","clear"),et.__value="",Ae(et,et.__value),mt.__value="written",Ae(mt,mt.__value),pt.__value="chunk_pixels",Ae(pt,pt.__value),bt.__value="shard_pixels",Ae(bt,bt.__value),y(Fe,"class","svelte-cmksur"),y(nn,"class","svelte-cmksur"),y(ke,"class","selectWrapper svelte-cmksur"),y(c,"class","filters svelte-cmksur"),y(w,"class","sidebar svelte-cmksur"),se(tt,"margin-left","15px"),y(tt,"class","svelte-cmksur"),y(yt,"class","results svelte-cmksur"),y(V,"class","sidebarContainer svelte-cmksur"),se(i,"--form-select-bg-img","url('"+Oo+"')"),y(i,"class","svelte-cmksur")},m(T,ee){je(e,T,ee),G(T,n,ee),G(T,i,ee),g(i,r),g(r,s),g(s,o),g(o,l),g(o,a),g(a,f),g(o,_),g(o,p),g(o,d),g(r,v),g(r,A),g(A,I),Ae(I,t[7]),g(A,F),g(A,P),g(P,J),g(i,$),g(i,V),g(V,w),g(w,c),g(c,u),g(c,m),g(c,k),g(k,C),g(C,L),g(L,O),g(C,j),g(C,z),g(C,B),g(C,M),g(C,be),wt(C,t[10],!0),g(k,ge),g(k,R),g(R,Z),g(Z,S),g(c,U),g(c,Q),g(Q,W),g(W,Y),g(Y,x),g(W,le);for(let ye=0;ye<Oe.length;ye+=1)Oe[ye]&&Oe[ye].m(W,null);wt(W,t[9],!0),g(Q,me),g(Q,ne),g(ne,fe),g(fe,de),g(c,ae),g(c,Ee),g(Ee,he),g(he,Se),g(Se,ze),g(he,ue);for(let ye=0;ye<ie.length;ye+=1)ie[ye]&&ie[ye].m(he,null);wt(he,t[8],!0),g(Ee,re),g(Ee,Ye),g(Ye,Ce),g(Ce,$e),g(c,Ze),g(c,We),g(c,Qe),g(c,Te),g(c,at),g(c,ke),g(ke,Fe),g(Fe,et),g(Fe,$n);for(let ye=0;ye<5;ye+=1)Rt[ye]&&Rt[ye].m(Fe,null);g(Fe,ei),g(Fe,mt),g(Fe,pt),g(Fe,bt),g(ke,ti),g(ke,nn),je(ut,nn,null),g(V,ni),g(V,yt),g(yt,tt),g(tt,ii),g(tt,bn),g(tt,ri),g(tt,yn),g(tt,si),g(yt,oi),je(ct,yt,null),De=!0,vn||(li=[we(I,"input",t[18]),we(I,"input",t[17]),we(P,"click",t[17]),we(C,"change",t[19]),we(C,"change",t[14]),we(Z,"click",t[14]),we(W,"change",t[20]),we(W,"change",t[15]),we(fe,"click",t[15]),we(he,"change",t[21]),we(he,"change",t[16]),we(Ce,"click",t[16]),we(Fe,"change",t[13])],vn=!0)},p(T,ee){if((!De||ee[0]&4)&&b!==(b=dn(T[2])+"")&&Ne(p,b),ee[0]&128&&I.value!==T[7]&&Ae(I,T[7]),(!De||ee[0]&128)&&se(P,"visibility",T[7]!==""?"visible":"hidden"),(!De||ee[0]&1024)&&N!==(N=T[10]!==""?"All Dimensions":"Dimension Count")&&Ne(O,N),ee[0]&1024&&wt(C,T[10]),(!De||ee[0]&1024)&&se(Z,"visibility",T[10]!==""?"visible":"hidden"),(!De||ee[0]&512)&&D!==(D=T[9]==""?"Organism":"All Organisms")&&Ne(x,D),ee[0]&8){vt=xe(Object.keys(T[3]).sort());let qe;for(qe=0;qe<vt.length;qe+=1){const ui=Ji(T,vt,qe);Oe[qe]?Oe[qe].p(ui,ee):(Oe[qe]=Yi(ui),Oe[qe].c(),Oe[qe].m(W,null))}for(;qe<Oe.length;qe+=1)Oe[qe].d(1);Oe.length=vt.length}ee[0]&520&&wt(W,T[9]),(!De||ee[0]&512)&&se(fe,"visibility",T[9]!==""?"visible":"hidden"),(!De||ee[0]&256)&&Me!==(Me=T[8]==""?"Imaging Modality":"All Modalities")&&Ne(ze,Me),ee[0]&16&&(sn=xe(Object.keys(T[4]).sort()),ie=sr(ie,ee,ai,1,T,sn,Xe,he,Lr,Zi,null,Gi)),ee[0]&272&&wt(he,T[8]),(!De||ee[0]&256)&&se(Ce,"visibility",T[8]!==""?"visible":"hidden");const ye={};ee[0]&64&&(ye.sortAscending=T[6]),ut.$set(ye),(!De||ee[0]&1)&&rn!==(rn=T[0].length+"")&&Ne(bn,rn),(!De||ee[0]&2)&&Ne(yn,T[1]);const on={};ee[0]&1&&(on.tableRows=T[0]),ee[0]&128&&(on.textFilter=T[7]),ee[0]&32&&(on.sortedBy=T[5]),ct.$set(on)},i(T){De||(oe(e.$$.fragment,T),oe(ut.$$.fragment,T),oe(ct.$$.fragment,T),De=!0)},o(T){ce(e.$$.fragment,T),ce(ut.$$.fragment,T),ce(ct.$$.fragment,T),De=!1},d(T){T&&(K(n),K(i)),Ve(e,T),Dt(Oe,T);for(let ee=0;ee<ie.length;ee+=1)ie[ee].d();Dt(Rt,T),Ve(ut),Ve(ct),vn=!1,lt(li)}}}function xo(t,e,n){let i,r,s,o,l=Lo,a=[],h=0,f=0,_={},b={};He.subscribe(m=>{n(0,a=I(m)),n(1,h=m.length),n(2,f=m.reduce((k,C)=>k+parseInt(C.written)||0,0))}),cr.subscribe(m=>{let k={};for(const[C,L]of Object.entries(m))k[L]=C;n(3,_=k)}),fr.subscribe(m=>{let k={};for(const[C,L]of Object.entries(m))k[L]=C;n(4,b=k)}),ar(l,He);let p="",d=!1;function v(){n(6,d=!d),He.sortTable(p,d)}function A(m){n(5,p=m.target.value),p===""?He.sortTable("index",!0):He.sortTable(p,d)}function I(m){if(i!==""&&(m=m.filter(k=>k.dim_count==i)),r!==""&&(m=m.filter(k=>k.organismId==r)),s!=""&&(m=m.filter(k=>k.fbbiId==s)),o&&o!=""){let k=o.toLowerCase();m=m.filter(C=>{var L,N;return C.url.toLowerCase().includes(k)||((L=C.description)==null?void 0:L.toLowerCase().includes(k))||((N=C.name)==null?void 0:N.toLowerCase().includes(k))})}return m}function F(m){n(10,i=m.target.value||""),n(0,a=I(He.getRows()))}function P(m){n(9,r=m.target.value||""),n(0,a=I(He.getRows()))}function J(m){n(8,s=m.target.value||""),n(0,a=I(He.getRows()))}function $(m){n(7,o=m.target.value),n(0,a=I(He.getRows()))}function V(){o=this.value,n(7,o)}function w(){i=En(this),n(10,i)}function c(){r=En(this),n(9,r),n(3,_)}function u(){s=En(this),n(8,s),n(4,b)}return t.$$.update=()=>{t.$$.dirty[0]&1&&a.some(m=>m.source)},n(10,i=""),n(9,r=""),n(8,s=""),n(7,o=""),[a,h,f,_,b,p,d,o,s,r,i,l,v,A,F,P,J,$,V,w,c,u]}class jo extends Je{constructor(e){super(),Ge(this,e,xo,Uo,Be,{},null,[-1,-1])}}const Vo="/zowser/nfdi_rgb_Wortmarke_Zusatz_quer.png",Wo="/zowser/czi-logo-chan-zuckerberg-initiative-logo.png";function qo(t){let e,n,i;return{c(){e=E("base"),n=H(),i=E("div"),i.innerHTML=`<h2>Introduction</h2> <p>Zowser is an OME-Zarr browser based on the <a href="https://forum.image.sc/t/ome2024-ngff-challenge/97363">2024 OME-NGFF Challenge</a>, conceived at the
    <a href="https://www.openmicroscopy.org/events/ome-community-meeting-2024/">OME Annual Community Meeting</a>
    in Dundee in May 2024.</p> <h2>Acknowledgements</h2> <p>Coordination of the challenge was supported by the <a href="https://www.nfdi.de/">German National Research Data Initiative (NFDI)</a>
    and the
    <a href="https://chanzuckerberg.com/">Chan Zuckerberg Initiative</a>:</p> <table><tr><td><img src="${Vo}" alt="NFDI Logo" width="45%"/></td> <td><img src="${Wo}" alt="Chan Zuckerberg Initiative Logo" width="45%"/></td></tr></table>`,y(e,"href",t[0]),y(i,"class","svelte-zlrnwt")},m(r,s){G(r,e,s),G(r,n,s),G(r,i,s)},p:pe,i:pe,o:pe,d(r){r&&(K(e),K(n),K(i))}}}function Ho(t){return["/zowser/"]}class Ko extends Je{constructor(e){super(),Ge(this,e,Ho,qo,Be,{})}}function Go(t){let e,n;return e=new jo({}),{c(){Ke(e.$$.fragment)},m(i,r){je(e,i,r),n=!0},i(i){n||(oe(e.$$.fragment,i),n=!0)},o(i){ce(e.$$.fragment,i),n=!1},d(i){Ve(e,i)}}}function Jo(t){let e,n;return e=new Ko({}),{c(){Ke(e.$$.fragment)},m(i,r){je(e,i,r),n=!0},i(i){n||(oe(e.$$.fragment,i),n=!0)},o(i){ce(e.$$.fragment,i),n=!1},d(i){Ve(e,i)}}}function Yo(t){let e,n,i,r,s,o;n=new No({});const l=[Jo,Go],a=[];function h(f,_){return f[0].endsWith("/about/")?0:1}return r=h(t),s=a[r]=l[r](t),{c(){e=E("div"),Ke(n.$$.fragment),i=H(),s.c(),y(e,"class","app svelte-1mc4mod")},m(f,_){G(f,e,_),je(n,e,null),g(e,i),a[r].m(e,null),o=!0},p:pe,i(f){o||(oe(n.$$.fragment,f),oe(s),o=!0)},o(f){ce(n.$$.fragment,f),ce(s),o=!1},d(f){f&&K(e),Ve(n),a[r].d()}}}function Zo(t){return[window.location.pathname]}class Qo extends Je{constructor(e){super(),Ge(this,e,Zo,Yo,Be,{})}}new Qo({target:document.getElementById("app")});
