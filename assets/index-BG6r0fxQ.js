const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/blosc-E49GQuAK.js","assets/chunk-INHXZS53-D3tQiqtZ.js","assets/gzip-CF-9a_hd.js","assets/browser-B-ZyVB-j.js","assets/lz4-BIGKWw27.js","assets/zlib-CBiqHlio.js","assets/zstd-IvP746pw.js"])))=>i.map(i=>d[i]);
var Al=Object.defineProperty;var xi=n=>{throw TypeError(n)};var Il=(n,e,t)=>e in n?Al(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var re=(n,e,t)=>Il(n,typeof e!="symbol"?e+"":e,t),qs=(n,e,t)=>e.has(n)||xi("Cannot "+t);var G=(n,e,t)=>(qs(n,e,"read from private field"),t?t.call(n):e.get(n)),Oe=(n,e,t)=>e.has(n)?xi("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),we=(n,e,t,s)=>(qs(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),$s=(n,e,t)=>(qs(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function Ae(){}function Ol(n,e){for(const t in e)n[t]=e[t];return n}function lo(n){return n()}function er(){return Object.create(null)}function wt(n){n.forEach(lo)}function ao(n){return typeof n=="function"}function He(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let ns;function dt(n,e){return n===e?!0:(ns||(ns=document.createElement("a")),ns.href=e,n===ns.href)}function Tl(n){return Object.keys(n).length===0}function Cl(n,...e){if(n==null){for(const s of e)s(void 0);return Ae}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function fs(n){let e;return Cl(n,t=>e=t)(),e}function ti(n,e,t,s){if(n){const i=co(n,e,t,s);return n[0](i)}}function co(n,e,t,s){return n[1]&&s?Ol(t.ctx.slice(),n[1](s(e))):t.ctx}function ni(n,e,t,s){if(n[2]&&s){const i=n[2](s(t));if(e.dirty===void 0)return i;if(typeof i=="object"){const r=[],o=Math.max(e.dirty.length,i.length);for(let l=0;l<o;l+=1)r[l]=e.dirty[l]|i[l];return r}return e.dirty|i}return e.dirty}function si(n,e,t,s,i,r){if(i){const o=co(e,t,s,r);n.p(o,i)}}function ii(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let s=0;s<t;s++)e[s]=-1;return e}return-1}function k(n,e){n.appendChild(e)}function Y(n,e,t){n.insertBefore(e,t||null)}function W(n){n.parentNode&&n.parentNode.removeChild(n)}function en(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function I(n){return document.createElement(n)}function ne(n){return document.createTextNode(n)}function X(){return ne(" ")}function fn(){return ne("")}function _e(n,e,t,s){return n.addEventListener(e,t,s),()=>n.removeEventListener(e,t,s)}function v(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Nl(n){return Array.from(n.childNodes)}function Be(n,e){e=""+e,n.data!==e&&(n.data=e)}function De(n,e){n.value=e??""}function de(n,e,t,s){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,"")}function Vt(n,e,t){for(let s=0;s<n.options.length;s+=1){const i=n.options[s];if(i.__value===e){i.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function Vs(n){const e=n.querySelector(":checked");return e&&e.__value}function Ce(n,e,t){n.classList.toggle(e,!!t)}function Ll(n,e,{bubbles:t=!1,cancelable:s=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:s})}let Tn;function In(n){Tn=n}function bi(){if(!Tn)throw new Error("Function called outside component initialization");return Tn}function un(n){bi().$$.on_mount.push(n)}function wi(n){bi().$$.on_destroy.push(n)}function Ml(){const n=bi();return(e,t,{cancelable:s=!1}={})=>{const i=n.$$.callbacks[e];if(i){const r=Ll(e,t,{cancelable:s});return i.slice().forEach(o=>{o.call(n,r)}),!r.defaultPrevented}return!0}}const Gt=[],It=[];let tn=[];const tr=[],fo=Promise.resolve();let ri=!1;function uo(){ri||(ri=!0,fo.then(Ke))}function Rl(){return uo(),fo}function vt(n){tn.push(n)}const Js=new Set;let Jt=0;function Ke(){if(Jt!==0)return;const n=Tn;do{try{for(;Jt<Gt.length;){const e=Gt[Jt];Jt++,In(e),Dl(e.$$)}}catch(e){throw Gt.length=0,Jt=0,e}for(In(null),Gt.length=0,Jt=0;It.length;)It.pop()();for(let e=0;e<tn.length;e+=1){const t=tn[e];Js.has(t)||(Js.add(t),t())}tn.length=0}while(Gt.length);for(;tr.length;)tr.pop()();ri=!1,Js.clear(),In(n)}function Dl(n){if(n.fragment!==null){n.update(),wt(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(vt)}}function Bl(n){const e=[],t=[];tn.forEach(s=>n.indexOf(s)===-1?e.push(s):t.push(s)),t.forEach(s=>s()),tn=e}const us=new Set;let Lt;function Wn(){Lt={r:0,c:[],p:Lt}}function Yn(){Lt.r||wt(Lt.c),Lt=Lt.p}function ce(n,e){n&&n.i&&(us.delete(n),n.i(e))}function me(n,e,t,s){if(n&&n.o){if(us.has(n))return;us.add(n),Lt.c.push(()=>{us.delete(n),s&&(t&&n.d(1),s())}),n.o(e)}else s&&s()}function $e(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Pl(n,e){n.d(1),e.delete(n.key)}function Fl(n,e){me(n,1,1,()=>{e.delete(n.key)})}function ho(n,e,t,s,i,r,o,l,a,c,u,d){let p=n.length,m=r.length,_=p;const h={};for(;_--;)h[n[_].key]=_;const y=[],E=new Map,C=new Map,O=[];for(_=m;_--;){const b=d(i,r,_),f=t(b);let g=o.get(f);g?O.push(()=>g.p(b,e)):(g=c(f,b),g.c()),E.set(f,y[_]=g),f in h&&C.set(f,Math.abs(_-h[f]))}const M=new Set,R=new Set;function T(b){ce(b,1),b.m(l,u),o.set(b.key,b),u=b.first,m--}for(;p&&m;){const b=y[m-1],f=n[p-1],g=b.key,w=f.key;b===f?(u=b.first,p--,m--):E.has(w)?!o.has(g)||M.has(g)?T(b):R.has(w)?p--:C.get(g)>C.get(w)?(R.add(g),T(b)):(M.add(w),p--):(a(f,o),p--)}for(;p--;){const b=n[p];E.has(b.key)||a(b,o)}for(;m;)T(y[m-1]);return wt(O),y}function rt(n){n&&n.c()}function nt(n,e,t){const{fragment:s,after_update:i}=n.$$;s&&s.m(e,t),vt(()=>{const r=n.$$.on_mount.map(lo).filter(ao);n.$$.on_destroy?n.$$.on_destroy.push(...r):wt(r),n.$$.on_mount=[]}),i.forEach(vt)}function st(n,e){const t=n.$$;t.fragment!==null&&(Bl(t.after_update),wt(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function zl(n,e){n.$$.dirty[0]===-1&&(Gt.push(n),uo(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function at(n,e,t,s,i,r,o=null,l=[-1]){const a=Tn;In(n);const c=n.$$={fragment:null,ctx:[],props:r,update:Ae,not_equal:i,bound:er(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:er(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(c.root);let u=!1;if(c.ctx=t?t(n,e.props||{},(d,p,...m)=>{const _=m.length?m[0]:p;return c.ctx&&i(c.ctx[d],c.ctx[d]=_)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](_),u&&zl(n,d)),p}):[],c.update(),u=!0,wt(c.before_update),c.fragment=s?s(c.ctx):!1,e.target){if(e.hydrate){const d=Nl(e.target);c.fragment&&c.fragment.l(d),d.forEach(W)}else c.fragment&&c.fragment.c();e.intro&&ce(n.$$.fragment),nt(n,e.target,e.anchor),Ke()}In(a)}class ct{constructor(){re(this,"$$");re(this,"$$set")}$destroy(){st(this,1),this.$destroy=Ae}$on(e,t){if(!ao(t))return Ae;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const i=s.indexOf(t);i!==-1&&s.splice(i,1)}}$set(e){this.$$set&&!Tl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const jl="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(jl);const Wt=[];function oi(n,e=Ae){let t;const s=new Set;function i(l){if(He(n,l)&&(n=l,t)){const a=!Wt.length;for(const c of s)c[1](),Wt.push(c,n);if(a){for(let c=0;c<Wt.length;c+=2)Wt[c][0](Wt[c+1]);Wt.length=0}}}function r(l){i(l(n))}function o(l,a=Ae){const c=[l,a];return s.add(c),s.size===1&&(t=e(i,r)||Ae),l(n),()=>{s.delete(c),s.size===0&&t&&(t(),t=null)}}return{set:i,update:r,subscribe:o}}var Ul=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Kl(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var po={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(n,e){(function(t,s){n.exports=s()})(Ul,function t(){var s=typeof self<"u"?self:typeof window<"u"?window:s!==void 0?s:{},i=!s.document&&!!s.postMessage,r=s.IS_PAPA_WORKER||!1,o={},l=0,a={parse:function(f,g){var w=(g=g||{}).dynamicTyping||!1;if(b(w)&&(g.dynamicTypingFunction=w,w={}),g.dynamicTyping=w,g.transform=!!b(g.transform)&&g.transform,g.worker&&a.WORKERS_SUPPORTED){var A=function(){if(!a.WORKERS_SUPPORTED)return!1;var z=(q=s.URL||s.webkitURL||null,L=t.toString(),a.BLOB_URL||(a.BLOB_URL=q.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",L,")();"],{type:"text/javascript"})))),j=new s.Worker(z),q,L;return j.onmessage=C,j.id=l++,o[j.id]=j}();return A.userStep=g.step,A.userChunk=g.chunk,A.userComplete=g.complete,A.userError=g.error,g.step=b(g.step),g.chunk=b(g.chunk),g.complete=b(g.complete),g.error=b(g.error),delete g.worker,void A.postMessage({input:f,config:g,workerId:A.id})}var S=null;return a.NODE_STREAM_INPUT,typeof f=="string"?(f=function(z){return z.charCodeAt(0)===65279?z.slice(1):z}(f),S=g.download?new d(g):new m(g)):f.readable===!0&&b(f.read)&&b(f.on)?S=new _(g):(s.File&&f instanceof File||f instanceof Object)&&(S=new p(g)),S.stream(f)},unparse:function(f,g){var w=!1,A=!0,S=",",z=`\r
`,j='"',q=j+j,L=!1,N=null,K=!1;(function(){if(typeof g=="object"){if(typeof g.delimiter!="string"||a.BAD_DELIMITERS.filter(function(F){return g.delimiter.indexOf(F)!==-1}).length||(S=g.delimiter),(typeof g.quotes=="boolean"||typeof g.quotes=="function"||Array.isArray(g.quotes))&&(w=g.quotes),typeof g.skipEmptyLines!="boolean"&&typeof g.skipEmptyLines!="string"||(L=g.skipEmptyLines),typeof g.newline=="string"&&(z=g.newline),typeof g.quoteChar=="string"&&(j=g.quoteChar),typeof g.header=="boolean"&&(A=g.header),Array.isArray(g.columns)){if(g.columns.length===0)throw new Error("Option columns is empty");N=g.columns}g.escapeChar!==void 0&&(q=g.escapeChar+j),(typeof g.escapeFormulae=="boolean"||g.escapeFormulae instanceof RegExp)&&(K=g.escapeFormulae instanceof RegExp?g.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var D=new RegExp(y(j),"g");if(typeof f=="string"&&(f=JSON.parse(f)),Array.isArray(f)){if(!f.length||Array.isArray(f[0]))return se(null,f,L);if(typeof f[0]=="object")return se(N||Object.keys(f[0]),f,L)}else if(typeof f=="object")return typeof f.data=="string"&&(f.data=JSON.parse(f.data)),Array.isArray(f.data)&&(f.fields||(f.fields=f.meta&&f.meta.fields||N),f.fields||(f.fields=Array.isArray(f.data[0])?f.fields:typeof f.data[0]=="object"?Object.keys(f.data[0]):[]),Array.isArray(f.data[0])||typeof f.data[0]=="object"||(f.data=[f.data])),se(f.fields||[],f.data||[],L);throw new Error("Unable to serialize unrecognized input");function se(F,fe,P){var $="";typeof F=="string"&&(F=JSON.parse(F)),typeof fe=="string"&&(fe=JSON.parse(fe));var Q=Array.isArray(F)&&0<F.length,x=!Array.isArray(fe[0]);if(Q&&A){for(var ee=0;ee<F.length;ee++)0<ee&&($+=S),$+=H(F[ee],ee);0<fe.length&&($+=z)}for(var U=0;U<fe.length;U++){var V=Q?F.length:fe[U].length,Z=!1,ve=Q?Object.keys(fe[U]).length===0:fe[U].length===0;if(P&&!Q&&(Z=P==="greedy"?fe[U].join("").trim()==="":fe[U].length===1&&fe[U][0].length===0),P==="greedy"&&Q){for(var ue=[],Ee=0;Ee<V;Ee++){var oe=x?F[Ee]:Ee;ue.push(fe[U][oe])}Z=ue.join("").trim()===""}if(!Z){for(var he=0;he<V;he++){0<he&&!ve&&($+=S);var Ve=Q&&x?F[he]:he;$+=H(fe[U][Ve],he)}U<fe.length-1&&(!P||0<V&&!ve)&&($+=z)}}return $}function H(F,fe){if(F==null)return"";if(F.constructor===Date)return JSON.stringify(F).slice(1,25);var P=!1;K&&typeof F=="string"&&K.test(F)&&(F="'"+F,P=!0);var $=F.toString().replace(D,q);return(P=P||w===!0||typeof w=="function"&&w(F,fe)||Array.isArray(w)&&w[fe]||function(Q,x){for(var ee=0;ee<x.length;ee++)if(-1<Q.indexOf(x[ee]))return!0;return!1}($,a.BAD_DELIMITERS)||-1<$.indexOf(S)||$.charAt(0)===" "||$.charAt($.length-1)===" ")?j+$+j:$}}};if(a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!i&&!!s.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=E,a.ParserHandle=h,a.NetworkStreamer=d,a.FileStreamer=p,a.StringStreamer=m,a.ReadableStreamStreamer=_,s.jQuery){var c=s.jQuery;c.fn.parse=function(f){var g=f.config||{},w=[];return this.each(function(z){if(!(c(this).prop("tagName").toUpperCase()==="INPUT"&&c(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var j=0;j<this.files.length;j++)w.push({file:this.files[j],inputElem:this,instanceConfig:c.extend({},g)})}),A(),this;function A(){if(w.length!==0){var z,j,q,L,N=w[0];if(b(f.before)){var K=f.before(N.file,N.inputElem);if(typeof K=="object"){if(K.action==="abort")return z="AbortError",j=N.file,q=N.inputElem,L=K.reason,void(b(f.error)&&f.error({name:z},j,q,L));if(K.action==="skip")return void S();typeof K.config=="object"&&(N.instanceConfig=c.extend(N.instanceConfig,K.config))}else if(K==="skip")return void S()}var D=N.instanceConfig.complete;N.instanceConfig.complete=function(se){b(D)&&D(se,N.file,N.inputElem),S()},a.parse(N.file,N.instanceConfig)}else b(f.complete)&&f.complete()}function S(){w.splice(0,1),A()}}}function u(f){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(g){var w=R(g);w.chunkSize=parseInt(w.chunkSize),g.step||g.chunk||(w.chunkSize=null),this._handle=new h(w),(this._handle.streamer=this)._config=w}).call(this,f),this.parseChunk=function(g,w){if(this.isFirstChunk&&b(this._config.beforeFirstChunk)){var A=this._config.beforeFirstChunk(g);A!==void 0&&(g=A)}this.isFirstChunk=!1,this._halted=!1;var S=this._partialLine+g;this._partialLine="";var z=this._handle.parse(S,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var j=z.meta.cursor;this._finished||(this._partialLine=S.substring(j-this._baseIndex),this._baseIndex=j),z&&z.data&&(this._rowCount+=z.data.length);var q=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(r)s.postMessage({results:z,workerId:a.WORKER_ID,finished:q});else if(b(this._config.chunk)&&!w){if(this._config.chunk(z,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);z=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(z.data),this._completeResults.errors=this._completeResults.errors.concat(z.errors),this._completeResults.meta=z.meta),this._completed||!q||!b(this._config.complete)||z&&z.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),q||z&&z.meta.paused||this._nextChunk(),z}this._halted=!0},this._sendError=function(g){b(this._config.error)?this._config.error(g):r&&this._config.error&&s.postMessage({workerId:a.WORKER_ID,error:g,finished:!1})}}function d(f){var g;(f=f||{}).chunkSize||(f.chunkSize=a.RemoteChunkSize),u.call(this,f),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(w){this._input=w,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(g=new XMLHttpRequest,this._config.withCredentials&&(g.withCredentials=this._config.withCredentials),i||(g.onload=T(this._chunkLoaded,this),g.onerror=T(this._chunkError,this)),g.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var w=this._config.downloadRequestHeaders;for(var A in w)g.setRequestHeader(A,w[A])}if(this._config.chunkSize){var S=this._start+this._config.chunkSize-1;g.setRequestHeader("Range","bytes="+this._start+"-"+S)}try{g.send(this._config.downloadRequestBody)}catch(z){this._chunkError(z.message)}i&&g.status===0&&this._chunkError()}},this._chunkLoaded=function(){g.readyState===4&&(g.status<200||400<=g.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:g.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(w){var A=w.getResponseHeader("Content-Range");return A===null?-1:parseInt(A.substring(A.lastIndexOf("/")+1))}(g),this.parseChunk(g.responseText)))},this._chunkError=function(w){var A=g.statusText||w;this._sendError(new Error(A))}}function p(f){var g,w;(f=f||{}).chunkSize||(f.chunkSize=a.LocalChunkSize),u.call(this,f);var A=typeof FileReader<"u";this.stream=function(S){this._input=S,w=S.slice||S.webkitSlice||S.mozSlice,A?((g=new FileReader).onload=T(this._chunkLoaded,this),g.onerror=T(this._chunkError,this)):g=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var S=this._input;if(this._config.chunkSize){var z=Math.min(this._start+this._config.chunkSize,this._input.size);S=w.call(S,this._start,z)}var j=g.readAsText(S,this._config.encoding);A||this._chunkLoaded({target:{result:j}})},this._chunkLoaded=function(S){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(S.target.result)},this._chunkError=function(){this._sendError(g.error)}}function m(f){var g;u.call(this,f=f||{}),this.stream=function(w){return g=w,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var w,A=this._config.chunkSize;return A?(w=g.substring(0,A),g=g.substring(A)):(w=g,g=""),this._finished=!g,this.parseChunk(w)}}}function _(f){u.call(this,f=f||{});var g=[],w=!0,A=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(S){this._input=S,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){A&&g.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),g.length?this.parseChunk(g.shift()):w=!0},this._streamData=T(function(S){try{g.push(typeof S=="string"?S:S.toString(this._config.encoding)),w&&(w=!1,this._checkIsFinished(),this.parseChunk(g.shift()))}catch(z){this._streamError(z)}},this),this._streamError=T(function(S){this._streamCleanUp(),this._sendError(S)},this),this._streamEnd=T(function(){this._streamCleanUp(),A=!0,this._streamData("")},this),this._streamCleanUp=T(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function h(f){var g,w,A,S=Math.pow(2,53),z=-S,j=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,q=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,L=this,N=0,K=0,D=!1,se=!1,H=[],F={data:[],errors:[],meta:{}};if(b(f.step)){var fe=f.step;f.step=function(U){if(F=U,Q())$();else{if($(),F.data.length===0)return;N+=U.data.length,f.preview&&N>f.preview?w.abort():(F.data=F.data[0],fe(F,L))}}}function P(U){return f.skipEmptyLines==="greedy"?U.join("").trim()==="":U.length===1&&U[0].length===0}function $(){return F&&A&&(ee("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),A=!1),f.skipEmptyLines&&(F.data=F.data.filter(function(U){return!P(U)})),Q()&&function(){if(!F)return;function U(Z,ve){b(f.transformHeader)&&(Z=f.transformHeader(Z,ve)),H.push(Z)}if(Array.isArray(F.data[0])){for(var V=0;Q()&&V<F.data.length;V++)F.data[V].forEach(U);F.data.splice(0,1)}else F.data.forEach(U)}(),function(){if(!F||!f.header&&!f.dynamicTyping&&!f.transform)return F;function U(Z,ve){var ue,Ee=f.header?{}:[];for(ue=0;ue<Z.length;ue++){var oe=ue,he=Z[ue];f.header&&(oe=ue>=H.length?"__parsed_extra":H[ue]),f.transform&&(he=f.transform(he,oe)),he=x(oe,he),oe==="__parsed_extra"?(Ee[oe]=Ee[oe]||[],Ee[oe].push(he)):Ee[oe]=he}return f.header&&(ue>H.length?ee("FieldMismatch","TooManyFields","Too many fields: expected "+H.length+" fields but parsed "+ue,K+ve):ue<H.length&&ee("FieldMismatch","TooFewFields","Too few fields: expected "+H.length+" fields but parsed "+ue,K+ve)),Ee}var V=1;return!F.data.length||Array.isArray(F.data[0])?(F.data=F.data.map(U),V=F.data.length):F.data=U(F.data,0),f.header&&F.meta&&(F.meta.fields=H),K+=V,F}()}function Q(){return f.header&&H.length===0}function x(U,V){return Z=U,f.dynamicTypingFunction&&f.dynamicTyping[Z]===void 0&&(f.dynamicTyping[Z]=f.dynamicTypingFunction(Z)),(f.dynamicTyping[Z]||f.dynamicTyping)===!0?V==="true"||V==="TRUE"||V!=="false"&&V!=="FALSE"&&(function(ve){if(j.test(ve)){var ue=parseFloat(ve);if(z<ue&&ue<S)return!0}return!1}(V)?parseFloat(V):q.test(V)?new Date(V):V===""?null:V):V;var Z}function ee(U,V,Z,ve){var ue={type:U,code:V,message:Z};ve!==void 0&&(ue.row=ve),F.errors.push(ue)}this.parse=function(U,V,Z){var ve=f.quoteChar||'"';if(f.newline||(f.newline=function(oe,he){oe=oe.substring(0,1048576);var Ve=new RegExp(y(he)+"([^]*?)"+y(he),"gm"),Le=(oe=oe.replace(Ve,"")).split("\r"),Ge=oe.split(`
`),Qe=1<Ge.length&&Ge[0].length<Le[0].length;if(Le.length===1||Qe)return`
`;for(var Fe=0,le=0;le<Le.length;le++)Le[le][0]===`
`&&Fe++;return Fe>=Le.length/2?`\r
`:"\r"}(U,ve)),A=!1,f.delimiter)b(f.delimiter)&&(f.delimiter=f.delimiter(U),F.meta.delimiter=f.delimiter);else{var ue=function(oe,he,Ve,Le,Ge){var Qe,Fe,le,ie;Ge=Ge||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var Je=0;Je<Ge.length;Je++){var ae=Ge[Je],gt=0,Me=0,We=0;le=void 0;for(var ze=new E({comments:Le,delimiter:ae,newline:he,preview:10}).parse(oe),ft=0;ft<ze.data.length;ft++)if(Ve&&P(ze.data[ft]))We++;else{var Xe=ze.data[ft].length;Me+=Xe,le!==void 0?0<Xe&&(gt+=Math.abs(Xe-le),le=Xe):le=Xe}0<ze.data.length&&(Me/=ze.data.length-We),(Fe===void 0||gt<=Fe)&&(ie===void 0||ie<Me)&&1.99<Me&&(Fe=gt,Qe=ae,ie=Me)}return{successful:!!(f.delimiter=Qe),bestDelimiter:Qe}}(U,f.newline,f.skipEmptyLines,f.comments,f.delimitersToGuess);ue.successful?f.delimiter=ue.bestDelimiter:(A=!0,f.delimiter=a.DefaultDelimiter),F.meta.delimiter=f.delimiter}var Ee=R(f);return f.preview&&f.header&&Ee.preview++,g=U,w=new E(Ee),F=w.parse(g,V,Z),$(),D?{meta:{paused:!0}}:F||{meta:{paused:!1}}},this.paused=function(){return D},this.pause=function(){D=!0,w.abort(),g=b(f.chunk)?"":g.substring(w.getCharIndex())},this.resume=function(){L.streamer._halted?(D=!1,L.streamer.parseChunk(g,!0)):setTimeout(L.resume,3)},this.aborted=function(){return se},this.abort=function(){se=!0,w.abort(),F.meta.aborted=!0,b(f.complete)&&f.complete(F),g=""}}function y(f){return f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function E(f){var g,w=(f=f||{}).delimiter,A=f.newline,S=f.comments,z=f.step,j=f.preview,q=f.fastMode,L=g=f.quoteChar===void 0||f.quoteChar===null?'"':f.quoteChar;if(f.escapeChar!==void 0&&(L=f.escapeChar),(typeof w!="string"||-1<a.BAD_DELIMITERS.indexOf(w))&&(w=","),S===w)throw new Error("Comment character same as delimiter");S===!0?S="#":(typeof S!="string"||-1<a.BAD_DELIMITERS.indexOf(S))&&(S=!1),A!==`
`&&A!=="\r"&&A!==`\r
`&&(A=`
`);var N=0,K=!1;this.parse=function(D,se,H){if(typeof D!="string")throw new Error("Input must be a string");var F=D.length,fe=w.length,P=A.length,$=S.length,Q=b(z),x=[],ee=[],U=[],V=N=0;if(!D)return Ie();if(f.header&&!se){var Z=D.split(A)[0].split(w),ve=[],ue={},Ee=!1;for(var oe in Z){var he=Z[oe];b(f.transformHeader)&&(he=f.transformHeader(he,oe));var Ve=he,Le=ue[he]||0;for(0<Le&&(Ee=!0,Ve=he+"_"+Le),ue[he]=Le+1;ve.includes(Ve);)Ve=Ve+"_"+Le;ve.push(Ve)}if(Ee){var Ge=D.split(A);Ge[0]=ve.join(w),D=Ge.join(A)}}if(q||q!==!1&&D.indexOf(g)===-1){for(var Qe=D.split(A),Fe=0;Fe<Qe.length;Fe++){if(U=Qe[Fe],N+=U.length,Fe!==Qe.length-1)N+=A.length;else if(H)return Ie();if(!S||U.substring(0,$)!==S){if(Q){if(x=[],We(U.split(w)),Ct(),K)return Ie()}else We(U.split(w));if(j&&j<=Fe)return x=x.slice(0,j),Ie(!0)}}return Ie()}for(var le=D.indexOf(w,N),ie=D.indexOf(A,N),Je=new RegExp(y(L)+y(g),"g"),ae=D.indexOf(g,N);;)if(D[N]!==g)if(S&&U.length===0&&D.substring(N,N+$)===S){if(ie===-1)return Ie();N=ie+P,ie=D.indexOf(A,N),le=D.indexOf(w,N)}else if(le!==-1&&(le<ie||ie===-1))U.push(D.substring(N,le)),N=le+fe,le=D.indexOf(w,N);else{if(ie===-1)break;if(U.push(D.substring(N,ie)),Xe(ie+P),Q&&(Ct(),K))return Ie();if(j&&x.length>=j)return Ie(!0)}else for(ae=N,N++;;){if((ae=D.indexOf(g,ae+1))===-1)return H||ee.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:x.length,index:N}),ft();if(ae===F-1)return ft(D.substring(N,ae).replace(Je,g));if(g!==L||D[ae+1]!==L){if(g===L||ae===0||D[ae-1]!==L){le!==-1&&le<ae+1&&(le=D.indexOf(w,ae+1)),ie!==-1&&ie<ae+1&&(ie=D.indexOf(A,ae+1));var gt=ze(ie===-1?le:Math.min(le,ie));if(D.substr(ae+1+gt,fe)===w){U.push(D.substring(N,ae).replace(Je,g)),D[N=ae+1+gt+fe]!==g&&(ae=D.indexOf(g,N)),le=D.indexOf(w,N),ie=D.indexOf(A,N);break}var Me=ze(ie);if(D.substring(ae+1+Me,ae+1+Me+P)===A){if(U.push(D.substring(N,ae).replace(Je,g)),Xe(ae+1+Me+P),le=D.indexOf(w,N),ae=D.indexOf(g,N),Q&&(Ct(),K))return Ie();if(j&&x.length>=j)return Ie(!0);break}ee.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:x.length,index:N}),ae++}}else ae++}return ft();function We(Te){x.push(Te),V=N}function ze(Te){var it=0;if(Te!==-1){var Kt=D.substring(ae+1,Te);Kt&&Kt.trim()===""&&(it=Kt.length)}return it}function ft(Te){return H||(Te===void 0&&(Te=D.substring(N)),U.push(Te),N=F,We(U),Q&&Ct()),Ie()}function Xe(Te){N=Te,We(U),U=[],ie=D.indexOf(A,N)}function Ie(Te){return{data:x,errors:ee,meta:{delimiter:w,linebreak:A,aborted:K,truncated:!!Te,cursor:V+(se||0)}}}function Ct(){z(Ie()),x=[],ee=[]}},this.abort=function(){K=!0},this.getCharIndex=function(){return N}}function C(f){var g=f.data,w=o[g.workerId],A=!1;if(g.error)w.userError(g.error,g.file);else if(g.results&&g.results.data){var S={abort:function(){A=!0,O(g.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:M,resume:M};if(b(w.userStep)){for(var z=0;z<g.results.data.length&&(w.userStep({data:g.results.data[z],errors:g.results.errors,meta:g.results.meta},S),!A);z++);delete g.results}else b(w.userChunk)&&(w.userChunk(g.results,S,g.file),delete g.results)}g.finished&&!A&&O(g.workerId,g.results)}function O(f,g){var w=o[f];b(w.userComplete)&&w.userComplete(g),w.terminate(),delete o[f]}function M(){throw new Error("Not implemented.")}function R(f){if(typeof f!="object"||f===null)return f;var g=Array.isArray(f)?[]:{};for(var w in f)g[w]=R(f[w]);return g}function T(f,g){return function(){f.apply(g,arguments)}}function b(f){return typeof f=="function"}return r&&(s.onmessage=function(f){var g=f.data;if(a.WORKER_ID===void 0&&g&&(a.WORKER_ID=g.workerId),typeof g.input=="string")s.postMessage({workerId:a.WORKER_ID,results:a.parse(g.input,g.config),finished:!0});else if(s.File&&g.input instanceof File||g.input instanceof Object){var w=a.parse(g.input,g.config);w&&s.postMessage({workerId:a.WORKER_ID,results:w,finished:!0})}}),(d.prototype=Object.create(u.prototype)).constructor=d,(p.prototype=Object.create(u.prototype)).constructor=p,(m.prototype=Object.create(m.prototype)).constructor=m,(_.prototype=Object.create(u.prototype)).constructor=_,a})})(po);var ql=po.exports;const $l=Kl(ql);function Vl(n){const e=n.data;let t=0,s=1/0;for(let i=0;i<e.length;i++){const r=e[i];r>t&&(t=r),r<s&&(s=r)}return[s,t]}function mo(n){n.startsWith("#")&&(n=n.slice(1));const e=parseInt(n.slice(0,2),16),t=parseInt(n.slice(2,4),16),s=parseInt(n.slice(4,6),16);return[e,t,s]}const hs=4,Et={cyan:"#00FFFF",yellow:"#FFFF00",magenta:"#FF00FF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",white:"#FFFFFF"},Jl=[Et.magenta,Et.green],Wl=[Et.red,Et.green,Et.blue],nr=Object.values(Et).slice(0,-2);function Yl(n){return n<=hs?Array(n).fill(!0):[...Array(hs).fill(!0),...Array(n-hs).fill(!1)]}function Hl(n,e){let t=[];if(n==1)t=[Et.white];else if(n==2)t=Jl;else if(n==3)t=Wl;else if(n<=hs)t=nr.slice(0,n);else{t=Array(n).fill(Et.white);const s=e.flatMap((i,r)=>i?r:[]);for(const[i,r]of s.entries())t[r]=nr[i]}return t.map(mo)}function Gl(n,e,t){const s=n[0].shape,i=s[0],r=s[1],o=i*r,l=new Uint8ClampedArray(4*o).fill(0);let a=0;for(let c=0;c<o;c++){for(let u=0;u<n.length;u++){const d=t[u],p=n[u].data,m=e[u],h=(p[c]-m[0])/(m[1]-m[0]);for(let y=0;y<3;y++){const E=h*d[y]<<0;l[a*4+y]=Math.max(l[a*4+y],E)}}l[a*4+3]=255,a++}return l}const ki=Symbol.for("yaml.alias"),li=Symbol.for("yaml.document"),At=Symbol.for("yaml.map"),go=Symbol.for("yaml.pair"),mt=Symbol.for("yaml.scalar"),hn=Symbol.for("yaml.seq"),lt=Symbol.for("yaml.node.type"),Tt=n=>!!n&&typeof n=="object"&&n[lt]===ki,jt=n=>!!n&&typeof n=="object"&&n[lt]===li,dn=n=>!!n&&typeof n=="object"&&n[lt]===At,be=n=>!!n&&typeof n=="object"&&n[lt]===go,pe=n=>!!n&&typeof n=="object"&&n[lt]===mt,pn=n=>!!n&&typeof n=="object"&&n[lt]===hn;function ke(n){if(n&&typeof n=="object")switch(n[lt]){case At:case hn:return!0}return!1}function Se(n){if(n&&typeof n=="object")switch(n[lt]){case ki:case At:case mt:case hn:return!0}return!1}const yo=n=>(pe(n)||ke(n))&&!!n.anchor,Ye=Symbol("break visit"),_o=Symbol("skip children"),pt=Symbol("remove node");function Ut(n,e){const t=bo(e);jt(n)?Qt(null,n.contents,t,Object.freeze([n]))===pt&&(n.contents=null):Qt(null,n,t,Object.freeze([]))}Ut.BREAK=Ye;Ut.SKIP=_o;Ut.REMOVE=pt;function Qt(n,e,t,s){const i=wo(n,e,t,s);if(Se(i)||be(i))return ko(n,s,i),Qt(n,i,t,s);if(typeof i!="symbol"){if(ke(e)){s=Object.freeze(s.concat(e));for(let r=0;r<e.items.length;++r){const o=Qt(r,e.items[r],t,s);if(typeof o=="number")r=o-1;else{if(o===Ye)return Ye;o===pt&&(e.items.splice(r,1),r-=1)}}}else if(be(e)){s=Object.freeze(s.concat(e));const r=Qt("key",e.key,t,s);if(r===Ye)return Ye;r===pt&&(e.key=null);const o=Qt("value",e.value,t,s);if(o===Ye)return Ye;o===pt&&(e.value=null)}}return i}async function Es(n,e){const t=bo(e);jt(n)?await Xt(null,n.contents,t,Object.freeze([n]))===pt&&(n.contents=null):await Xt(null,n,t,Object.freeze([]))}Es.BREAK=Ye;Es.SKIP=_o;Es.REMOVE=pt;async function Xt(n,e,t,s){const i=await wo(n,e,t,s);if(Se(i)||be(i))return ko(n,s,i),Xt(n,i,t,s);if(typeof i!="symbol"){if(ke(e)){s=Object.freeze(s.concat(e));for(let r=0;r<e.items.length;++r){const o=await Xt(r,e.items[r],t,s);if(typeof o=="number")r=o-1;else{if(o===Ye)return Ye;o===pt&&(e.items.splice(r,1),r-=1)}}}else if(be(e)){s=Object.freeze(s.concat(e));const r=await Xt("key",e.key,t,s);if(r===Ye)return Ye;r===pt&&(e.key=null);const o=await Xt("value",e.value,t,s);if(o===Ye)return Ye;o===pt&&(e.value=null)}}return i}function bo(n){return typeof n=="object"&&(n.Collection||n.Node||n.Value)?Object.assign({Alias:n.Node,Map:n.Node,Scalar:n.Node,Seq:n.Node},n.Value&&{Map:n.Value,Scalar:n.Value,Seq:n.Value},n.Collection&&{Map:n.Collection,Seq:n.Collection},n):n}function wo(n,e,t,s){var i,r,o,l,a;if(typeof t=="function")return t(n,e,s);if(dn(e))return(i=t.Map)==null?void 0:i.call(t,n,e,s);if(pn(e))return(r=t.Seq)==null?void 0:r.call(t,n,e,s);if(be(e))return(o=t.Pair)==null?void 0:o.call(t,n,e,s);if(pe(e))return(l=t.Scalar)==null?void 0:l.call(t,n,e,s);if(Tt(e))return(a=t.Alias)==null?void 0:a.call(t,n,e,s)}function ko(n,e,t){const s=e[e.length-1];if(ke(s))s.items[n]=t;else if(be(s))n==="key"?s.key=t:s.value=t;else if(jt(s))s.contents=t;else{const i=Tt(s)?"alias":"scalar";throw new Error(`Cannot replace node with ${i} parent`)}}const Ql={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},Xl=n=>n.replace(/[!,[\]{}]/g,e=>Ql[e]);class qe{constructor(e,t){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},qe.defaultYaml,e),this.tags=Object.assign({},qe.defaultTags,t)}clone(){const e=new qe(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){const e=new qe(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:qe.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},qe.defaultTags);break}return e}add(e,t){this.atNextDocument&&(this.yaml={explicit:qe.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},qe.defaultTags),this.atNextDocument=!1);const s=e.trim().split(/[ \t]+/),i=s.shift();switch(i){case"%TAG":{if(s.length!==2&&(t(0,"%TAG directive should contain exactly two parts"),s.length<2))return!1;const[r,o]=s;return this.tags[r]=o,!0}case"%YAML":{if(this.yaml.explicit=!0,s.length!==1)return t(0,"%YAML directive should contain exactly one part"),!1;const[r]=s;if(r==="1.1"||r==="1.2")return this.yaml.version=r,!0;{const o=/^\d+\.\d+$/.test(r);return t(6,`Unsupported YAML version ${r}`,o),!1}}default:return t(0,`Unknown directive ${i}`,!0),!1}}tagName(e,t){if(e==="!")return"!";if(e[0]!=="!")return t(`Not a valid tag: ${e}`),null;if(e[1]==="<"){const o=e.slice(2,-1);return o==="!"||o==="!!"?(t(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(e[e.length-1]!==">"&&t("Verbatim tags must end with a >"),o)}const[,s,i]=e.match(/^(.*!)([^!]*)$/s);i||t(`The ${e} tag has no suffix`);const r=this.tags[s];if(r)try{return r+decodeURIComponent(i)}catch(o){return t(String(o)),null}return s==="!"?e:(t(`Could not resolve tag: ${e}`),null)}tagString(e){for(const[t,s]of Object.entries(this.tags))if(e.startsWith(s))return t+Xl(e.substring(s.length));return e[0]==="!"?e:`!<${e}>`}toString(e){const t=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],s=Object.entries(this.tags);let i;if(e&&s.length>0&&Se(e.contents)){const r={};Ut(e.contents,(o,l)=>{Se(l)&&l.tag&&(r[l.tag]=!0)}),i=Object.keys(r)}else i=[];for(const[r,o]of s)r==="!!"&&o==="tag:yaml.org,2002:"||(!e||i.some(l=>l.startsWith(o)))&&t.push(`%TAG ${r} ${o}`);return t.join(`
`)}}qe.defaultYaml={explicit:!1,version:"1.2"};qe.defaultTags={"!!":"tag:yaml.org,2002:"};function So(n){if(/[\x00-\x19\s,[\]{}]/.test(n)){const t=`Anchor must not contain whitespace or control characters: ${JSON.stringify(n)}`;throw new Error(t)}return!0}function vo(n){const e=new Set;return Ut(n,{Value(t,s){s.anchor&&e.add(s.anchor)}}),e}function Eo(n,e){for(let t=1;;++t){const s=`${n}${t}`;if(!e.has(s))return s}}function Zl(n,e){const t=[],s=new Map;let i=null;return{onAnchor:r=>{t.push(r),i??(i=vo(n));const o=Eo(e,i);return i.add(o),o},setAnchors:()=>{for(const r of t){const o=s.get(r);if(typeof o=="object"&&o.anchor&&(pe(o.node)||ke(o.node)))o.node.anchor=o.anchor;else{const l=new Error("Failed to resolve repeated object (this should not happen)");throw l.source=r,l}}},sourceObjects:s}}function Zt(n,e,t,s){if(s&&typeof s=="object")if(Array.isArray(s))for(let i=0,r=s.length;i<r;++i){const o=s[i],l=Zt(n,s,String(i),o);l===void 0?delete s[i]:l!==o&&(s[i]=l)}else if(s instanceof Map)for(const i of Array.from(s.keys())){const r=s.get(i),o=Zt(n,s,i,r);o===void 0?s.delete(i):o!==r&&s.set(i,o)}else if(s instanceof Set)for(const i of Array.from(s)){const r=Zt(n,s,i,i);r===void 0?s.delete(i):r!==i&&(s.delete(i),s.add(r))}else for(const[i,r]of Object.entries(s)){const o=Zt(n,s,i,r);o===void 0?delete s[i]:o!==r&&(s[i]=o)}return n.call(e,t,s)}function ot(n,e,t){if(Array.isArray(n))return n.map((s,i)=>ot(s,String(i),t));if(n&&typeof n.toJSON=="function"){if(!t||!yo(n))return n.toJSON(e,t);const s={aliasCount:0,count:1,res:void 0};t.anchors.set(n,s),t.onCreate=r=>{s.res=r,delete t.onCreate};const i=n.toJSON(e,t);return t.onCreate&&t.onCreate(i),i}return typeof n=="bigint"&&!(t!=null&&t.keep)?Number(n):n}class Si{constructor(e){Object.defineProperty(this,lt,{value:e})}clone(){const e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:t,maxAliasCount:s,onAnchor:i,reviver:r}={}){if(!jt(e))throw new TypeError("A document argument is required");const o={anchors:new Map,doc:e,keep:!0,mapAsMap:t===!0,mapKeyWarned:!1,maxAliasCount:typeof s=="number"?s:100},l=ot(this,"",o);if(typeof i=="function")for(const{count:a,res:c}of o.anchors.values())i(c,a);return typeof r=="function"?Zt(r,{"":l},"",l):l}}class As extends Si{constructor(e){super(ki),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e,t){let s;t!=null&&t.aliasResolveCache?s=t.aliasResolveCache:(s=[],Ut(e,{Node:(r,o)=>{(Tt(o)||yo(o))&&s.push(o)}}),t&&(t.aliasResolveCache=s));let i;for(const r of s){if(r===this)break;r.anchor===this.source&&(i=r)}return i}toJSON(e,t){if(!t)return{source:this.source};const{anchors:s,doc:i,maxAliasCount:r}=t,o=this.resolve(i,t);if(!o){const a=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(a)}let l=s.get(o);if(l||(ot(o,null,t),l=s.get(o)),!l||l.res===void 0){const a="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(a)}if(r>=0&&(l.count+=1,l.aliasCount===0&&(l.aliasCount=ds(i,o,s)),l.count*l.aliasCount>r)){const a="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(a)}return l.res}toString(e,t,s){const i=`*${this.source}`;if(e){if(So(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){const r=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(r)}if(e.implicitKey)return`${i} `}return i}}function ds(n,e,t){if(Tt(e)){const s=e.resolve(n),i=t&&s&&t.get(s);return i?i.count*i.aliasCount:0}else if(ke(e)){let s=0;for(const i of e.items){const r=ds(n,i,t);r>s&&(s=r)}return s}else if(be(e)){const s=ds(n,e.key,t),i=ds(n,e.value,t);return Math.max(s,i)}return 1}const Ao=n=>!n||typeof n!="function"&&typeof n!="object";class J extends Si{constructor(e){super(mt),this.value=e}toJSON(e,t){return t!=null&&t.keep?this.value:ot(this.value,e,t)}toString(){return String(this.value)}}J.BLOCK_FOLDED="BLOCK_FOLDED";J.BLOCK_LITERAL="BLOCK_LITERAL";J.PLAIN="PLAIN";J.QUOTE_DOUBLE="QUOTE_DOUBLE";J.QUOTE_SINGLE="QUOTE_SINGLE";const xl="tag:yaml.org,2002:";function ea(n,e,t){if(e){const s=t.filter(r=>r.tag===e),i=s.find(r=>!r.format)??s[0];if(!i)throw new Error(`Tag ${e} not found`);return i}return t.find(s=>{var i;return((i=s.identify)==null?void 0:i.call(s,n))&&!s.format})}function Cn(n,e,t){var d,p,m;if(jt(n)&&(n=n.contents),Se(n))return n;if(be(n)){const _=(p=(d=t.schema[At]).createNode)==null?void 0:p.call(d,t.schema,null,t);return _.items.push(n),_}(n instanceof String||n instanceof Number||n instanceof Boolean||typeof BigInt<"u"&&n instanceof BigInt)&&(n=n.valueOf());const{aliasDuplicateObjects:s,onAnchor:i,onTagObj:r,schema:o,sourceObjects:l}=t;let a;if(s&&n&&typeof n=="object"){if(a=l.get(n),a)return a.anchor??(a.anchor=i(n)),new As(a.anchor);a={anchor:null,node:null},l.set(n,a)}e!=null&&e.startsWith("!!")&&(e=xl+e.slice(2));let c=ea(n,e,o.tags);if(!c){if(n&&typeof n.toJSON=="function"&&(n=n.toJSON()),!n||typeof n!="object"){const _=new J(n);return a&&(a.node=_),_}c=n instanceof Map?o[At]:Symbol.iterator in Object(n)?o[hn]:o[At]}r&&(r(c),delete t.onTagObj);const u=c!=null&&c.createNode?c.createNode(t.schema,n,t):typeof((m=c==null?void 0:c.nodeClass)==null?void 0:m.from)=="function"?c.nodeClass.from(t.schema,n,t):new J(n);return e?u.tag=e:c.default||(u.tag=c.tag),a&&(a.node=u),u}function _s(n,e,t){let s=t;for(let i=e.length-1;i>=0;--i){const r=e[i];if(typeof r=="number"&&Number.isInteger(r)&&r>=0){const o=[];o[r]=s,s=o}else s=new Map([[r,s]])}return Cn(s,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:n,sourceObjects:new Map})}const En=n=>n==null||typeof n=="object"&&!!n[Symbol.iterator]().next().done;class Io extends Si{constructor(e,t){super(e),Object.defineProperty(this,"schema",{value:t,configurable:!0,enumerable:!1,writable:!0})}clone(e){const t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(t.schema=e),t.items=t.items.map(s=>Se(s)||be(s)?s.clone(e):s),this.range&&(t.range=this.range.slice()),t}addIn(e,t){if(En(e))this.add(t);else{const[s,...i]=e,r=this.get(s,!0);if(ke(r))r.addIn(i,t);else if(r===void 0&&this.schema)this.set(s,_s(this.schema,i,t));else throw new Error(`Expected YAML collection at ${s}. Remaining path: ${i}`)}}deleteIn(e){const[t,...s]=e;if(s.length===0)return this.delete(t);const i=this.get(t,!0);if(ke(i))return i.deleteIn(s);throw new Error(`Expected YAML collection at ${t}. Remaining path: ${s}`)}getIn(e,t){const[s,...i]=e,r=this.get(s,!0);return i.length===0?!t&&pe(r)?r.value:r:ke(r)?r.getIn(i,t):void 0}hasAllNullValues(e){return this.items.every(t=>{if(!be(t))return!1;const s=t.value;return s==null||e&&pe(s)&&s.value==null&&!s.commentBefore&&!s.comment&&!s.tag})}hasIn(e){const[t,...s]=e;if(s.length===0)return this.has(t);const i=this.get(t,!0);return ke(i)?i.hasIn(s):!1}setIn(e,t){const[s,...i]=e;if(i.length===0)this.set(s,t);else{const r=this.get(s,!0);if(ke(r))r.setIn(i,t);else if(r===void 0&&this.schema)this.set(s,_s(this.schema,i,t));else throw new Error(`Expected YAML collection at ${s}. Remaining path: ${i}`)}}}const ta=n=>n.replace(/^(?!$)(?: $)?/gm,"#");function _t(n,e){return/^\n+$/.test(n)?n.substring(1):e?n.replace(/^(?! *$)/gm,e):n}const Mt=(n,e,t)=>n.endsWith(`
`)?_t(t,e):t.includes(`
`)?`
`+_t(t,e):(n.endsWith(" ")?"":" ")+t,Oo="flow",ai="block",ps="quoted";function Is(n,e,t="flow",{indentAtStart:s,lineWidth:i=80,minContentWidth:r=20,onFold:o,onOverflow:l}={}){if(!i||i<0)return n;i<r&&(r=0);const a=Math.max(1+r,1+i-e.length);if(n.length<=a)return n;const c=[],u={};let d=i-e.length;typeof s=="number"&&(s>i-Math.max(2,r)?c.push(0):d=i-s);let p,m,_=!1,h=-1,y=-1,E=-1;t===ai&&(h=sr(n,h,e.length),h!==-1&&(d=h+a));for(let O;O=n[h+=1];){if(t===ps&&O==="\\"){switch(y=h,n[h+1]){case"x":h+=3;break;case"u":h+=5;break;case"U":h+=9;break;default:h+=1}E=h}if(O===`
`)t===ai&&(h=sr(n,h,e.length)),d=h+e.length+a,p=void 0;else{if(O===" "&&m&&m!==" "&&m!==`
`&&m!=="	"){const M=n[h+1];M&&M!==" "&&M!==`
`&&M!=="	"&&(p=h)}if(h>=d)if(p)c.push(p),d=p+a,p=void 0;else if(t===ps){for(;m===" "||m==="	";)m=O,O=n[h+=1],_=!0;const M=h>E+1?h-2:y-1;if(u[M])return n;c.push(M),u[M]=!0,d=M+a,p=void 0}else _=!0}m=O}if(_&&l&&l(),c.length===0)return n;o&&o();let C=n.slice(0,c[0]);for(let O=0;O<c.length;++O){const M=c[O],R=c[O+1]||n.length;M===0?C=`
${e}${n.slice(0,R)}`:(t===ps&&u[M]&&(C+=`${n[M]}\\`),C+=`
${e}${n.slice(M+1,R)}`)}return C}function sr(n,e,t){let s=e,i=e+1,r=n[i];for(;r===" "||r==="	";)if(e<i+t)r=n[++e];else{do r=n[++e];while(r&&r!==`
`);s=e,i=e+1,r=n[i]}return s}const Os=(n,e)=>({indentAtStart:e?n.indent.length:n.indentAtStart,lineWidth:n.options.lineWidth,minContentWidth:n.options.minContentWidth}),Ts=n=>/^(%|---|\.\.\.)/m.test(n);function na(n,e,t){if(!e||e<0)return!1;const s=e-t,i=n.length;if(i<=s)return!1;for(let r=0,o=0;r<i;++r)if(n[r]===`
`){if(r-o>s)return!0;if(o=r+1,i-o<=s)return!1}return!0}function On(n,e){const t=JSON.stringify(n);if(e.options.doubleQuotedAsJSON)return t;const{implicitKey:s}=e,i=e.options.doubleQuotedMinMultiLineLength,r=e.indent||(Ts(n)?"  ":"");let o="",l=0;for(let a=0,c=t[a];c;c=t[++a])if(c===" "&&t[a+1]==="\\"&&t[a+2]==="n"&&(o+=t.slice(l,a)+"\\ ",a+=1,l=a,c="\\"),c==="\\")switch(t[a+1]){case"u":{o+=t.slice(l,a);const u=t.substr(a+2,4);switch(u){case"0000":o+="\\0";break;case"0007":o+="\\a";break;case"000b":o+="\\v";break;case"001b":o+="\\e";break;case"0085":o+="\\N";break;case"00a0":o+="\\_";break;case"2028":o+="\\L";break;case"2029":o+="\\P";break;default:u.substr(0,2)==="00"?o+="\\x"+u.substr(2):o+=t.substr(a,6)}a+=5,l=a+1}break;case"n":if(s||t[a+2]==='"'||t.length<i)a+=1;else{for(o+=t.slice(l,a)+`

`;t[a+2]==="\\"&&t[a+3]==="n"&&t[a+4]!=='"';)o+=`
`,a+=2;o+=r,t[a+2]===" "&&(o+="\\"),a+=1,l=a+1}break;default:a+=1}return o=l?o+t.slice(l):t,s?o:Is(o,r,ps,Os(e,!1))}function ci(n,e){if(e.options.singleQuote===!1||e.implicitKey&&n.includes(`
`)||/[ \t]\n|\n[ \t]/.test(n))return On(n,e);const t=e.indent||(Ts(n)?"  ":""),s="'"+n.replace(/'/g,"''").replace(/\n+/g,`$&
${t}`)+"'";return e.implicitKey?s:Is(s,t,Oo,Os(e,!1))}function xt(n,e){const{singleQuote:t}=e.options;let s;if(t===!1)s=On;else{const i=n.includes('"'),r=n.includes("'");i&&!r?s=ci:r&&!i?s=On:s=t?ci:On}return s(n,e)}let fi;try{fi=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{fi=/\n+(?!\n|$)/g}function ms({comment:n,type:e,value:t},s,i,r){const{blockQuote:o,commentString:l,lineWidth:a}=s.options;if(!o||/\n[\t ]+$/.test(t))return xt(t,s);const c=s.indent||(s.forceBlockIndent||Ts(t)?"  ":""),u=o==="literal"?!0:o==="folded"||e===J.BLOCK_FOLDED?!1:e===J.BLOCK_LITERAL?!0:!na(t,a,c.length);if(!t)return u?`|
`:`>
`;let d,p;for(p=t.length;p>0;--p){const R=t[p-1];if(R!==`
`&&R!=="	"&&R!==" ")break}let m=t.substring(p);const _=m.indexOf(`
`);_===-1?d="-":t===m||_!==m.length-1?(d="+",r&&r()):d="",m&&(t=t.slice(0,-m.length),m[m.length-1]===`
`&&(m=m.slice(0,-1)),m=m.replace(fi,`$&${c}`));let h=!1,y,E=-1;for(y=0;y<t.length;++y){const R=t[y];if(R===" ")h=!0;else if(R===`
`)E=y;else break}let C=t.substring(0,E<y?E+1:y);C&&(t=t.substring(C.length),C=C.replace(/\n+/g,`$&${c}`));let M=(h?c?"2":"1":"")+d;if(n&&(M+=" "+l(n.replace(/ ?[\r\n]+/g," ")),i&&i()),!u){const R=t.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${c}`);let T=!1;const b=Os(s,!0);o!=="folded"&&e!==J.BLOCK_FOLDED&&(b.onOverflow=()=>{T=!0});const f=Is(`${C}${R}${m}`,c,ai,b);if(!T)return`>${M}
${c}${f}`}return t=t.replace(/\n+/g,`$&${c}`),`|${M}
${c}${C}${t}${m}`}function sa(n,e,t,s){const{type:i,value:r}=n,{actualString:o,implicitKey:l,indent:a,indentStep:c,inFlow:u}=e;if(l&&r.includes(`
`)||u&&/[[\]{},]/.test(r))return xt(r,e);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(r))return l||u||!r.includes(`
`)?xt(r,e):ms(n,e,t,s);if(!l&&!u&&i!==J.PLAIN&&r.includes(`
`))return ms(n,e,t,s);if(Ts(r)){if(a==="")return e.forceBlockIndent=!0,ms(n,e,t,s);if(l&&a===c)return xt(r,e)}const d=r.replace(/\n+/g,`$&
${a}`);if(o){const p=h=>{var y;return h.default&&h.tag!=="tag:yaml.org,2002:str"&&((y=h.test)==null?void 0:y.test(d))},{compat:m,tags:_}=e.doc.schema;if(_.some(p)||m!=null&&m.some(p))return xt(r,e)}return l?d:Is(d,a,Oo,Os(e,!1))}function Hn(n,e,t,s){const{implicitKey:i,inFlow:r}=e,o=typeof n.value=="string"?n:Object.assign({},n,{value:String(n.value)});let{type:l}=n;l!==J.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(o.value)&&(l=J.QUOTE_DOUBLE);const a=u=>{switch(u){case J.BLOCK_FOLDED:case J.BLOCK_LITERAL:return i||r?xt(o.value,e):ms(o,e,t,s);case J.QUOTE_DOUBLE:return On(o.value,e);case J.QUOTE_SINGLE:return ci(o.value,e);case J.PLAIN:return sa(o,e,t,s);default:return null}};let c=a(l);if(c===null){const{defaultKeyType:u,defaultStringType:d}=e.options,p=i&&u||d;if(c=a(p),c===null)throw new Error(`Unsupported default string type ${p}`)}return c}function To(n,e){const t=Object.assign({blockQuote:!0,commentString:ta,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},n.schema.toStringOptions,e);let s;switch(t.collectionStyle){case"block":s=!1;break;case"flow":s=!0;break;default:s=null}return{anchors:new Set,doc:n,flowCollectionPadding:t.flowCollectionPadding?" ":"",indent:"",indentStep:typeof t.indent=="number"?" ".repeat(t.indent):"  ",inFlow:s,options:t}}function ia(n,e){var i;if(e.tag){const r=n.filter(o=>o.tag===e.tag);if(r.length>0)return r.find(o=>o.format===e.format)??r[0]}let t,s;if(pe(e)){s=e.value;let r=n.filter(o=>{var l;return(l=o.identify)==null?void 0:l.call(o,s)});if(r.length>1){const o=r.filter(l=>l.test);o.length>0&&(r=o)}t=r.find(o=>o.format===e.format)??r.find(o=>!o.format)}else s=e,t=n.find(r=>r.nodeClass&&s instanceof r.nodeClass);if(!t){const r=((i=s==null?void 0:s.constructor)==null?void 0:i.name)??(s===null?"null":typeof s);throw new Error(`Tag not resolved for ${r} value`)}return t}function ra(n,e,{anchors:t,doc:s}){if(!s.directives)return"";const i=[],r=(pe(n)||ke(n))&&n.anchor;r&&So(r)&&(t.add(r),i.push(`&${r}`));const o=n.tag??(e.default?null:e.tag);return o&&i.push(s.directives.tagString(o)),i.join(" ")}function an(n,e,t,s){var a;if(be(n))return n.toString(e,t,s);if(Tt(n)){if(e.doc.directives)return n.toString(e);if((a=e.resolvedAliases)!=null&&a.has(n))throw new TypeError("Cannot stringify circular structure without alias nodes");e.resolvedAliases?e.resolvedAliases.add(n):e.resolvedAliases=new Set([n]),n=n.resolve(e.doc)}let i;const r=Se(n)?n:e.doc.createNode(n,{onTagObj:c=>i=c});i??(i=ia(e.doc.schema.tags,r));const o=ra(r,i,e);o.length>0&&(e.indentAtStart=(e.indentAtStart??0)+o.length+1);const l=typeof i.stringify=="function"?i.stringify(r,e,t,s):pe(r)?Hn(r,e,t,s):r.toString(e,t,s);return o?pe(r)||l[0]==="{"||l[0]==="["?`${o} ${l}`:`${o}
${e.indent}${l}`:l}function oa({key:n,value:e},t,s,i){const{allNullValues:r,doc:o,indent:l,indentStep:a,options:{commentString:c,indentSeq:u,simpleKeys:d}}=t;let p=Se(n)&&n.comment||null;if(d){if(p)throw new Error("With simple keys, key nodes cannot have comments");if(ke(n)||!Se(n)&&typeof n=="object"){const b="With simple keys, collection cannot be used as a key value";throw new Error(b)}}let m=!d&&(!n||p&&e==null&&!t.inFlow||ke(n)||(pe(n)?n.type===J.BLOCK_FOLDED||n.type===J.BLOCK_LITERAL:typeof n=="object"));t=Object.assign({},t,{allNullValues:!1,implicitKey:!m&&(d||!r),indent:l+a});let _=!1,h=!1,y=an(n,t,()=>_=!0,()=>h=!0);if(!m&&!t.inFlow&&y.length>1024){if(d)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");m=!0}if(t.inFlow){if(r||e==null)return _&&s&&s(),y===""?"?":m?`? ${y}`:y}else if(r&&!d||e==null&&m)return y=`? ${y}`,p&&!_?y+=Mt(y,t.indent,c(p)):h&&i&&i(),y;_&&(p=null),m?(p&&(y+=Mt(y,t.indent,c(p))),y=`? ${y}
${l}:`):(y=`${y}:`,p&&(y+=Mt(y,t.indent,c(p))));let E,C,O;Se(e)?(E=!!e.spaceBefore,C=e.commentBefore,O=e.comment):(E=!1,C=null,O=null,e&&typeof e=="object"&&(e=o.createNode(e))),t.implicitKey=!1,!m&&!p&&pe(e)&&(t.indentAtStart=y.length+1),h=!1,!u&&a.length>=2&&!t.inFlow&&!m&&pn(e)&&!e.flow&&!e.tag&&!e.anchor&&(t.indent=t.indent.substring(2));let M=!1;const R=an(e,t,()=>M=!0,()=>h=!0);let T=" ";if(p||E||C){if(T=E?`
`:"",C){const b=c(C);T+=`
${_t(b,t.indent)}`}R===""&&!t.inFlow?T===`
`&&(T=`

`):T+=`
${t.indent}`}else if(!m&&ke(e)){const b=R[0],f=R.indexOf(`
`),g=f!==-1,w=t.inFlow??e.flow??e.items.length===0;if(g||!w){let A=!1;if(g&&(b==="&"||b==="!")){let S=R.indexOf(" ");b==="&"&&S!==-1&&S<f&&R[S+1]==="!"&&(S=R.indexOf(" ",S+1)),(S===-1||f<S)&&(A=!0)}A||(T=`
${t.indent}`)}}else(R===""||R[0]===`
`)&&(T="");return y+=T+R,t.inFlow?M&&s&&s():O&&!M?y+=Mt(y,t.indent,c(O)):h&&i&&i(),y}function Co(n,e){(n==="debug"||n==="warn")&&console.warn(e)}const ss="<<",bt={identify:n=>n===ss||typeof n=="symbol"&&n.description===ss,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new J(Symbol(ss)),{addToJSMap:No}),stringify:()=>ss},la=(n,e)=>(bt.identify(e)||pe(e)&&(!e.type||e.type===J.PLAIN)&&bt.identify(e.value))&&(n==null?void 0:n.doc.schema.tags.some(t=>t.tag===bt.tag&&t.default));function No(n,e,t){if(t=n&&Tt(t)?t.resolve(n.doc):t,pn(t))for(const s of t.items)Ws(n,e,s);else if(Array.isArray(t))for(const s of t)Ws(n,e,s);else Ws(n,e,t)}function Ws(n,e,t){const s=n&&Tt(t)?t.resolve(n.doc):t;if(!dn(s))throw new Error("Merge sources must be maps or map aliases");const i=s.toJSON(null,n,Map);for(const[r,o]of i)e instanceof Map?e.has(r)||e.set(r,o):e instanceof Set?e.add(r):Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(e,r,{value:o,writable:!0,enumerable:!0,configurable:!0});return e}function Lo(n,e,{key:t,value:s}){if(Se(t)&&t.addToJSMap)t.addToJSMap(n,e,s);else if(la(n,t))No(n,e,s);else{const i=ot(t,"",n);if(e instanceof Map)e.set(i,ot(s,i,n));else if(e instanceof Set)e.add(i);else{const r=aa(t,i,n),o=ot(s,r,n);r in e?Object.defineProperty(e,r,{value:o,writable:!0,enumerable:!0,configurable:!0}):e[r]=o}}return e}function aa(n,e,t){if(e===null)return"";if(typeof e!="object")return String(e);if(Se(n)&&(t!=null&&t.doc)){const s=To(t.doc,{});s.anchors=new Set;for(const r of t.anchors.keys())s.anchors.add(r.anchor);s.inFlow=!0,s.inStringifyKey=!0;const i=n.toString(s);if(!t.mapKeyWarned){let r=JSON.stringify(i);r.length>40&&(r=r.substring(0,36)+'..."'),Co(t.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${r}. Set mapAsMap: true to use object keys.`),t.mapKeyWarned=!0}return i}return JSON.stringify(e)}function vi(n,e,t){const s=Cn(n,void 0,t),i=Cn(e,void 0,t);return new Pe(s,i)}class Pe{constructor(e,t=null){Object.defineProperty(this,lt,{value:go}),this.key=e,this.value=t}clone(e){let{key:t,value:s}=this;return Se(t)&&(t=t.clone(e)),Se(s)&&(s=s.clone(e)),new Pe(t,s)}toJSON(e,t){const s=t!=null&&t.mapAsMap?new Map:{};return Lo(t,s,this)}toString(e,t,s){return e!=null&&e.doc?oa(this,e,t,s):JSON.stringify(this)}}function Mo(n,e,t){return(e.inFlow??n.flow?fa:ca)(n,e,t)}function ca({comment:n,items:e},t,{blockItemPrefix:s,flowChars:i,itemIndent:r,onChompKeep:o,onComment:l}){const{indent:a,options:{commentString:c}}=t,u=Object.assign({},t,{indent:r,type:null});let d=!1;const p=[];for(let _=0;_<e.length;++_){const h=e[_];let y=null;if(Se(h))!d&&h.spaceBefore&&p.push(""),bs(t,p,h.commentBefore,d),h.comment&&(y=h.comment);else if(be(h)){const C=Se(h.key)?h.key:null;C&&(!d&&C.spaceBefore&&p.push(""),bs(t,p,C.commentBefore,d))}d=!1;let E=an(h,u,()=>y=null,()=>d=!0);y&&(E+=Mt(E,r,c(y))),d&&y&&(d=!1),p.push(s+E)}let m;if(p.length===0)m=i.start+i.end;else{m=p[0];for(let _=1;_<p.length;++_){const h=p[_];m+=h?`
${a}${h}`:`
`}}return n?(m+=`
`+_t(c(n),a),l&&l()):d&&o&&o(),m}function fa({items:n},e,{flowChars:t,itemIndent:s}){const{indent:i,indentStep:r,flowCollectionPadding:o,options:{commentString:l}}=e;s+=r;const a=Object.assign({},e,{indent:s,inFlow:!0,type:null});let c=!1,u=0;const d=[];for(let _=0;_<n.length;++_){const h=n[_];let y=null;if(Se(h))h.spaceBefore&&d.push(""),bs(e,d,h.commentBefore,!1),h.comment&&(y=h.comment);else if(be(h)){const C=Se(h.key)?h.key:null;C&&(C.spaceBefore&&d.push(""),bs(e,d,C.commentBefore,!1),C.comment&&(c=!0));const O=Se(h.value)?h.value:null;O?(O.comment&&(y=O.comment),O.commentBefore&&(c=!0)):h.value==null&&(C!=null&&C.comment)&&(y=C.comment)}y&&(c=!0);let E=an(h,a,()=>y=null);_<n.length-1&&(E+=","),y&&(E+=Mt(E,s,l(y))),!c&&(d.length>u||E.includes(`
`))&&(c=!0),d.push(E),u=d.length}const{start:p,end:m}=t;if(d.length===0)return p+m;if(!c){const _=d.reduce((h,y)=>h+y.length+2,2);c=e.options.lineWidth>0&&_>e.options.lineWidth}if(c){let _=p;for(const h of d)_+=h?`
${r}${i}${h}`:`
`;return`${_}
${i}${m}`}else return`${p}${o}${d.join(" ")}${o}${m}`}function bs({indent:n,options:{commentString:e}},t,s,i){if(s&&i&&(s=s.replace(/^\n+/,"")),s){const r=_t(e(s),n);t.push(r.trimStart())}}function Rt(n,e){const t=pe(e)?e.value:e;for(const s of n)if(be(s)&&(s.key===e||s.key===t||pe(s.key)&&s.key.value===t))return s}class tt extends Io{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(At,e),this.items=[]}static from(e,t,s){const{keepUndefined:i,replacer:r}=s,o=new this(e),l=(a,c)=>{if(typeof r=="function")c=r.call(t,a,c);else if(Array.isArray(r)&&!r.includes(a))return;(c!==void 0||i)&&o.items.push(vi(a,c,s))};if(t instanceof Map)for(const[a,c]of t)l(a,c);else if(t&&typeof t=="object")for(const a of Object.keys(t))l(a,t[a]);return typeof e.sortMapEntries=="function"&&o.items.sort(e.sortMapEntries),o}add(e,t){var o;let s;be(e)?s=e:!e||typeof e!="object"||!("key"in e)?s=new Pe(e,e==null?void 0:e.value):s=new Pe(e.key,e.value);const i=Rt(this.items,s.key),r=(o=this.schema)==null?void 0:o.sortMapEntries;if(i){if(!t)throw new Error(`Key ${s.key} already set`);pe(i.value)&&Ao(s.value)?i.value.value=s.value:i.value=s.value}else if(r){const l=this.items.findIndex(a=>r(s,a)<0);l===-1?this.items.push(s):this.items.splice(l,0,s)}else this.items.push(s)}delete(e){const t=Rt(this.items,e);return t?this.items.splice(this.items.indexOf(t),1).length>0:!1}get(e,t){const s=Rt(this.items,e),i=s==null?void 0:s.value;return(!t&&pe(i)?i.value:i)??void 0}has(e){return!!Rt(this.items,e)}set(e,t){this.add(new Pe(e,t),!0)}toJSON(e,t,s){const i=s?new s:t!=null&&t.mapAsMap?new Map:{};t!=null&&t.onCreate&&t.onCreate(i);for(const r of this.items)Lo(t,i,r);return i}toString(e,t,s){if(!e)return JSON.stringify(this);for(const i of this.items)if(!be(i))throw new Error(`Map items must all be pairs; found ${JSON.stringify(i)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),Mo(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:s,onComment:t})}}const mn={collection:"map",default:!0,nodeClass:tt,tag:"tag:yaml.org,2002:map",resolve(n,e){return dn(n)||e("Expected a mapping for this tag"),n},createNode:(n,e,t)=>tt.from(n,e,t)};class Ot extends Io{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(hn,e),this.items=[]}add(e){this.items.push(e)}delete(e){const t=is(e);return typeof t!="number"?!1:this.items.splice(t,1).length>0}get(e,t){const s=is(e);if(typeof s!="number")return;const i=this.items[s];return!t&&pe(i)?i.value:i}has(e){const t=is(e);return typeof t=="number"&&t<this.items.length}set(e,t){const s=is(e);if(typeof s!="number")throw new Error(`Expected a valid index, not ${e}.`);const i=this.items[s];pe(i)&&Ao(t)?i.value=t:this.items[s]=t}toJSON(e,t){const s=[];t!=null&&t.onCreate&&t.onCreate(s);let i=0;for(const r of this.items)s.push(ot(r,String(i++),t));return s}toString(e,t,s){return e?Mo(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:s,onComment:t}):JSON.stringify(this)}static from(e,t,s){const{replacer:i}=s,r=new this(e);if(t&&Symbol.iterator in Object(t)){let o=0;for(let l of t){if(typeof i=="function"){const a=t instanceof Set?l:String(o++);l=i.call(t,a,l)}r.items.push(Cn(l,void 0,s))}}return r}}function is(n){let e=pe(n)?n.value:n;return e&&typeof e=="string"&&(e=Number(e)),typeof e=="number"&&Number.isInteger(e)&&e>=0?e:null}const gn={collection:"seq",default:!0,nodeClass:Ot,tag:"tag:yaml.org,2002:seq",resolve(n,e){return pn(n)||e("Expected a sequence for this tag"),n},createNode:(n,e,t)=>Ot.from(n,e,t)},Cs={identify:n=>typeof n=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:n=>n,stringify(n,e,t,s){return e=Object.assign({actualString:!0},e),Hn(n,e,t,s)}},Ns={identify:n=>n==null,createNode:()=>new J(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new J(null),stringify:({source:n},e)=>typeof n=="string"&&Ns.test.test(n)?n:e.options.nullStr},Ei={identify:n=>typeof n=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:n=>new J(n[0]==="t"||n[0]==="T"),stringify({source:n,value:e},t){if(n&&Ei.test.test(n)){const s=n[0]==="t"||n[0]==="T";if(e===s)return n}return e?t.options.trueStr:t.options.falseStr}};function ht({format:n,minFractionDigits:e,tag:t,value:s}){if(typeof s=="bigint")return String(s);const i=typeof s=="number"?s:Number(s);if(!isFinite(i))return isNaN(i)?".nan":i<0?"-.inf":".inf";let r=JSON.stringify(s);if(!n&&e&&(!t||t==="tag:yaml.org,2002:float")&&/^\d/.test(r)){let o=r.indexOf(".");o<0&&(o=r.length,r+=".");let l=e-(r.length-o-1);for(;l-- >0;)r+="0"}return r}const Ro={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:n=>n.slice(-3).toLowerCase()==="nan"?NaN:n[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ht},Do={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:n=>parseFloat(n),stringify(n){const e=Number(n.value);return isFinite(e)?e.toExponential():ht(n)}},Bo={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(n){const e=new J(parseFloat(n)),t=n.indexOf(".");return t!==-1&&n[n.length-1]==="0"&&(e.minFractionDigits=n.length-t-1),e},stringify:ht},Ls=n=>typeof n=="bigint"||Number.isInteger(n),Ai=(n,e,t,{intAsBigInt:s})=>s?BigInt(n):parseInt(n.substring(e),t);function Po(n,e,t){const{value:s}=n;return Ls(s)&&s>=0?t+s.toString(e):ht(n)}const Fo={identify:n=>Ls(n)&&n>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(n,e,t)=>Ai(n,2,8,t),stringify:n=>Po(n,8,"0o")},zo={identify:Ls,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(n,e,t)=>Ai(n,0,10,t),stringify:ht},jo={identify:n=>Ls(n)&&n>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(n,e,t)=>Ai(n,2,16,t),stringify:n=>Po(n,16,"0x")},ua=[mn,gn,Cs,Ns,Ei,Fo,zo,jo,Ro,Do,Bo];function ir(n){return typeof n=="bigint"||Number.isInteger(n)}const rs=({value:n})=>JSON.stringify(n),ha=[{identify:n=>typeof n=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:n=>n,stringify:rs},{identify:n=>n==null,createNode:()=>new J(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:rs},{identify:n=>typeof n=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:n=>n==="true",stringify:rs},{identify:ir,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(n,e,{intAsBigInt:t})=>t?BigInt(n):parseInt(n,10),stringify:({value:n})=>ir(n)?n.toString():JSON.stringify(n)},{identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:n=>parseFloat(n),stringify:rs}],da={default:!0,tag:"",test:/^/,resolve(n,e){return e(`Unresolved plain scalar ${JSON.stringify(n)}`),n}},pa=[mn,gn].concat(ha,da),Ii={identify:n=>n instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(n,e){if(typeof atob=="function"){const t=atob(n.replace(/[\n\r]/g,"")),s=new Uint8Array(t.length);for(let i=0;i<t.length;++i)s[i]=t.charCodeAt(i);return s}else return e("This environment does not support reading binary tags; either Buffer or atob is required"),n},stringify({comment:n,type:e,value:t},s,i,r){if(!t)return"";const o=t;let l;if(typeof btoa=="function"){let a="";for(let c=0;c<o.length;++c)a+=String.fromCharCode(o[c]);l=btoa(a)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(e??(e=J.BLOCK_LITERAL),e!==J.QUOTE_DOUBLE){const a=Math.max(s.options.lineWidth-s.indent.length,s.options.minContentWidth),c=Math.ceil(l.length/a),u=new Array(c);for(let d=0,p=0;d<c;++d,p+=a)u[d]=l.substr(p,a);l=u.join(e===J.BLOCK_LITERAL?`
`:" ")}return Hn({comment:n,type:e,value:l},s,i,r)}};function Uo(n,e){if(pn(n))for(let t=0;t<n.items.length;++t){let s=n.items[t];if(!be(s)){if(dn(s)){s.items.length>1&&e("Each pair must have its own sequence indicator");const i=s.items[0]||new Pe(new J(null));if(s.commentBefore&&(i.key.commentBefore=i.key.commentBefore?`${s.commentBefore}
${i.key.commentBefore}`:s.commentBefore),s.comment){const r=i.value??i.key;r.comment=r.comment?`${s.comment}
${r.comment}`:s.comment}s=i}n.items[t]=be(s)?s:new Pe(s)}}else e("Expected a sequence for this tag");return n}function Ko(n,e,t){const{replacer:s}=t,i=new Ot(n);i.tag="tag:yaml.org,2002:pairs";let r=0;if(e&&Symbol.iterator in Object(e))for(let o of e){typeof s=="function"&&(o=s.call(e,String(r++),o));let l,a;if(Array.isArray(o))if(o.length===2)l=o[0],a=o[1];else throw new TypeError(`Expected [key, value] tuple: ${o}`);else if(o&&o instanceof Object){const c=Object.keys(o);if(c.length===1)l=c[0],a=o[l];else throw new TypeError(`Expected tuple with one key, not ${c.length} keys`)}else l=o;i.items.push(vi(l,a,t))}return i}const Oi={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:Uo,createNode:Ko};class nn extends Ot{constructor(){super(),this.add=tt.prototype.add.bind(this),this.delete=tt.prototype.delete.bind(this),this.get=tt.prototype.get.bind(this),this.has=tt.prototype.has.bind(this),this.set=tt.prototype.set.bind(this),this.tag=nn.tag}toJSON(e,t){if(!t)return super.toJSON(e);const s=new Map;t!=null&&t.onCreate&&t.onCreate(s);for(const i of this.items){let r,o;if(be(i)?(r=ot(i.key,"",t),o=ot(i.value,r,t)):r=ot(i,"",t),s.has(r))throw new Error("Ordered maps must not include duplicate keys");s.set(r,o)}return s}static from(e,t,s){const i=Ko(e,t,s),r=new this;return r.items=i.items,r}}nn.tag="tag:yaml.org,2002:omap";const Ti={collection:"seq",identify:n=>n instanceof Map,nodeClass:nn,default:!1,tag:"tag:yaml.org,2002:omap",resolve(n,e){const t=Uo(n,e),s=[];for(const{key:i}of t.items)pe(i)&&(s.includes(i.value)?e(`Ordered maps must not include duplicate keys: ${i.value}`):s.push(i.value));return Object.assign(new nn,t)},createNode:(n,e,t)=>nn.from(n,e,t)};function qo({value:n,source:e},t){return e&&(n?$o:Vo).test.test(e)?e:n?t.options.trueStr:t.options.falseStr}const $o={identify:n=>n===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new J(!0),stringify:qo},Vo={identify:n=>n===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new J(!1),stringify:qo},ma={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:n=>n.slice(-3).toLowerCase()==="nan"?NaN:n[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ht},ga={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:n=>parseFloat(n.replace(/_/g,"")),stringify(n){const e=Number(n.value);return isFinite(e)?e.toExponential():ht(n)}},ya={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(n){const e=new J(parseFloat(n.replace(/_/g,""))),t=n.indexOf(".");if(t!==-1){const s=n.substring(t+1).replace(/_/g,"");s[s.length-1]==="0"&&(e.minFractionDigits=s.length)}return e},stringify:ht},Gn=n=>typeof n=="bigint"||Number.isInteger(n);function Ms(n,e,t,{intAsBigInt:s}){const i=n[0];if((i==="-"||i==="+")&&(e+=1),n=n.substring(e).replace(/_/g,""),s){switch(t){case 2:n=`0b${n}`;break;case 8:n=`0o${n}`;break;case 16:n=`0x${n}`;break}const o=BigInt(n);return i==="-"?BigInt(-1)*o:o}const r=parseInt(n,t);return i==="-"?-1*r:r}function Ci(n,e,t){const{value:s}=n;if(Gn(s)){const i=s.toString(e);return s<0?"-"+t+i.substr(1):t+i}return ht(n)}const _a={identify:Gn,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(n,e,t)=>Ms(n,2,2,t),stringify:n=>Ci(n,2,"0b")},ba={identify:Gn,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(n,e,t)=>Ms(n,1,8,t),stringify:n=>Ci(n,8,"0")},wa={identify:Gn,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(n,e,t)=>Ms(n,0,10,t),stringify:ht},ka={identify:Gn,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(n,e,t)=>Ms(n,2,16,t),stringify:n=>Ci(n,16,"0x")};class sn extends tt{constructor(e){super(e),this.tag=sn.tag}add(e){let t;be(e)?t=e:e&&typeof e=="object"&&"key"in e&&"value"in e&&e.value===null?t=new Pe(e.key,null):t=new Pe(e,null),Rt(this.items,t.key)||this.items.push(t)}get(e,t){const s=Rt(this.items,e);return!t&&be(s)?pe(s.key)?s.key.value:s.key:s}set(e,t){if(typeof t!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof t}`);const s=Rt(this.items,e);s&&!t?this.items.splice(this.items.indexOf(s),1):!s&&t&&this.items.push(new Pe(e))}toJSON(e,t){return super.toJSON(e,t,Set)}toString(e,t,s){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),t,s);throw new Error("Set items must all have null values")}static from(e,t,s){const{replacer:i}=s,r=new this(e);if(t&&Symbol.iterator in Object(t))for(let o of t)typeof i=="function"&&(o=i.call(t,o,o)),r.items.push(vi(o,null,s));return r}}sn.tag="tag:yaml.org,2002:set";const Ni={collection:"map",identify:n=>n instanceof Set,nodeClass:sn,default:!1,tag:"tag:yaml.org,2002:set",createNode:(n,e,t)=>sn.from(n,e,t),resolve(n,e){if(dn(n)){if(n.hasAllNullValues(!0))return Object.assign(new sn,n);e("Set items must all have null values")}else e("Expected a mapping for this tag");return n}};function Li(n,e){const t=n[0],s=t==="-"||t==="+"?n.substring(1):n,i=o=>e?BigInt(o):Number(o),r=s.replace(/_/g,"").split(":").reduce((o,l)=>o*i(60)+i(l),i(0));return t==="-"?i(-1)*r:r}function Jo(n){let{value:e}=n,t=o=>o;if(typeof e=="bigint")t=o=>BigInt(o);else if(isNaN(e)||!isFinite(e))return ht(n);let s="";e<0&&(s="-",e*=t(-1));const i=t(60),r=[e%i];return e<60?r.unshift(0):(e=(e-r[0])/i,r.unshift(e%i),e>=60&&(e=(e-r[0])/i,r.unshift(e))),s+r.map(o=>String(o).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const Wo={identify:n=>typeof n=="bigint"||Number.isInteger(n),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(n,e,{intAsBigInt:t})=>Li(n,t),stringify:Jo},Yo={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:n=>Li(n,!1),stringify:Jo},Rs={identify:n=>n instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(n){const e=n.match(Rs.test);if(!e)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,t,s,i,r,o,l]=e.map(Number),a=e[7]?Number((e[7]+"00").substr(1,3)):0;let c=Date.UTC(t,s-1,i,r||0,o||0,l||0,a);const u=e[8];if(u&&u!=="Z"){let d=Li(u,!1);Math.abs(d)<30&&(d*=60),c-=6e4*d}return new Date(c)},stringify:({value:n})=>(n==null?void 0:n.toISOString().replace(/(T00:00:00)?\.000Z$/,""))??""},rr=[mn,gn,Cs,Ns,$o,Vo,_a,ba,wa,ka,ma,ga,ya,Ii,bt,Ti,Oi,Ni,Wo,Yo,Rs],or=new Map([["core",ua],["failsafe",[mn,gn,Cs]],["json",pa],["yaml11",rr],["yaml-1.1",rr]]),lr={binary:Ii,bool:Ei,float:Bo,floatExp:Do,floatNaN:Ro,floatTime:Yo,int:zo,intHex:jo,intOct:Fo,intTime:Wo,map:mn,merge:bt,null:Ns,omap:Ti,pairs:Oi,seq:gn,set:Ni,timestamp:Rs},Sa={"tag:yaml.org,2002:binary":Ii,"tag:yaml.org,2002:merge":bt,"tag:yaml.org,2002:omap":Ti,"tag:yaml.org,2002:pairs":Oi,"tag:yaml.org,2002:set":Ni,"tag:yaml.org,2002:timestamp":Rs};function Ys(n,e,t){const s=or.get(e);if(s&&!n)return t&&!s.includes(bt)?s.concat(bt):s.slice();let i=s;if(!i)if(Array.isArray(n))i=[];else{const r=Array.from(or.keys()).filter(o=>o!=="yaml11").map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown schema "${e}"; use one of ${r} or define customTags array`)}if(Array.isArray(n))for(const r of n)i=i.concat(r);else typeof n=="function"&&(i=n(i.slice()));return t&&(i=i.concat(bt)),i.reduce((r,o)=>{const l=typeof o=="string"?lr[o]:o;if(!l){const a=JSON.stringify(o),c=Object.keys(lr).map(u=>JSON.stringify(u)).join(", ");throw new Error(`Unknown custom tag ${a}; use one of ${c}`)}return r.includes(l)||r.push(l),r},[])}const va=(n,e)=>n.key<e.key?-1:n.key>e.key?1:0;class Ds{constructor({compat:e,customTags:t,merge:s,resolveKnownTags:i,schema:r,sortMapEntries:o,toStringDefaults:l}){this.compat=Array.isArray(e)?Ys(e,"compat"):e?Ys(null,e):null,this.name=typeof r=="string"&&r||"core",this.knownTags=i?Sa:{},this.tags=Ys(t,this.name,s),this.toStringOptions=l??null,Object.defineProperty(this,At,{value:mn}),Object.defineProperty(this,mt,{value:Cs}),Object.defineProperty(this,hn,{value:gn}),this.sortMapEntries=typeof o=="function"?o:o===!0?va:null}clone(){const e=Object.create(Ds.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}}function Ea(n,e){var a;const t=[];let s=e.directives===!0;if(e.directives!==!1&&n.directives){const c=n.directives.toString(n);c?(t.push(c),s=!0):n.directives.docStart&&(s=!0)}s&&t.push("---");const i=To(n,e),{commentString:r}=i.options;if(n.commentBefore){t.length!==1&&t.unshift("");const c=r(n.commentBefore);t.unshift(_t(c,""))}let o=!1,l=null;if(n.contents){if(Se(n.contents)){if(n.contents.spaceBefore&&s&&t.push(""),n.contents.commentBefore){const d=r(n.contents.commentBefore);t.push(_t(d,""))}i.forceBlockIndent=!!n.comment,l=n.contents.comment}const c=l?void 0:()=>o=!0;let u=an(n.contents,i,()=>l=null,c);l&&(u+=Mt(u,"",r(l))),(u[0]==="|"||u[0]===">")&&t[t.length-1]==="---"?t[t.length-1]=`--- ${u}`:t.push(u)}else t.push(an(n.contents,i));if((a=n.directives)!=null&&a.docEnd)if(n.comment){const c=r(n.comment);c.includes(`
`)?(t.push("..."),t.push(_t(c,""))):t.push(`... ${c}`)}else t.push("...");else{let c=n.comment;c&&o&&(c=c.replace(/^\n+/,"")),c&&((!o||l)&&t[t.length-1]!==""&&t.push(""),t.push(_t(r(c),"")))}return t.join(`
`)+`
`}class yn{constructor(e,t,s){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,lt,{value:li});let i=null;typeof t=="function"||Array.isArray(t)?i=t:s===void 0&&t&&(s=t,t=void 0);const r=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},s);this.options=r;let{version:o}=r;s!=null&&s._directives?(this.directives=s._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new qe({version:o}),this.setSchema(o,s),this.contents=e===void 0?null:this.createNode(e,i,s)}clone(){const e=Object.create(yn.prototype,{[lt]:{value:li}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=Se(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){Yt(this.contents)&&this.contents.add(e)}addIn(e,t){Yt(this.contents)&&this.contents.addIn(e,t)}createAlias(e,t){if(!e.anchor){const s=vo(this);e.anchor=!t||s.has(t)?Eo(t||"a",s):t}return new As(e.anchor)}createNode(e,t,s){let i;if(typeof t=="function")e=t.call({"":e},"",e),i=t;else if(Array.isArray(t)){const y=C=>typeof C=="number"||C instanceof String||C instanceof Number,E=t.filter(y).map(String);E.length>0&&(t=t.concat(E)),i=t}else s===void 0&&t&&(s=t,t=void 0);const{aliasDuplicateObjects:r,anchorPrefix:o,flow:l,keepUndefined:a,onTagObj:c,tag:u}=s??{},{onAnchor:d,setAnchors:p,sourceObjects:m}=Zl(this,o||"a"),_={aliasDuplicateObjects:r??!0,keepUndefined:a??!1,onAnchor:d,onTagObj:c,replacer:i,schema:this.schema,sourceObjects:m},h=Cn(e,u,_);return l&&ke(h)&&(h.flow=!0),p(),h}createPair(e,t,s={}){const i=this.createNode(e,null,s),r=this.createNode(t,null,s);return new Pe(i,r)}delete(e){return Yt(this.contents)?this.contents.delete(e):!1}deleteIn(e){return En(e)?this.contents==null?!1:(this.contents=null,!0):Yt(this.contents)?this.contents.deleteIn(e):!1}get(e,t){return ke(this.contents)?this.contents.get(e,t):void 0}getIn(e,t){return En(e)?!t&&pe(this.contents)?this.contents.value:this.contents:ke(this.contents)?this.contents.getIn(e,t):void 0}has(e){return ke(this.contents)?this.contents.has(e):!1}hasIn(e){return En(e)?this.contents!==void 0:ke(this.contents)?this.contents.hasIn(e):!1}set(e,t){this.contents==null?this.contents=_s(this.schema,[e],t):Yt(this.contents)&&this.contents.set(e,t)}setIn(e,t){En(e)?this.contents=t:this.contents==null?this.contents=_s(this.schema,Array.from(e),t):Yt(this.contents)&&this.contents.setIn(e,t)}setSchema(e,t={}){typeof e=="number"&&(e=String(e));let s;switch(e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new qe({version:"1.1"}),s={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new qe({version:e}),s={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,s=null;break;default:{const i=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${i}`)}}if(t.schema instanceof Object)this.schema=t.schema;else if(s)this.schema=new Ds(Object.assign(s,t));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:t,mapAsMap:s,maxAliasCount:i,onAnchor:r,reviver:o}={}){const l={anchors:new Map,doc:this,keep:!e,mapAsMap:s===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},a=ot(this.contents,t??"",l);if(typeof r=="function")for(const{count:c,res:u}of l.anchors.values())r(u,c);return typeof o=="function"?Zt(o,{"":a},"",a):a}toJSON(e,t){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:t})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){const t=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${t}`)}return Ea(this,e)}}function Yt(n){if(ke(n))return!0;throw new Error("Expected a YAML collection as document contents")}class Mi extends Error{constructor(e,t,s,i){super(),this.name=e,this.code=s,this.message=i,this.pos=t}}class Dt extends Mi{constructor(e,t,s){super("YAMLParseError",e,t,s)}}class Ho extends Mi{constructor(e,t,s){super("YAMLWarning",e,t,s)}}const ws=(n,e)=>t=>{if(t.pos[0]===-1)return;t.linePos=t.pos.map(l=>e.linePos(l));const{line:s,col:i}=t.linePos[0];t.message+=` at line ${s}, column ${i}`;let r=i-1,o=n.substring(e.lineStarts[s-1],e.lineStarts[s]).replace(/[\n\r]+$/,"");if(r>=60&&o.length>80){const l=Math.min(r-39,o.length-79);o=""+o.substring(l),r-=l-1}if(o.length>80&&(o=o.substring(0,79)+""),s>1&&/^ *$/.test(o.substring(0,r))){let l=n.substring(e.lineStarts[s-2],e.lineStarts[s-1]);l.length>80&&(l=l.substring(0,79)+`
`),o=l+o}if(/[^ ]/.test(o)){let l=1;const a=t.linePos[1];a&&a.line===s&&a.col>i&&(l=Math.max(1,Math.min(a.col-i,80-r)));const c=" ".repeat(r)+"^".repeat(l);t.message+=`:

${o}
${c}
`}};function cn(n,{flow:e,indicator:t,next:s,offset:i,onError:r,parentIndent:o,startOnNewline:l}){let a=!1,c=l,u=l,d="",p="",m=!1,_=!1,h=null,y=null,E=null,C=null,O=null,M=null,R=null;for(const f of n)switch(_&&(f.type!=="space"&&f.type!=="newline"&&f.type!=="comma"&&r(f.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),_=!1),h&&(c&&f.type!=="comment"&&f.type!=="newline"&&r(h,"TAB_AS_INDENT","Tabs are not allowed as indentation"),h=null),f.type){case"space":!e&&(t!=="doc-start"||(s==null?void 0:s.type)!=="flow-collection")&&f.source.includes("	")&&(h=f),u=!0;break;case"comment":{u||r(f,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const g=f.source.substring(1)||" ";d?d+=p+g:d=g,p="",c=!1;break}case"newline":c?d?d+=f.source:(!M||t!=="seq-item-ind")&&(a=!0):p+=f.source,c=!0,m=!0,(y||E)&&(C=f),u=!0;break;case"anchor":y&&r(f,"MULTIPLE_ANCHORS","A node can have at most one anchor"),f.source.endsWith(":")&&r(f.offset+f.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),y=f,R??(R=f.offset),c=!1,u=!1,_=!0;break;case"tag":{E&&r(f,"MULTIPLE_TAGS","A node can have at most one tag"),E=f,R??(R=f.offset),c=!1,u=!1,_=!0;break}case t:(y||E)&&r(f,"BAD_PROP_ORDER",`Anchors and tags must be after the ${f.source} indicator`),M&&r(f,"UNEXPECTED_TOKEN",`Unexpected ${f.source} in ${e??"collection"}`),M=f,c=t==="seq-item-ind"||t==="explicit-key-ind",u=!1;break;case"comma":if(e){O&&r(f,"UNEXPECTED_TOKEN",`Unexpected , in ${e}`),O=f,c=!1,u=!1;break}default:r(f,"UNEXPECTED_TOKEN",`Unexpected ${f.type} token`),c=!1,u=!1}const T=n[n.length-1],b=T?T.offset+T.source.length:i;return _&&s&&s.type!=="space"&&s.type!=="newline"&&s.type!=="comma"&&(s.type!=="scalar"||s.source!=="")&&r(s.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),h&&(c&&h.indent<=o||(s==null?void 0:s.type)==="block-map"||(s==null?void 0:s.type)==="block-seq")&&r(h,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:O,found:M,spaceBefore:a,comment:d,hasNewline:m,anchor:y,tag:E,newlineAfterProp:C,end:b,start:R??b}}function Nn(n){if(!n)return null;switch(n.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(n.source.includes(`
`))return!0;if(n.end){for(const e of n.end)if(e.type==="newline")return!0}return!1;case"flow-collection":for(const e of n.items){for(const t of e.start)if(t.type==="newline")return!0;if(e.sep){for(const t of e.sep)if(t.type==="newline")return!0}if(Nn(e.key)||Nn(e.value))return!0}return!1;default:return!0}}function ui(n,e,t){if((e==null?void 0:e.type)==="flow-collection"){const s=e.end[0];s.indent===n&&(s.source==="]"||s.source==="}")&&Nn(e)&&t(s,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function Go(n,e,t){const{uniqueKeys:s}=n.options;if(s===!1)return!1;const i=typeof s=="function"?s:(r,o)=>r===o||pe(r)&&pe(o)&&r.value===o.value;return e.some(r=>i(r.key,t))}const ar="All mapping items must start at the same column";function Aa({composeNode:n,composeEmptyNode:e},t,s,i,r){var u;const o=(r==null?void 0:r.nodeClass)??tt,l=new o(t.schema);t.atRoot&&(t.atRoot=!1);let a=s.offset,c=null;for(const d of s.items){const{start:p,key:m,sep:_,value:h}=d,y=cn(p,{indicator:"explicit-key-ind",next:m??(_==null?void 0:_[0]),offset:a,onError:i,parentIndent:s.indent,startOnNewline:!0}),E=!y.found;if(E){if(m&&(m.type==="block-seq"?i(a,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in m&&m.indent!==s.indent&&i(a,"BAD_INDENT",ar)),!y.anchor&&!y.tag&&!_){c=y.end,y.comment&&(l.comment?l.comment+=`
`+y.comment:l.comment=y.comment);continue}(y.newlineAfterProp||Nn(m))&&i(m??p[p.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else((u=y.found)==null?void 0:u.indent)!==s.indent&&i(a,"BAD_INDENT",ar);t.atKey=!0;const C=y.end,O=m?n(t,m,y,i):e(t,C,p,null,y,i);t.schema.compat&&ui(s.indent,m,i),t.atKey=!1,Go(t,l.items,O)&&i(C,"DUPLICATE_KEY","Map keys must be unique");const M=cn(_??[],{indicator:"map-value-ind",next:h,offset:O.range[2],onError:i,parentIndent:s.indent,startOnNewline:!m||m.type==="block-scalar"});if(a=M.end,M.found){E&&((h==null?void 0:h.type)==="block-map"&&!M.hasNewline&&i(a,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),t.options.strict&&y.start<M.found.offset-1024&&i(O.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const R=h?n(t,h,M,i):e(t,a,_,null,M,i);t.schema.compat&&ui(s.indent,h,i),a=R.range[2];const T=new Pe(O,R);t.options.keepSourceTokens&&(T.srcToken=d),l.items.push(T)}else{E&&i(O.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),M.comment&&(O.comment?O.comment+=`
`+M.comment:O.comment=M.comment);const R=new Pe(O);t.options.keepSourceTokens&&(R.srcToken=d),l.items.push(R)}}return c&&c<a&&i(c,"IMPOSSIBLE","Map comment with trailing content"),l.range=[s.offset,a,c??a],l}function Ia({composeNode:n,composeEmptyNode:e},t,s,i,r){const o=(r==null?void 0:r.nodeClass)??Ot,l=new o(t.schema);t.atRoot&&(t.atRoot=!1),t.atKey&&(t.atKey=!1);let a=s.offset,c=null;for(const{start:u,value:d}of s.items){const p=cn(u,{indicator:"seq-item-ind",next:d,offset:a,onError:i,parentIndent:s.indent,startOnNewline:!0});if(!p.found)if(p.anchor||p.tag||d)d&&d.type==="block-seq"?i(p.end,"BAD_INDENT","All sequence items must start at the same column"):i(a,"MISSING_CHAR","Sequence item without - indicator");else{c=p.end,p.comment&&(l.comment=p.comment);continue}const m=d?n(t,d,p,i):e(t,p.end,u,null,p,i);t.schema.compat&&ui(s.indent,d,i),a=m.range[2],l.items.push(m)}return l.range=[s.offset,a,c??a],l}function Qn(n,e,t,s){let i="";if(n){let r=!1,o="";for(const l of n){const{source:a,type:c}=l;switch(c){case"space":r=!0;break;case"comment":{t&&!r&&s(l,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const u=a.substring(1)||" ";i?i+=o+u:i=u,o="";break}case"newline":i&&(o+=a),r=!0;break;default:s(l,"UNEXPECTED_TOKEN",`Unexpected ${c} at node end`)}e+=a.length}}return{comment:i,offset:e}}const Hs="Block collections are not allowed within flow collections",Gs=n=>n&&(n.type==="block-map"||n.type==="block-seq");function Oa({composeNode:n,composeEmptyNode:e},t,s,i,r){const o=s.start.source==="{",l=o?"flow map":"flow sequence",a=(r==null?void 0:r.nodeClass)??(o?tt:Ot),c=new a(t.schema);c.flow=!0;const u=t.atRoot;u&&(t.atRoot=!1),t.atKey&&(t.atKey=!1);let d=s.offset+s.start.source.length;for(let y=0;y<s.items.length;++y){const E=s.items[y],{start:C,key:O,sep:M,value:R}=E,T=cn(C,{flow:l,indicator:"explicit-key-ind",next:O??(M==null?void 0:M[0]),offset:d,onError:i,parentIndent:s.indent,startOnNewline:!1});if(!T.found){if(!T.anchor&&!T.tag&&!M&&!R){y===0&&T.comma?i(T.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${l}`):y<s.items.length-1&&i(T.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${l}`),T.comment&&(c.comment?c.comment+=`
`+T.comment:c.comment=T.comment),d=T.end;continue}!o&&t.options.strict&&Nn(O)&&i(O,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(y===0)T.comma&&i(T.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${l}`);else if(T.comma||i(T.start,"MISSING_CHAR",`Missing , between ${l} items`),T.comment){let b="";e:for(const f of C)switch(f.type){case"comma":case"space":break;case"comment":b=f.source.substring(1);break e;default:break e}if(b){let f=c.items[c.items.length-1];be(f)&&(f=f.value??f.key),f.comment?f.comment+=`
`+b:f.comment=b,T.comment=T.comment.substring(b.length+1)}}if(!o&&!M&&!T.found){const b=R?n(t,R,T,i):e(t,T.end,M,null,T,i);c.items.push(b),d=b.range[2],Gs(R)&&i(b.range,"BLOCK_IN_FLOW",Hs)}else{t.atKey=!0;const b=T.end,f=O?n(t,O,T,i):e(t,b,C,null,T,i);Gs(O)&&i(f.range,"BLOCK_IN_FLOW",Hs),t.atKey=!1;const g=cn(M??[],{flow:l,indicator:"map-value-ind",next:R,offset:f.range[2],onError:i,parentIndent:s.indent,startOnNewline:!1});if(g.found){if(!o&&!T.found&&t.options.strict){if(M)for(const S of M){if(S===g.found)break;if(S.type==="newline"){i(S,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}T.start<g.found.offset-1024&&i(g.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else R&&("source"in R&&R.source&&R.source[0]===":"?i(R,"MISSING_CHAR",`Missing space after : in ${l}`):i(g.start,"MISSING_CHAR",`Missing , or : between ${l} items`));const w=R?n(t,R,g,i):g.found?e(t,g.end,M,null,g,i):null;w?Gs(R)&&i(w.range,"BLOCK_IN_FLOW",Hs):g.comment&&(f.comment?f.comment+=`
`+g.comment:f.comment=g.comment);const A=new Pe(f,w);if(t.options.keepSourceTokens&&(A.srcToken=E),o){const S=c;Go(t,S.items,f)&&i(b,"DUPLICATE_KEY","Map keys must be unique"),S.items.push(A)}else{const S=new tt(t.schema);S.flow=!0,S.items.push(A);const z=(w??f).range;S.range=[f.range[0],z[1],z[2]],c.items.push(S)}d=w?w.range[2]:g.end}}const p=o?"}":"]",[m,..._]=s.end;let h=d;if(m&&m.source===p)h=m.offset+m.source.length;else{const y=l[0].toUpperCase()+l.substring(1),E=u?`${y} must end with a ${p}`:`${y} in block collection must be sufficiently indented and end with a ${p}`;i(d,u?"MISSING_CHAR":"BAD_INDENT",E),m&&m.source.length!==1&&_.unshift(m)}if(_.length>0){const y=Qn(_,h,t.options.strict,i);y.comment&&(c.comment?c.comment+=`
`+y.comment:c.comment=y.comment),c.range=[s.offset,h,y.offset]}else c.range=[s.offset,h,h];return c}function Qs(n,e,t,s,i,r){const o=t.type==="block-map"?Aa(n,e,t,s,r):t.type==="block-seq"?Ia(n,e,t,s,r):Oa(n,e,t,s,r),l=o.constructor;return i==="!"||i===l.tagName?(o.tag=l.tagName,o):(i&&(o.tag=i),o)}function Ta(n,e,t,s,i){var p;const r=s.tag,o=r?e.directives.tagName(r.source,m=>i(r,"TAG_RESOLVE_FAILED",m)):null;if(t.type==="block-seq"){const{anchor:m,newlineAfterProp:_}=s,h=m&&r?m.offset>r.offset?m:r:m??r;h&&(!_||_.offset<h.offset)&&i(h,"MISSING_CHAR","Missing newline after block sequence props")}const l=t.type==="block-map"?"map":t.type==="block-seq"?"seq":t.start.source==="{"?"map":"seq";if(!r||!o||o==="!"||o===tt.tagName&&l==="map"||o===Ot.tagName&&l==="seq")return Qs(n,e,t,i,o);let a=e.schema.tags.find(m=>m.tag===o&&m.collection===l);if(!a){const m=e.schema.knownTags[o];if(m&&m.collection===l)e.schema.tags.push(Object.assign({},m,{default:!1})),a=m;else return m?i(r,"BAD_COLLECTION_TYPE",`${m.tag} used for ${l} collection, but expects ${m.collection??"scalar"}`,!0):i(r,"TAG_RESOLVE_FAILED",`Unresolved tag: ${o}`,!0),Qs(n,e,t,i,o)}const c=Qs(n,e,t,i,o,a),u=((p=a.resolve)==null?void 0:p.call(a,c,m=>i(r,"TAG_RESOLVE_FAILED",m),e.options))??c,d=Se(u)?u:new J(u);return d.range=c.range,d.tag=o,a!=null&&a.format&&(d.format=a.format),d}function Qo(n,e,t){const s=e.offset,i=Ca(e,n.options.strict,t);if(!i)return{value:"",type:null,comment:"",range:[s,s,s]};const r=i.mode===">"?J.BLOCK_FOLDED:J.BLOCK_LITERAL,o=e.source?Na(e.source):[];let l=o.length;for(let h=o.length-1;h>=0;--h){const y=o[h][1];if(y===""||y==="\r")l=h;else break}if(l===0){const h=i.chomp==="+"&&o.length>0?`
`.repeat(Math.max(1,o.length-1)):"";let y=s+i.length;return e.source&&(y+=e.source.length),{value:h,type:r,comment:i.comment,range:[s,y,y]}}let a=e.indent+i.indent,c=e.offset+i.length,u=0;for(let h=0;h<l;++h){const[y,E]=o[h];if(E===""||E==="\r")i.indent===0&&y.length>a&&(a=y.length);else{y.length<a&&t(c+y.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),i.indent===0&&(a=y.length),u=h,a===0&&!n.atRoot&&t(c,"BAD_INDENT","Block scalar values in collections must be indented");break}c+=y.length+E.length+1}for(let h=o.length-1;h>=l;--h)o[h][0].length>a&&(l=h+1);let d="",p="",m=!1;for(let h=0;h<u;++h)d+=o[h][0].slice(a)+`
`;for(let h=u;h<l;++h){let[y,E]=o[h];c+=y.length+E.length+1;const C=E[E.length-1]==="\r";if(C&&(E=E.slice(0,-1)),E&&y.length<a){const M=`Block scalar lines must not be less indented than their ${i.indent?"explicit indentation indicator":"first line"}`;t(c-E.length-(C?2:1),"BAD_INDENT",M),y=""}r===J.BLOCK_LITERAL?(d+=p+y.slice(a)+E,p=`
`):y.length>a||E[0]==="	"?(p===" "?p=`
`:!m&&p===`
`&&(p=`

`),d+=p+y.slice(a)+E,p=`
`,m=!0):E===""?p===`
`?d+=`
`:p=`
`:(d+=p+E,p=" ",m=!1)}switch(i.chomp){case"-":break;case"+":for(let h=l;h<o.length;++h)d+=`
`+o[h][0].slice(a);d[d.length-1]!==`
`&&(d+=`
`);break;default:d+=`
`}const _=s+i.length+e.source.length;return{value:d,type:r,comment:i.comment,range:[s,_,_]}}function Ca({offset:n,props:e},t,s){if(e[0].type!=="block-scalar-header")return s(e[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:i}=e[0],r=i[0];let o=0,l="",a=-1;for(let p=1;p<i.length;++p){const m=i[p];if(!l&&(m==="-"||m==="+"))l=m;else{const _=Number(m);!o&&_?o=_:a===-1&&(a=n+p)}}a!==-1&&s(a,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${i}`);let c=!1,u="",d=i.length;for(let p=1;p<e.length;++p){const m=e[p];switch(m.type){case"space":c=!0;case"newline":d+=m.source.length;break;case"comment":t&&!c&&s(m,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),d+=m.source.length,u=m.source.substring(1);break;case"error":s(m,"UNEXPECTED_TOKEN",m.message),d+=m.source.length;break;default:{const _=`Unexpected token in block scalar header: ${m.type}`;s(m,"UNEXPECTED_TOKEN",_);const h=m.source;h&&typeof h=="string"&&(d+=h.length)}}}return{mode:r,indent:o,chomp:l,comment:u,length:d}}function Na(n){const e=n.split(/\n( *)/),t=e[0],s=t.match(/^( *)/),r=[s!=null&&s[1]?[s[1],t.slice(s[1].length)]:["",t]];for(let o=1;o<e.length;o+=2)r.push([e[o],e[o+1]]);return r}function Xo(n,e,t){const{offset:s,type:i,source:r,end:o}=n;let l,a;const c=(p,m,_)=>t(s+p,m,_);switch(i){case"scalar":l=J.PLAIN,a=La(r,c);break;case"single-quoted-scalar":l=J.QUOTE_SINGLE,a=Ma(r,c);break;case"double-quoted-scalar":l=J.QUOTE_DOUBLE,a=Ra(r,c);break;default:return t(n,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${i}`),{value:"",type:null,comment:"",range:[s,s+r.length,s+r.length]}}const u=s+r.length,d=Qn(o,u,e,t);return{value:a,type:l,comment:d.comment,range:[s,u,d.offset]}}function La(n,e){let t="";switch(n[0]){case"	":t="a tab character";break;case",":t="flow indicator character ,";break;case"%":t="directive indicator character %";break;case"|":case">":{t=`block scalar indicator ${n[0]}`;break}case"@":case"`":{t=`reserved character ${n[0]}`;break}}return t&&e(0,"BAD_SCALAR_START",`Plain value cannot start with ${t}`),Zo(n)}function Ma(n,e){return(n[n.length-1]!=="'"||n.length===1)&&e(n.length,"MISSING_CHAR","Missing closing 'quote"),Zo(n.slice(1,-1)).replace(/''/g,"'")}function Zo(n){let e,t;try{e=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),t=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{e=/(.*?)[ \t]*\r?\n/sy,t=/[ \t]*(.*?)[ \t]*\r?\n/sy}let s=e.exec(n);if(!s)return n;let i=s[1],r=" ",o=e.lastIndex;for(t.lastIndex=o;s=t.exec(n);)s[1]===""?r===`
`?i+=r:r=`
`:(i+=r+s[1],r=" "),o=t.lastIndex;const l=/[ \t]*(.*)/sy;return l.lastIndex=o,s=l.exec(n),i+r+((s==null?void 0:s[1])??"")}function Ra(n,e){let t="";for(let s=1;s<n.length-1;++s){const i=n[s];if(!(i==="\r"&&n[s+1]===`
`))if(i===`
`){const{fold:r,offset:o}=Da(n,s);t+=r,s=o}else if(i==="\\"){let r=n[++s];const o=Ba[r];if(o)t+=o;else if(r===`
`)for(r=n[s+1];r===" "||r==="	";)r=n[++s+1];else if(r==="\r"&&n[s+1]===`
`)for(r=n[++s+1];r===" "||r==="	";)r=n[++s+1];else if(r==="x"||r==="u"||r==="U"){const l={x:2,u:4,U:8}[r];t+=Pa(n,s+1,l,e),s+=l}else{const l=n.substr(s-1,2);e(s-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${l}`),t+=l}}else if(i===" "||i==="	"){const r=s;let o=n[s+1];for(;o===" "||o==="	";)o=n[++s+1];o!==`
`&&!(o==="\r"&&n[s+2]===`
`)&&(t+=s>r?n.slice(r,s+1):i)}else t+=i}return(n[n.length-1]!=='"'||n.length===1)&&e(n.length,"MISSING_CHAR",'Missing closing "quote'),t}function Da(n,e){let t="",s=n[e+1];for(;(s===" "||s==="	"||s===`
`||s==="\r")&&!(s==="\r"&&n[e+2]!==`
`);)s===`
`&&(t+=`
`),e+=1,s=n[e+1];return t||(t=" "),{fold:t,offset:e}}const Ba={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:"",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function Pa(n,e,t,s){const i=n.substr(e,t),o=i.length===t&&/^[0-9a-fA-F]+$/.test(i)?parseInt(i,16):NaN;if(isNaN(o)){const l=n.substr(e-2,t+2);return s(e-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${l}`),l}return String.fromCodePoint(o)}function xo(n,e,t,s){const{value:i,type:r,comment:o,range:l}=e.type==="block-scalar"?Qo(n,e,s):Xo(e,n.options.strict,s),a=t?n.directives.tagName(t.source,d=>s(t,"TAG_RESOLVE_FAILED",d)):null;let c;n.options.stringKeys&&n.atKey?c=n.schema[mt]:a?c=Fa(n.schema,i,a,t,s):e.type==="scalar"?c=za(n,i,e,s):c=n.schema[mt];let u;try{const d=c.resolve(i,p=>s(t??e,"TAG_RESOLVE_FAILED",p),n.options);u=pe(d)?d:new J(d)}catch(d){const p=d instanceof Error?d.message:String(d);s(t??e,"TAG_RESOLVE_FAILED",p),u=new J(i)}return u.range=l,u.source=i,r&&(u.type=r),a&&(u.tag=a),c.format&&(u.format=c.format),o&&(u.comment=o),u}function Fa(n,e,t,s,i){var l;if(t==="!")return n[mt];const r=[];for(const a of n.tags)if(!a.collection&&a.tag===t)if(a.default&&a.test)r.push(a);else return a;for(const a of r)if((l=a.test)!=null&&l.test(e))return a;const o=n.knownTags[t];return o&&!o.collection?(n.tags.push(Object.assign({},o,{default:!1,test:void 0})),o):(i(s,"TAG_RESOLVE_FAILED",`Unresolved tag: ${t}`,t!=="tag:yaml.org,2002:str"),n[mt])}function za({atKey:n,directives:e,schema:t},s,i,r){const o=t.tags.find(l=>{var a;return(l.default===!0||n&&l.default==="key")&&((a=l.test)==null?void 0:a.test(s))})||t[mt];if(t.compat){const l=t.compat.find(a=>{var c;return a.default&&((c=a.test)==null?void 0:c.test(s))})??t[mt];if(o.tag!==l.tag){const a=e.tagString(o.tag),c=e.tagString(l.tag),u=`Value may be parsed as either ${a} or ${c}`;r(i,"TAG_RESOLVE_FAILED",u,!0)}}return o}function ja(n,e,t){if(e){t??(t=e.length);for(let s=t-1;s>=0;--s){let i=e[s];switch(i.type){case"space":case"comment":case"newline":n-=i.source.length;continue}for(i=e[++s];(i==null?void 0:i.type)==="space";)n+=i.source.length,i=e[++s];break}}return n}const Ua={composeNode:el,composeEmptyNode:Ri};function el(n,e,t,s){const i=n.atKey,{spaceBefore:r,comment:o,anchor:l,tag:a}=t;let c,u=!0;switch(e.type){case"alias":c=Ka(n,e,s),(l||a)&&s(e,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":c=xo(n,e,a,s),l&&(c.anchor=l.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":c=Ta(Ua,n,e,t,s),l&&(c.anchor=l.source.substring(1));break;default:{const d=e.type==="error"?e.message:`Unsupported token (type: ${e.type})`;s(e,"UNEXPECTED_TOKEN",d),c=Ri(n,e.offset,void 0,null,t,s),u=!1}}return l&&c.anchor===""&&s(l,"BAD_ALIAS","Anchor cannot be an empty string"),i&&n.options.stringKeys&&(!pe(c)||typeof c.value!="string"||c.tag&&c.tag!=="tag:yaml.org,2002:str")&&s(a??e,"NON_STRING_KEY","With stringKeys, all keys must be strings"),r&&(c.spaceBefore=!0),o&&(e.type==="scalar"&&e.source===""?c.comment=o:c.commentBefore=o),n.options.keepSourceTokens&&u&&(c.srcToken=e),c}function Ri(n,e,t,s,{spaceBefore:i,comment:r,anchor:o,tag:l,end:a},c){const u={type:"scalar",offset:ja(e,t,s),indent:-1,source:""},d=xo(n,u,l,c);return o&&(d.anchor=o.source.substring(1),d.anchor===""&&c(o,"BAD_ALIAS","Anchor cannot be an empty string")),i&&(d.spaceBefore=!0),r&&(d.comment=r,d.range[2]=a),d}function Ka({options:n},{offset:e,source:t,end:s},i){const r=new As(t.substring(1));r.source===""&&i(e,"BAD_ALIAS","Alias cannot be an empty string"),r.source.endsWith(":")&&i(e+t.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const o=e+t.length,l=Qn(s,o,n.strict,i);return r.range=[e,o,l.offset],l.comment&&(r.comment=l.comment),r}function qa(n,e,{offset:t,start:s,value:i,end:r},o){const l=Object.assign({_directives:e},n),a=new yn(void 0,l),c={atKey:!1,atRoot:!0,directives:a.directives,options:a.options,schema:a.schema},u=cn(s,{indicator:"doc-start",next:i??(r==null?void 0:r[0]),offset:t,onError:o,parentIndent:0,startOnNewline:!0});u.found&&(a.directives.docStart=!0,i&&(i.type==="block-map"||i.type==="block-seq")&&!u.hasNewline&&o(u.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),a.contents=i?el(c,i,u,o):Ri(c,u.end,s,null,u,o);const d=a.contents.range[2],p=Qn(r,d,!1,o);return p.comment&&(a.comment=p.comment),a.range=[t,d,p.offset],a}function kn(n){if(typeof n=="number")return[n,n+1];if(Array.isArray(n))return n.length===2?n:[n[0],n[1]];const{offset:e,source:t}=n;return[e,e+(typeof t=="string"?t.length:1)]}function cr(n){var i;let e="",t=!1,s=!1;for(let r=0;r<n.length;++r){const o=n[r];switch(o[0]){case"#":e+=(e===""?"":s?`

`:`
`)+(o.substring(1)||" "),t=!0,s=!1;break;case"%":((i=n[r+1])==null?void 0:i[0])!=="#"&&(r+=1),t=!1;break;default:t||(s=!0),t=!1}}return{comment:e,afterEmptyLine:s}}class Di{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(t,s,i,r)=>{const o=kn(t);r?this.warnings.push(new Ho(o,s,i)):this.errors.push(new Dt(o,s,i))},this.directives=new qe({version:e.version||"1.2"}),this.options=e}decorate(e,t){const{comment:s,afterEmptyLine:i}=cr(this.prelude);if(s){const r=e.contents;if(t)e.comment=e.comment?`${e.comment}
${s}`:s;else if(i||e.directives.docStart||!r)e.commentBefore=s;else if(ke(r)&&!r.flow&&r.items.length>0){let o=r.items[0];be(o)&&(o=o.key);const l=o.commentBefore;o.commentBefore=l?`${s}
${l}`:s}else{const o=r.commentBefore;r.commentBefore=o?`${s}
${o}`:s}}t?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:cr(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,t=!1,s=-1){for(const i of e)yield*this.next(i);yield*this.end(t,s)}*next(e){switch(e.type){case"directive":this.directives.add(e.source,(t,s,i)=>{const r=kn(e);r[0]+=t,this.onError(r,"BAD_DIRECTIVE",s,i)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{const t=qa(this.options,this.directives,e,this.onError);this.atDirectives&&!t.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(t,!1),this.doc&&(yield this.doc),this.doc=t,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{const t=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,s=new Dt(kn(e),"UNEXPECTED_TOKEN",t);this.atDirectives||!this.doc?this.errors.push(s):this.doc.errors.push(s);break}case"doc-end":{if(!this.doc){const s="Unexpected doc-end without preceding document";this.errors.push(new Dt(kn(e),"UNEXPECTED_TOKEN",s));break}this.doc.directives.docEnd=!0;const t=Qn(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),t.comment){const s=this.doc.comment;this.doc.comment=s?`${s}
${t.comment}`:t.comment}this.doc.range[2]=t.offset;break}default:this.errors.push(new Dt(kn(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,t=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){const s=Object.assign({_directives:this.directives},this.options),i=new yn(void 0,s);this.atDirectives&&this.onError(t,"MISSING_CHAR","Missing directives-end indicator line"),i.range=[0,t,t],this.decorate(i,!1),yield i}}}function $a(n,e=!0,t){if(n){const s=(i,r,o)=>{const l=typeof i=="number"?i:Array.isArray(i)?i[0]:i.offset;if(t)t(l,r,o);else throw new Dt([l,l+1],r,o)};switch(n.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return Xo(n,e,s);case"block-scalar":return Qo({options:{strict:e}},n,s)}}return null}function Va(n,e){const{implicitKey:t=!1,indent:s,inFlow:i=!1,offset:r=-1,type:o="PLAIN"}=e,l=Hn({type:o,value:n},{implicitKey:t,indent:s>0?" ".repeat(s):"",inFlow:i,options:{blockQuote:!0,lineWidth:-1}}),a=e.end??[{type:"newline",offset:-1,indent:s,source:`
`}];switch(l[0]){case"|":case">":{const c=l.indexOf(`
`),u=l.substring(0,c),d=l.substring(c+1)+`
`,p=[{type:"block-scalar-header",offset:r,indent:s,source:u}];return tl(p,a)||p.push({type:"newline",offset:-1,indent:s,source:`
`}),{type:"block-scalar",offset:r,indent:s,props:p,source:d}}case'"':return{type:"double-quoted-scalar",offset:r,indent:s,source:l,end:a};case"'":return{type:"single-quoted-scalar",offset:r,indent:s,source:l,end:a};default:return{type:"scalar",offset:r,indent:s,source:l,end:a}}}function Ja(n,e,t={}){let{afterKey:s=!1,implicitKey:i=!1,inFlow:r=!1,type:o}=t,l="indent"in n?n.indent:null;if(s&&typeof l=="number"&&(l+=2),!o)switch(n.type){case"single-quoted-scalar":o="QUOTE_SINGLE";break;case"double-quoted-scalar":o="QUOTE_DOUBLE";break;case"block-scalar":{const c=n.props[0];if(c.type!=="block-scalar-header")throw new Error("Invalid block scalar header");o=c.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:o="PLAIN"}const a=Hn({type:o,value:e},{implicitKey:i||l===null,indent:l!==null&&l>0?" ".repeat(l):"",inFlow:r,options:{blockQuote:!0,lineWidth:-1}});switch(a[0]){case"|":case">":Wa(n,a);break;case'"':Xs(n,a,"double-quoted-scalar");break;case"'":Xs(n,a,"single-quoted-scalar");break;default:Xs(n,a,"scalar")}}function Wa(n,e){const t=e.indexOf(`
`),s=e.substring(0,t),i=e.substring(t+1)+`
`;if(n.type==="block-scalar"){const r=n.props[0];if(r.type!=="block-scalar-header")throw new Error("Invalid block scalar header");r.source=s,n.source=i}else{const{offset:r}=n,o="indent"in n?n.indent:-1,l=[{type:"block-scalar-header",offset:r,indent:o,source:s}];tl(l,"end"in n?n.end:void 0)||l.push({type:"newline",offset:-1,indent:o,source:`
`});for(const a of Object.keys(n))a!=="type"&&a!=="offset"&&delete n[a];Object.assign(n,{type:"block-scalar",indent:o,props:l,source:i})}}function tl(n,e){if(e)for(const t of e)switch(t.type){case"space":case"comment":n.push(t);break;case"newline":return n.push(t),!0}return!1}function Xs(n,e,t){switch(n.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":n.type=t,n.source=e;break;case"block-scalar":{const s=n.props.slice(1);let i=e.length;n.props[0].type==="block-scalar-header"&&(i-=n.props[0].source.length);for(const r of s)r.offset+=i;delete n.props,Object.assign(n,{type:t,source:e,end:s});break}case"block-map":case"block-seq":{const i={type:"newline",offset:n.offset+e.length,indent:n.indent,source:`
`};delete n.items,Object.assign(n,{type:t,source:e,end:[i]});break}default:{const s="indent"in n?n.indent:-1,i="end"in n&&Array.isArray(n.end)?n.end.filter(r=>r.type==="space"||r.type==="comment"||r.type==="newline"):[];for(const r of Object.keys(n))r!=="type"&&r!=="offset"&&delete n[r];Object.assign(n,{type:t,indent:s,source:e,end:i})}}}const Ya=n=>"type"in n?ks(n):gs(n);function ks(n){switch(n.type){case"block-scalar":{let e="";for(const t of n.props)e+=ks(t);return e+n.source}case"block-map":case"block-seq":{let e="";for(const t of n.items)e+=gs(t);return e}case"flow-collection":{let e=n.start.source;for(const t of n.items)e+=gs(t);for(const t of n.end)e+=t.source;return e}case"document":{let e=gs(n);if(n.end)for(const t of n.end)e+=t.source;return e}default:{let e=n.source;if("end"in n&&n.end)for(const t of n.end)e+=t.source;return e}}}function gs({start:n,key:e,sep:t,value:s}){let i="";for(const r of n)i+=r.source;if(e&&(i+=ks(e)),t)for(const r of t)i+=r.source;return s&&(i+=ks(s)),i}const hi=Symbol("break visit"),Ha=Symbol("skip children"),nl=Symbol("remove item");function Ft(n,e){"type"in n&&n.type==="document"&&(n={start:n.start,value:n.value}),sl(Object.freeze([]),n,e)}Ft.BREAK=hi;Ft.SKIP=Ha;Ft.REMOVE=nl;Ft.itemAtPath=(n,e)=>{let t=n;for(const[s,i]of e){const r=t==null?void 0:t[s];if(r&&"items"in r)t=r.items[i];else return}return t};Ft.parentCollection=(n,e)=>{const t=Ft.itemAtPath(n,e.slice(0,-1)),s=e[e.length-1][0],i=t==null?void 0:t[s];if(i&&"items"in i)return i;throw new Error("Parent collection not found")};function sl(n,e,t){let s=t(e,n);if(typeof s=="symbol")return s;for(const i of["key","value"]){const r=e[i];if(r&&"items"in r){for(let o=0;o<r.items.length;++o){const l=sl(Object.freeze(n.concat([[i,o]])),r.items[o],t);if(typeof l=="number")o=l-1;else{if(l===hi)return hi;l===nl&&(r.items.splice(o,1),o-=1)}}typeof s=="function"&&i==="key"&&(s=s(e,n))}}return typeof s=="function"?s(e,n):s}const Bs="\uFEFF",Ps="",Fs="",Ln="",Ga=n=>!!n&&"items"in n,Qa=n=>!!n&&(n.type==="scalar"||n.type==="single-quoted-scalar"||n.type==="double-quoted-scalar"||n.type==="block-scalar");function Xa(n){switch(n){case Bs:return"<BOM>";case Ps:return"<DOC>";case Fs:return"<FLOW_END>";case Ln:return"<SCALAR>";default:return JSON.stringify(n)}}function il(n){switch(n){case Bs:return"byte-order-mark";case Ps:return"doc-mode";case Fs:return"flow-error-end";case Ln:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(n[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}const Za=Object.freeze(Object.defineProperty({__proto__:null,BOM:Bs,DOCUMENT:Ps,FLOW_END:Fs,SCALAR:Ln,createScalarToken:Va,isCollection:Ga,isScalar:Qa,prettyToken:Xa,resolveAsScalar:$a,setScalarValue:Ja,stringify:Ya,tokenType:il,visit:Ft},Symbol.toStringTag,{value:"Module"}));function ut(n){switch(n){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}const fr=new Set("0123456789ABCDEFabcdef"),xa=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),os=new Set(",[]{}"),ec=new Set(` ,[]{}
\r	`),Zs=n=>!n||ec.has(n);class rl{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,t=!1){if(e){if(typeof e!="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null}this.atEnd=!t;let s=this.next??"stream";for(;s&&(t||this.hasChars(1));)s=yield*this.parseNext(s)}atLineEnd(){let e=this.pos,t=this.buffer[e];for(;t===" "||t==="	";)t=this.buffer[++e];return!t||t==="#"||t===`
`?!0:t==="\r"?this.buffer[e+1]===`
`:!1}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let t=this.buffer[e];if(this.indentNext>0){let s=0;for(;t===" ";)t=this.buffer[++s+e];if(t==="\r"){const i=this.buffer[s+e+1];if(i===`
`||!i&&!this.atEnd)return e+s+1}return t===`
`||s>=this.indentNext||!t&&!this.atEnd?e+s:-1}if(t==="-"||t==="."){const s=this.buffer.substr(e,3);if((s==="---"||s==="...")&&ut(this.buffer[e+3]))return-1}return e}getLine(){let e=this.lineEndPos;return(typeof e!="number"||e!==-1&&e<this.pos)&&(e=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=e),e===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[e-1]==="\r"&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(e===null)return this.setNext("stream");if(e[0]===Bs&&(yield*this.pushCount(1),e=e.substring(1)),e[0]==="%"){let t=e.length,s=e.indexOf("#");for(;s!==-1;){const r=e[s-1];if(r===" "||r==="	"){t=s-1;break}else s=e.indexOf("#",s+1)}for(;;){const r=e[t-1];if(r===" "||r==="	")t-=1;else break}const i=(yield*this.pushCount(t))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-i),this.pushNewline(),"stream"}if(this.atLineEnd()){const t=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-t),yield*this.pushNewline(),"stream"}return yield Ps,yield*this.parseLineStart()}*parseLineStart(){const e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if(e==="-"||e==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const t=this.peek(3);if((t==="---"||t==="...")&&ut(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,t==="---"?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!ut(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[e,t]=this.peek(2);if(!t&&!this.atEnd)return this.setNext("block-start");if((e==="-"||e==="?"||e===":")&&ut(t)){const s=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=s,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const e=this.getLine();if(e===null)return this.setNext("doc");let t=yield*this.pushIndicators();switch(e[t]){case"#":yield*this.pushCount(e.length-t);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Zs),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return t+=yield*this.parseBlockScalarHeader(),t+=yield*this.pushSpaces(!0),yield*this.pushCount(e.length-t),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,t,s=-1;do e=yield*this.pushNewline(),e>0?(t=yield*this.pushSpaces(!1),this.indentValue=s=t):t=0,t+=yield*this.pushSpaces(!0);while(e+t>0);const i=this.getLine();if(i===null)return this.setNext("flow");if((s!==-1&&s<this.indentNext&&i[0]!=="#"||s===0&&(i.startsWith("---")||i.startsWith("..."))&&ut(i[3]))&&!(s===this.indentNext-1&&this.flowLevel===1&&(i[0]==="]"||i[0]==="}")))return this.flowLevel=0,yield Fs,yield*this.parseLineStart();let r=0;for(;i[r]===",";)r+=yield*this.pushCount(1),r+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(r+=yield*this.pushIndicators(),i[r]){case void 0:return"flow";case"#":return yield*this.pushCount(i.length-r),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Zs),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const o=this.charAt(1);if(this.flowKey||ut(o)||o===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const e=this.charAt(0);let t=this.buffer.indexOf(e,this.pos+1);if(e==="'")for(;t!==-1&&this.buffer[t+1]==="'";)t=this.buffer.indexOf("'",t+2);else for(;t!==-1;){let r=0;for(;this.buffer[t-1-r]==="\\";)r+=1;if(r%2===0)break;t=this.buffer.indexOf('"',t+1)}const s=this.buffer.substring(0,t);let i=s.indexOf(`
`,this.pos);if(i!==-1){for(;i!==-1;){const r=this.continueScalar(i+1);if(r===-1)break;i=s.indexOf(`
`,r)}i!==-1&&(t=i-(s[i-1]==="\r"?2:1))}if(t===-1){if(!this.atEnd)return this.setNext("quoted-scalar");t=this.buffer.length}return yield*this.pushToIndex(t+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){const t=this.buffer[++e];if(t==="+")this.blockScalarKeep=!0;else if(t>"0"&&t<="9")this.blockScalarIndent=Number(t)-1;else if(t!=="-")break}return yield*this.pushUntil(t=>ut(t)||t==="#")}*parseBlockScalar(){let e=this.pos-1,t=0,s;e:for(let r=this.pos;s=this.buffer[r];++r)switch(s){case" ":t+=1;break;case`
`:e=r,t=0;break;case"\r":{const o=this.buffer[r+1];if(!o&&!this.atEnd)return this.setNext("block-scalar");if(o===`
`)break}default:break e}if(!s&&!this.atEnd)return this.setNext("block-scalar");if(t>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=t:this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{const r=this.continueScalar(e+1);if(r===-1)break;e=this.buffer.indexOf(`
`,r)}while(e!==-1);if(e===-1){if(!this.atEnd)return this.setNext("block-scalar");e=this.buffer.length}}let i=e+1;for(s=this.buffer[i];s===" ";)s=this.buffer[++i];if(s==="	"){for(;s==="	"||s===" "||s==="\r"||s===`
`;)s=this.buffer[++i];e=i-1}else if(!this.blockScalarKeep)do{let r=e-1,o=this.buffer[r];o==="\r"&&(o=this.buffer[--r]);const l=r;for(;o===" ";)o=this.buffer[--r];if(o===`
`&&r>=this.pos&&r+1+t>l)e=r;else break}while(!0);return yield Ln,yield*this.pushToIndex(e+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const e=this.flowLevel>0;let t=this.pos-1,s=this.pos-1,i;for(;i=this.buffer[++s];)if(i===":"){const r=this.buffer[s+1];if(ut(r)||e&&os.has(r))break;t=s}else if(ut(i)){let r=this.buffer[s+1];if(i==="\r"&&(r===`
`?(s+=1,i=`
`,r=this.buffer[s+1]):t=s),r==="#"||e&&os.has(r))break;if(i===`
`){const o=this.continueScalar(s+1);if(o===-1)break;s=Math.max(s,o-2)}}else{if(e&&os.has(i))break;t=s}return!i&&!this.atEnd?this.setNext("plain-scalar"):(yield Ln,yield*this.pushToIndex(t+1,!0),e?"flow":"doc")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,t){const s=this.buffer.slice(this.pos,e);return s?(yield s,this.pos+=s.length,s.length):(t&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Zs))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const e=this.flowLevel>0,t=this.charAt(1);if(ut(t)||e&&os.has(t))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let e=this.pos+2,t=this.buffer[e];for(;!ut(t)&&t!==">";)t=this.buffer[++e];return yield*this.pushToIndex(t===">"?e+1:e,!1)}else{let e=this.pos+1,t=this.buffer[e];for(;t;)if(xa.has(t))t=this.buffer[++e];else if(t==="%"&&fr.has(this.buffer[e+1])&&fr.has(this.buffer[e+2]))t=this.buffer[e+=3];else break;return yield*this.pushToIndex(e,!1)}}*pushNewline(){const e=this.buffer[this.pos];return e===`
`?yield*this.pushCount(1):e==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(e){let t=this.pos-1,s;do s=this.buffer[++t];while(s===" "||e&&s==="	");const i=t-this.pos;return i>0&&(yield this.buffer.substr(this.pos,i),this.pos=t),i}*pushUntil(e){let t=this.pos,s=this.buffer[t];for(;!e(s);)s=this.buffer[++t];return yield*this.pushToIndex(t,!1)}}class ol{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let t=0,s=this.lineStarts.length;for(;t<s;){const r=t+s>>1;this.lineStarts[r]<e?t=r+1:s=r}if(this.lineStarts[t]===e)return{line:t+1,col:1};if(t===0)return{line:0,col:e};const i=this.lineStarts[t-1];return{line:t,col:e-i+1}}}}function kt(n,e){for(let t=0;t<n.length;++t)if(n[t].type===e)return!0;return!1}function ur(n){for(let e=0;e<n.length;++e)switch(n[e].type){case"space":case"comment":case"newline":break;default:return e}return-1}function ll(n){switch(n==null?void 0:n.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function ls(n){switch(n.type){case"document":return n.start;case"block-map":{const e=n.items[n.items.length-1];return e.sep??e.start}case"block-seq":return n.items[n.items.length-1].start;default:return[]}}function Ht(n){var t;if(n.length===0)return[];let e=n.length;e:for(;--e>=0;)switch(n[e].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;((t=n[++e])==null?void 0:t.type)==="space";);return n.splice(e,n.length)}function hr(n){if(n.start.type==="flow-seq-start")for(const e of n.items)e.sep&&!e.value&&!kt(e.start,"explicit-key-ind")&&!kt(e.sep,"map-value-ind")&&(e.key&&(e.value=e.key),delete e.key,ll(e.value)?e.value.end?Array.prototype.push.apply(e.value.end,e.sep):e.value.end=e.sep:Array.prototype.push.apply(e.start,e.sep),delete e.sep)}class Bi{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new rl,this.onNewLine=e}*parse(e,t=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const s of this.lexer.lex(e,t))yield*this.next(s);t||(yield*this.end())}*next(e){if(this.source=e,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=e.length;return}const t=il(e);if(t)if(t==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=t,yield*this.step(),t){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&e[0]===" "&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{const s=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:s,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const e=this.peek(1);if(this.type==="doc-end"&&(!e||e.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}peek(e){return this.stack[this.stack.length-e]}*pop(e){const t=e??this.stack.pop();if(!t)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield t;else{const s=this.peek(1);switch(t.type==="block-scalar"?t.indent="indent"in s?s.indent:0:t.type==="flow-collection"&&s.type==="document"&&(t.indent=0),t.type==="flow-collection"&&hr(t),s.type){case"document":s.value=t;break;case"block-scalar":s.props.push(t);break;case"block-map":{const i=s.items[s.items.length-1];if(i.value){s.items.push({start:[],key:t,sep:[]}),this.onKeyLine=!0;return}else if(i.sep)i.value=t;else{Object.assign(i,{key:t,sep:[]}),this.onKeyLine=!i.explicitKey;return}break}case"block-seq":{const i=s.items[s.items.length-1];i.value?s.items.push({start:[],value:t}):i.value=t;break}case"flow-collection":{const i=s.items[s.items.length-1];!i||i.value?s.items.push({start:[],key:t,sep:[]}):i.sep?i.value=t:Object.assign(i,{key:t,sep:[]});return}default:yield*this.pop(),yield*this.pop(t)}if((s.type==="document"||s.type==="block-map"||s.type==="block-seq")&&(t.type==="block-map"||t.type==="block-seq")){const i=t.items[t.items.length-1];i&&!i.sep&&!i.value&&i.start.length>0&&ur(i.start)===-1&&(t.indent===0||i.start.every(r=>r.type!=="comment"||r.indent<t.indent))&&(s.type==="document"?s.end=i.start:s.items.push({start:i.start}),t.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const e={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":{ur(e.start)!==-1?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}const t=this.startBlockValue(e);t?this.stack.push(t):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if(this.type==="map-value-ind"){const t=ls(this.peek(2)),s=Ht(t);let i;e.end?(i=e.end,i.push(this.sourceToken),delete e.end):i=[this.sourceToken];const r={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:s,key:e,sep:i}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=r}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){var s;const t=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,t.value){const i="end"in t.value?t.value.end:void 0,r=Array.isArray(i)?i[i.length-1]:void 0;(r==null?void 0:r.type)==="comment"?i==null||i.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else if(t.sep)t.sep.push(this.sourceToken);else{if(this.atIndentedComment(t.start,e.indent)){const i=e.items[e.items.length-2],r=(s=i==null?void 0:i.value)==null?void 0:s.end;if(Array.isArray(r)){Array.prototype.push.apply(r,t.start),r.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return}if(this.indent>=e.indent){const i=!this.onKeyLine&&this.indent===e.indent,r=i&&(t.sep||t.explicitKey)&&this.type!=="seq-item-ind";let o=[];if(r&&t.sep&&!t.value){const l=[];for(let a=0;a<t.sep.length;++a){const c=t.sep[a];switch(c.type){case"newline":l.push(a);break;case"space":break;case"comment":c.indent>e.indent&&(l.length=0);break;default:l.length=0}}l.length>=2&&(o=t.sep.splice(l[1]))}switch(this.type){case"anchor":case"tag":r||t.value?(o.push(this.sourceToken),e.items.push({start:o}),this.onKeyLine=!0):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"explicit-key-ind":!t.sep&&!t.explicitKey?(t.start.push(this.sourceToken),t.explicitKey=!0):r||t.value?(o.push(this.sourceToken),e.items.push({start:o,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(t.explicitKey)if(t.sep)if(t.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(kt(t.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:null,sep:[this.sourceToken]}]});else if(ll(t.key)&&!kt(t.sep,"newline")){const l=Ht(t.start),a=t.key,c=t.sep;c.push(this.sourceToken),delete t.key,delete t.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:l,key:a,sep:c}]})}else o.length>0?t.sep=t.sep.concat(o,this.sourceToken):t.sep.push(this.sourceToken);else if(kt(t.start,"newline"))Object.assign(t,{key:null,sep:[this.sourceToken]});else{const l=Ht(t.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:l,key:null,sep:[this.sourceToken]}]})}else t.sep?t.value||r?e.items.push({start:o,key:null,sep:[this.sourceToken]}):kt(t.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const l=this.flowScalar(this.type);r||t.value?(e.items.push({start:o,key:l,sep:[]}),this.onKeyLine=!0):t.sep?this.stack.push(l):(Object.assign(t,{key:l,sep:[]}),this.onKeyLine=!0);return}default:{const l=this.startBlockValue(e);if(l){if(l.type==="block-seq"){if(!t.explicitKey&&t.sep&&!kt(t.sep,"newline")){yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source});return}}else i&&e.items.push({start:o});this.stack.push(l);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){var s;const t=e.items[e.items.length-1];switch(this.type){case"newline":if(t.value){const i="end"in t.value?t.value.end:void 0,r=Array.isArray(i)?i[i.length-1]:void 0;(r==null?void 0:r.type)==="comment"?i==null||i.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(t.start,e.indent)){const i=e.items[e.items.length-2],r=(s=i==null?void 0:i.value)==null?void 0:s.end;if(Array.isArray(r)){Array.prototype.push.apply(r,t.start),r.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return;case"anchor":case"tag":if(t.value||this.indent<=e.indent)break;t.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;t.value||kt(t.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return}if(this.indent>e.indent){const i=this.startBlockValue(e);if(i){this.stack.push(i);return}}yield*this.pop(),yield*this.step()}*flowCollection(e){const t=e.items[e.items.length-1];if(this.type==="flow-error-end"){let s;do yield*this.pop(),s=this.peek(1);while(s&&s.type==="flow-collection")}else if(e.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!t||t.sep?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return;case"map-value-ind":!t||t.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!t||t.value?e.items.push({start:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const i=this.flowScalar(this.type);!t||t.value?e.items.push({start:[],key:i,sep:[]}):t.sep?this.stack.push(i):Object.assign(t,{key:i,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}const s=this.startBlockValue(e);s?this.stack.push(s):(yield*this.pop(),yield*this.step())}else{const s=this.peek(2);if(s.type==="block-map"&&(this.type==="map-value-ind"&&s.indent===e.indent||this.type==="newline"&&!s.items[s.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&s.type!=="flow-collection"){const i=ls(s),r=Ht(i);hr(e);const o=e.end.splice(1,e.end.length);o.push(this.sourceToken);const l={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:r,key:e,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=l}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const t=ls(e),s=Ht(t);return s.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const t=ls(e),s=Ht(t);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,t){return this.type!=="comment"||this.indent<=t?!1:e.every(s=>s.type==="newline"||s.type==="space")}*documentEnd(e){this.type!=="doc-mode"&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function al(n){const e=n.prettyErrors!==!1;return{lineCounter:n.lineCounter||e&&new ol||null,prettyErrors:e}}function tc(n,e={}){const{lineCounter:t,prettyErrors:s}=al(e),i=new Bi(t==null?void 0:t.addNewLine),r=new Di(e),o=Array.from(r.compose(i.parse(n)));if(s&&t)for(const l of o)l.errors.forEach(ws(n,t)),l.warnings.forEach(ws(n,t));return o.length>0?o:Object.assign([],{empty:!0},r.streamInfo())}function cl(n,e={}){const{lineCounter:t,prettyErrors:s}=al(e),i=new Bi(t==null?void 0:t.addNewLine),r=new Di(e);let o=null;for(const l of r.compose(i.parse(n),!0,n.length))if(!o)o=l;else if(o.options.logLevel!=="silent"){o.errors.push(new Dt(l.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return s&&t&&(o.errors.forEach(ws(n,t)),o.warnings.forEach(ws(n,t))),o}function nc(n,e,t){let s;typeof e=="function"?s=e:t===void 0&&e&&typeof e=="object"&&(t=e);const i=cl(n,t);if(!i)return null;if(i.warnings.forEach(r=>Co(i.options.logLevel,r)),i.errors.length>0){if(i.options.logLevel!=="silent")throw i.errors[0];i.errors=[]}return i.toJS(Object.assign({reviver:s},t))}function sc(n,e,t){let s=null;if(typeof e=="function"||Array.isArray(e)?s=e:t===void 0&&e&&(t=e),typeof t=="string"&&(t=t.length),typeof t=="number"){const i=Math.round(t);t=i<1?void 0:i>8?{indent:8}:{indent:i}}if(n===void 0){const{keepUndefined:i}=t??e??{};if(!i)return}return jt(n)&&!s?n.toString(t):new yn(n,s,t).toString(t)}const fl=Object.freeze(Object.defineProperty({__proto__:null,Alias:As,CST:Za,Composer:Di,Document:yn,Lexer:rl,LineCounter:ol,Pair:Pe,Parser:Bi,Scalar:J,Schema:Ds,YAMLError:Mi,YAMLMap:tt,YAMLParseError:Dt,YAMLSeq:Ot,YAMLWarning:Ho,isAlias:Tt,isCollection:ke,isDocument:jt,isMap:dn,isNode:Se,isPair:be,isScalar:pe,isSeq:pn,parse:nc,parseAllDocuments:tc,parseDocument:cl,stringify:sc,visit:Ut,visitAsync:Es},Symbol.toStringTag,{value:"Module"})),ic="/zowser/config.yaml";let as=null;async function rc(){return as||(as=(async()=>{try{const n=await fetch(ic).then(o=>o.text()),e=fl.parse(n)||{},t=new Set((e.samples||[]).map(o=>(o||"").trim())),s=new Map;for(const o of e.extended_samples||[])if(o&&o.url){const{url:l,...a}=o;s.set((l||"").trim(),a)}const i=new Set([...t,...s.keys()]);return{predicate:o=>i.has((o.url||"").trim()),overrides:s}}catch(n){return console.warn("No YAML view config found, showing all rows.",n),{predicate:()=>!0,overrides:new Map}}})(),as)}function ul(n,e,t={}){$l.parse(n,{header:!1,download:!0,skipEmptyLines:"greedy",complete:async s=>{let i=["url"],r=s.data[0];r.length>1&&(i=r,s.data.shift());const o=s.data.map(h=>{const y={...t};for(let E=0;E<i.length;E++)y[i[E]]=h[E];return y});let l=o.filter(h=>{var y;return!((y=h.url)!=null&&y.endsWith(".csv"))});const{predicate:a,overrides:c}=await rc();l=l.filter(a).map(h=>{const y=c.get((h.url||"").trim());return y?Object.assign(h,y):h});const u=o.filter(h=>{var y;return(y=h.url)==null?void 0:y.endsWith(".csv")}),d={};l.forEach(h=>{d[h.url]||(d[h.url]=h)}),l=Object.values(d);const p=l.reduce((h,y)=>y.wells?h+1:h,0),m=l.reduce((h,y)=>h+parseInt(y.written||0),0);let _=l.length;p>0&&(_=l.reduce((h,y)=>h+parseInt(y.images||1),0)),e.addCsv(n,u,_,p,m),e.addRows(l),u.forEach(h=>{const y=h.url;h.csv=y,ul(y,e,h)})}})}async function oc(n){return await fetch(n).then(e=>e.json())}function dr(n){if(!n)return"";const e=2;return n<1024?`${n} B`:n<1024**2?`${(n/1024).toFixed(e)} KB`:n<1024**3?`${(n/1024**2).toFixed(e)} MB`:n<1024**4?`${(n/1024**3).toFixed(e)} GB`:n<1024**5?`${(n/1024**4).toFixed(e)} TB`:`${(n/1024**5).toFixed(e)} PB`}class hl{constructor(){this.store=oi({})}async lookupOntologyTerm(e){let t="",s="";e.includes("NCBITaxon")|e.includes("NCBI:txid")&&(t=e.replace("NCBI:txid",""),t=t.replace("obo:NCBITaxon_",""),s="NCBITaxon"),e.includes("FBbi")&&(t=e.replace("obo:FBbi_",""),t=t.replace("obo:FBbi:",""),t=t.replace("FBbi:",""),s="FBbi"),e.includes("NCIT_")&&(t=e.replace("NCIT_",""),s="NCIT"),e.includes("obo:MI_")&&(t=e.replace("obo:MI_",""),s="MI"),e.includes("obo:OBI_")&&(t=e.replace("obo:OBI_",""),s="OBI");let i=s+"_"+t,o=`https://www.ebi.ac.uk/ols4/api/ontologies/${s.toLowerCase()}/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252F${i}`;return(await oc(o)).label||e}addTerms(e){let t=fs(this.store);[...new Set(e)].forEach(i=>{i&&(t[i]||(t[i]="Loading...",setTimeout(()=>{this.lookupOntologyTerm(i).then(r=>{this.addEntry(i,r)})},Math.random()*5e3)))})}addEntry(e,t){this.store.update(s=>(s[e]=t,s))}subscribe(e){return this.store.subscribe(e)}}const dl=new hl,pl=new hl;class Xn extends Error{constructor(e,t={}){super(`Node not found: ${e}`,t),this.name="NodeNotFoundError"}}class Pi extends Error{constructor(e){super(`Missing key: ${e}`),this.name="KeyError"}}var et;class ml{constructor(e,t,s){Oe(this,et);typeof e=="number"?we(this,et,new Uint8Array(e)):e instanceof ArrayBuffer?we(this,et,new Uint8Array(e,t,s)):we(this,et,new Uint8Array(Array.from(e,i=>i?1:0)))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return G(this,et).byteOffset}get byteLength(){return G(this,et).byteLength}get buffer(){return G(this,et).buffer}get length(){return G(this,et).length}get(e){let t=G(this,et)[e];return typeof t=="number"?t!==0:t}set(e,t){G(this,et)[e]=t?1:0}fill(e){G(this,et).fill(e?1:0)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}et=new WeakMap;var rn;class Fi{constructor(e,t,s,i){re(this,"_data");re(this,"chars");Oe(this,rn);if(this.chars=e,we(this,rn,new TextEncoder),typeof t=="number")this._data=new Uint8Array(t*e);else if(t instanceof ArrayBuffer)i&&(i=i*e),this._data=new Uint8Array(t,s,i);else{let r=Array.from(t);this._data=new Uint8Array(r.length*e);for(let o=0;o<r.length;o++)this.set(o,r[o])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(e){const t=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);return new TextDecoder().decode(t).replace(/\x00/g,"")}set(e,t){const s=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);s.fill(0),s.set(G(this,rn).encode(t))}fill(e){const t=G(this,rn).encode(e);for(let s=0;s<this.length;s++)this._data.set(t,s*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}rn=new WeakMap;var Re;const $i=class $i{constructor(e,t,s,i){Oe(this,Re);re(this,"chars");if(this.chars=e,typeof t=="number")we(this,Re,new Int32Array(t*e));else if(t instanceof ArrayBuffer)i&&(i*=e),we(this,Re,new Int32Array(t,s,i));else{const r=t,o=new $i(e,1);we(this,Re,new Int32Array(function*(){for(let l of r)o.set(0,l),yield*G(o,Re)}()))}}get BYTES_PER_ELEMENT(){return G(this,Re).BYTES_PER_ELEMENT*this.chars}get byteLength(){return G(this,Re).byteLength}get byteOffset(){return G(this,Re).byteOffset}get buffer(){return G(this,Re).buffer}get length(){return G(this,Re).length/this.chars}get(e){const t=this.chars*e;let s="";for(let i=0;i<this.chars;i++)s+=String.fromCodePoint(G(this,Re)[t+i]);return s.replace(/\u0000/g,"")}set(e,t){const s=this.chars*e,i=G(this,Re).subarray(s,s+this.chars);i.fill(0);for(let r=0;r<this.chars;r++)i[r]=t.codePointAt(r)??0}fill(e){this.set(0,e);let t=G(this,Re).subarray(0,this.chars);for(let s=1;s<this.length;s++)G(this,Re).set(t,s*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}};Re=new WeakMap;let Mn=$i;const lc="modulepreload",ac=function(n){return"/zowser/"+n},pr={},Sn=function(e,t,s){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(t.map(a=>{if(a=ac(a),a in pr)return;pr[a]=!0;const c=a.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":lc,c||(d.as="script"),d.crossOrigin="",d.href=a,l&&d.setAttribute("nonce",l),document.head.appendChild(d),c)return new Promise((p,m)=>{d.addEventListener("load",p),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${a}`)))})}))}function r(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&r(l.reason);return e().catch(r)})};function Zn(n){const e=new TextDecoder().decode(n);return JSON.parse(e)}function mr(n,e){const t=e/2,s=e-1;let i=0;for(let r=0;r<n.length;r+=e)for(let o=0;o<t;o+=1)i=n[r+o],n[r+o]=n[r+s-o],n[r+s-o]=i}function gl(n){if(n==="v2:object")return globalThis.Array;let e=n.match(/v2:([US])(\d+)/);if(e){let[,s,i]=e;return(s==="U"?Mn:Fi).bind(null,Number(i))}let t={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float16:globalThis.Float16Array,float32:Float32Array,float64:Float64Array,bool:ml}[n];return Ne(t,`Unknown or unsupported data_type: ${n}`),t}function zt(n,e){const t=n.length;typeof e=="string"&&(e=e==="C"?Array.from({length:t},(r,o)=>o):Array.from({length:t},(r,o)=>t-1-o)),Ne(t===e.length,"Order length must match the number of dimensions.");let s=1,i=new Array(t);for(let r=e.length-1;r>=0;r--)i[e[r]]=s,s*=n[e[r]];return i}function cc({name:n,configuration:e}){if(n==="default"){const t=(e==null?void 0:e.separator)??"/";return s=>["c",...s].join(t)}if(n==="v2"){const t=(e==null?void 0:e.separator)??".";return s=>s.join(t)||"0"}throw new Error(`Unknown chunk key encoding: ${n}`)}function fc(n){if(n==="|O")return{data_type:"v2:object"};let e=n.match(/^([<|>])(.*)$/);Ne(e,`Invalid dtype: ${n}`);let[,t,s]=e,i={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f2:"float16",f4:"float32",f8:"float64"}[s]??(s.startsWith("S")||s.startsWith("U")?`v2:${s}`:void 0);return Ne(i,`Unsupported or unknown dtype: ${n}`),t==="|"?{data_type:i}:{data_type:i,endian:t==="<"?"little":"big"}}function uc(n,e={}){let t=[],s=fc(n.dtype);n.order==="F"&&t.push({name:"transpose",configuration:{order:"F"}}),"endian"in s&&s.endian==="big"&&t.push({name:"bytes",configuration:{endian:"big"}});for(let{id:i,...r}of n.filters??[])t.push({name:i,configuration:r});if(n.compressor){let{id:i,...r}=n.compressor;t.push({name:i,configuration:r})}return{zarr_format:3,node_type:"array",shape:n.shape,data_type:s.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:n.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:n.dimension_separator??"."}},codecs:t,fill_value:n.fill_value,attributes:e}}function hc(n,e={}){return{zarr_format:3,node_type:"group",attributes:e}}function dc(n,e){if(e!=="number"&&e!=="bigint"&&e!=="boolean"&&e!=="object"&&e!=="string")return n===e;let t=n==="bool";if(e==="boolean")return t;let s=n.startsWith("v2:U")||n.startsWith("v2:S");if(e==="string")return s;let i=n==="int64"||n==="uint64";if(e==="bigint")return i;let r=n==="v2:object";return e==="object"?r:!s&&!i&&!t&&!r}function pc(n){return(n==null?void 0:n.name)==="sharding_indexed"}function yl(n){return(n.data_type==="uint64"||n.data_type==="int64")&&n.fill_value!=null?BigInt(n.fill_value):n.fill_value}function _l(n,...e){if(!e.some(t=>n instanceof t))throw n}function Ne(n,e=""){if(!n)throw new Error(e)}class zi{constructor(e,t){re(this,"kind","array_to_array");Ne(e.keepbits>=0,"keepbits must be zero or positive")}static fromConfig(e,t){return new zi(e,t)}encode(e){throw new Error("`BitroundCodec.encode` is not implemented. Please open an issue at https://github.com/manzt/zarrita.js/issues.")}decode(e){return e}}const gr=mc();function mc(){const n=new Uint32Array([305419896]);return new Uint8Array(n.buffer,n.byteOffset,n.byteLength)[0]!==18}function yr(n){return"BYTES_PER_ELEMENT"in n?n.BYTES_PER_ELEMENT:4}var Dn,St,Bn,Pn,on;const Vi=class Vi{constructor(e,t){re(this,"kind","array_to_bytes");Oe(this,Dn);Oe(this,St);Oe(this,Bn);Oe(this,Pn);Oe(this,on);we(this,on,e==null?void 0:e.endian),we(this,St,gl(t.data_type)),we(this,Pn,t.shape),we(this,Dn,zt(t.shape,"C"));const s=new(G(this,St))(0);we(this,Bn,s.BYTES_PER_ELEMENT)}static fromConfig(e,t){return new Vi(e,t)}encode(e){let t=new Uint8Array(e.data.buffer);return gr&&G(this,on)==="big"&&mr(t,yr(G(this,St))),t}decode(e){return gr&&G(this,on)==="big"&&mr(e,yr(G(this,St))),{data:new(G(this,St))(e.buffer,e.byteOffset,e.byteLength/G(this,Bn)),shape:G(this,Pn),stride:G(this,Dn)}}};Dn=new WeakMap,St=new WeakMap,Bn=new WeakMap,Pn=new WeakMap,on=new WeakMap;let Ss=Vi;class ji{constructor(){re(this,"kind","bytes_to_bytes")}static fromConfig(){return new ji}encode(e){throw new Error("Not implemented")}decode(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength-4)}}function gc(n,e){return Ne(!Number.isNaN(e),"JsonCodec allow_nan is false but NaN was encountered during encoding."),Ne(e!==Number.POSITIVE_INFINITY,"JsonCodec allow_nan is false but Infinity was encountered during encoding."),Ne(e!==Number.NEGATIVE_INFINITY,"JsonCodec allow_nan is false but -Infinity was encountered during encoding."),e}function yc(n,e){return e instanceof Object&&!Array.isArray(e)?Object.keys(e).sort().reduce((t,s)=>(t[s]=e[s],t),{}):e}var Fn,zn;const Ji=class Ji{constructor(e={}){re(this,"configuration");re(this,"kind","array_to_bytes");Oe(this,Fn);Oe(this,zn);this.configuration=e;const{encoding:t="utf-8",skipkeys:s=!1,ensure_ascii:i=!0,check_circular:r=!0,allow_nan:o=!0,sort_keys:l=!0,indent:a,strict:c=!0}=e;let u=e.separators;u||(a?u=[", ",": "]:u=[",",":"]),we(this,Fn,{encoding:t,skipkeys:s,ensure_ascii:i,check_circular:r,allow_nan:o,indent:a,separators:u,sort_keys:l}),we(this,zn,{strict:c})}static fromConfig(e){return new Ji(e)}encode(e){const{indent:t,encoding:s,ensure_ascii:i,check_circular:r,allow_nan:o,sort_keys:l}=G(this,Fn);Ne(s==="utf-8","JsonCodec does not yet support non-utf-8 encoding.");const a=[];Ne(r,"JsonCodec does not yet support skipping the check for circular references during encoding."),o||a.push(gc),l&&a.push(yc);const c=Array.from(e.data);c.push("|O"),c.push(e.shape);let u;a.length&&(u=(p,m)=>{let _=m;for(let h of a)_=h(p,_);return _});let d=JSON.stringify(c,u,t);return i&&(d=d.replace(/[\u007F-\uFFFF]/g,p=>{const m=`0000${p.charCodeAt(0).toString(16)}`;return`\\u${m.substring(m.length-4)}`})),new TextEncoder().encode(d)}decode(e){const{strict:t}=G(this,zn);Ne(t,"JsonCodec does not yet support non-strict decoding.");const s=Zn(e),i=s.pop();s.pop(),Ne(i,"0D not implemented for JsonCodec.");const r=zt(i,"C");return{data:s,shape:i,stride:r}}};Fn=new WeakMap,zn=new WeakMap;let di=Ji;function _r(n){return n instanceof ml||n instanceof Fi||n instanceof Mn?new Proxy(n,{get(t,s){return t.get(Number(s))},set(t,s,i){return t.set(Number(s),i),!0}}):n}function _c(n,e){let t;return n.data instanceof Fi||n.data instanceof Mn?t=new n.constructor(n.data.length,n.data.chars):t=new n.constructor(n.data.length),{data:t,shape:n.shape,stride:zt(n.shape,e)}}function bc(n,e){let t=_c(n,e),s=n.shape.length,i=n.data.length,r=Array(s).fill(0),o=_r(n.data),l=_r(t.data);for(let a=0;a<i;a++){let c=0;for(let u=0;u<s;u++)c+=r[u]*t.stride[u];l[c]=o[a],r[0]+=1;for(let u=0;u<s;u++)if(r[u]===n.shape[u]){if(u+1===s)break;r[u]=0,r[u+1]+=1}}return t}function wc(n){let e=n.shape.length;return Ne(e===n.stride.length,"Shape and stride must have the same length."),n.stride.map((t,s)=>({stride:t,index:s})).sort((t,s)=>s.stride-t.stride).map(t=>t.index)}function kc(n,e){let t=wc(n);return Ne(t.length===e.length,"Orders must match"),t.every((s,i)=>s===e[i])}var jn,ln;const Wi=class Wi{constructor(e,t){re(this,"kind","array_to_array");Oe(this,jn);Oe(this,ln);let s=e.order??"C",i=t.shape.length,r=new Array(i),o=new Array(i);if(s==="C")for(let l=0;l<i;++l)r[l]=l,o[l]=l;else if(s==="F")for(let l=0;l<i;++l)r[l]=i-l-1,o[l]=i-l-1;else r=s,r.forEach((l,a)=>{Ne(o[l]===void 0,`Invalid permutation: ${JSON.stringify(s)}`),o[l]=a});we(this,jn,r),we(this,ln,o)}static fromConfig(e,t){return new Wi(e,t)}encode(e){return kc(e,G(this,ln))?e:bc(e,G(this,ln))}decode(e){return{data:e.data,shape:e.shape,stride:zt(e.shape,G(this,jn))}}};jn=new WeakMap,ln=new WeakMap;let pi=Wi;var Un,Kn;const Yi=class Yi{constructor(e){re(this,"kind","array_to_bytes");Oe(this,Un);Oe(this,Kn);we(this,Un,e),we(this,Kn,zt(e,"C"))}static fromConfig(e,t){return new Yi(t.shape)}encode(e){throw new Error("Method not implemented.")}decode(e){let t=new TextDecoder,s=new DataView(e.buffer),i=Array(s.getUint32(0,!0)),r=4;for(let o=0;o<i.length;o++){let l=s.getUint32(r,!0);r+=4,i[o]=t.decode(e.buffer.slice(r,r+l)),r+=l}return{data:i,shape:G(this,Un),stride:G(this,Kn)}}};Un=new WeakMap,Kn=new WeakMap;let mi=Yi;function Sc(){return new Map().set("blosc",()=>Sn(()=>import("./blosc-E49GQuAK.js"),__vite__mapDeps([0,1])).then(n=>n.default)).set("gzip",()=>Sn(()=>import("./gzip-CF-9a_hd.js"),__vite__mapDeps([2,3])).then(n=>n.default)).set("lz4",()=>Sn(()=>import("./lz4-BIGKWw27.js"),__vite__mapDeps([4,1])).then(n=>n.default)).set("zlib",()=>Sn(()=>import("./zlib-CBiqHlio.js"),__vite__mapDeps([5,3])).then(n=>n.default)).set("zstd",()=>Sn(()=>import("./zstd-IvP746pw.js"),__vite__mapDeps([6,1])).then(n=>n.default)).set("transpose",()=>pi).set("bytes",()=>Ss).set("crc32c",()=>ji).set("vlen-utf8",()=>mi).set("json2",()=>di).set("bitround",()=>zi)}const vc=Sc();function gi(n){let e;return{async encode(t){e||(e=await br(n));for(const i of e.array_to_array)t=await i.encode(t);let s=await e.array_to_bytes.encode(t);for(const i of e.bytes_to_bytes)s=await i.encode(s);return s},async decode(t){e||(e=await br(n));for(let i=e.bytes_to_bytes.length-1;i>=0;i--)t=await e.bytes_to_bytes[i].decode(t);let s=await e.array_to_bytes.decode(t);for(let i=e.array_to_array.length-1;i>=0;i--)s=await e.array_to_array[i].decode(s);return s}}}async function br(n){let e=n.codecs.map(async r=>{var l;let o=await((l=vc.get(r.name))==null?void 0:l());return Ne(o,`Unknown codec: ${r.name}`),{Codec:o,meta:r}}),t=[],s,i=[];for await(let{Codec:r,meta:o}of e){let l=r.fromConfig(o.configuration,n);switch(l.kind){case"array_to_array":t.push(l);break;case"array_to_bytes":s=l;break;default:i.push(l)}}return s||(Ne(Ec(n),`Cannot encode ${n.data_type} to bytes without a codec`),s=Ss.fromConfig({endian:"little"},n)),{array_to_array:t,array_to_bytes:s,bytes_to_bytes:i}}function Ec(n){return n.data_type!=="v2:object"}const wr=18446744073709551615n;function Ac(n,e,t,s){Ne(n.store.getRange,"Store does not support range requests");let i=n.store.getRange.bind(n.store),r=e.map((a,c)=>a/s.chunk_shape[c]),o=gi({data_type:"uint64",shape:[...r,2],codecs:s.index_codecs}),l={};return async a=>{let c=a.map((C,O)=>Math.floor(C/r[O])),u=n.resolve(t(c)).path,d;if(u in l)d=l[u];else{let C=4,O=16*r.reduce((R,T)=>R*T,1),M=await i(u,{suffixLength:O+C});d=l[u]=M?await o.decode(M):null}if(d===null)return;let{data:p,shape:m,stride:_}=d,h=a.map((C,O)=>C%m[O]).reduce((C,O,M)=>C+O*_[M],0),y=p[h],E=p[h+1];if(!(y===wr&&E===wr))return i(u,{offset:Number(y),length:Number(E)})}}class _n{constructor(e,t="/"){re(this,"store");re(this,"path");this.store=e,this.path=t}resolve(e){let t=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new _n(this.store,new URL(e,t).pathname)}}var qn;class Ui extends _n{constructor(t,s,i){super(t,s);re(this,"kind","group");Oe(this,qn);we(this,qn,i)}get attrs(){return G(this,qn).attributes}}qn=new WeakMap;function kr(n){var t;const e=n.find(s=>s.name==="transpose");return((t=e==null?void 0:e.configuration)==null?void 0:t.order)??"C"}const An=Symbol("zarrita.context");function Ic(n){return n[An]}function Oc(n,e){let{configuration:t}=e.codecs.find(pc)??{},s={encode_chunk_key:cc(e.chunk_key_encoding),TypedArray:gl(e.data_type),fill_value:e.fill_value};if(t){let r=kr(t.codecs);return{...s,kind:"sharded",chunk_shape:t.chunk_shape,codec:gi({data_type:e.data_type,shape:t.chunk_shape,codecs:t.codecs}),get_strides(o){return zt(o,r)},get_chunk_bytes:Ac(n,e.chunk_grid.configuration.chunk_shape,s.encode_chunk_key,t)}}let i=kr(e.codecs);return{...s,kind:"regular",chunk_shape:e.chunk_grid.configuration.chunk_shape,codec:gi({data_type:e.data_type,shape:e.chunk_grid.configuration.chunk_shape,codecs:e.codecs}),get_strides(r){return zt(r,i)},async get_chunk_bytes(r,o){let l=s.encode_chunk_key(r),a=n.resolve(l).path;return n.store.get(a,o)}}}var io,ro,Pt,oo;let vs=(oo=class extends(ro=_n,io=An,ro){constructor(t,s,i){super(t,s);re(this,"kind","array");Oe(this,Pt);re(this,io);we(this,Pt,{...i,fill_value:yl(i)}),this[An]=Oc(this,i)}get attrs(){return G(this,Pt).attributes}get shape(){return G(this,Pt).shape}get chunks(){return this[An].chunk_shape}get dtype(){return G(this,Pt).data_type}async getChunk(t,s){let i=this[An],r=await i.get_chunk_bytes(t,s);if(!r){let o=i.chunk_shape.reduce((a,c)=>a*c,1),l=new i.TypedArray(o);return l.fill(i.fill_value),{data:l,shape:i.chunk_shape,stride:i.get_strides(i.chunk_shape)}}return i.codec.decode(r)}is(t){return dc(this.dtype,t)}},Pt=new WeakMap,oo),zs=Tc();function Tc(){let n=new WeakMap;function e(t){let s=n.get(t)??{v2:0,v3:0};return n.set(t,s),s}return{increment(t,s){e(t)[s]+=1},version_max(t){let s=e(t);return s.v3>s.v2?"v3":"v2"}}}async function Cc(n){let e=await n.store.get(n.resolve(".zattrs").path);return e?Zn(e):{}}async function Nc(n,e={}){let t="store"in n?n:new _n(n),s={};return(e.attrs??!0)&&(s=await Cc(t)),e.kind==="array"?Sr(t,s):e.kind==="group"?vr(t,s):Sr(t,s).catch(i=>(_l(i,Xn),vr(t,s)))}async function Sr(n,e){let{path:t}=n.resolve(".zarray"),s=await n.store.get(t);if(!s)throw new Xn("v2 array",{cause:new Pi(t)});return zs.increment(n.store,"v2"),new vs(n.store,n.path,uc(Zn(s),e))}async function vr(n,e){let{path:t}=n.resolve(".zgroup"),s=await n.store.get(t);if(!s)throw new Xn("v2 group",{cause:new Pi(t)});return zs.increment(n.store,"v2"),new Ui(n.store,n.path,hc(Zn(s),e))}async function Lc(n){let{store:e,path:t}=n.resolve("zarr.json"),s=await n.store.get(t);if(!s)throw new Xn("v3 array or group",{cause:new Pi(t)});let i=Zn(s);return i.node_type==="array"&&(i.fill_value=yl(i)),i.node_type==="array"?new vs(e,n.path,i):new Ui(e,n.path,i)}async function Mc(n,e={}){let t="store"in n?n:new _n(n),s=await Lc(t);if(zs.increment(t.store,"v3"),e.kind===void 0||e.kind==="array"&&s instanceof vs||e.kind==="group"&&s instanceof Ui)return s;let i=s instanceof vs?"array":"group";throw new Error(`Expected node of kind ${e.kind}, found ${i}.`)}async function Bt(n,e={}){let t="store"in n?n.store:n,s=zs.version_max(t),i=s==="v2"?Bt.v2:Bt.v3,r=s==="v2"?Bt.v3:Bt.v2;return i(n,e).catch(o=>(_l(o,Xn),r(n,e)))}Bt.v2=Nc;Bt.v3=Mc;function*Rc(n,e,t=1){e===void 0&&(e=n,n=0);for(let s=n;s<e;s+=t)yield s}function*Dc(...n){if(n.length===0)return;const e=n.map(s=>s[Symbol.iterator]()),t=e.map(s=>s.next());if(t.some(s=>s.done))throw new Error("Input contains an empty iterator.");for(let s=0;;){if(t[s].done){if(e[s]=n[s][Symbol.iterator](),t[s]=e[s].next(),++s>=e.length)return}else yield t.map(({value:i})=>i),s=0;t[s]=e[s].next()}}function Bc({start:n,stop:e,step:t},s){if(t===0)throw new Error("slice step cannot be zero");t=t??1;const i=t<0,[r,o]=i?[-1,s-1]:[0,s];return n===null?n=i?o:r:n<0?(n+=s,n<r&&(n=r)):n>o&&(n=o),e===null?e=i?r:o:e<0?(e+=s,e<r&&(e=r)):e>o&&(e=o),[n,e,t]}function Er(n,e,t=null){return e===void 0&&(e=n,n=null),{start:n,stop:e,step:t}}function Pc(){const n=[];return{add:e=>n.push(e()),onIdle:()=>Promise.all(n)}}class Ki extends Error{constructor(e){super(e),this.name="IndexError"}}function Fc(n,e){throw new Ki(`too many indicies for array; expected ${e.length}, got ${n.length}`)}function zc(n){throw new Ki(`index out of bounds for dimension with length ${n}`)}function jc(){throw new Ki("only slices with step >= 1 are supported")}function Uc(n,e){n.length>e.length&&Fc(n,e)}function Kc(n,e){return n=Math.trunc(n),n<0&&(n=e+n),(n>=e||n<0)&&zc(e),n}class qc{constructor({dim_sel:e,dim_len:t,dim_chunk_len:s}){re(this,"dim_sel");re(this,"dim_len");re(this,"dim_chunk_len");re(this,"nitems");e=Kc(e,t),this.dim_sel=e,this.dim_len=t,this.dim_chunk_len=s,this.nitems=1}*[Symbol.iterator](){const e=Math.floor(this.dim_sel/this.dim_chunk_len),t=e*this.dim_chunk_len,s=this.dim_sel-t;yield{dim_chunk_ix:e,dim_chunk_sel:s}}}class Ar{constructor({dim_sel:e,dim_len:t,dim_chunk_len:s}){re(this,"start");re(this,"stop");re(this,"step");re(this,"dim_len");re(this,"dim_chunk_len");re(this,"nitems");re(this,"nchunks");const[i,r,o]=Bc(e,t);this.start=i,this.stop=r,this.step=o,this.step<1&&jc(),this.dim_len=t,this.dim_chunk_len=s,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const e=Math.floor(this.start/this.dim_chunk_len),t=Math.ceil(this.stop/this.dim_chunk_len);for(const s of Rc(e,t)){const i=s*this.dim_chunk_len,r=Math.min(this.dim_len,(s+1)*this.dim_chunk_len),o=r-i;let l=0,a=0;if(this.start<i){const m=(i-this.start)%this.step;m&&(a+=this.step-m),l=Math.ceil((i-this.start)/this.step)}else a=this.start-i;const c=this.stop>r?o:this.stop-i,u=[a,c,this.step],d=Math.ceil((c-a)/this.step),p=[l,l+d,1];yield{dim_chunk_ix:s,dim_chunk_sel:u,dim_out_sel:p}}}}function $c(n,e){let t=[];return n===null?t=e.map(s=>Er(null)):Array.isArray(n)&&(t=n.map(s=>s??Er(null))),Uc(t,e),t}class Vc{constructor({selection:e,shape:t,chunk_shape:s}){re(this,"dim_indexers");re(this,"shape");this.dim_indexers=$c(e,t).map((i,r)=>new(typeof i=="number"?qc:Ar)({dim_sel:i,dim_len:t[r],dim_chunk_len:s[r]})),this.shape=this.dim_indexers.filter(i=>i instanceof Ar).map(i=>i.nitems)}*[Symbol.iterator](){for(const e of Dc(...this.dim_indexers)){const t=e.map(i=>i.dim_chunk_ix),s=e.map(i=>"dim_out_sel"in i?{from:i.dim_chunk_sel,to:i.dim_out_sel}:{from:i.dim_chunk_sel,to:null});yield{chunk_coords:t,mapping:s}}}}function Jc(n,e){return"get"in n?n.get(e):n[e]}async function Wc(n,e,t,s){var a;let i=Ic(n),r=new Vc({selection:e,shape:n.shape,chunk_shape:n.chunks}),o=s.prepare(new i.TypedArray(r.shape.reduce((c,u)=>c*u,1)),r.shape,i.get_strides(r.shape)),l=((a=t.create_queue)==null?void 0:a.call(t))??Pc();for(const{chunk_coords:c,mapping:u}of r)l.add(async()=>{let{data:d,shape:p,stride:m}=await n.getChunk(c,t.opts),_=s.prepare(d,p,m);s.set_from_chunk(o,_,u)});return await l.onIdle(),r.shape.length===0?Jc(o.data,0):o}function qi(n,e=0,t){let s=t??n.length-e;return{length:s,subarray(i,r=s){return qi(n,e+i,r-i)},set(i,r=0){for(let o=0;o<i.length;o++)n[e+r+o]=i.get(o)},get(i){return n[e+i]}}}function xs(n){return globalThis.Array.isArray(n.data)?{data:qi(n.data),stride:n.stride,bytes_per_element:1}:{data:new Uint8Array(n.data.buffer,n.data.byteOffset,n.data.byteLength),stride:n.stride,bytes_per_element:n.data.BYTES_PER_ELEMENT}}function Yc(n){return"chars"in n?n.constructor.bind(null,n.chars):n.constructor}function Hc(n,e){if(globalThis.Array.isArray(n.data))return qi([e]);let t=Yc(n.data),s=new t([e]);return new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}const Gc={prepare(n,e,t){return{data:n,shape:e,stride:t}},set_scalar(n,e,t){let s=xs(n);yi(s,e,Hc(n,t),s.bytes_per_element)},set_from_chunk(n,e,t){let s=xs(n);ys(s,xs(e),s.bytes_per_element,t)}};async function Qc(n,e=null,t={}){return Wc(n,e,t,Gc)}function bl(n,e,t){return t<0&&e<n?Math.floor((n-e-1)/-t)+1:n<e?Math.floor((e-n-1)/t)+1:0}function yi(n,e,t,s){if(e.length===0){n.data.set(t,0);return}const[i,...r]=e,[o,...l]=n.stride;if(typeof i=="number"){const p=n.data.subarray(o*i*s);yi({data:p,stride:l},r,t,s);return}const[a,c,u]=i,d=bl(a,c,u);if(r.length===0){for(let p=0;p<d;p++)n.data.set(t,o*(a+u*p)*s);return}for(let p=0;p<d;p++){const m=n.data.subarray(o*(a+u*p)*s);yi({data:m,stride:l},r,t,s)}}function ys(n,e,t,s){const[i,...r]=s,[o,...l]=n.stride,[a,...c]=e.stride;if(i.from===null){if(r.length===0){n.data.set(e.data.subarray(0,t),i.to*t);return}ys({data:n.data.subarray(o*i.to*t),stride:l},e,t,r);return}if(i.to===null){if(r.length===0){let E=i.from*t;n.data.set(e.data.subarray(E,E+t),0);return}ys(n,{data:e.data.subarray(a*i.from*t),stride:c},t,r);return}const[u,d,p]=i.to,[m,_,h]=i.from,y=bl(u,d,p);if(r.length===0){if(p===1&&h===1&&o===1&&a===1){let E=m*t,C=y*t;n.data.set(e.data.subarray(E,E+C),u*t);return}for(let E=0;E<y;E++){let C=a*(m+h*E)*t;n.data.set(e.data.subarray(C,C+t),o*(u+p*E)*t)}return}for(let E=0;E<y;E++)ys({data:n.data.subarray(o*(u+E*p)*t),stride:l},{data:e.data.subarray(a*(m+E*h)*t),stride:c},t,r)}function wl(n,e,t,s={}){return e!==void 0&&t!==void 0&&(s={...s,headers:{...s.headers,Range:`bytes=${e}-${e+t-1}`}}),fetch(n,s)}function Xc(n,e){return{...n,...e,headers:{...n.headers,...e.headers}}}function Ir(n,e){const t=typeof n=="string"?new URL(n):n;t.pathname.endsWith("/")||(t.pathname+="/");const s=new URL(e.slice(1),t);return s.search=t.search,s}async function Or(n){if(n.status!==404){if(n.status===200||n.status===206)return new Uint8Array(await n.arrayBuffer());throw new Error(`Unexpected response status ${n.status} ${n.statusText}`)}}async function Zc(n,e,t,s){if(s)return fetch(n,{...t,headers:{...t.headers,Range:`bytes=-${e}`}});let i=await fetch(n,{...t,method:"HEAD"});if(!i.ok)return i;let r=i.headers.get("Content-Length"),o=Number(r);return wl(n,o-e,o,t)}var $n,Vn,Jn,_i;class xc{constructor(e,t={}){Oe(this,Jn);re(this,"url");Oe(this,$n);Oe(this,Vn);this.url=e,we(this,$n,t.overrides??{}),we(this,Vn,t.useSuffixRequest??!1)}async get(e,t={}){let s=Ir(this.url,e).href,i=await fetch(s,$s(this,Jn,_i).call(this,t));return Or(i)}async getRange(e,t,s={}){let i=Ir(this.url,e),r=$s(this,Jn,_i).call(this,s),o;return"suffixLength"in t?o=await Zc(i,t.suffixLength,r,G(this,Vn)):o=await wl(i,t.offset,t.length,r),Or(o)}}$n=new WeakMap,Vn=new WeakMap,Jn=new WeakSet,_i=function(e){return Xc(G(this,$n),e)};async function Rn(n,e){var i;let t;try{const r=await fetch(`${n}/zarr.json`,{signal:e});if(!r.ok)throw new Error(`HTTP ${r.status} for ${n}/zarr.json`);t=await r.json()}catch(r){return console.warn(`[ngffLoader] ${n}/zarr.json not found or invalid`,r.message),[void 0,n]}const s=(i=t==null?void 0:t.attributes)==null?void 0:i.ome;if(!s)return[void 0,n];if(s.multiscales)return[s,n];if(s.plate){const r=s.plate.wells[0],o=`${n}/${r.path}/0`,[l,a]=await Rn(o,e);return[l,a,s.plate]}if(s["bioformats2raw.layout"]){const r=`${n}/0`;return await Rn(r,e)}return[void 0,n]}async function ef(n,e,t,s=512,i){var M,R,T;if(!((M=e==null?void 0:e.multiscales)!=null&&M.length))return null;const r=e.multiscales[0].datasets.map(b=>b.path),o=e.multiscales[0].axes.map(b=>b.name);let l=r.at(-1);t!==void 0&&t<r.length&&(l=r[t]);const a=new xc(`${n}/${l}`),c=await Bt.v3(a,{kind:"array"}),u=o.indexOf("c"),d=c.shape;if(d.at(-1)*d.at(-2)>s*s)return console.log("Thumbnail skipped, too large:",d,n),null;const p=d[u]||1,m=(R=e==null?void 0:e.omero)!=null&&R.channels?e.omero.channels.map(b=>b.active):Yl(p),_=(T=e==null?void 0:e.omero)!=null&&T.channels?e.omero.channels.map(b=>mo(b.color)):Hl(p,m),h=m.reduce((b,f,g)=>f?[...b,g]:b,[]),y=b=>d.map((f,g)=>g===u?b:g>=d.length-2?{start:0,stop:f,step:1}:parseInt(f/2)),E=await Promise.all(h.map(b=>Qc(c,y(b),{opts:{signal:i}}))),C=E.map(Vl);return{rgb:Gl(E,C,_),width:d.at(-1),height:d.at(-2)}}class tf{constructor(e="index",t=!0){this.store=oi([]),this.selectedRow=oi(null),this.sortColumn=e,this.sortAscending=t,this.csvFiles=[]}addCsv(e,t,s,i,r){t=t.map(l=>({...l,child_csv:[]}));let o;for(let l of this.csvFiles){if(l.url===e){o=l;break}for(let a of l.child_csv){if(a.url===e){o=a;break}for(let c of a.child_csv)if(c.url===e){o=c;break}}}o?(o.image_count=s,o.plate_count=i,o.bytes=r,o.child_csv=t):(o={url:e,image_count:s,plate_count:i,bytes:r,child_csv:t},this.csvFiles.push(o))}addRows(e){e=e.map((i,r)=>{if(i.written&&(i.written=parseFloat(i.written)),i.shape){let o=i.shape.split(",").map(a=>parseInt(a)),l;i.dimension_names?l=i.dimension_names.split(","):o.length==5&&(l=["t","c","z","y","x"]),l&&l.length==o.length&&l.forEach((a,c)=>i["size_"+a]=o[c]),i.dim_count=o.reduce((a,c)=>a+(c>1?1:0),0)}if(i.chunks){let o=i.chunks.split(",").map(l=>parseInt(l));i.chunk_pixels=o.reduce((l,a)=>l*a,1)}if(i.shards){let o=i.shards.split(",").map(l=>parseInt(l));i.shard_pixels=o.reduce((l,a)=>l*a,1)}return i.index=Math.random()*(1+r),i}),console.log("Adding rows",e),this.store.update(i=>(i.push(...e),i.sort((r,o)=>this.compareRows(r,o,!0)),i));let t=e.map(i=>i.organismId);dl.addTerms(t);let s=e.map(i=>i.fbbiId);pl.addTerms(s)}populateRow(e,t){this.store.update(s=>(s=s.map(i=>(i.url===e&&(i={...i,...t}),i)),s))}async loadNgffMetadata(e){var p;const[t,s,i]=await Rn(e);let r=[],o=0,l=0,a=!1,c=!0,u={multiscales:t},d=s;if(i&&(o=i.wells.length,l=i.field_count||1),t){const m=(p=t[0])==null?void 0:p.datasets[0],_=m==null?void 0:m.path;if(_){const h=await fetch(`${s}/${_}/zarr.json`).then(y=>y.json()).catch(y=>{console.log(`----> Failed to parse ${s}/${_}/zarr.json`,y)});r=h==null?void 0:h.shape}}else console.log("No multiscales found"),a=!0,r=[0];this.populateRow(e,{image_attrs:u,image_url:d,shape:r,well_count:o,field_count:l,load_failed:a,loaded:c})}compareRows(e,t,s=!1){let i=e[this.sortColumn],r=t[this.sortColumn];if(s)return i===void 0&&(i=0),r===void 0&&(r=0),i<r?this.sortAscending?-1:1:i>r?this.sortAscending?1:-1:0;i===void 0&&(i=""),r===void 0&&(r="");let o=0;return s?o=i-r:o=i.localeCompare(r),this.sortAscending?o:-o}sortTable(e,t=!0){console.log("sortTable",e,t),this.sortColumn=e,this.sortAscending=t;let s=this.isColumnNumeric(e);this.store.update(i=>(i.sort((r,o)=>this.compareRows(r,o,s)),i))}isColumnNumeric(e){let t=fs(this.store);for(let s of t){let i=s[e];if(i!==void 0&&i!=="")return!isNaN(i)}}emptyTable(){this.store.set([])}subscribe(e){return this.store.subscribe(e)}getRows(){return fs(this.store)}getRow(e){return fs(this.store)[e]}subscribeSelectedRow(e){return this.selectedRow.subscribe(e)}setSelectedRow(e){this.selectedRow.set(e)}}const xe=new tf;function nf(n){let e,t,s,i,r,o;return{c(){e=I("button"),t=I("span"),t.textContent="^",s=X(),i=I("span"),i.textContent="^",v(t,"class","acc svelte-17vd65t"),Ce(t,"strong",n[1]),v(i,"class","dec svelte-17vd65t"),Ce(i,"strong",!n[1]),v(e,"class","svelte-17vd65t")},m(l,a){Y(l,e,a),k(e,t),k(e,s),k(e,i),r||(o=_e(e,"click",n[2]),r=!0)},p(l,[a]){a&2&&Ce(t,"strong",l[1]),a&2&&Ce(i,"strong",!l[1])},i:Ae,o:Ae,d(l){l&&W(e),r=!1,o()}}}function sf(n,e,t){let{toggleAscending:s}=e,{sortAscending:i}=e;const r=()=>s();return n.$$set=o=>{"toggleAscending"in o&&t(0,s=o.toggleAscending),"sortAscending"in o&&t(1,i=o.sortAscending)},[s,i,r]}class rf extends ct{constructor(e){super(),at(this,e,sf,nf,He,{toggleAscending:0,sortAscending:1})}}const cs={AUTO:"auto",START:"start",CENTER:"center",END:"end"},yt={HORIZONTAL:"horizontal",VERTICAL:"vertical"},vn={OBSERVED:0,REQUESTED:1},of={[yt.VERTICAL]:"top",[yt.HORIZONTAL]:"left"},Tr={[yt.VERTICAL]:"scrollTop",[yt.HORIZONTAL]:"scrollLeft"};class lf{constructor({itemSize:e,itemCount:t,estimatedItemSize:s}){this.itemSize=e,this.itemCount=t,this.estimatedItemSize=s,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig({itemSize:e,itemCount:t,estimatedItemSize:s}){t!=null&&(this.itemCount=t),s!=null&&(this.estimatedItemSize=s),e!=null&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!=null?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.itemCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:t}=this;return typeof t=="function"?t(e):Array.isArray(t)?t[e]:t}computeTotalSizeAndPositionData(){let e=0;for(let t=0;t<this.itemCount;t++){const s=this.getSize(t),i=e;e+=s,this.itemSizeAndPositionData[t]={offset:i,size:s}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){if(e<0||e>=this.itemCount)throw Error(`Requested index ${e} is outside of range 0..${this.itemCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const t=this.getSizeAndPositionOfLastMeasuredItem();let s=t.offset+t.size;for(let i=this.lastMeasuredIndex+1;i<=e;i++){const r=this.getSize(i);if(r==null||isNaN(r))throw Error(`Invalid size returned for index ${i} of value ${r}`);this.itemSizeAndPositionData[i]={offset:s,size:r},s+=r}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize}getUpdatedOffsetForIndex({align:e=cs.START,containerSize:t,currentOffset:s,targetIndex:i}){if(t<=0)return 0;const r=this.getSizeAndPositionForIndex(i),o=r.offset,l=o-t+r.size;let a;switch(e){case cs.END:a=l;break;case cs.CENTER:a=o-(t-r.size)/2;break;case cs.START:a=o;break;default:a=Math.max(l,Math.min(o,s))}const c=this.getTotalSize();return Math.max(0,Math.min(c-t,a))}getVisibleRange({containerSize:e=0,offset:t,overscanCount:s}){if(this.getTotalSize()===0)return{};const r=t+e;let o=this.findNearestItem(t);if(o===void 0)throw Error(`Invalid offset ${t} specified`);const l=this.getSizeAndPositionForIndex(o);t=l.offset+l.size;let a=o;for(;t<r&&a<this.itemCount-1;)a++,t+=this.getSizeAndPositionForIndex(a).size;return s&&(o=Math.max(0,o-s),a=Math.min(a+s,this.itemCount-1)),{start:o,stop:a}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const t=this.getSizeAndPositionOfLastMeasuredItem(),s=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch({high:s,low:0,offset:e}):this.exponentialSearch({index:s,offset:e})}binarySearch({low:e,high:t,offset:s}){let i=0,r=0;for(;e<=t;){if(i=e+Math.floor((t-e)/2),r=this.getSizeAndPositionForIndex(i).offset,r===s)return i;r<s?e=i+1:r>s&&(t=i-1)}return e>0?e-1:0}exponentialSearch({index:e,offset:t}){let s=1;for(;e<this.itemCount&&this.getSizeAndPositionForIndex(e).offset<t;)e+=s,s*=2;return this.binarySearch({high:Math.min(e,this.itemCount-1),low:Math.floor(e/2),offset:t})}}const af=n=>({}),Cr=n=>({});function Nr(n,e,t){const s=n.slice();return s[37]=e[t],s}const cf=n=>({style:n[0]&4,index:n[0]&4}),Lr=n=>({style:n[37].style,index:n[37].index}),ff=n=>({}),Mr=n=>({});function Rr(n,e){let t,s;const i=e[21].item,r=ti(i,e,e[20],Lr);return{key:n,first:null,c(){t=fn(),r&&r.c(),this.first=t},m(o,l){Y(o,t,l),r&&r.m(o,l),s=!0},p(o,l){e=o,r&&r.p&&(!s||l[0]&1048580)&&si(r,i,e,e[20],s?ni(i,e[20],l,cf):ii(e[20]),Lr)},i(o){s||(ce(r,o),s=!0)},o(o){me(r,o),s=!1},d(o){o&&W(t),r&&r.d(o)}}}function uf(n){let e,t,s,i=[],r=new Map,o,l;const a=n[21].header,c=ti(a,n,n[20],Mr);let u=$e(n[2]);const d=_=>_[0]?_[0](_[37].index):_[37].index;for(let _=0;_<u.length;_+=1){let h=Nr(n,u,_),y=d(h);r.set(y,i[_]=Rr(y,h))}const p=n[21].footer,m=ti(p,n,n[20],Cr);return{c(){e=I("div"),c&&c.c(),t=X(),s=I("div");for(let _=0;_<i.length;_+=1)i[_].c();o=X(),m&&m.c(),v(s,"class","virtual-list-inner svelte-dwpad5"),v(s,"style",n[4]),v(e,"class","virtual-list-wrapper svelte-dwpad5"),v(e,"style",n[3])},m(_,h){Y(_,e,h),c&&c.m(e,null),k(e,t),k(e,s);for(let y=0;y<i.length;y+=1)i[y]&&i[y].m(s,null);k(e,o),m&&m.m(e,null),n[22](e),l=!0},p(_,h){c&&c.p&&(!l||h[0]&1048576)&&si(c,a,_,_[20],l?ni(a,_[20],h,ff):ii(_[20]),Mr),h[0]&1048581&&(u=$e(_[2]),Wn(),i=ho(i,h,d,1,_,u,r,s,Fl,Rr,null,Nr),Yn()),(!l||h[0]&16)&&v(s,"style",_[4]),m&&m.p&&(!l||h[0]&1048576)&&si(m,p,_,_[20],l?ni(p,_[20],h,af):ii(_[20]),Cr),(!l||h[0]&8)&&v(e,"style",_[3])},i(_){if(!l){ce(c,_);for(let h=0;h<u.length;h+=1)ce(i[h]);ce(m,_),l=!0}},o(_){me(c,_);for(let h=0;h<i.length;h+=1)me(i[h]);me(m,_),l=!1},d(_){_&&W(e),c&&c.d(_);for(let h=0;h<i.length;h+=1)i[h].d();m&&m.d(_),n[22](null)}}}const hf=(()=>{let n=!1;try{const e=Object.defineProperty({},"passive",{get(){return n={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return n})();function df(n,e,t){let{$$slots:s={},$$scope:i}=e,{height:r}=e,{width:o="100%"}=e,{itemCount:l}=e,{itemSize:a}=e,{estimatedItemSize:c=null}=e,{stickyIndices:u=null}=e,{getKey:d=null}=e,{scrollDirection:p=yt.VERTICAL}=e,{scrollOffset:m=null}=e,{scrollToIndex:_=null}=e,{scrollToAlignment:h=null}=e,{scrollToBehaviour:y="instant"}=e,{overscanCount:E=3}=e;const C=Ml(),O=new lf({itemCount:l,itemSize:a,estimatedItemSize:H()});let M=!1,R,T=[],b={offset:m||_!=null&&T.length&&K(_)||0,scrollChangeReason:vn.REQUESTED},f=b,g={scrollToIndex:_,scrollToAlignment:h,scrollOffset:m,itemCount:l,itemSize:a,estimatedItemSize:c},w={},A="",S="";q(),un(()=>{t(18,M=!0),R.addEventListener("scroll",D,hf),m!=null?L(m):_!=null&&L(K(_))}),wi(()=>{M&&R.removeEventListener("scroll",D)});function z(){if(!M)return;const P=g.scrollToIndex!==_||g.scrollToAlignment!==h,$=g.itemCount!==l||g.itemSize!==a||g.estimatedItemSize!==c;$&&(O.updateConfig({itemSize:a,itemCount:l,estimatedItemSize:H()}),N()),g.scrollOffset!==m?t(19,b={offset:m||0,scrollChangeReason:vn.REQUESTED}):typeof _=="number"&&(P||$)&&t(19,b={offset:K(_,h,l),scrollChangeReason:vn.REQUESTED}),g={scrollToIndex:_,scrollToAlignment:h,scrollOffset:m,itemCount:l,itemSize:a,estimatedItemSize:c}}function j(){if(!M)return;const{offset:P,scrollChangeReason:$}=b;(f.offset!==P||f.scrollChangeReason!==$)&&q(),f.offset!==P&&$===vn.REQUESTED&&L(P),f=b}function q(){const{offset:P}=b,{start:$,stop:Q}=O.getVisibleRange({containerSize:p===yt.VERTICAL?r:o,offset:P,overscanCount:E});let x=[];const ee=O.getTotalSize();p===yt.VERTICAL?(t(3,A=`height:${r}${typeof r=="number"?"px":""};width:${o};`),t(4,S=`flex-direction:column;height:${ee}px;`)):(t(3,A=`height:${r};width:${o}${typeof o=="number"?"px":""}`),t(4,S=`min-height:100%;width:${ee}px;`));const U=u!=null&&u.length!==0;if(U)for(let V=0;V<u.length;V++){const Z=u[V];x.push({index:Z,style:F(Z,!0)})}if($!==void 0&&Q!==void 0){for(let V=$;V<=Q;V++)U&&u.includes(V)||x.push({index:V,style:F(V,!1)});C("itemsUpdated",{start:$,end:Q})}t(2,T=x)}function L(P){"scroll"in R?R.scroll({[of[p]]:P,behavior:y}):t(1,R[Tr[p]]=P,R)}function N(P=0){w={},O.resetItem(P),q()}function K(P,$=h,Q=l){return(P<0||P>=Q)&&(P=0),O.getUpdatedOffsetForIndex({align:$,containerSize:p===yt.VERTICAL?r:o,currentOffset:b.offset||0,targetIndex:P})}function D(P){const $=se();$<0||b.offset===$||P.target!==R||(t(19,b={offset:$,scrollChangeReason:vn.OBSERVED}),C("afterScroll",{offset:$,event:P}))}function se(){return R[Tr[p]]}function H(){return c||typeof a=="number"&&a||50}function F(P,$){if(w[P])return w[P];const{size:Q,offset:x}=O.getSizeAndPositionForIndex(P);let ee;return p===yt.VERTICAL?(ee=`left:0;width:100%;height:${Q}px;`,$?ee+=`position:sticky;flex-grow:0;z-index:1;top:0;margin-top:${x}px;margin-bottom:${-(x+Q)}px;`:ee+=`position:absolute;top:${x}px;`):(ee=`top:0;width:${Q}px;`,$?ee+=`position:sticky;z-index:1;left:0;margin-left:${x}px;margin-right:${-(x+Q)}px;`:ee+=`position:absolute;height:100%;left:${x}px;`),w[P]=ee}function fe(P){It[P?"unshift":"push"](()=>{R=P,t(1,R)})}return n.$$set=P=>{"height"in P&&t(5,r=P.height),"width"in P&&t(6,o=P.width),"itemCount"in P&&t(7,l=P.itemCount),"itemSize"in P&&t(8,a=P.itemSize),"estimatedItemSize"in P&&t(9,c=P.estimatedItemSize),"stickyIndices"in P&&t(10,u=P.stickyIndices),"getKey"in P&&t(0,d=P.getKey),"scrollDirection"in P&&t(11,p=P.scrollDirection),"scrollOffset"in P&&t(12,m=P.scrollOffset),"scrollToIndex"in P&&t(13,_=P.scrollToIndex),"scrollToAlignment"in P&&t(14,h=P.scrollToAlignment),"scrollToBehaviour"in P&&t(15,y=P.scrollToBehaviour),"overscanCount"in P&&t(16,E=P.overscanCount),"$$scope"in P&&t(20,i=P.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&29568&&z(),n.$$.dirty[0]&524288&&j(),n.$$.dirty[0]&263264&&M&&N(0)},[d,R,T,A,S,r,o,l,a,c,u,p,m,_,h,y,E,N,M,b,i,s,fe]}class pf extends ct{constructor(e){super(),at(this,e,df,uf,He,{height:5,width:6,itemCount:7,itemSize:8,estimatedItemSize:9,stickyIndices:10,getKey:0,scrollDirection:11,scrollOffset:12,scrollToIndex:13,scrollToAlignment:14,scrollToBehaviour:15,overscanCount:16,recomputeSizes:17},null,[-1,-1])}get height(){return this.$$.ctx[5]}set height(e){this.$$set({height:e}),Ke()}get width(){return this.$$.ctx[6]}set width(e){this.$$set({width:e}),Ke()}get itemCount(){return this.$$.ctx[7]}set itemCount(e){this.$$set({itemCount:e}),Ke()}get itemSize(){return this.$$.ctx[8]}set itemSize(e){this.$$set({itemSize:e}),Ke()}get estimatedItemSize(){return this.$$.ctx[9]}set estimatedItemSize(e){this.$$set({estimatedItemSize:e}),Ke()}get stickyIndices(){return this.$$.ctx[10]}set stickyIndices(e){this.$$set({stickyIndices:e}),Ke()}get getKey(){return this.$$.ctx[0]}set getKey(e){this.$$set({getKey:e}),Ke()}get scrollDirection(){return this.$$.ctx[11]}set scrollDirection(e){this.$$set({scrollDirection:e}),Ke()}get scrollOffset(){return this.$$.ctx[12]}set scrollOffset(e){this.$$set({scrollOffset:e}),Ke()}get scrollToIndex(){return this.$$.ctx[13]}set scrollToIndex(e){this.$$set({scrollToIndex:e}),Ke()}get scrollToAlignment(){return this.$$.ctx[14]}set scrollToAlignment(e){this.$$set({scrollToAlignment:e}),Ke()}get scrollToBehaviour(){return this.$$.ctx[15]}set scrollToBehaviour(e){this.$$set({scrollToBehaviour:e}),Ke()}get overscanCount(){return this.$$.ctx[16]}set overscanCount(e){this.$$set({overscanCount:e}),Ke()}get recomputeSizes(){return this.$$.ctx[17]}}function mf(n){let e,t,s,i,r;return{c(){e=I("div"),t=I("img"),i=X(),r=I("canvas"),de(t,"width",n[4]+"px"),de(t,"height",n[5]+"px"),de(t,"object-fit","cover"),v(t,"alt",""),v(t,"aria-hidden",s=n[7]!=="cached"),v(t,"class","svelte-12dtn57"),Ce(t,"hidden",n[7]!=="cached"),de(r,"width",n[4]+"px"),de(r,"height",n[5]+"px"),de(r,"background-color","lightgrey"),v(r,"width",n[2]),v(r,"height",n[3]),v(r,"class","svelte-12dtn57"),Ce(r,"hidden",n[7]!=="live"),v(e,"class","canvasWrapper svelte-12dtn57"),de(e,"width",n[4]+"px"),de(e,"height",n[5]+"px"),Ce(e,"spinner",n[6])},m(o,l){Y(o,e,l),k(e,t),n[14](t),k(e,i),k(e,r),n[15](r)},p(o,[l]){l&16&&de(t,"width",o[4]+"px"),l&32&&de(t,"height",o[5]+"px"),l&128&&s!==(s=o[7]!=="cached")&&v(t,"aria-hidden",s),l&128&&Ce(t,"hidden",o[7]!=="cached"),l&16&&de(r,"width",o[4]+"px"),l&32&&de(r,"height",o[5]+"px"),l&4&&v(r,"width",o[2]),l&8&&v(r,"height",o[3]),l&128&&Ce(r,"hidden",o[7]!=="live"),l&16&&de(e,"width",o[4]+"px"),l&32&&de(e,"height",o[5]+"px"),l&64&&Ce(e,"spinner",o[6])},i:Ae,o:Ae,d(o){o&&W(e),n[14](null),n[15](null)}}}function gf(n){try{const t=new URL(n,window.location.href).pathname.split("/").filter(Boolean);return t[t.length-1]}catch{const e=n.split("?")[0].split("/");return e[e.length-1]}}function yf(n,e,t){let{source:s}=e,{attrs:i}=e,{thumbDatasetIndex:r=void 0}=e,{thumbAspectRatio:o=1}=e,{cssSize:l=120}=e,{max_size:a=512}=e;const c="/zowser/";let u,d,p=l,m=l;o>1?m=p/o:o<1&&(p=m*o);let _=p,h=m,y=!0,E="none";const C=new AbortController;async function O(){const b=gf(s);console.log(c);const f=`${c}thumbs/${b}.jpg`,g=new Image;return g.decoding="async",g.referrerPolicy="no-referrer",new Promise(w=>{g.onload=()=>{t(7,E="cached"),t(6,y=!1),t(1,d.src=f,d),w(!0)},g.onerror=()=>w(!1),g.src=f})}async function M(){t(7,E="live");const b=await ef(s,i,r,a,C.signal);if(!b){console.warn("Thumbnail generation skipped/failed:",s);return}const{rgb:f,width:g,height:w}=b;t(2,p=g),t(3,m=w);let A=Math.max(p,m)/l;A<1&&(A=1),t(4,_=p/A),t(5,h=m/A),await Rl(),u.getContext("2d").putImageData(new ImageData(f,p,m),0,0),t(6,y=!1)}un(async()=>{await O()||await M()}),wi(()=>C.abort());function R(b){It[b?"unshift":"push"](()=>{d=b,t(1,d)})}function T(b){It[b?"unshift":"push"](()=>{u=b,t(0,u)})}return n.$$set=b=>{"source"in b&&t(8,s=b.source),"attrs"in b&&t(9,i=b.attrs),"thumbDatasetIndex"in b&&t(10,r=b.thumbDatasetIndex),"thumbAspectRatio"in b&&t(11,o=b.thumbAspectRatio),"cssSize"in b&&t(12,l=b.cssSize),"max_size"in b&&t(13,a=b.max_size)},[u,d,p,m,_,h,y,E,s,i,r,o,l,a,R,T]}class kl extends ct{constructor(e){super(),at(this,e,yf,mf,He,{source:8,attrs:9,thumbDatasetIndex:10,thumbAspectRatio:11,cssSize:12,max_size:13})}}const Sl="/zowser/ome-logomark.svg",_f=[{name:"vizarr",logo:"/vizarr_logo.png",href:"https://hms-dbmi.github.io/vizarr/?source="},{name:"itk-vtk-viewer",logo:"/itkvtk_logo.png",href:"https://kitware.github.io/itk-vtk-viewer/app/?rotate=false&fileToLoad="},{name:"neuroglancer",logo:"/neuroglancer.png","//":"NB: The {URL} in the href is replaced with NGFF image URL",href:"https://neuroglancer-demo.appspot.com/#!{%22layers%22:[{%22source%22:%22{URL}%22,%22name%22:%22OME-NGFF%22}]}"},{name:"Vol-E viewer",logo:"/aics_website-3d-cell-viewer.png",href:"https://volumeviewer.allencell.org/viewer?url="},{name:"napari",logo:"/napari.png",html:"<p>See <a href='https://napari.org/'>napari.org</a> for install instructions.</p><p>Then <code>napari {URL}</code>"},{name:"MoBIE",logo:"/MoBIE.jpeg",html:"<p><a href='https://github.com/mobie/mobie-viewer-fiji/'>MoBIE</a> plugin for ImageJ/Fiji. See <a href='https://omero-guides.readthedocs.io/en/latest/fiji/docs/view_mobie_zarr.html'>MoBIE guide</a> for installation. Plugins > BigDataViewer > OME ZARR > <br> Open OME ZARR from S3. <code>{URL}</code>"}],bf={viewers:_f},ei="/zowser/vizarr_logo.png",vl="/zowser/copy.png";function Dr(n,e,t){const s=n.slice();return s[21]=e[t],s[23]=t,s}function wf(n){let e,t,s,i,r,o,l,a;function c(){return n[18](n[23])}return{c(){e=I("button"),t=I("img"),i=X(),r=I("img"),v(t,"class","viewer_icon"),dt(t.src,s=n[21].logo_path)||v(t,"src",s),v(t,"alt","Viewer Icon"),v(r,"class","smallCopyBtn"),dt(r.src,o=vl)||v(r,"src",o),v(r,"alt","Copy Icon"),Ce(r,"shaking",n[2][n[23]]),v(e,"class","inlineButton"),v(e,"title","Copy URL")},m(u,d){Y(u,e,d),k(e,t),k(e,i),k(e,r),l||(a=_e(e,"click",c),l=!0)},p(u,d){n=u,d&8&&!dt(t.src,s=n[21].logo_path)&&v(t,"src",s),d&4&&Ce(r,"shaking",n[2][n[23]])},d(u){u&&W(e),l=!1,a()}}}function kf(n){let e,t,s,i,r,o,l;function a(){return n[17](n[21])}return{c(){e=I("button"),t=I("img"),v(t,"class","viewer_icon"),dt(t.src,s=n[21].logo_path)||v(t,"src",s),v(t,"alt",i=n[21].name),v(e,"class","inlineButton"),v(e,"title",r="View "+n[1]+" in "+n[21].name)},m(c,u){Y(c,e,u),k(e,t),o||(l=_e(e,"click",a),o=!0)},p(c,u){n=c,u&8&&!dt(t.src,s=n[21].logo_path)&&v(t,"src",s),u&8&&i!==(i=n[21].name)&&v(t,"alt",i),u&10&&r!==(r="View "+n[1]+" in "+n[21].name)&&v(e,"title",r)},d(c){c&&W(e),o=!1,l()}}}function Br(n){let e,t=n[21].html.replace("{URL}",n[0])+"";return{c(){e=I("div"),v(e,"class","viewer_html")},m(s,i){Y(s,e,i),e.innerHTML=t},p(s,i){i&9&&t!==(t=s[21].html.replace("{URL}",s[0])+"")&&(e.innerHTML=t)},d(s){s&&W(e)}}}function Pr(n){let e,t,s;function i(a,c){return a[21].href?kf:wf}let r=i(n),o=r(n),l=n[21].html&&Br(n);return{c(){e=I("div"),o.c(),t=X(),l&&l.c(),s=X(),v(e,"class","viewerItem")},m(a,c){Y(a,e,c),o.m(e,null),k(e,t),l&&l.m(e,null),k(e,s)},p(a,c){r===(r=i(a))&&o?o.p(a,c):(o.d(1),o=r(a),o&&(o.c(),o.m(e,t))),a[21].html?l?l.p(a,c):(l=Br(a),l.c(),l.m(e,s)):l&&(l.d(1),l=null)},d(a){a&&W(e),o.d(),l&&l.d()}}}function Fr(n){let e,t,s;return{c(){e=I("span"),t=ne(" "),s=ne(n[8]),v(e,"class","file-info")},m(i,r){Y(i,e,r),k(e,t),k(e,s)},p(i,r){r&256&&Be(s,i[8])},d(i){i&&W(e)}}}function Sf(n){let e,t,s,i,r,o,l,a,c,u,d,p,m,_,h,y,E,C,O,M,R,T,b,f,g,w,A,S,z,j,q,L=$e(n[3]),N=[];for(let D=0;D<L.length;D+=1)N[D]=Pr(Dr(n,L,D));let K=n[8]&&Fr(n);return{c(){e=I("div"),t=I("div"),s=I("div"),i=I("button"),r=I("img"),a=X(),c=I("div"),u=I("button"),u.innerHTML=`<img class="viewer_icon" src="${Sl}" alt="Validator"/>`,d=X();for(let D=0;D<N.length;D+=1)N[D].c();p=X(),m=I("div"),_=I("div"),h=I("div"),y=I("img"),C=X(),O=I("span"),M=ne(n[6]),R=X(),K&&K.c(),T=X(),b=I("div"),f=I("button"),f.textContent="",g=X(),w=I("button"),w.textContent="",A=X(),S=I("iframe"),v(r,"class","viewer_icon"),dt(r.src,o=vl)||v(r,"src",o),v(r,"alt","Copy Icon"),Ce(r,"shaking",n[2].bigCopyButton),v(i,"class","inlineButton"),v(i,"title",l="Source: "+n[0]),v(s,"class","viewerItem"),v(u,"class","inlineButton"),v(u,"title","Validate NGFF"),v(c,"class","viewerItem"),v(t,"class","viewerRow"),v(e,"class","openwith"),dt(y.src,E=n[7])||v(y,"src",E),v(y,"alt",""),v(y,"class","viewer_header_logo"),v(h,"class","vh-left"),v(f,"class","external"),v(f,"title","Open externally"),v(w,"class","close"),v(w,"title","Close"),v(b,"class","popover-buttons inline"),v(_,"class","viewer-header"),dt(S.src,z=n[5])||v(S,"src",z),v(S,"frameborder","0"),v(S,"title",n[6]),v(m,"id","viewer-popover"),v(m,"popover","")},m(D,se){Y(D,e,se),k(e,t),k(t,s),k(s,i),k(i,r),k(t,a),k(t,c),k(c,u),k(t,d);for(let H=0;H<N.length;H+=1)N[H]&&N[H].m(t,null);Y(D,p,se),Y(D,m,se),k(m,_),k(_,h),k(h,y),k(h,C),k(h,O),k(O,M),k(h,R),K&&K.m(h,null),k(_,T),k(_,b),k(b,f),k(b,g),k(b,w),k(m,A),k(m,S),n[19](m),j||(q=[_e(i,"click",n[15]),_e(u,"click",n[16]),_e(f,"click",n[12]),_e(w,"click",n[11])],j=!0)},p(D,[se]){if(se&4&&Ce(r,"shaking",D[2].bigCopyButton),se&1&&l!==(l="Source: "+D[0])&&v(i,"title",l),se&1551){L=$e(D[3]);let H;for(H=0;H<L.length;H+=1){const F=Dr(D,L,H);N[H]?N[H].p(F,se):(N[H]=Pr(F),N[H].c(),N[H].m(t,null))}for(;H<N.length;H+=1)N[H].d(1);N.length=L.length}se&128&&!dt(y.src,E=D[7])&&v(y,"src",E),se&64&&Be(M,D[6]),D[8]?K?K.p(D,se):(K=Fr(D),K.c(),K.m(h,null)):K&&(K.d(1),K=null),se&32&&!dt(S.src,z=D[5])&&v(S,"src",z),se&64&&v(S,"title",D[6])},i:Ae,o:Ae,d(D){D&&(W(e),W(p),W(m)),en(N,D),K&&K.d(),n[19](null),j=!1,wt(q)}}}function vf(n){try{const e=new URL(n).pathname.split("/");return decodeURIComponent(e.pop()||"")}catch{return decodeURIComponent(n.split("/").pop()||n)}}function Ef(n,e,t){let{source:s}=e,{dtype:i}=e,{version:r}=e,{rowData:o=void 0}=e,l={};function a(f,g){const w=document.createElement("textarea");w.value=f,document.body.appendChild(w),w.select(),document.execCommand("copy"),document.body.removeChild(w),t(2,l[g]=!0,l),setTimeout(()=>t(2,l[g]=!1,l),1e3)}let c=bf.viewers.map(f=>{let g=f.href?f.href.includes("{URL}")?f.href.replace("{URL}",s):f.href+s:void 0;const w=ei.replace("/vizarr_logo.png",f.logo);return{...f,href:g,logo_path:w}});r==="0.5"&&(c=c.filter(f=>f.name!=="itk-vtk-viewer"));let u,d="",p="",m="",_=ei,h="";function y(f,g,w=ei){d=f,t(5,p=f),t(6,m=g),t(7,_=w),t(8,h=(o==null?void 0:o.name)||vf(s)),u==null||u.showPopover()}function E(){u==null||u.hidePopover(),t(5,p="about:blank")}function C(){window.open(d,"_blank"),E()}const O=()=>a(s,"bigCopyButton"),M=()=>y(`https://ome.github.io/ome-ngff-validator/?source=${s}`,"NGFF Validator",Sl),R=f=>y(f.href,f.name,f.logo_path),T=f=>a(s,f);function b(f){It[f?"unshift":"push"](()=>{u=f,t(4,u)})}return n.$$set=f=>{"source"in f&&t(0,s=f.source),"dtype"in f&&t(1,i=f.dtype),"version"in f&&t(13,r=f.version),"rowData"in f&&t(14,o=f.rowData)},[s,i,l,c,u,p,m,_,h,a,y,E,C,r,o,O,M,R,T,b]}class Af extends ct{constructor(e){super(),at(this,e,Ef,Sf,He,{source:0,dtype:1,version:13,rowData:14})}}function zr(n,e,t){const s=n.slice();return s[11]=e[t],s}function jr(n){let e,t;return e=new kl({props:{source:n[4],attrs:n[3],max_size:2e3,thumbDatasetIndex:n[5],thumbAspectRatio:n[6]}}),{c(){rt(e.$$.fragment)},m(s,i){nt(e,s,i),t=!0},p(s,i){const r={};i&16&&(r.source=s[4]),i&8&&(r.attrs=s[3]),i&32&&(r.thumbDatasetIndex=s[5]),i&64&&(r.thumbAspectRatio=s[6]),e.$set(r)},i(s){t||(ce(e.$$.fragment,s),t=!0)},o(s){me(e.$$.fragment,s),t=!1},d(s){st(e,s)}}}function Ur(n){let e=n[11].toUpperCase()+"",t,s,i=n[0][`size_${n[11]}`]+"",r,o;return{c(){t=ne(e),s=ne(":"),r=ne(i),o=ne(" ")},m(l,a){Y(l,t,a),Y(l,s,a),Y(l,r,a),Y(l,o,a)},p(l,a){a&1&&i!==(i=l[0][`size_${l[11]}`]+"")&&Be(r,i)},d(l){l&&(W(t),W(s),W(r),W(o))}}}function Kr(n){let e,t=n[0][`size_${n[11]}`]!==void 0&&Ur(n);return{c(){t&&t.c(),e=fn()},m(s,i){t&&t.m(s,i),Y(s,e,i)},p(s,i){s[0][`size_${s[11]}`]!==void 0?t?t.p(s,i):(t=Ur(s),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(s){s&&W(e),t&&t.d(s)}}}function If(n){let e,t,s=dr(n[0].written)+"",i;return{c(){e=I("div"),t=ne("Data size: "),i=ne(s)},m(r,o){Y(r,e,o),k(e,t),k(e,i)},p(r,o){o&1&&s!==(s=dr(r[0].written)+"")&&Be(i,s)},d(r){r&&W(e)}}}function Of(n){let e,t,s=n[0].shards+"",i;return{c(){e=I("div"),t=ne("Shard shape: "),i=ne(s)},m(r,o){Y(r,e,o),k(e,t),k(e,i)},p(r,o){o&1&&s!==(s=r[0].shards+"")&&Be(i,s)},d(r){r&&W(e)}}}function Tf(n){let e,t,s=n[0].chunks+"",i;return{c(){e=I("div"),t=ne("Chunk shape: "),i=ne(s)},m(r,o){Y(r,e,o),k(e,t),k(e,i)},p(r,o){o&1&&s!==(s=r[0].chunks+"")&&Be(i,s)},d(r){r&&W(e)}}}function Cf(n){let e,t,s,i,r,o,l,a=n[0].name.replaceAll(n[1],`<mark>${n[1]}</mark>`)+"",c,u,d,p=n[0].description.replaceAll(n[1],`<mark>${n[1]}</mark>`)+"",m,_,h,y,E,C,O,M,R,T=n[3]&&jr(n);_=new Af({props:{source:n[0].url,dtype:Nf,version:Lf}});let b=$e(["t","c","z","y","x"]),f=[];for(let S=0;S<5;S+=1)f[S]=Kr(zr(n,b,S));function g(S,z){return S[2]=="chunk_pixels"?Tf:S[2]=="shard_pixels"?Of:If}let w=g(n),A=w(n);return{c(){e=I("div"),t=I("div"),T&&T.c(),s=X(),i=I("div"),r=I("div"),o=I("div"),l=I("strong"),u=X(),d=I("div"),m=X(),rt(_.$$.fragment),h=X(),y=I("div"),E=ne(`Image size:
      `);for(let S=0;S<5;S+=1)f[S].c();C=X(),A.c(),v(t,"class","thumbWrapper svelte-gffxyg"),v(o,"title",c=n[0].name),v(r,"class","nameRow"),v(d,"class","svelte-gffxyg"),Ce(d,"hideOnSmall",!n[1]),v(e,"class","zarr-list-item svelte-gffxyg")},m(S,z){Y(S,e,z),k(e,t),T&&T.m(t,null),k(e,s),k(e,i),k(i,r),k(r,o),k(o,l),l.innerHTML=a,k(i,u),k(i,d),d.innerHTML=p,k(i,m),nt(_,i,null),k(i,h),k(i,y),k(y,E);for(let j=0;j<5;j+=1)f[j]&&f[j].m(y,null);k(i,C),A.m(i,null),O=!0,M||(R=_e(t,"click",n[7]),M=!0)},p(S,[z]){S[3]?T?(T.p(S,z),z&8&&ce(T,1)):(T=jr(S),T.c(),ce(T,1),T.m(t,null)):T&&(Wn(),me(T,1,1,()=>{T=null}),Yn()),(!O||z&3)&&a!==(a=S[0].name.replaceAll(S[1],`<mark>${S[1]}</mark>`)+"")&&(l.innerHTML=a),(!O||z&1&&c!==(c=S[0].name))&&v(o,"title",c),(!O||z&3)&&p!==(p=S[0].description.replaceAll(S[1],`<mark>${S[1]}</mark>`)+"")&&(d.innerHTML=p),(!O||z&2)&&Ce(d,"hideOnSmall",!S[1]);const j={};if(z&1&&(j.source=S[0].url),_.$set(j),z&1){b=$e(["t","c","z","y","x"]);let q;for(q=0;q<5;q+=1){const L=zr(S,b,q);f[q]?f[q].p(L,z):(f[q]=Kr(L),f[q].c(),f[q].m(y,null))}for(;q<5;q+=1)f[q].d(1)}w===(w=g(S))&&A?A.p(S,z):(A.d(1),A=w(S),A&&(A.c(),A.m(i,null)))},i(S){O||(ce(T),ce(_.$$.fragment,S),O=!0)},o(S){me(T),me(_.$$.fragment,S),O=!1},d(S){S&&W(e),T&&T.d(),st(_),en(f,S),A.d(),M=!1,R()}}}let Nf="image",Lf="0.5";function Mf(n,e,t){let{rowData:s}=e,{textFilter:i}=e,{sortedBy:r=void 0}=e,o,l,a,c=1;const u=new AbortController;if(s.size_x&&s.size_y){let p=Math.max(s.size_x,s.size_y);for(a=0;p>256;)a+=1,p=p/2;c=s.size_x/s.size_y}function d(){console.log("Clicked on thumbnail"),xe.setSelectedRow(s)}return un(async()=>{let p=s.url;s.series0!==void 0&&(p+="/"+s.series0);let m=await Rn(p,u.signal);t(3,o=m[0]),t(4,l=m[1]),m[2]}),wi(()=>{u.abort()}),n.$$set=p=>{"rowData"in p&&t(0,s=p.rowData),"textFilter"in p&&t(1,i=p.textFilter),"sortedBy"in p&&t(2,r=p.sortedBy)},[s,i,r,o,l,a,c,d]}class Rf extends ct{constructor(e){super(),at(this,e,Mf,Cf,He,{rowData:0,textFilter:1,sortedBy:2})}}function Df(n){let e,t,s,i;return t=new Rf({props:{rowData:n[0][n[13]],textFilter:n[1],sortedBy:n[2]}}),{c(){e=I("div"),rt(t.$$.fragment),v(e,"slot","item"),v(e,"style",s=n[12]),v(e,"class","row svelte-1xlep2t")},m(r,o){Y(r,e,o),nt(t,e,null),i=!0},p(r,o){const l={};o&8193&&(l.rowData=r[0][r[13]]),o&2&&(l.textFilter=r[1]),o&4&&(l.sortedBy=r[2]),t.$set(l),(!i||o&4096&&s!==(s=r[12]))&&v(e,"style",s)},i(r){i||(ce(t.$$.fragment,r),i=!0)},o(r){me(t.$$.fragment,r),i=!1},d(r){r&&W(e),st(t)}}}function Bf(n){let e=!1,t=()=>{e=!1},s,i,r,o=`${n[5]}px`,l,a,c;return vt(n[8]),vt(n[9]),r=new pf({props:{width:"100%",height:n[5],itemCount:n[0].length,itemSize:160,getKey:n[6],$$slots:{item:[Df,({style:u,index:d})=>({12:u,13:d}),({style:u,index:d})=>(u?4096:0)|(d?8192:0)]},$$scope:{ctx:n}}}),r.$on("afterScroll",n[7]),{c(){i=I("div"),rt(r.$$.fragment),v(i,"class","imageListContainer svelte-1xlep2t"),de(i,"height",o)},m(u,d){Y(u,i,d),nt(r,i,null),n[10](i),l=!0,a||(c=[_e(window,"resize",n[8]),_e(window,"scroll",()=>{e=!0,clearTimeout(s),s=setTimeout(t,100),n[9]()})],a=!0)},p(u,[d]){d&16&&!e&&(e=!0,clearTimeout(s),scrollTo(window.pageXOffset,u[4]),s=setTimeout(t,100));const p={};d&32&&(p.height=u[5]),d&1&&(p.itemCount=u[0].length),d&28679&&(p.$$scope={dirty:d,ctx:u}),r.$set(p),d&32&&o!==(o=`${u[5]}px`)&&de(i,"height",o)},i(u){l||(ce(r.$$.fragment,u),l=!0)},o(u){me(r.$$.fragment,u),l=!1},d(u){u&&W(i),st(r),n[10](null),a=!1,wt(c)}}}function Pf(n,e,t){let s,{tableRows:i}=e,{textFilter:r}=e,{sortedBy:o=void 0}=e;function l(h){return i[h].url}let a,c=0,u=0;function d(h){let E=a.offsetTop-20;h.detail.offset-u<0&&c>E&&t(4,c-=1),u=h.detail.offset}function p(){t(5,s=window.innerHeight)}function m(){t(4,c=window.pageYOffset)}function _(h){It[h?"unshift":"push"](()=>{a=h,t(3,a)})}return n.$$set=h=>{"tableRows"in h&&t(0,i=h.tableRows),"textFilter"in h&&t(1,r=h.textFilter),"sortedBy"in h&&t(2,o=h.sortedBy)},t(5,s=0),[i,r,o,a,c,s,l,d,p,m,_]}class Ff extends ct{constructor(e){super(),at(this,e,Pf,Bf,He,{tableRows:0,textFilter:1,sortedBy:2})}}function qr(n){let e,t;return e=new kl({props:{source:n[1],attrs:n[0],cssSize:512,max_size:2e3,thumbDatasetIndex:n[2],thumbAspectRatio:n[3]}}),{c(){rt(e.$$.fragment)},m(s,i){nt(e,s,i),t=!0},p(s,i){const r={};i&2&&(r.source=s[1]),i&1&&(r.attrs=s[0]),i&4&&(r.thumbDatasetIndex=s[2]),i&8&&(r.thumbAspectRatio=s[3]),e.$set(r)},i(s){t||(ce(e.$$.fragment,s),t=!0)},o(s){me(e.$$.fragment,s),t=!1},d(s){st(e,s)}}}function zf(n){let e,t,s=n[0]&&qr(n);return{c(){s&&s.c(),e=fn()},m(i,r){s&&s.m(i,r),Y(i,e,r),t=!0},p(i,[r]){i[0]?s?(s.p(i,r),r&1&&ce(s,1)):(s=qr(i),s.c(),ce(s,1),s.m(e.parentNode,e)):s&&(Wn(),me(s,1,1,()=>{s=null}),Yn())},i(i){t||(ce(s),t=!0)},o(i){me(s),t=!1},d(i){i&&W(e),s&&s.d(i)}}}function jf(n,e,t){let{rowData:s}=e;console.log("ThumbLoader",s);let i,r,o,l=1;if(s.size_x&&s.size_y){let a=Math.max(s.size_x,s.size_y);for(o=0;a>1024;)o+=1,a=a/2;l=s.size_x/s.size_y}else o=void 0,l=1;return un(async()=>{let a=await Rn(s.url);t(0,i=a[0]),t(1,r=a[1]),a[2]}),n.$$set=a=>{"rowData"in a&&t(4,s=a.rowData)},[i,r,o,l,s]}class Uf extends ct{constructor(e){super(),at(this,e,jf,zf,He,{rowData:4})}}function $r(n,e,t){const s=n.slice();return s[5]=e[t][0],s[6]=e[t][1],s}function Vr(n){let e,t;return e=new Uf({props:{rowData:n[1]}}),{c(){rt(e.$$.fragment)},m(s,i){nt(e,s,i),t=!0},p(s,i){const r={};i&2&&(r.rowData=s[1]),e.$set(r)},i(s){t||(ce(e.$$.fragment,s),t=!0)},o(s){me(e.$$.fragment,s),t=!1},d(s){st(e,s)}}}function Jr(n){let e,t,s=n[2]&&Vr(n);return{c(){s&&s.c(),e=fn()},m(i,r){s&&s.m(i,r),Y(i,e,r),t=!0},p(i,r){i[2]?s?(s.p(i,r),r&4&&ce(s,1)):(s=Vr(i),s.c(),ce(s,1),s.m(e.parentNode,e)):s&&(Wn(),me(s,1,1,()=>{s=null}),Yn())},i(i){t||(ce(s),t=!0)},o(i){me(s),t=!1},d(i){i&&W(e),s&&s.d(i)}}}function Wr(n){let e,t=$e(Object.entries(n[1])),s=[];for(let i=0;i<t.length;i+=1)s[i]=Yr($r(n,t,i));return{c(){e=I("table");for(let i=0;i<s.length;i+=1)s[i].c()},m(i,r){Y(i,e,r);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null)},p(i,r){if(r&2){t=$e(Object.entries(i[1]));let o;for(o=0;o<t.length;o+=1){const l=$r(i,t,o);s[o]?s[o].p(l,r):(s[o]=Yr(l),s[o].c(),s[o].m(e,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=t.length}},d(i){i&&W(e),en(s,i)}}}function Yr(n){let e,t,s=n[5]+"",i,r,o=n[6]+"",l;return{c(){e=I("tr"),t=I("td"),i=ne(s),r=I("td"),l=ne(o)},m(a,c){Y(a,e,c),k(e,t),k(t,i),k(e,r),k(r,l)},p(a,c){c&2&&s!==(s=a[5]+"")&&Be(i,s),c&2&&o!==(o=a[6]+"")&&Be(l,o)},d(a){a&&W(e)}}}function Kf(n){let e,t,s,i,r=n[2],o,l,a,c,u=Jr(n),d=n[1]&&Wr(n);return{c(){e=I("div"),t=I("button"),t.textContent="",s=X(),i=I("div"),u.c(),o=X(),d&&d.c(),v(t,"class","close svelte-1g3sjso"),v(t,"title","Close"),v(i,"class","scrollable svelte-1g3sjso"),v(e,"id","mypopover"),v(e,"popover",""),v(e,"class","svelte-1g3sjso")},m(p,m){Y(p,e,m),k(e,t),k(e,s),k(e,i),u.m(i,null),k(i,o),d&&d.m(i,null),n[4](e),l=!0,a||(c=_e(t,"click",n[3]),a=!0)},p(p,[m]){m&4&&He(r,r=p[2])?(Wn(),me(u,1,1,Ae),Yn(),u=Jr(p),u.c(),ce(u,1),u.m(i,o)):u.p(p,m),p[1]?d?d.p(p,m):(d=Wr(p),d.c(),d.m(i,null)):d&&(d.d(1),d=null)},i(p){l||(ce(u),l=!0)},o(p){me(u),l=!1},d(p){p&&W(e),u.d(p),d&&d.d(),n[4](null),a=!1,c()}}}function qf(n,e,t){let s,i,r;xe.subscribeSelectedRow(a=>{console.log("Showing preview for",a),a&&(t(1,i=a),console.log("Showing Thumb preview for",a,i),t(2,r=i.url),s.showPopover())});function o(){s.hidePopover()}un(()=>{console.log("Mounted popover",s),s&&s.addEventListener("toggle",a=>{a.newState==="open"||(console.log("Popover has been hidden"),xe.setSelectedRow(null))})});function l(a){It[a?"unshift":"push"](()=>{s=a,t(0,s)})}return[s,i,r,o,l]}class $f extends ct{constructor(e){super(),at(this,e,qf,Kf,He,{})}}const Vf="/zowser/selectCaret.svg",Jf="/zowser/samples/zarrs_metadata.csv";function Hr(n){let e,t,s=n[2]&&Gr(n),i=n[1]&&Qr(n);return{c(){e=I("div"),s&&s.c(),t=X(),i&&i.c(),v(e,"class","collectionHeader svelte-74q8mm"),Ce(e,"center",n[0])},m(r,o){Y(r,e,o),s&&s.m(e,null),k(e,t),i&&i.m(e,null)},p(r,o){r[2]?s?s.p(r,o):(s=Gr(r),s.c(),s.m(e,t)):s&&(s.d(1),s=null),r[1]?i?i.p(r,o):(i=Qr(r),i.c(),i.m(e,null)):i&&(i.d(1),i=null),o&1&&Ce(e,"center",r[0])},d(r){r&&W(e),s&&s.d(),i&&i.d()}}}function Gr(n){let e;return{c(){e=I("h2"),v(e,"class","collectionTitle svelte-74q8mm")},m(t,s){Y(t,e,s),e.innerHTML=n[2]},p(t,s){s&4&&(e.innerHTML=t[2])},d(t){t&&W(e)}}}function Qr(n){let e;return{c(){e=I("p"),v(e,"class","collectionDesc svelte-74q8mm")},m(t,s){Y(t,e,s),e.innerHTML=n[1]},p(t,s){s&2&&(e.innerHTML=t[1])},d(t){t&&W(e)}}}function Wf(n){let e,t=(n[2]||n[1])&&Hr(n);return{c(){t&&t.c(),e=fn()},m(s,i){t&&t.m(s,i),Y(s,e,i)},p(s,[i]){s[2]||s[1]?t?t.p(s,i):(t=Hr(s),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ae,o:Ae,d(s){s&&W(e),t&&t.d(s)}}}function Yf(n,e,t){let s,i,{yamlUrl:r="/zowser/config.yaml"}=e,{fallbackTitle:o=""}=e,{fallbackDescription:l=""}=e,{center:a=!0}=e,c="",u="";async function d(){var p,m;try{const _=await fetch(r,{cache:"no-store"});if(!_.ok)throw new Error(`${_.status} ${_.statusText}`);const h=fl.parse(await _.text())||{};t(6,c=((p=h==null?void 0:h.config)==null?void 0:p.title)||""),t(7,u=((m=h==null?void 0:h.config)==null?void 0:m.description)||"")}catch(_){console.warn("PageTitle: YAML load failed:",_),t(6,c=o),t(7,u=l)}}return un(d),n.$$set=p=>{"yamlUrl"in p&&t(3,r=p.yamlUrl),"fallbackTitle"in p&&t(4,o=p.fallbackTitle),"fallbackDescription"in p&&t(5,l=p.fallbackDescription),"center"in p&&t(0,a=p.center)},n.$$.update=()=>{n.$$.dirty&80&&t(2,s=c||o),n.$$.dirty&160&&t(1,i=u||l)},[a,i,s,r,o,l,c,u]}class Hf extends ct{constructor(e){super(),at(this,e,Yf,Wf,He,{yamlUrl:3,fallbackTitle:4,fallbackDescription:5,center:0})}}function Gf(n,e,t){const s=n.slice();return s[31]=e[t],s}function Xr(n,e,t){const s=n.slice();return s[34]=e[t],s}function Zr(n,e,t){const s=n.slice();return s[34]=e[t],s}function xr(n,e,t){const s=n.slice();return s[31]=e[t],s}function eo(n){let e,t=n[31]+"",s,i,r;return{c(){e=I("option"),s=ne(t),i=ne("D"),e.__value=r=n[31],De(e,e.__value)},m(o,l){Y(o,e,l),k(e,s),k(e,i)},p(o,l){l[0]&64&&t!==(t=o[31]+"")&&Be(s,t),l[0]&64&&r!==(r=o[31])&&(e.__value=r,De(e,e.__value))},d(o){o&&W(e)}}}function to(n){let e=n[12].includes(n[31]),t,s=e&&eo(n);return{c(){s&&s.c(),t=fn()},m(i,r){s&&s.m(i,r),Y(i,t,r)},p(i,r){r[0]&4160&&(e=i[12].includes(i[31])),e?s?s.p(i,r):(s=eo(i),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},d(i){i&&W(t),s&&s.d(i)}}}function no(n){let e,t=n[34]+"",s,i;return{c(){e=I("option"),s=ne(t),e.__value=i=n[1][n[34]],De(e,e.__value)},m(r,o){Y(r,e,o),k(e,s)},p(r,o){o[0]&2050&&t!==(t=r[34]+"")&&Be(s,t),o[0]&2050&&i!==(i=r[1][r[34]])&&(e.__value=i,De(e,e.__value))},d(r){r&&W(e)}}}function so(n,e){let t,s=e[34]+"",i,r;return{key:n,first:null,c(){t=I("option"),i=ne(s),t.__value=r=e[2][e[34]],De(t,t.__value),this.first=t},m(o,l){Y(o,t,l),k(t,i)},p(o,l){e=o,l[0]&1028&&s!==(s=e[34]+"")&&Be(i,s),l[0]&1028&&r!==(r=e[2][e[34]])&&(t.__value=r,De(t,t.__value))},d(o){o&&W(t)}}}function Qf(n){let e;return{c(){e=I("option"),e.textContent=`Size: ${n[31].toUpperCase()}`,e.__value="size_"+n[31],De(e,e.__value)},m(t,s){Y(t,e,s)},p:Ae,d(t){t&&W(e)}}}function Xf(n){let e,t,s,i,r,o,l,a,c,u,d,p,m,_,h,y,E,C,O,M,R=n[3]!==""?"All Dimensions":"Dimension Count",T,b,f,g,w,A,S,z,j,q,L,N=n[4]==""?"Organism":"All Organisms",K,D,se,H,F,fe,P,$,Q,x,ee=n[5]==""?"Imaging Modality":"All Modalities",U,V,Z=[],ve=new Map,ue,Ee,oe,he,Ve,Le,Ge,Qe,Fe,le,ie,Je,ae,gt,Me,We,ze,ft,Xe,Ie,Ct,Te,it,Kt,xn=n[0].length+"",js,Hi,Us,Gi,Qi,Nt,Ze,Ks,Xi;e=new $f({}),r=new Hf({});let qt=$e(n[6]),je=[];for(let B=0;B<qt.length;B+=1)je[B]=to(xr(n,qt,B));let $t=$e(Object.keys(n[1]).sort().filter(n[23])),Ue=[];for(let B=0;B<$t.length;B+=1)Ue[B]=no(Zr(n,$t,B));let es=$e(Object.keys(n[2]).sort().filter(n[25]));const Zi=B=>B[34];for(let B=0;B<es.length;B+=1){let te=Xr(n,es,B),ge=Zi(te);ve.set(ge,Z[B]=so(ge,te))}let El=$e(["x","y","z","c","t"]),bn=[];for(let B=0;B<5;B+=1)bn[B]=Qf(Gf(n,El,B));return Ie=new rf({props:{toggleAscending:n[14],sortAscending:n[9]}}),Nt=new Ff({props:{tableRows:n[0],textFilter:n[13],sortedBy:n[8]}}),{c(){rt(e.$$.fragment),t=X(),s=I("main"),i=I("div"),rt(r.$$.fragment),o=X(),l=I("div"),a=I("input"),c=X(),u=I("button"),d=ne(""),p=X(),m=I("div"),_=I("div"),h=I("div"),y=I("div"),y.textContent="Filter by:",E=X(),C=I("div"),O=I("select"),M=I("option"),T=ne(R),b=X(),f=I("hr");for(let B=0;B<je.length;B+=1)je[B].c();g=X(),w=I("div"),A=I("button"),S=ne(""),z=X(),j=I("div"),q=I("select"),L=I("option"),K=ne(N),D=I("hr");for(let B=0;B<Ue.length;B+=1)Ue[B].c();se=X(),H=I("div"),F=I("button"),fe=ne(""),P=X(),$=I("div"),Q=I("select"),x=I("option"),U=ne(ee),V=I("hr");for(let B=0;B<Z.length;B+=1)Z[B].c();ue=X(),Ee=I("div"),oe=I("button"),he=ne(""),Ve=X(),Le=I("div"),Ge=X(),Qe=I("div"),Qe.textContent="Sort by:",Fe=X(),le=I("div"),ie=I("select"),Je=I("option"),Je.textContent="--",ae=I("hr");for(let B=0;B<5;B+=1)bn[B].c();gt=I("hr"),Me=I("option"),Me.textContent="Data Size (bytes)",We=I("option"),We.textContent="Chunk Size (pixels)",ze=I("option"),ze.textContent="Shard Size (pixels)",ft=X(),Xe=I("div"),rt(Ie.$$.fragment),Ct=X(),Te=I("div"),it=I("h3"),Kt=ne("Showing "),js=ne(xn),Hi=ne(" out of "),Us=ne(n[7]),Gi=ne(" images"),Qi=X(),rt(Nt.$$.fragment),v(a,"placeholder","Filter by Name or Description"),v(a,"name","textFilter"),v(a,"class","svelte-cmksur"),v(u,"title","Clear Filter"),de(u,"visibility",n[13]!==""?"visible":"hidden"),v(u,"class","svelte-cmksur"),v(l,"class","textInputWrapper svelte-cmksur"),v(i,"class","summary svelte-cmksur"),de(y,"white-space","nowrap"),M.__value="",De(M,M.__value),v(O,"class","svelte-cmksur"),n[3]===void 0&&vt(()=>n[22].call(O)),v(A,"title","Clear Filter"),de(A,"visibility",n[3]!==""?"visible":"hidden"),v(A,"class","svelte-cmksur"),v(w,"class","svelte-cmksur"),v(C,"class","selectWrapper svelte-cmksur"),L.__value="",De(L,L.__value),v(q,"class","svelte-cmksur"),n[4]===void 0&&vt(()=>n[24].call(q)),v(F,"title","Clear Filter"),de(F,"visibility",n[4]!==""?"visible":"hidden"),v(F,"class","svelte-cmksur"),v(H,"class","svelte-cmksur"),v(j,"class","selectWrapper svelte-cmksur"),x.__value="",De(x,x.__value),v(Q,"class","svelte-cmksur"),n[5]===void 0&&vt(()=>n[26].call(Q)),v(oe,"title","Clear Filter"),de(oe,"visibility",n[5]!==""?"visible":"hidden"),v(oe,"class","svelte-cmksur"),v(Ee,"class","svelte-cmksur"),v($,"class","selectWrapper svelte-cmksur"),v(Le,"class","clear"),Je.__value="",De(Je,Je.__value),Me.__value="written",De(Me,Me.__value),We.__value="chunk_pixels",De(We,We.__value),ze.__value="shard_pixels",De(ze,ze.__value),v(ie,"class","svelte-cmksur"),v(Xe,"class","svelte-cmksur"),v(le,"class","selectWrapper svelte-cmksur"),v(h,"class","filters svelte-cmksur"),v(_,"class","sidebar svelte-cmksur"),de(it,"margin-left","15px"),v(it,"class","svelte-cmksur"),v(Te,"class","results svelte-cmksur"),v(m,"class","sidebarContainer svelte-cmksur"),de(s,"--form-select-bg-img","url('"+Vf+"')"),v(s,"class","svelte-cmksur")},m(B,te){nt(e,B,te),Y(B,t,te),Y(B,s,te),k(s,i),nt(r,i,null),k(i,o),k(i,l),k(l,a),De(a,n[13]),k(l,c),k(l,u),k(u,d),k(s,p),k(s,m),k(m,_),k(_,h),k(h,y),k(h,E),k(h,C),k(C,O),k(O,M),k(M,T),k(M,b),k(O,f);for(let ge=0;ge<je.length;ge+=1)je[ge]&&je[ge].m(O,null);Vt(O,n[3],!0),k(C,g),k(C,w),k(w,A),k(A,S),k(h,z),k(h,j),k(j,q),k(q,L),k(L,K),k(q,D);for(let ge=0;ge<Ue.length;ge+=1)Ue[ge]&&Ue[ge].m(q,null);Vt(q,n[4],!0),k(j,se),k(j,H),k(H,F),k(F,fe),k(h,P),k(h,$),k($,Q),k(Q,x),k(x,U),k(Q,V);for(let ge=0;ge<Z.length;ge+=1)Z[ge]&&Z[ge].m(Q,null);Vt(Q,n[5],!0),k($,ue),k($,Ee),k(Ee,oe),k(oe,he),k(h,Ve),k(h,Le),k(h,Ge),k(h,Qe),k(h,Fe),k(h,le),k(le,ie),k(ie,Je),k(ie,ae);for(let ge=0;ge<5;ge+=1)bn[ge]&&bn[ge].m(ie,null);k(ie,gt),k(ie,Me),k(ie,We),k(ie,ze),k(le,ft),k(le,Xe),nt(Ie,Xe,null),k(m,Ct),k(m,Te),k(Te,it),k(it,Kt),k(it,js),k(it,Hi),k(it,Us),k(it,Gi),k(Te,Qi),nt(Nt,Te,null),Ze=!0,Ks||(Xi=[_e(a,"input",n[21]),_e(a,"input",n[19]),_e(u,"click",n[19]),_e(O,"change",n[22]),_e(O,"change",n[16]),_e(A,"click",n[16]),_e(q,"change",n[24]),_e(q,"change",n[17]),_e(F,"click",n[17]),_e(Q,"change",n[26]),_e(Q,"change",n[18]),_e(oe,"click",n[18]),_e(ie,"change",n[15])],Ks=!0)},p(B,te){if(te[0]&8192&&a.value!==B[13]&&De(a,B[13]),(!Ze||te[0]&8192)&&de(u,"visibility",B[13]!==""?"visible":"hidden"),(!Ze||te[0]&8)&&R!==(R=B[3]!==""?"All Dimensions":"Dimension Count")&&Be(T,R),te[0]&4160){qt=$e(B[6]);let ye;for(ye=0;ye<qt.length;ye+=1){const wn=xr(B,qt,ye);je[ye]?je[ye].p(wn,te):(je[ye]=to(wn),je[ye].c(),je[ye].m(O,null))}for(;ye<je.length;ye+=1)je[ye].d(1);je.length=qt.length}if(te[0]&72&&Vt(O,B[3]),(!Ze||te[0]&8)&&de(A,"visibility",B[3]!==""?"visible":"hidden"),(!Ze||te[0]&16)&&N!==(N=B[4]==""?"Organism":"All Organisms")&&Be(K,N),te[0]&2050){$t=$e(Object.keys(B[1]).sort().filter(B[23]));let ye;for(ye=0;ye<$t.length;ye+=1){const wn=Zr(B,$t,ye);Ue[ye]?Ue[ye].p(wn,te):(Ue[ye]=no(wn),Ue[ye].c(),Ue[ye].m(q,null))}for(;ye<Ue.length;ye+=1)Ue[ye].d(1);Ue.length=$t.length}te[0]&2066&&Vt(q,B[4]),(!Ze||te[0]&16)&&de(F,"visibility",B[4]!==""?"visible":"hidden"),(!Ze||te[0]&32)&&ee!==(ee=B[5]==""?"Imaging Modality":"All Modalities")&&Be(U,ee),te[0]&1028&&(es=$e(Object.keys(B[2]).sort().filter(B[25])),Z=ho(Z,te,Zi,1,B,es,ve,Q,Pl,so,null,Xr)),te[0]&1060&&Vt(Q,B[5]),(!Ze||te[0]&32)&&de(oe,"visibility",B[5]!==""?"visible":"hidden");const ge={};te[0]&512&&(ge.sortAscending=B[9]),Ie.$set(ge),(!Ze||te[0]&1)&&xn!==(xn=B[0].length+"")&&Be(js,xn),(!Ze||te[0]&128)&&Be(Us,B[7]);const ts={};te[0]&1&&(ts.tableRows=B[0]),te[0]&8192&&(ts.textFilter=B[13]),te[0]&256&&(ts.sortedBy=B[8]),Nt.$set(ts)},i(B){Ze||(ce(e.$$.fragment,B),ce(r.$$.fragment,B),ce(Ie.$$.fragment,B),ce(Nt.$$.fragment,B),Ze=!0)},o(B){me(e.$$.fragment,B),me(r.$$.fragment,B),me(Ie.$$.fragment,B),me(Nt.$$.fragment,B),Ze=!1},d(B){B&&(W(t),W(s)),st(e,B),st(r),en(je,B),en(Ue,B);for(let te=0;te<Z.length;te+=1)Z[te].d();en(bn,B),st(Ie),st(Nt),Ks=!1,wt(Xi)}}}function Zf(n,e,t){let s,i,r,o,l,a,c,u,d,p=Jf,m=[],_=0,h={},y={};xe.subscribe(L=>{t(0,m=R(L)),t(7,_=L.length),L.reduce((N,K)=>N+parseInt(K.written)||0,0)}),dl.subscribe(L=>{let N={};for(const[K,D]of Object.entries(L))N[D]=K;t(1,h=N)}),pl.subscribe(L=>{let N={};for(const[K,D]of Object.entries(L))N[D]=K;t(2,y=N)}),ul(p,xe);let E="",C=!1;function O(){t(9,C=!C),xe.sortTable(E,C)}function M(L){t(8,E=L.target.value),E===""?xe.sortTable("index",!0):xe.sortTable(E,C)}function R(L){if(s!==""&&(L=L.filter(N=>N.dim_count==s)),i!==""&&(L=L.filter(N=>N.organismId==i)),r!=""&&(L=L.filter(N=>N.fbbiId==r)),o&&o!=""){let N=o.toLowerCase();L=L.filter(K=>{var D,se;return K.url.toLowerCase().includes(N)||((D=K.description)==null?void 0:D.toLowerCase().includes(N))||((se=K.name)==null?void 0:se.toLowerCase().includes(N))})}return L}function T(L){t(3,s=L.target.value||""),t(0,m=R(xe.getRows()))}function b(L){t(4,i=L.target.value||""),t(0,m=R(xe.getRows()))}function f(L){t(5,r=L.target.value||""),t(0,m=R(xe.getRows()))}function g(L){t(13,o=L.target.value),t(0,m=R(xe.getRows()))}function w(){o=this.value,t(13,o)}function A(){s=Vs(this),t(3,s),t(6,a),t(20,l)}const S=L=>u.includes(h[L]);function z(){i=Vs(this),t(4,i),t(1,h),t(11,u),t(20,l),t(1,h),t(5,r),t(3,s)}const j=L=>d.includes(y[L]);function q(){r=Vs(this),t(5,r),t(2,y),t(10,d),t(20,l),t(2,y),t(4,i),t(3,s)}return n.$$.update=()=>{n.$$.dirty[0]&1&&m.some(L=>L.source),n.$$.dirty[0]&1048576&&t(6,a=Array.from(new Set(l.map(L=>String(L.dim_count)).filter(Boolean))).sort()),n.$$.dirty[0]&1048688&&t(12,c=l.length===0?a:Array.from(new Set(l.filter(L=>(i?L.organismId===i:!0)&&(r?L.fbbiId===r:!0)).map(L=>String(L.dim_count)).filter(Boolean))).sort()),n.$$.dirty[0]&1048618&&t(11,u=l.length===0?Object.values(h):Array.from(new Set(l.filter(L=>(r?L.fbbiId===r:!0)&&(s?String(L.dim_count)===s:!0)).map(L=>L.organismId).filter(Boolean)))),n.$$.dirty[0]&1048604&&t(10,d=l.length===0?Object.values(y):Array.from(new Set(l.filter(L=>(i?L.organismId===i:!0)&&(s?String(L.dim_count)===s:!0)).map(L=>L.fbbiId).filter(Boolean))))},t(3,s=""),t(4,i=""),t(5,r=""),t(13,o=""),t(20,l=xe.getRows()),[m,h,y,s,i,r,a,_,E,C,d,u,c,o,O,M,T,b,f,g,l,w,A,S,z,j,q]}class xf extends ct{constructor(e){super(),at(this,e,Zf,Xf,He,{},null,[-1,-1])}}const eu="/zowser/nfdi_rgb_Wortmarke_Zusatz_quer.png",tu="/zowser/czi-logo-chan-zuckerberg-initiative-logo.png";function nu(n){let e,t,s;return{c(){e=I("base"),t=X(),s=I("div"),s.innerHTML=`<h2>Introduction</h2> <p>Zowser is an OME-Zarr browser based on the <a href="https://forum.image.sc/t/ome2024-ngff-challenge/97363">2024 OME-NGFF Challenge</a>, conceived at the
    <a href="https://www.openmicroscopy.org/events/ome-community-meeting-2024/">OME Annual Community Meeting</a>
    in Dundee in May 2024.</p> <h2>Acknowledgements</h2> <p>Coordination of the challenge was supported by the <a href="https://www.nfdi.de/">German National Research Data Initiative (NFDI)</a>
    and the
    <a href="https://chanzuckerberg.com/">Chan Zuckerberg Initiative</a>:</p> <table><tr><td><img src="${eu}" alt="NFDI Logo" width="45%"/></td> <td><img src="${tu}" alt="Chan Zuckerberg Initiative Logo" width="45%"/></td></tr></table>`,v(e,"href",n[0]),v(s,"class","svelte-zlrnwt")},m(i,r){Y(i,e,r),Y(i,t,r),Y(i,s,r)},p:Ae,i:Ae,o:Ae,d(i){i&&(W(e),W(t),W(s))}}}function su(n){return["/zowser/"]}class iu extends ct{constructor(e){super(),at(this,e,su,nu,He,{})}}function ru(n){let e,t;return e=new xf({}),{c(){rt(e.$$.fragment)},m(s,i){nt(e,s,i),t=!0},i(s){t||(ce(e.$$.fragment,s),t=!0)},o(s){me(e.$$.fragment,s),t=!1},d(s){st(e,s)}}}function ou(n){let e,t;return e=new iu({}),{c(){rt(e.$$.fragment)},m(s,i){nt(e,s,i),t=!0},i(s){t||(ce(e.$$.fragment,s),t=!0)},o(s){me(e.$$.fragment,s),t=!1},d(s){st(e,s)}}}function lu(n){let e,t,s,i;const r=[ou,ru],o=[];function l(a,c){return a[0].endsWith("/about/")?0:1}return t=l(n),s=o[t]=r[t](n),{c(){e=I("div"),s.c(),v(e,"class","app svelte-zq2j0t")},m(a,c){Y(a,e,c),o[t].m(e,null),i=!0},p:Ae,i(a){i||(ce(s),i=!0)},o(a){me(s),i=!1},d(a){a&&W(e),o[t].d()}}}function au(n){return[window.location.pathname]}class cu extends ct{constructor(e){super(),at(this,e,au,lu,He,{})}}new cu({target:document.getElementById("app")});
