const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/blosc-E49GQuAK.js","assets/chunk-INHXZS53-D3tQiqtZ.js","assets/gzip-CF-9a_hd.js","assets/browser-B-ZyVB-j.js","assets/lz4-BIGKWw27.js","assets/zlib-CBiqHlio.js","assets/zstd-IvP746pw.js"])))=>i.map(i=>d[i]);
var Ar=Object.defineProperty;var ui=t=>{throw TypeError(t)};var Sr=(t,e,n)=>e in t?Ar(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var se=(t,e,n)=>Sr(t,typeof e!="symbol"?e+"":e,n),En=(t,e,n)=>e.has(t)||ui("Cannot "+n);var K=(t,e,n)=>(En(t,e,"read from private field"),n?n.call(t):e.get(t)),Ee=(t,e,n)=>e.has(t)?ui("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),ye=(t,e,n,i)=>(En(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),Cn=(t,e,n)=>(En(t,e,"access private method"),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function we(){}function zr(t,e){for(const n in e)t[n]=e[n];return t}function rr(t){return t()}function ci(){return Object.create(null)}function st(t){t.forEach(rr)}function sr(t){return typeof t=="function"}function je(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let cn;function $e(t,e){return t===e?!0:(cn||(cn=document.createElement("a")),cn.href=e,t===cn.href)}function Tr(t){return Object.keys(t).length===0}function Rr(t,...e){if(t==null){for(const i of e)i(void 0);return we}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function hn(t){let e;return Rr(t,n=>e=n)(),e}function Tn(t,e,n,i){if(t){const r=or(t,e,n,i);return t[0](r)}}function or(t,e,n,i){return t[1]&&i?zr(n.ctx.slice(),t[1](i(e))):n.ctx}function Rn(t,e,n,i){if(t[2]&&i){const r=t[2](i(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],o=Math.max(e.dirty.length,r.length);for(let l=0;l<o;l+=1)s[l]=e.dirty[l]|r[l];return s}return e.dirty|r}return e.dirty}function On(t,e,n,i,r,s){if(r){const o=or(e,n,i,s);t.p(o,r)}}function Ln(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let i=0;i<n;i++)e[i]=-1;return e}return-1}function fi(t){return t??""}function _(t,e){t.appendChild(e)}function G(t,e,n){t.insertBefore(e,n||null)}function q(t){t.parentNode&&t.parentNode.removeChild(t)}function It(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function E(t){return document.createElement(t)}function Y(t){return document.createTextNode(t)}function H(){return Y(" ")}function $t(){return Y("")}function pe(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function b(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Or(t){return Array.from(t.childNodes)}function Ie(t,e){e=""+e,t.data!==e&&(t.data=e)}function Re(t,e){t.value=e??""}function le(t,e,n,i){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}function wt(t,e,n){for(let i=0;i<t.options.length;i+=1){const r=t.options[i];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function In(t){const e=t.querySelector(":checked");return e&&e.__value}function Ue(t,e,n){t.classList.toggle(e,!!n)}function Lr(t,e,{bubbles:n=!1,cancelable:i=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:i})}let Bt;function Pt(t){Bt=t}function xn(){if(!Bt)throw new Error("Function called outside component initialization");return Bt}function en(t){xn().$$.on_mount.push(t)}function Vn(t){xn().$$.on_destroy.push(t)}function Mr(){const t=xn();return(e,n,{cancelable:i=!1}={})=>{const r=t.$$.callbacks[e];if(r){const s=Lr(e,n,{cancelable:i});return r.slice().forEach(o=>{o.call(t,s)}),!s.defaultPrevented}return!0}}const Ct=[],ut=[];let At=[];const hi=[],lr=Promise.resolve();let Mn=!1;function ar(){Mn||(Mn=!0,lr.then(Ne))}function Fr(){return ar(),lr}function lt(t){At.push(t)}const An=new Set;let kt=0;function Ne(){if(kt!==0)return;const t=Bt;do{try{for(;kt<Ct.length;){const e=Ct[kt];kt++,Pt(e),Dr(e.$$)}}catch(e){throw Ct.length=0,kt=0,e}for(Pt(null),Ct.length=0,kt=0;ut.length;)ut.pop()();for(let e=0;e<At.length;e+=1){const n=At[e];An.has(n)||(An.add(n),n())}At.length=0}while(Ct.length);for(;hi.length;)hi.pop()();Mn=!1,An.clear(),Pt(t)}function Dr(t){if(t.fragment!==null){t.update(),st(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(lt)}}function Nr(t){const e=[],n=[];At.forEach(i=>t.indexOf(i)===-1?e.push(i):n.push(i)),n.forEach(i=>i()),At=e}const dn=new Set;let ht;function tn(){ht={r:0,c:[],p:ht}}function nn(){ht.r||st(ht.c),ht=ht.p}function ae(t,e){t&&t.i&&(dn.delete(t),t.i(e))}function he(t,e,n,i){if(t&&t.o){if(dn.has(t))return;dn.add(t),ht.c.push(()=>{dn.delete(t),i&&(n&&t.d(1),i())}),t.o(e)}else i&&i()}function Pe(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Pr(t,e){t.d(1),e.delete(t.key)}function Br(t,e){he(t,1,1,()=>{e.delete(t.key)})}function ur(t,e,n,i,r,s,o,l,a,h,f,p){let y=t.length,g=s.length,d=y;const k={};for(;d--;)k[t[d].key]=d;const L=[],R=new Map,j=new Map,U=[];for(d=g;d--;){const w=p(r,s,d),u=n(w);let c=o.get(u);c?U.push(()=>c.p(w,e)):(c=h(u,w),c.c()),R.set(u,L[d]=c),u in k&&j.set(u,Math.abs(d-k[u]))}const J=new Set,Z=new Set;function B(w){ae(w,1),w.m(l,f),o.set(w.key,w),f=w.first,g--}for(;y&&g;){const w=L[g-1],u=t[y-1],c=w.key,v=u.key;w===u?(f=w.first,y--,g--):R.has(v)?!o.has(c)||J.has(c)?B(w):Z.has(v)?y--:j.get(c)>j.get(v)?(Z.add(c),B(w)):(J.add(v),y--):(a(u,o),y--)}for(;y--;){const w=t[y];R.has(w.key)||a(w,o)}for(;g;)B(L[g-1]);return st(U),L}function Je(t){t&&t.c()}function qe(t,e,n){const{fragment:i,after_update:r}=t.$$;i&&i.m(e,n),lt(()=>{const s=t.$$.on_mount.map(rr).filter(sr);t.$$.on_destroy?t.$$.on_destroy.push(...s):st(s),t.$$.on_mount=[]}),r.forEach(lt)}function Ke(t,e){const n=t.$$;n.fragment!==null&&(Nr(n.after_update),st(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Ur(t,e){t.$$.dirty[0]===-1&&(Ct.push(t),ar(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Ye(t,e,n,i,r,s,o=null,l=[-1]){const a=Bt;Pt(t);const h=t.$$={fragment:null,ctx:[],props:s,update:we,not_equal:r,bound:ci(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:ci(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(h.root);let f=!1;if(h.ctx=n?n(t,e.props||{},(p,y,...g)=>{const d=g.length?g[0]:y;return h.ctx&&r(h.ctx[p],h.ctx[p]=d)&&(!h.skip_bound&&h.bound[p]&&h.bound[p](d),f&&Ur(t,p)),y}):[],h.update(),f=!0,st(h.before_update),h.fragment=i?i(h.ctx):!1,e.target){if(e.hydrate){const p=Or(e.target);h.fragment&&h.fragment.l(p),p.forEach(q)}else h.fragment&&h.fragment.c();e.intro&&ae(t.$$.fragment),qe(t,e.target,e.anchor),Ne()}Pt(a)}class Ze{constructor(){se(this,"$$");se(this,"$$set")}$destroy(){Ke(this,1),this.$destroy=we}$on(e,n){if(!sr(n))return we;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(e){this.$$set&&!Tr(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const jr="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(jr);const Et=[];function Fn(t,e=we){let n;const i=new Set;function r(l){if(je(t,l)&&(t=l,n)){const a=!Et.length;for(const h of i)h[1](),Et.push(h,t);if(a){for(let h=0;h<Et.length;h+=2)Et[h][0](Et[h+1]);Et.length=0}}}function s(l){r(l(t))}function o(l,a=we){const h=[l,a];return i.add(h),i.size===1&&(n=e(r,s)||we),l(t),()=>{i.delete(h),i.size===0&&n&&(n(),n=null)}}return{set:r,update:s,subscribe:o}}var xr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var cr={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){(function(n,i){t.exports=i()})(xr,function n(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},r=!i.document&&!!i.postMessage,s=i.IS_PAPA_WORKER||!1,o={},l=0,a={parse:function(u,c){var v=(c=c||{}).dynamicTyping||!1;if(w(v)&&(c.dynamicTypingFunction=v,v={}),c.dynamicTyping=v,c.transform=!!w(c.transform)&&c.transform,c.worker&&a.WORKERS_SUPPORTED){var C=function(){if(!a.WORKERS_SUPPORTED)return!1;var M=(O=i.URL||i.webkitURL||null,D=n.toString(),a.BLOB_URL||(a.BLOB_URL=O.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",D,")();"],{type:"text/javascript"})))),N=new i.Worker(M),O,D;return N.onmessage=j,N.id=l++,o[N.id]=N}();return C.userStep=c.step,C.userChunk=c.chunk,C.userComplete=c.complete,C.userError=c.error,c.step=w(c.step),c.chunk=w(c.chunk),c.complete=w(c.complete),c.error=w(c.error),delete c.worker,void C.postMessage({input:u,config:c,workerId:C.id})}var S=null;return a.NODE_STREAM_INPUT,typeof u=="string"?(u=function(M){return M.charCodeAt(0)===65279?M.slice(1):M}(u),S=c.download?new p(c):new g(c)):u.readable===!0&&w(u.read)&&w(u.on)?S=new d(c):(i.File&&u instanceof File||u instanceof Object)&&(S=new y(c)),S.stream(u)},unparse:function(u,c){var v=!1,C=!0,S=",",M=`\r
`,N='"',O=N+N,D=!1,m=null,A=!1;(function(){if(typeof c=="object"){if(typeof c.delimiter!="string"||a.BAD_DELIMITERS.filter(function(F){return c.delimiter.indexOf(F)!==-1}).length||(S=c.delimiter),(typeof c.quotes=="boolean"||typeof c.quotes=="function"||Array.isArray(c.quotes))&&(v=c.quotes),typeof c.skipEmptyLines!="boolean"&&typeof c.skipEmptyLines!="string"||(D=c.skipEmptyLines),typeof c.newline=="string"&&(M=c.newline),typeof c.quoteChar=="string"&&(N=c.quoteChar),typeof c.header=="boolean"&&(C=c.header),Array.isArray(c.columns)){if(c.columns.length===0)throw new Error("Option columns is empty");m=c.columns}c.escapeChar!==void 0&&(O=c.escapeChar+N),(typeof c.escapeFormulae=="boolean"||c.escapeFormulae instanceof RegExp)&&(A=c.escapeFormulae instanceof RegExp?c.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var T=new RegExp(L(N),"g");if(typeof u=="string"&&(u=JSON.parse(u)),Array.isArray(u)){if(!u.length||Array.isArray(u[0]))return V(null,u,D);if(typeof u[0]=="object")return V(m||Object.keys(u[0]),u,D)}else if(typeof u=="object")return typeof u.data=="string"&&(u.data=JSON.parse(u.data)),Array.isArray(u.data)&&(u.fields||(u.fields=u.meta&&u.meta.fields||m),u.fields||(u.fields=Array.isArray(u.data[0])?u.fields:typeof u.data[0]=="object"?Object.keys(u.data[0]):[]),Array.isArray(u.data[0])||typeof u.data[0]=="object"||(u.data=[u.data])),V(u.fields||[],u.data||[],D);throw new Error("Unable to serialize unrecognized input");function V(F,ee,I){var x="";typeof F=="string"&&(F=JSON.parse(F)),typeof ee=="string"&&(ee=JSON.parse(ee));var te=Array.isArray(F)&&0<F.length,ne=!Array.isArray(ee[0]);if(te&&C){for(var ie=0;ie<F.length;ie++)0<ie&&(x+=S),x+=ce(F[ie],ie);0<ee.length&&(x+=M)}for(var P=0;P<ee.length;P++){var W=te?F.length:ee[P].length,Q=!1,ve=te?Object.keys(ee[P]).length===0:ee[P].length===0;if(I&&!te&&(Q=I==="greedy"?ee[P].join("").trim()==="":ee[P].length===1&&ee[P][0].length===0),I==="greedy"&&te){for(var ue=[],be=0;be<W;be++){var $=ne?F[be]:be;ue.push(ee[P][$])}Q=ue.join("").trim()===""}if(!Q){for(var re=0;re<W;re++){0<re&&!ve&&(x+=S);var Ae=te&&ne?F[re]:re;x+=ce(ee[P][Ae],re)}P<ee.length-1&&(!I||0<W&&!ve)&&(x+=M)}}return x}function ce(F,ee){if(F==null)return"";if(F.constructor===Date)return JSON.stringify(F).slice(1,25);var I=!1;A&&typeof F=="string"&&A.test(F)&&(F="'"+F,I=!0);var x=F.toString().replace(T,O);return(I=I||v===!0||typeof v=="function"&&v(F,ee)||Array.isArray(v)&&v[ee]||function(te,ne){for(var ie=0;ie<ne.length;ie++)if(-1<te.indexOf(ne[ie]))return!0;return!1}(x,a.BAD_DELIMITERS)||-1<x.indexOf(S)||x.charAt(0)===" "||x.charAt(x.length-1)===" ")?N+x+N:x}}};if(a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!r&&!!i.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=R,a.ParserHandle=k,a.NetworkStreamer=p,a.FileStreamer=y,a.StringStreamer=g,a.ReadableStreamStreamer=d,i.jQuery){var h=i.jQuery;h.fn.parse=function(u){var c=u.config||{},v=[];return this.each(function(M){if(!(h(this).prop("tagName").toUpperCase()==="INPUT"&&h(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var N=0;N<this.files.length;N++)v.push({file:this.files[N],inputElem:this,instanceConfig:h.extend({},c)})}),C(),this;function C(){if(v.length!==0){var M,N,O,D,m=v[0];if(w(u.before)){var A=u.before(m.file,m.inputElem);if(typeof A=="object"){if(A.action==="abort")return M="AbortError",N=m.file,O=m.inputElem,D=A.reason,void(w(u.error)&&u.error({name:M},N,O,D));if(A.action==="skip")return void S();typeof A.config=="object"&&(m.instanceConfig=h.extend(m.instanceConfig,A.config))}else if(A==="skip")return void S()}var T=m.instanceConfig.complete;m.instanceConfig.complete=function(V){w(T)&&T(V,m.file,m.inputElem),S()},a.parse(m.file,m.instanceConfig)}else w(u.complete)&&u.complete()}function S(){v.splice(0,1),C()}}}function f(u){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(c){var v=Z(c);v.chunkSize=parseInt(v.chunkSize),c.step||c.chunk||(v.chunkSize=null),this._handle=new k(v),(this._handle.streamer=this)._config=v}).call(this,u),this.parseChunk=function(c,v){if(this.isFirstChunk&&w(this._config.beforeFirstChunk)){var C=this._config.beforeFirstChunk(c);C!==void 0&&(c=C)}this.isFirstChunk=!1,this._halted=!1;var S=this._partialLine+c;this._partialLine="";var M=this._handle.parse(S,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var N=M.meta.cursor;this._finished||(this._partialLine=S.substring(N-this._baseIndex),this._baseIndex=N),M&&M.data&&(this._rowCount+=M.data.length);var O=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)i.postMessage({results:M,workerId:a.WORKER_ID,finished:O});else if(w(this._config.chunk)&&!v){if(this._config.chunk(M,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);M=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(M.data),this._completeResults.errors=this._completeResults.errors.concat(M.errors),this._completeResults.meta=M.meta),this._completed||!O||!w(this._config.complete)||M&&M.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),O||M&&M.meta.paused||this._nextChunk(),M}this._halted=!0},this._sendError=function(c){w(this._config.error)?this._config.error(c):s&&this._config.error&&i.postMessage({workerId:a.WORKER_ID,error:c,finished:!1})}}function p(u){var c;(u=u||{}).chunkSize||(u.chunkSize=a.RemoteChunkSize),f.call(this,u),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(v){this._input=v,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(c=new XMLHttpRequest,this._config.withCredentials&&(c.withCredentials=this._config.withCredentials),r||(c.onload=B(this._chunkLoaded,this),c.onerror=B(this._chunkError,this)),c.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var v=this._config.downloadRequestHeaders;for(var C in v)c.setRequestHeader(C,v[C])}if(this._config.chunkSize){var S=this._start+this._config.chunkSize-1;c.setRequestHeader("Range","bytes="+this._start+"-"+S)}try{c.send(this._config.downloadRequestBody)}catch(M){this._chunkError(M.message)}r&&c.status===0&&this._chunkError()}},this._chunkLoaded=function(){c.readyState===4&&(c.status<200||400<=c.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:c.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(v){var C=v.getResponseHeader("Content-Range");return C===null?-1:parseInt(C.substring(C.lastIndexOf("/")+1))}(c),this.parseChunk(c.responseText)))},this._chunkError=function(v){var C=c.statusText||v;this._sendError(new Error(C))}}function y(u){var c,v;(u=u||{}).chunkSize||(u.chunkSize=a.LocalChunkSize),f.call(this,u);var C=typeof FileReader<"u";this.stream=function(S){this._input=S,v=S.slice||S.webkitSlice||S.mozSlice,C?((c=new FileReader).onload=B(this._chunkLoaded,this),c.onerror=B(this._chunkError,this)):c=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var S=this._input;if(this._config.chunkSize){var M=Math.min(this._start+this._config.chunkSize,this._input.size);S=v.call(S,this._start,M)}var N=c.readAsText(S,this._config.encoding);C||this._chunkLoaded({target:{result:N}})},this._chunkLoaded=function(S){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(S.target.result)},this._chunkError=function(){this._sendError(c.error)}}function g(u){var c;f.call(this,u=u||{}),this.stream=function(v){return c=v,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var v,C=this._config.chunkSize;return C?(v=c.substring(0,C),c=c.substring(C)):(v=c,c=""),this._finished=!c,this.parseChunk(v)}}}function d(u){f.call(this,u=u||{});var c=[],v=!0,C=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(S){this._input=S,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){C&&c.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),c.length?this.parseChunk(c.shift()):v=!0},this._streamData=B(function(S){try{c.push(typeof S=="string"?S:S.toString(this._config.encoding)),v&&(v=!1,this._checkIsFinished(),this.parseChunk(c.shift()))}catch(M){this._streamError(M)}},this),this._streamError=B(function(S){this._streamCleanUp(),this._sendError(S)},this),this._streamEnd=B(function(){this._streamCleanUp(),C=!0,this._streamData("")},this),this._streamCleanUp=B(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function k(u){var c,v,C,S=Math.pow(2,53),M=-S,N=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,O=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,D=this,m=0,A=0,T=!1,V=!1,ce=[],F={data:[],errors:[],meta:{}};if(w(u.step)){var ee=u.step;u.step=function(P){if(F=P,te())x();else{if(x(),F.data.length===0)return;m+=P.data.length,u.preview&&m>u.preview?v.abort():(F.data=F.data[0],ee(F,D))}}}function I(P){return u.skipEmptyLines==="greedy"?P.join("").trim()==="":P.length===1&&P[0].length===0}function x(){return F&&C&&(ie("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),C=!1),u.skipEmptyLines&&(F.data=F.data.filter(function(P){return!I(P)})),te()&&function(){if(!F)return;function P(Q,ve){w(u.transformHeader)&&(Q=u.transformHeader(Q,ve)),ce.push(Q)}if(Array.isArray(F.data[0])){for(var W=0;te()&&W<F.data.length;W++)F.data[W].forEach(P);F.data.splice(0,1)}else F.data.forEach(P)}(),function(){if(!F||!u.header&&!u.dynamicTyping&&!u.transform)return F;function P(Q,ve){var ue,be=u.header?{}:[];for(ue=0;ue<Q.length;ue++){var $=ue,re=Q[ue];u.header&&($=ue>=ce.length?"__parsed_extra":ce[ue]),u.transform&&(re=u.transform(re,$)),re=ne($,re),$==="__parsed_extra"?(be[$]=be[$]||[],be[$].push(re)):be[$]=re}return u.header&&(ue>ce.length?ie("FieldMismatch","TooManyFields","Too many fields: expected "+ce.length+" fields but parsed "+ue,A+ve):ue<ce.length&&ie("FieldMismatch","TooFewFields","Too few fields: expected "+ce.length+" fields but parsed "+ue,A+ve)),be}var W=1;return!F.data.length||Array.isArray(F.data[0])?(F.data=F.data.map(P),W=F.data.length):F.data=P(F.data,0),u.header&&F.meta&&(F.meta.fields=ce),A+=W,F}()}function te(){return u.header&&ce.length===0}function ne(P,W){return Q=P,u.dynamicTypingFunction&&u.dynamicTyping[Q]===void 0&&(u.dynamicTyping[Q]=u.dynamicTypingFunction(Q)),(u.dynamicTyping[Q]||u.dynamicTyping)===!0?W==="true"||W==="TRUE"||W!=="false"&&W!=="FALSE"&&(function(ve){if(N.test(ve)){var ue=parseFloat(ve);if(M<ue&&ue<S)return!0}return!1}(W)?parseFloat(W):O.test(W)?new Date(W):W===""?null:W):W;var Q}function ie(P,W,Q,ve){var ue={type:P,code:W,message:Q};ve!==void 0&&(ue.row=ve),F.errors.push(ue)}this.parse=function(P,W,Q){var ve=u.quoteChar||'"';if(u.newline||(u.newline=function($,re){$=$.substring(0,1048576);var Ae=new RegExp(L(re)+"([^]*?)"+L(re),"gm"),Se=($=$.replace(Ae,"")).split("\r"),xe=$.split(`
`),ke=1<xe.length&&xe[0].length<Se[0].length;if(Se.length===1||ke)return`
`;for(var Oe=0,fe=0;fe<Se.length;fe++)Se[fe][0]===`
`&&Oe++;return Oe>=Se.length/2?`\r
`:"\r"}(P,ve)),C=!1,u.delimiter)w(u.delimiter)&&(u.delimiter=u.delimiter(P),F.meta.delimiter=u.delimiter);else{var ue=function($,re,Ae,Se,xe){var ke,Oe,fe,de;xe=xe||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var ze=0;ze<xe.length;ze++){var oe=xe[ze],nt=0,Ve=0,et=0;fe=void 0;for(var Ge=new R({comments:Se,delimiter:oe,newline:re,preview:10}).parse($),Qe=0;Qe<Ge.data.length;Qe++)if(Ae&&I(Ge.data[Qe]))et++;else{var Le=Ge.data[Qe].length;Ve+=Le,fe!==void 0?0<Le&&(nt+=Math.abs(Le-fe),fe=Le):fe=Le}0<Ge.data.length&&(Ve/=Ge.data.length-et),(Oe===void 0||nt<=Oe)&&(de===void 0||de<Ve)&&1.99<Ve&&(Oe=nt,ke=oe,de=Ve)}return{successful:!!(u.delimiter=ke),bestDelimiter:ke}}(P,u.newline,u.skipEmptyLines,u.comments,u.delimitersToGuess);ue.successful?u.delimiter=ue.bestDelimiter:(C=!0,u.delimiter=a.DefaultDelimiter),F.meta.delimiter=u.delimiter}var be=Z(u);return u.preview&&u.header&&be.preview++,c=P,v=new R(be),F=v.parse(c,W,Q),x(),T?{meta:{paused:!0}}:F||{meta:{paused:!1}}},this.paused=function(){return T},this.pause=function(){T=!0,v.abort(),c=w(u.chunk)?"":c.substring(v.getCharIndex())},this.resume=function(){D.streamer._halted?(T=!1,D.streamer.parseChunk(c,!0)):setTimeout(D.resume,3)},this.aborted=function(){return V},this.abort=function(){V=!0,v.abort(),F.meta.aborted=!0,w(u.complete)&&u.complete(F),c=""}}function L(u){return u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function R(u){var c,v=(u=u||{}).delimiter,C=u.newline,S=u.comments,M=u.step,N=u.preview,O=u.fastMode,D=c=u.quoteChar===void 0||u.quoteChar===null?'"':u.quoteChar;if(u.escapeChar!==void 0&&(D=u.escapeChar),(typeof v!="string"||-1<a.BAD_DELIMITERS.indexOf(v))&&(v=","),S===v)throw new Error("Comment character same as delimiter");S===!0?S="#":(typeof S!="string"||-1<a.BAD_DELIMITERS.indexOf(S))&&(S=!1),C!==`
`&&C!=="\r"&&C!==`\r
`&&(C=`
`);var m=0,A=!1;this.parse=function(T,V,ce){if(typeof T!="string")throw new Error("Input must be a string");var F=T.length,ee=v.length,I=C.length,x=S.length,te=w(M),ne=[],ie=[],P=[],W=m=0;if(!T)return me();if(u.header&&!V){var Q=T.split(C)[0].split(v),ve=[],ue={},be=!1;for(var $ in Q){var re=Q[$];w(u.transformHeader)&&(re=u.transformHeader(re,$));var Ae=re,Se=ue[re]||0;for(0<Se&&(be=!0,Ae=re+"_"+Se),ue[re]=Se+1;ve.includes(Ae);)Ae=Ae+"_"+Se;ve.push(Ae)}if(be){var xe=T.split(C);xe[0]=ve.join(v),T=xe.join(C)}}if(O||O!==!1&&T.indexOf(c)===-1){for(var ke=T.split(C),Oe=0;Oe<ke.length;Oe++){if(P=ke[Oe],m+=P.length,Oe!==ke.length-1)m+=C.length;else if(ce)return me();if(!S||P.substring(0,x)!==S){if(te){if(ne=[],et(P.split(v)),Xe(),A)return me()}else et(P.split(v));if(N&&N<=Oe)return ne=ne.slice(0,N),me(!0)}}return me()}for(var fe=T.indexOf(v,m),de=T.indexOf(C,m),ze=new RegExp(L(D)+L(c),"g"),oe=T.indexOf(c,m);;)if(T[m]!==c)if(S&&P.length===0&&T.substring(m,m+x)===S){if(de===-1)return me();m=de+I,de=T.indexOf(C,m),fe=T.indexOf(v,m)}else if(fe!==-1&&(fe<de||de===-1))P.push(T.substring(m,fe)),m=fe+ee,fe=T.indexOf(v,m);else{if(de===-1)break;if(P.push(T.substring(m,de)),Le(de+I),te&&(Xe(),A))return me();if(N&&ne.length>=N)return me(!0)}else for(oe=m,m++;;){if((oe=T.indexOf(c,oe+1))===-1)return ce||ie.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ne.length,index:m}),Qe();if(oe===F-1)return Qe(T.substring(m,oe).replace(ze,c));if(c!==D||T[oe+1]!==D){if(c===D||oe===0||T[oe-1]!==D){fe!==-1&&fe<oe+1&&(fe=T.indexOf(v,oe+1)),de!==-1&&de<oe+1&&(de=T.indexOf(C,oe+1));var nt=Ge(de===-1?fe:Math.min(fe,de));if(T.substr(oe+1+nt,ee)===v){P.push(T.substring(m,oe).replace(ze,c)),T[m=oe+1+nt+ee]!==c&&(oe=T.indexOf(c,m)),fe=T.indexOf(v,m),de=T.indexOf(C,m);break}var Ve=Ge(de);if(T.substring(oe+1+Ve,oe+1+Ve+I)===C){if(P.push(T.substring(m,oe).replace(ze,c)),Le(oe+1+Ve+I),fe=T.indexOf(v,m),oe=T.indexOf(c,m),te&&(Xe(),A))return me();if(N&&ne.length>=N)return me(!0);break}ie.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ne.length,index:m}),oe++}}else oe++}return Qe();function et(Me){ne.push(Me),W=m}function Ge(Me){var Ot=0;if(Me!==-1){var tt=T.substring(oe+1,Me);tt&&tt.trim()===""&&(Ot=tt.length)}return Ot}function Qe(Me){return ce||(Me===void 0&&(Me=T.substring(m)),P.push(Me),m=F,et(P),te&&Xe()),me()}function Le(Me){m=Me,et(P),P=[],de=T.indexOf(C,m)}function me(Me){return{data:ne,errors:ie,meta:{delimiter:v,linebreak:C,aborted:A,truncated:!!Me,cursor:W+(V||0)}}}function Xe(){M(me()),ne=[],ie=[]}},this.abort=function(){A=!0},this.getCharIndex=function(){return m}}function j(u){var c=u.data,v=o[c.workerId],C=!1;if(c.error)v.userError(c.error,c.file);else if(c.results&&c.results.data){var S={abort:function(){C=!0,U(c.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:J,resume:J};if(w(v.userStep)){for(var M=0;M<c.results.data.length&&(v.userStep({data:c.results.data[M],errors:c.results.errors,meta:c.results.meta},S),!C);M++);delete c.results}else w(v.userChunk)&&(v.userChunk(c.results,S,c.file),delete c.results)}c.finished&&!C&&U(c.workerId,c.results)}function U(u,c){var v=o[u];w(v.userComplete)&&v.userComplete(c),v.terminate(),delete o[u]}function J(){throw new Error("Not implemented.")}function Z(u){if(typeof u!="object"||u===null)return u;var c=Array.isArray(u)?[]:{};for(var v in u)c[v]=Z(u[v]);return c}function B(u,c){return function(){u.apply(c,arguments)}}function w(u){return typeof u=="function"}return s&&(i.onmessage=function(u){var c=u.data;if(a.WORKER_ID===void 0&&c&&(a.WORKER_ID=c.workerId),typeof c.input=="string")i.postMessage({workerId:a.WORKER_ID,results:a.parse(c.input,c.config),finished:!0});else if(i.File&&c.input instanceof File||c.input instanceof Object){var v=a.parse(c.input,c.config);v&&i.postMessage({workerId:a.WORKER_ID,results:v,finished:!0})}}),(p.prototype=Object.create(f.prototype)).constructor=p,(y.prototype=Object.create(f.prototype)).constructor=y,(g.prototype=Object.create(g.prototype)).constructor=g,(d.prototype=Object.create(f.prototype)).constructor=d,a})})(cr);var Wr=cr.exports;const Hr=Vr(Wr);function qr(t){const e=t.data;let n=0,i=1/0;for(let r=0;r<e.length;r++){const s=e[r];s>n&&(n=s),s<i&&(i=s)}return[i,n]}function fr(t){t.startsWith("#")&&(t=t.slice(1));const e=parseInt(t.slice(0,2),16),n=parseInt(t.slice(2,4),16),i=parseInt(t.slice(4,6),16);return[e,n,i]}const _n=4,at={cyan:"#00FFFF",yellow:"#FFFF00",magenta:"#FF00FF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",white:"#FFFFFF"},Kr=[at.magenta,at.green],Gr=[at.red,at.green,at.blue],di=Object.values(at).slice(0,-2);function Jr(t){return t<=_n?Array(t).fill(!0):[...Array(_n).fill(!0),...Array(t-_n).fill(!1)]}function Yr(t,e){let n=[];if(t==1)n=[at.white];else if(t==2)n=Kr;else if(t==3)n=Gr;else if(t<=_n)n=di.slice(0,t);else{n=Array(t).fill(at.white);const i=e.flatMap((r,s)=>r?s:[]);for(const[r,s]of i.entries())n[s]=di[r]}return n.map(fr)}function Zr(t,e,n){const i=t[0].shape,r=i[0],s=i[1],o=r*s,l=new Uint8ClampedArray(4*o).fill(0);let a=0;for(let h=0;h<o;h++){for(let f=0;f<t.length;f++){const p=n[f],y=t[f].data,g=e[f],k=(y[h]-g[0])/(g[1]-g[0]);for(let L=0;L<3;L++){const R=k*p[L]<<0;l[a*4+L]=Math.max(l[a*4+L],R)}}l[a*4+3]=255,a++}return l}function hr(t,e,n={}){Hr.parse(t,{header:!1,download:!0,skipEmptyLines:"greedy",complete:i=>{let r=["url"],s=i.data[0];s.length>1&&(r=s,i.data.shift());const o=i.data.map(g=>{const d={...n};for(let k=0;k<r.length;k++)d[r[k]]=g[k];return d});let l=o.filter(g=>{var d;return!((d=g.url)!=null&&d.endsWith(".csv"))});const a=o.filter(g=>{var d;return(d=g.url)==null?void 0:d.endsWith(".csv")}),h={};l.forEach(g=>{h[g.url]||(h[g.url]=g)}),l=Object.values(h);const f=l.reduce((g,d)=>d.wells?g+1:g,0),p=l.reduce((g,d)=>g+parseInt(d.written||0),0);let y=l.length;f>0&&(y=l.reduce((g,d)=>g+parseInt(d.images||1),0)),e.addCsv(t,a,y,f,p),e.addRows(l),a.forEach(g=>{const d=g.url;g.csv=d,hr(d,e,g)})}})}async function Qr(t){return await fetch(t).then(e=>e.json())}function mn(t){if(!t)return"";const e=2;return t<1024?`${t} B`:t<1024**2?`${(t/1024).toFixed(e)} KB`:t<1024**3?`${(t/1024**2).toFixed(e)} MB`:t<1024**4?`${(t/1024**3).toFixed(e)} GB`:t<1024**5?`${(t/1024**4).toFixed(e)} TB`:`${(t/1024**5).toFixed(e)} PB`}class dr{constructor(){this.store=Fn({})}async lookupOntologyTerm(e){let n="",i="";e.includes("NCBITaxon")|e.includes("NCBI:txid")&&(n=e.replace("NCBI:txid",""),n=n.replace("obo:NCBITaxon_",""),i="NCBITaxon"),e.includes("FBbi")&&(n=e.replace("obo:FBbi_",""),n=n.replace("obo:FBbi:",""),n=n.replace("FBbi:",""),i="FBbi"),e.includes("NCIT_")&&(n=e.replace("NCIT_",""),i="NCIT"),e.includes("obo:MI_")&&(n=e.replace("obo:MI_",""),i="MI"),e.includes("obo:OBI_")&&(n=e.replace("obo:OBI_",""),i="OBI");let r=i+"_"+n,o=`https://www.ebi.ac.uk/ols4/api/ontologies/${i.toLowerCase()}/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252F${r}`;return(await Qr(o)).label||e}addTerms(e){let n=hn(this.store);[...new Set(e)].forEach(r=>{r&&(n[r]||(n[r]="Loading...",setTimeout(()=>{this.lookupOntologyTerm(r).then(s=>{this.addEntry(r,s)})},Math.random()*5e3)))})}addEntry(e,n){this.store.update(i=>(i[e]=n,i))}subscribe(e){return this.store.subscribe(e)}}const _r=new dr,gr=new dr;class rn extends Error{constructor(e,n={}){super(`Node not found: ${e}`,n),this.name="NodeNotFoundError"}}class Wn extends Error{constructor(e){super(`Missing key: ${e}`),this.name="KeyError"}}var He;class mr{constructor(e,n,i){Ee(this,He);typeof e=="number"?ye(this,He,new Uint8Array(e)):e instanceof ArrayBuffer?ye(this,He,new Uint8Array(e,n,i)):ye(this,He,new Uint8Array(Array.from(e,r=>r?1:0)))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return K(this,He).byteOffset}get byteLength(){return K(this,He).byteLength}get buffer(){return K(this,He).buffer}get length(){return K(this,He).length}get(e){let n=K(this,He)[e];return typeof n=="number"?n!==0:n}set(e,n){K(this,He)[e]=n?1:0}fill(e){K(this,He).fill(e?1:0)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}He=new WeakMap;var St;class Hn{constructor(e,n,i,r){se(this,"_data");se(this,"chars");Ee(this,St);if(this.chars=e,ye(this,St,new TextEncoder),typeof n=="number")this._data=new Uint8Array(n*e);else if(n instanceof ArrayBuffer)r&&(r=r*e),this._data=new Uint8Array(n,i,r);else{let s=Array.from(n);this._data=new Uint8Array(s.length*e);for(let o=0;o<s.length;o++)this.set(o,s[o])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(e){const n=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);return new TextDecoder().decode(n).replace(/\x00/g,"")}set(e,n){const i=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);i.fill(0),i.set(K(this,St).encode(n))}fill(e){const n=K(this,St).encode(e);for(let i=0;i<this.length;i++)this._data.set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}St=new WeakMap;var Te;const Zn=class Zn{constructor(e,n,i,r){Ee(this,Te);se(this,"chars");if(this.chars=e,typeof n=="number")ye(this,Te,new Int32Array(n*e));else if(n instanceof ArrayBuffer)r&&(r*=e),ye(this,Te,new Int32Array(n,i,r));else{const s=n,o=new Zn(e,1);ye(this,Te,new Int32Array(function*(){for(let l of s)o.set(0,l),yield*K(o,Te)}()))}}get BYTES_PER_ELEMENT(){return K(this,Te).BYTES_PER_ELEMENT*this.chars}get byteLength(){return K(this,Te).byteLength}get byteOffset(){return K(this,Te).byteOffset}get buffer(){return K(this,Te).buffer}get length(){return K(this,Te).length/this.chars}get(e){const n=this.chars*e;let i="";for(let r=0;r<this.chars;r++)i+=String.fromCodePoint(K(this,Te)[n+r]);return i.replace(/\u0000/g,"")}set(e,n){const i=this.chars*e,r=K(this,Te).subarray(i,i+this.chars);r.fill(0);for(let s=0;s<this.chars;s++)r[s]=n.codePointAt(s)??0}fill(e){this.set(0,e);let n=K(this,Te).subarray(0,this.chars);for(let i=1;i<this.length;i++)K(this,Te).set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}};Te=new WeakMap;let Ut=Zn;const Xr="modulepreload",$r=function(t){return"/zowser/"+t},_i={},Ft=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(n.map(a=>{if(a=$r(a),a in _i)return;_i[a]=!0;const h=a.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${f}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":Xr,h||(p.as="script"),p.crossOrigin="",p.href=a,l&&p.setAttribute("nonce",l),document.head.appendChild(p),h)return new Promise((y,g)=>{p.addEventListener("load",y),p.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${a}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};function sn(t){const e=new TextDecoder().decode(t);return JSON.parse(e)}function gi(t,e){const n=e/2,i=e-1;let r=0;for(let s=0;s<t.length;s+=e)for(let o=0;o<n;o+=1)r=t[s+o],t[s+o]=t[s+i-o],t[s+i-o]=r}function pr(t){if(t==="v2:object")return globalThis.Array;let e=t.match(/v2:([US])(\d+)/);if(e){let[,i,r]=e;return(i==="U"?Ut:Hn).bind(null,Number(r))}let n={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float16:globalThis.Float16Array,float32:Float32Array,float64:Float64Array,bool:mr}[t];return Ce(n,`Unknown or unsupported data_type: ${t}`),n}function gt(t,e){const n=t.length;typeof e=="string"&&(e=e==="C"?Array.from({length:n},(s,o)=>o):Array.from({length:n},(s,o)=>n-1-o)),Ce(n===e.length,"Order length must match the number of dimensions.");let i=1,r=new Array(n);for(let s=e.length-1;s>=0;s--)r[e[s]]=i,i*=t[e[s]];return r}function es({name:t,configuration:e}){if(t==="default"){const n=(e==null?void 0:e.separator)??"/";return i=>["c",...i].join(n)}if(t==="v2"){const n=(e==null?void 0:e.separator)??".";return i=>i.join(n)||"0"}throw new Error(`Unknown chunk key encoding: ${t}`)}function ts(t){if(t==="|O")return{data_type:"v2:object"};let e=t.match(/^([<|>])(.*)$/);Ce(e,`Invalid dtype: ${t}`);let[,n,i]=e,r={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f2:"float16",f4:"float32",f8:"float64"}[i]??(i.startsWith("S")||i.startsWith("U")?`v2:${i}`:void 0);return Ce(r,`Unsupported or unknown dtype: ${t}`),n==="|"?{data_type:r}:{data_type:r,endian:n==="<"?"little":"big"}}function ns(t,e={}){let n=[],i=ts(t.dtype);t.order==="F"&&n.push({name:"transpose",configuration:{order:"F"}}),"endian"in i&&i.endian==="big"&&n.push({name:"bytes",configuration:{endian:"big"}});for(let{id:r,...s}of t.filters??[])n.push({name:r,configuration:s});if(t.compressor){let{id:r,...s}=t.compressor;n.push({name:r,configuration:s})}return{zarr_format:3,node_type:"array",shape:t.shape,data_type:i.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:t.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:t.dimension_separator??"."}},codecs:n,fill_value:t.fill_value,attributes:e}}function is(t,e={}){return{zarr_format:3,node_type:"group",attributes:e}}function rs(t,e){if(e!=="number"&&e!=="bigint"&&e!=="boolean"&&e!=="object"&&e!=="string")return t===e;let n=t==="bool";if(e==="boolean")return n;let i=t.startsWith("v2:U")||t.startsWith("v2:S");if(e==="string")return i;let r=t==="int64"||t==="uint64";if(e==="bigint")return r;let s=t==="v2:object";return e==="object"?s:!i&&!r&&!n&&!s}function ss(t){return(t==null?void 0:t.name)==="sharding_indexed"}function br(t){return(t.data_type==="uint64"||t.data_type==="int64")&&t.fill_value!=null?BigInt(t.fill_value):t.fill_value}function yr(t,...e){if(!e.some(n=>t instanceof n))throw t}function Ce(t,e=""){if(!t)throw new Error(e)}class qn{constructor(e,n){se(this,"kind","array_to_array");Ce(e.keepbits>=0,"keepbits must be zero or positive")}static fromConfig(e,n){return new qn(e,n)}encode(e){throw new Error("`BitroundCodec.encode` is not implemented. Please open an issue at https://github.com/manzt/zarrita.js/issues.")}decode(e){return e}}const mi=os();function os(){const t=new Uint32Array([305419896]);return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)[0]!==18}function pi(t){return"BYTES_PER_ELEMENT"in t?t.BYTES_PER_ELEMENT:4}var xt,ot,Vt,Wt,zt;const Qn=class Qn{constructor(e,n){se(this,"kind","array_to_bytes");Ee(this,xt);Ee(this,ot);Ee(this,Vt);Ee(this,Wt);Ee(this,zt);ye(this,zt,e==null?void 0:e.endian),ye(this,ot,pr(n.data_type)),ye(this,Wt,n.shape),ye(this,xt,gt(n.shape,"C"));const i=new(K(this,ot))(0);ye(this,Vt,i.BYTES_PER_ELEMENT)}static fromConfig(e,n){return new Qn(e,n)}encode(e){let n=new Uint8Array(e.data.buffer);return mi&&K(this,zt)==="big"&&gi(n,pi(K(this,ot))),n}decode(e){return mi&&K(this,zt)==="big"&&gi(e,pi(K(this,ot))),{data:new(K(this,ot))(e.buffer,e.byteOffset,e.byteLength/K(this,Vt)),shape:K(this,Wt),stride:K(this,xt)}}};xt=new WeakMap,ot=new WeakMap,Vt=new WeakMap,Wt=new WeakMap,zt=new WeakMap;let pn=Qn;class Kn{constructor(){se(this,"kind","bytes_to_bytes")}static fromConfig(){return new Kn}encode(e){throw new Error("Not implemented")}decode(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength-4)}}function ls(t,e){return Ce(!Number.isNaN(e),"JsonCodec allow_nan is false but NaN was encountered during encoding."),Ce(e!==Number.POSITIVE_INFINITY,"JsonCodec allow_nan is false but Infinity was encountered during encoding."),Ce(e!==Number.NEGATIVE_INFINITY,"JsonCodec allow_nan is false but -Infinity was encountered during encoding."),e}function as(t,e){return e instanceof Object&&!Array.isArray(e)?Object.keys(e).sort().reduce((n,i)=>(n[i]=e[i],n),{}):e}var Ht,qt;const Xn=class Xn{constructor(e={}){se(this,"configuration");se(this,"kind","array_to_bytes");Ee(this,Ht);Ee(this,qt);this.configuration=e;const{encoding:n="utf-8",skipkeys:i=!1,ensure_ascii:r=!0,check_circular:s=!0,allow_nan:o=!0,sort_keys:l=!0,indent:a,strict:h=!0}=e;let f=e.separators;f||(a?f=[", ",": "]:f=[",",":"]),ye(this,Ht,{encoding:n,skipkeys:i,ensure_ascii:r,check_circular:s,allow_nan:o,indent:a,separators:f,sort_keys:l}),ye(this,qt,{strict:h})}static fromConfig(e){return new Xn(e)}encode(e){const{indent:n,encoding:i,ensure_ascii:r,check_circular:s,allow_nan:o,sort_keys:l}=K(this,Ht);Ce(i==="utf-8","JsonCodec does not yet support non-utf-8 encoding.");const a=[];Ce(s,"JsonCodec does not yet support skipping the check for circular references during encoding."),o||a.push(ls),l&&a.push(as);const h=Array.from(e.data);h.push("|O"),h.push(e.shape);let f;a.length&&(f=(y,g)=>{let d=g;for(let k of a)d=k(y,d);return d});let p=JSON.stringify(h,f,n);return r&&(p=p.replace(/[\u007F-\uFFFF]/g,y=>{const g=`0000${y.charCodeAt(0).toString(16)}`;return`\\u${g.substring(g.length-4)}`})),new TextEncoder().encode(p)}decode(e){const{strict:n}=K(this,qt);Ce(n,"JsonCodec does not yet support non-strict decoding.");const i=sn(e),r=i.pop();i.pop(),Ce(r,"0D not implemented for JsonCodec.");const s=gt(r,"C");return{data:i,shape:r,stride:s}}};Ht=new WeakMap,qt=new WeakMap;let Dn=Xn;function bi(t){return t instanceof mr||t instanceof Hn||t instanceof Ut?new Proxy(t,{get(n,i){return n.get(Number(i))},set(n,i,r){return n.set(Number(i),r),!0}}):t}function us(t,e){let n;return t.data instanceof Hn||t.data instanceof Ut?n=new t.constructor(t.data.length,t.data.chars):n=new t.constructor(t.data.length),{data:n,shape:t.shape,stride:gt(t.shape,e)}}function cs(t,e){let n=us(t,e),i=t.shape.length,r=t.data.length,s=Array(i).fill(0),o=bi(t.data),l=bi(n.data);for(let a=0;a<r;a++){let h=0;for(let f=0;f<i;f++)h+=s[f]*n.stride[f];l[h]=o[a],s[0]+=1;for(let f=0;f<i;f++)if(s[f]===t.shape[f]){if(f+1===i)break;s[f]=0,s[f+1]+=1}}return n}function fs(t){let e=t.shape.length;return Ce(e===t.stride.length,"Shape and stride must have the same length."),t.stride.map((n,i)=>({stride:n,index:i})).sort((n,i)=>i.stride-n.stride).map(n=>n.index)}function hs(t,e){let n=fs(t);return Ce(n.length===e.length,"Orders must match"),n.every((i,r)=>i===e[r])}var Kt,Tt;const $n=class $n{constructor(e,n){se(this,"kind","array_to_array");Ee(this,Kt);Ee(this,Tt);let i=e.order??"C",r=n.shape.length,s=new Array(r),o=new Array(r);if(i==="C")for(let l=0;l<r;++l)s[l]=l,o[l]=l;else if(i==="F")for(let l=0;l<r;++l)s[l]=r-l-1,o[l]=r-l-1;else s=i,s.forEach((l,a)=>{Ce(o[l]===void 0,`Invalid permutation: ${JSON.stringify(i)}`),o[l]=a});ye(this,Kt,s),ye(this,Tt,o)}static fromConfig(e,n){return new $n(e,n)}encode(e){return hs(e,K(this,Tt))?e:cs(e,K(this,Tt))}decode(e){return{data:e.data,shape:e.shape,stride:gt(e.shape,K(this,Kt))}}};Kt=new WeakMap,Tt=new WeakMap;let Nn=$n;var Gt,Jt;const ei=class ei{constructor(e){se(this,"kind","array_to_bytes");Ee(this,Gt);Ee(this,Jt);ye(this,Gt,e),ye(this,Jt,gt(e,"C"))}static fromConfig(e,n){return new ei(n.shape)}encode(e){throw new Error("Method not implemented.")}decode(e){let n=new TextDecoder,i=new DataView(e.buffer),r=Array(i.getUint32(0,!0)),s=4;for(let o=0;o<r.length;o++){let l=i.getUint32(s,!0);s+=4,r[o]=n.decode(e.buffer.slice(s,s+l)),s+=l}return{data:r,shape:K(this,Gt),stride:K(this,Jt)}}};Gt=new WeakMap,Jt=new WeakMap;let Pn=ei;function ds(){return new Map().set("blosc",()=>Ft(()=>import("./blosc-E49GQuAK.js"),__vite__mapDeps([0,1])).then(t=>t.default)).set("gzip",()=>Ft(()=>import("./gzip-CF-9a_hd.js"),__vite__mapDeps([2,3])).then(t=>t.default)).set("lz4",()=>Ft(()=>import("./lz4-BIGKWw27.js"),__vite__mapDeps([4,1])).then(t=>t.default)).set("zlib",()=>Ft(()=>import("./zlib-CBiqHlio.js"),__vite__mapDeps([5,3])).then(t=>t.default)).set("zstd",()=>Ft(()=>import("./zstd-IvP746pw.js"),__vite__mapDeps([6,1])).then(t=>t.default)).set("transpose",()=>Nn).set("bytes",()=>pn).set("crc32c",()=>Kn).set("vlen-utf8",()=>Pn).set("json2",()=>Dn).set("bitround",()=>qn)}const _s=ds();function Bn(t){let e;return{async encode(n){e||(e=await yi(t));for(const r of e.array_to_array)n=await r.encode(n);let i=await e.array_to_bytes.encode(n);for(const r of e.bytes_to_bytes)i=await r.encode(i);return i},async decode(n){e||(e=await yi(t));for(let r=e.bytes_to_bytes.length-1;r>=0;r--)n=await e.bytes_to_bytes[r].decode(n);let i=await e.array_to_bytes.decode(n);for(let r=e.array_to_array.length-1;r>=0;r--)i=await e.array_to_array[r].decode(i);return i}}}async function yi(t){let e=t.codecs.map(async s=>{var l;let o=await((l=_s.get(s.name))==null?void 0:l());return Ce(o,`Unknown codec: ${s.name}`),{Codec:o,meta:s}}),n=[],i,r=[];for await(let{Codec:s,meta:o}of e){let l=s.fromConfig(o.configuration,t);switch(l.kind){case"array_to_array":n.push(l);break;case"array_to_bytes":i=l;break;default:r.push(l)}}return i||(Ce(gs(t),`Cannot encode ${t.data_type} to bytes without a codec`),i=pn.fromConfig({endian:"little"},t)),{array_to_array:n,array_to_bytes:i,bytes_to_bytes:r}}function gs(t){return t.data_type!=="v2:object"}const vi=18446744073709551615n;function ms(t,e,n,i){Ce(t.store.getRange,"Store does not support range requests");let r=t.store.getRange.bind(t.store),s=e.map((a,h)=>a/i.chunk_shape[h]),o=Bn({data_type:"uint64",shape:[...s,2],codecs:i.index_codecs}),l={};return async a=>{let h=a.map((j,U)=>Math.floor(j/s[U])),f=t.resolve(n(h)).path,p;if(f in l)p=l[f];else{let j=4,U=16*s.reduce((Z,B)=>Z*B,1),J=await r(f,{suffixLength:U+j});p=l[f]=J?await o.decode(J):null}if(p===null)return;let{data:y,shape:g,stride:d}=p,k=a.map((j,U)=>j%g[U]).reduce((j,U,J)=>j+U*d[J],0),L=y[k],R=y[k+1];if(!(L===vi&&R===vi))return r(f,{offset:Number(L),length:Number(R)})}}class Rt{constructor(e,n="/"){se(this,"store");se(this,"path");this.store=e,this.path=n}resolve(e){let n=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new Rt(this.store,new URL(e,n).pathname)}}var Yt;class Gn extends Rt{constructor(n,i,r){super(n,i);se(this,"kind","group");Ee(this,Yt);ye(this,Yt,r)}get attrs(){return K(this,Yt).attributes}}Yt=new WeakMap;function wi(t){var n;const e=t.find(i=>i.name==="transpose");return((n=e==null?void 0:e.configuration)==null?void 0:n.order)??"C"}const Nt=Symbol("zarrita.context");function ps(t){return t[Nt]}function bs(t,e){let{configuration:n}=e.codecs.find(ss)??{},i={encode_chunk_key:es(e.chunk_key_encoding),TypedArray:pr(e.data_type),fill_value:e.fill_value};if(n){let s=wi(n.codecs);return{...i,kind:"sharded",chunk_shape:n.chunk_shape,codec:Bn({data_type:e.data_type,shape:n.chunk_shape,codecs:n.codecs}),get_strides(o){return gt(o,s)},get_chunk_bytes:ms(t,e.chunk_grid.configuration.chunk_shape,i.encode_chunk_key,n)}}let r=wi(e.codecs);return{...i,kind:"regular",chunk_shape:e.chunk_grid.configuration.chunk_shape,codec:Bn({data_type:e.data_type,shape:e.chunk_grid.configuration.chunk_shape,codecs:e.codecs}),get_strides(s){return gt(s,r)},async get_chunk_bytes(s,o){let l=i.encode_chunk_key(s),a=t.resolve(l).path;return t.store.get(a,o)}}}var tr,nr,_t,ir;let bn=(ir=class extends(nr=Rt,tr=Nt,nr){constructor(n,i,r){super(n,i);se(this,"kind","array");Ee(this,_t);se(this,tr);ye(this,_t,{...r,fill_value:br(r)}),this[Nt]=bs(this,r)}get attrs(){return K(this,_t).attributes}get shape(){return K(this,_t).shape}get chunks(){return this[Nt].chunk_shape}get dtype(){return K(this,_t).data_type}async getChunk(n,i){let r=this[Nt],s=await r.get_chunk_bytes(n,i);if(!s){let o=r.chunk_shape.reduce((a,h)=>a*h,1),l=new r.TypedArray(o);return l.fill(r.fill_value),{data:l,shape:r.chunk_shape,stride:r.get_strides(r.chunk_shape)}}return r.codec.decode(s)}is(n){return rs(this.dtype,n)}},_t=new WeakMap,ir),yn=ys();function ys(){let t=new WeakMap;function e(n){let i=t.get(n)??{v2:0,v3:0};return t.set(n,i),i}return{increment(n,i){e(n)[i]+=1},version_max(n){let i=e(n);return i.v3>i.v2?"v3":"v2"}}}async function vs(t){let e=await t.store.get(t.resolve(".zattrs").path);return e?sn(e):{}}async function ws(t,e={}){let n="store"in t?t:new Rt(t),i={};return(e.attrs??!0)&&(i=await vs(n)),e.kind==="array"?ki(n,i):e.kind==="group"?Ei(n,i):ki(n,i).catch(r=>(yr(r,rn),Ei(n,i)))}async function ki(t,e){let{path:n}=t.resolve(".zarray"),i=await t.store.get(n);if(!i)throw new rn("v2 array",{cause:new Wn(n)});return yn.increment(t.store,"v2"),new bn(t.store,t.path,ns(sn(i),e))}async function Ei(t,e){let{path:n}=t.resolve(".zgroup"),i=await t.store.get(n);if(!i)throw new rn("v2 group",{cause:new Wn(n)});return yn.increment(t.store,"v2"),new Gn(t.store,t.path,is(sn(i),e))}async function ks(t){let{store:e,path:n}=t.resolve("zarr.json"),i=await t.store.get(n);if(!i)throw new rn("v3 array or group",{cause:new Wn(n)});let r=sn(i);return r.node_type==="array"&&(r.fill_value=br(r)),r.node_type==="array"?new bn(e,t.path,r):new Gn(e,t.path,r)}async function Es(t,e={}){let n="store"in t?t:new Rt(t),i=await ks(n);if(yn.increment(n.store,"v3"),e.kind===void 0||e.kind==="array"&&i instanceof bn||e.kind==="group"&&i instanceof Gn)return i;let r=i instanceof bn?"array":"group";throw new Error(`Expected node of kind ${e.kind}, found ${r}.`)}async function dt(t,e={}){let n="store"in t?t.store:t,i=yn.version_max(n),r=i==="v2"?dt.v2:dt.v3,s=i==="v2"?dt.v3:dt.v2;return r(t,e).catch(o=>(yr(o,rn),s(t,e)))}dt.v2=ws;dt.v3=Es;function*Cs(t,e,n=1){e===void 0&&(e=t,t=0);for(let i=t;i<e;i+=n)yield i}function*Is(...t){if(t.length===0)return;const e=t.map(i=>i[Symbol.iterator]()),n=e.map(i=>i.next());if(n.some(i=>i.done))throw new Error("Input contains an empty iterator.");for(let i=0;;){if(n[i].done){if(e[i]=t[i][Symbol.iterator](),n[i]=e[i].next(),++i>=e.length)return}else yield n.map(({value:r})=>r),i=0;n[i]=e[i].next()}}function As({start:t,stop:e,step:n},i){if(n===0)throw new Error("slice step cannot be zero");n=n??1;const r=n<0,[s,o]=r?[-1,i-1]:[0,i];return t===null?t=r?o:s:t<0?(t+=i,t<s&&(t=s)):t>o&&(t=o),e===null?e=r?s:o:e<0?(e+=i,e<s&&(e=s)):e>o&&(e=o),[t,e,n]}function Ci(t,e,n=null){return e===void 0&&(e=t,t=null),{start:t,stop:e,step:n}}function Ss(){const t=[];return{add:e=>t.push(e()),onIdle:()=>Promise.all(t)}}class Jn extends Error{constructor(e){super(e),this.name="IndexError"}}function zs(t,e){throw new Jn(`too many indicies for array; expected ${e.length}, got ${t.length}`)}function Ts(t){throw new Jn(`index out of bounds for dimension with length ${t}`)}function Rs(){throw new Jn("only slices with step >= 1 are supported")}function Os(t,e){t.length>e.length&&zs(t,e)}function Ls(t,e){return t=Math.trunc(t),t<0&&(t=e+t),(t>=e||t<0)&&Ts(e),t}class Ms{constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){se(this,"dim_sel");se(this,"dim_len");se(this,"dim_chunk_len");se(this,"nitems");e=Ls(e,n),this.dim_sel=e,this.dim_len=n,this.dim_chunk_len=i,this.nitems=1}*[Symbol.iterator](){const e=Math.floor(this.dim_sel/this.dim_chunk_len),n=e*this.dim_chunk_len,i=this.dim_sel-n;yield{dim_chunk_ix:e,dim_chunk_sel:i}}}class Ii{constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){se(this,"start");se(this,"stop");se(this,"step");se(this,"dim_len");se(this,"dim_chunk_len");se(this,"nitems");se(this,"nchunks");const[r,s,o]=As(e,n);this.start=r,this.stop=s,this.step=o,this.step<1&&Rs(),this.dim_len=n,this.dim_chunk_len=i,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const e=Math.floor(this.start/this.dim_chunk_len),n=Math.ceil(this.stop/this.dim_chunk_len);for(const i of Cs(e,n)){const r=i*this.dim_chunk_len,s=Math.min(this.dim_len,(i+1)*this.dim_chunk_len),o=s-r;let l=0,a=0;if(this.start<r){const g=(r-this.start)%this.step;g&&(a+=this.step-g),l=Math.ceil((r-this.start)/this.step)}else a=this.start-r;const h=this.stop>s?o:this.stop-r,f=[a,h,this.step],p=Math.ceil((h-a)/this.step),y=[l,l+p,1];yield{dim_chunk_ix:i,dim_chunk_sel:f,dim_out_sel:y}}}}function Fs(t,e){let n=[];return t===null?n=e.map(i=>Ci(null)):Array.isArray(t)&&(n=t.map(i=>i??Ci(null))),Os(n,e),n}class Ds{constructor({selection:e,shape:n,chunk_shape:i}){se(this,"dim_indexers");se(this,"shape");this.dim_indexers=Fs(e,n).map((r,s)=>new(typeof r=="number"?Ms:Ii)({dim_sel:r,dim_len:n[s],dim_chunk_len:i[s]})),this.shape=this.dim_indexers.filter(r=>r instanceof Ii).map(r=>r.nitems)}*[Symbol.iterator](){for(const e of Is(...this.dim_indexers)){const n=e.map(r=>r.dim_chunk_ix),i=e.map(r=>"dim_out_sel"in r?{from:r.dim_chunk_sel,to:r.dim_out_sel}:{from:r.dim_chunk_sel,to:null});yield{chunk_coords:n,mapping:i}}}}function Ns(t,e){return"get"in t?t.get(e):t[e]}async function Ps(t,e,n,i){var a;let r=ps(t),s=new Ds({selection:e,shape:t.shape,chunk_shape:t.chunks}),o=i.prepare(new r.TypedArray(s.shape.reduce((h,f)=>h*f,1)),s.shape,r.get_strides(s.shape)),l=((a=n.create_queue)==null?void 0:a.call(n))??Ss();for(const{chunk_coords:h,mapping:f}of s)l.add(async()=>{let{data:p,shape:y,stride:g}=await t.getChunk(h,n.opts),d=i.prepare(p,y,g);i.set_from_chunk(o,d,f)});return await l.onIdle(),s.shape.length===0?Ns(o.data,0):o}function Yn(t,e=0,n){let i=n??t.length-e;return{length:i,subarray(r,s=i){return Yn(t,e+r,s-r)},set(r,s=0){for(let o=0;o<r.length;o++)t[e+s+o]=r.get(o)},get(r){return t[e+r]}}}function Sn(t){return globalThis.Array.isArray(t.data)?{data:Yn(t.data),stride:t.stride,bytes_per_element:1}:{data:new Uint8Array(t.data.buffer,t.data.byteOffset,t.data.byteLength),stride:t.stride,bytes_per_element:t.data.BYTES_PER_ELEMENT}}function Bs(t){return"chars"in t?t.constructor.bind(null,t.chars):t.constructor}function Us(t,e){if(globalThis.Array.isArray(t.data))return Yn([e]);let n=Bs(t.data),i=new n([e]);return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}const js={prepare(t,e,n){return{data:t,shape:e,stride:n}},set_scalar(t,e,n){let i=Sn(t);Un(i,e,Us(t,n),i.bytes_per_element)},set_from_chunk(t,e,n){let i=Sn(t);gn(i,Sn(e),i.bytes_per_element,n)}};async function xs(t,e=null,n={}){return Ps(t,e,n,js)}function vr(t,e,n){return n<0&&e<t?Math.floor((t-e-1)/-n)+1:t<e?Math.floor((e-t-1)/n)+1:0}function Un(t,e,n,i){if(e.length===0){t.data.set(n,0);return}const[r,...s]=e,[o,...l]=t.stride;if(typeof r=="number"){const y=t.data.subarray(o*r*i);Un({data:y,stride:l},s,n,i);return}const[a,h,f]=r,p=vr(a,h,f);if(s.length===0){for(let y=0;y<p;y++)t.data.set(n,o*(a+f*y)*i);return}for(let y=0;y<p;y++){const g=t.data.subarray(o*(a+f*y)*i);Un({data:g,stride:l},s,n,i)}}function gn(t,e,n,i){const[r,...s]=i,[o,...l]=t.stride,[a,...h]=e.stride;if(r.from===null){if(s.length===0){t.data.set(e.data.subarray(0,n),r.to*n);return}gn({data:t.data.subarray(o*r.to*n),stride:l},e,n,s);return}if(r.to===null){if(s.length===0){let R=r.from*n;t.data.set(e.data.subarray(R,R+n),0);return}gn(t,{data:e.data.subarray(a*r.from*n),stride:h},n,s);return}const[f,p,y]=r.to,[g,d,k]=r.from,L=vr(f,p,y);if(s.length===0){if(y===1&&k===1&&o===1&&a===1){let R=g*n,j=L*n;t.data.set(e.data.subarray(R,R+j),f*n);return}for(let R=0;R<L;R++){let j=a*(g+k*R)*n;t.data.set(e.data.subarray(j,j+n),o*(f+y*R)*n)}return}for(let R=0;R<L;R++)gn({data:t.data.subarray(o*(f+R*y)*n),stride:l},{data:e.data.subarray(a*(g+R*k)*n),stride:h},n,s)}function wr(t,e,n,i={}){return e!==void 0&&n!==void 0&&(i={...i,headers:{...i.headers,Range:`bytes=${e}-${e+n-1}`}}),fetch(t,i)}function Vs(t,e){return{...t,...e,headers:{...t.headers,...e.headers}}}function Ai(t,e){const n=typeof t=="string"?new URL(t):t;n.pathname.endsWith("/")||(n.pathname+="/");const i=new URL(e.slice(1),n);return i.search=n.search,i}async function Si(t){if(t.status!==404){if(t.status===200||t.status===206)return new Uint8Array(await t.arrayBuffer());throw new Error(`Unexpected response status ${t.status} ${t.statusText}`)}}async function Ws(t,e,n,i){if(i)return fetch(t,{...n,headers:{...n.headers,Range:`bytes=-${e}`}});let r=await fetch(t,{...n,method:"HEAD"});if(!r.ok)return r;let s=r.headers.get("Content-Length"),o=Number(s);return wr(t,o-e,o,n)}var Zt,Qt,Xt,jn;class Hs{constructor(e,n={}){Ee(this,Xt);se(this,"url");Ee(this,Zt);Ee(this,Qt);this.url=e,ye(this,Zt,n.overrides??{}),ye(this,Qt,n.useSuffixRequest??!1)}async get(e,n={}){let i=Ai(this.url,e).href,r=await fetch(i,Cn(this,Xt,jn).call(this,n));return Si(r)}async getRange(e,n,i={}){let r=Ai(this.url,e),s=Cn(this,Xt,jn).call(this,i),o;return"suffixLength"in n?o=await Ws(r,n.suffixLength,s,K(this,Qt)):o=await wr(r,n.offset,n.length,s),Si(o)}}Zt=new WeakMap,Qt=new WeakMap,Xt=new WeakSet,jn=function(e){return Vs(K(this,Zt),e)};async function jt(t,e){var r;let n;try{const s=await fetch(`${t}/zarr.json`,{signal:e});if(!s.ok)throw new Error(`HTTP ${s.status} for ${t}/zarr.json`);n=await s.json()}catch(s){return console.warn(`[ngffLoader] ${t}/zarr.json not found or invalid`,s.message),[void 0,t]}const i=(r=n==null?void 0:n.attributes)==null?void 0:r.ome;if(!i)return[void 0,t];if(i.multiscales)return[i,t];if(i.plate){const s=i.plate.wells[0],o=`${t}/${s.path}/0`,[l,a]=await jt(o,e);return[l,a,i.plate]}if(i["bioformats2raw.layout"]){const s=`${t}/0`;return await jt(s,e)}return[void 0,t]}async function qs(t,e,n,i=512,r){var J,Z,B;if(!((J=e==null?void 0:e.multiscales)!=null&&J.length))return null;const s=e.multiscales[0].datasets.map(w=>w.path),o=e.multiscales[0].axes.map(w=>w.name);let l=s.at(-1);n!==void 0&&n<s.length&&(l=s[n]);const a=new Hs(`${t}/${l}`),h=await dt.v3(a,{kind:"array"}),f=o.indexOf("c"),p=h.shape;if(p.at(-1)*p.at(-2)>i*i)return console.log("Thumbnail skipped, too large:",p,t),null;const y=p[f]||1,g=(Z=e==null?void 0:e.omero)!=null&&Z.channels?e.omero.channels.map(w=>w.active):Jr(y),d=(B=e==null?void 0:e.omero)!=null&&B.channels?e.omero.channels.map(w=>fr(w.color)):Yr(y,g),k=g.reduce((w,u,c)=>u?[...w,c]:w,[]),L=w=>p.map((u,c)=>c===f?w:c>=p.length-2?{start:0,stop:u,step:1}:parseInt(u/2)),R=await Promise.all(k.map(w=>xs(h,L(w),{opts:{signal:r}}))),j=R.map(qr);return{rgb:Zr(R,j,d),width:p.at(-1),height:p.at(-2)}}class Ks{constructor(e="index",n=!0){this.store=Fn([]),this.selectedRow=Fn(null),this.sortColumn=e,this.sortAscending=n,this.csvFiles=[]}addCsv(e,n,i,r,s){n=n.map(l=>({...l,child_csv:[]}));let o;for(let l of this.csvFiles){if(l.url===e){o=l;break}for(let a of l.child_csv){if(a.url===e){o=a;break}for(let h of a.child_csv)if(h.url===e){o=h;break}}}o?(o.image_count=i,o.plate_count=r,o.bytes=s,o.child_csv=n):(o={url:e,image_count:i,plate_count:r,bytes:s,child_csv:n},this.csvFiles.push(o))}addRows(e){e=e.map((r,s)=>{if(r.written&&(r.written=parseFloat(r.written)),r.shape){let o=r.shape.split(",").map(a=>parseInt(a)),l;r.dimension_names?l=r.dimension_names.split(","):o.length==5&&(l=["t","c","z","y","x"]),l&&l.length==o.length&&l.forEach((a,h)=>r["size_"+a]=o[h]),r.dim_count=o.reduce((a,h)=>a+(h>1?1:0),0)}if(r.chunks){let o=r.chunks.split(",").map(l=>parseInt(l));r.chunk_pixels=o.reduce((l,a)=>l*a,1)}if(r.shards){let o=r.shards.split(",").map(l=>parseInt(l));r.shard_pixels=o.reduce((l,a)=>l*a,1)}return r.index=Math.random()*(1+s),r}),console.log("Adding rows",e),this.store.update(r=>(r.push(...e),r.sort((s,o)=>this.compareRows(s,o,!0)),r));let n=e.map(r=>r.organismId);_r.addTerms(n);let i=e.map(r=>r.fbbiId);gr.addTerms(i)}populateRow(e,n){this.store.update(i=>(i=i.map(r=>(r.url===e&&(r={...r,...n}),r)),i))}async loadNgffMetadata(e){var y;const[n,i,r]=await jt(e);let s=[],o=0,l=0,a=!1,h=!0,f={multiscales:n},p=i;if(r&&(o=r.wells.length,l=r.field_count||1),n){const g=(y=n[0])==null?void 0:y.datasets[0],d=g==null?void 0:g.path;if(d){const k=await fetch(`${i}/${d}/zarr.json`).then(L=>L.json()).catch(L=>{console.log(`----> Failed to parse ${i}/${d}/zarr.json`,L)});s=k==null?void 0:k.shape}}else console.log("No multiscales found"),a=!0,s=[0];this.populateRow(e,{image_attrs:f,image_url:p,shape:s,well_count:o,field_count:l,load_failed:a,loaded:h})}compareRows(e,n,i=!1){let r=e[this.sortColumn],s=n[this.sortColumn];if(i)return r===void 0&&(r=0),s===void 0&&(s=0),r<s?this.sortAscending?-1:1:r>s?this.sortAscending?1:-1:0;r===void 0&&(r=""),s===void 0&&(s="");let o=0;return i?o=r-s:o=r.localeCompare(s),this.sortAscending?o:-o}sortTable(e,n=!0){console.log("sortTable",e,n),this.sortColumn=e,this.sortAscending=n;let i=this.isColumnNumeric(e);this.store.update(r=>(r.sort((s,o)=>this.compareRows(s,o,i)),r))}isColumnNumeric(e){let n=hn(this.store);for(let i of n){let r=i[e];if(r!==void 0&&r!=="")return!isNaN(r)}}emptyTable(){this.store.set([])}subscribe(e){return this.store.subscribe(e)}getRows(){return hn(this.store)}getRow(e){return hn(this.store)[e]}subscribeSelectedRow(e){return this.selectedRow.subscribe(e)}setSelectedRow(e){this.selectedRow.set(e)}}const We=new Ks;function Gs(t){let e,n,i,r,s,o;return{c(){e=E("button"),n=E("span"),n.textContent="^",i=H(),r=E("span"),r.textContent="^",b(n,"class","acc svelte-17vd65t"),Ue(n,"strong",t[1]),b(r,"class","dec svelte-17vd65t"),Ue(r,"strong",!t[1]),b(e,"class","svelte-17vd65t")},m(l,a){G(l,e,a),_(e,n),_(e,i),_(e,r),s||(o=pe(e,"click",t[2]),s=!0)},p(l,[a]){a&2&&Ue(n,"strong",l[1]),a&2&&Ue(r,"strong",!l[1])},i:we,o:we,d(l){l&&q(e),s=!1,o()}}}function Js(t,e,n){let{toggleAscending:i}=e,{sortAscending:r}=e;const s=()=>i();return t.$$set=o=>{"toggleAscending"in o&&n(0,i=o.toggleAscending),"sortAscending"in o&&n(1,r=o.sortAscending)},[i,r,s]}class Ys extends Ze{constructor(e){super(),Ye(this,e,Js,Gs,je,{toggleAscending:0,sortAscending:1})}}const fn={AUTO:"auto",START:"start",CENTER:"center",END:"end"},rt={HORIZONTAL:"horizontal",VERTICAL:"vertical"},Dt={OBSERVED:0,REQUESTED:1},Zs={[rt.VERTICAL]:"top",[rt.HORIZONTAL]:"left"},zi={[rt.VERTICAL]:"scrollTop",[rt.HORIZONTAL]:"scrollLeft"};class Qs{constructor({itemSize:e,itemCount:n,estimatedItemSize:i}){this.itemSize=e,this.itemCount=n,this.estimatedItemSize=i,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig({itemSize:e,itemCount:n,estimatedItemSize:i}){n!=null&&(this.itemCount=n),i!=null&&(this.estimatedItemSize=i),e!=null&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!=null?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.itemCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:n}=this;return typeof n=="function"?n(e):Array.isArray(n)?n[e]:n}computeTotalSizeAndPositionData(){let e=0;for(let n=0;n<this.itemCount;n++){const i=this.getSize(n),r=e;e+=i,this.itemSizeAndPositionData[n]={offset:r,size:i}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){if(e<0||e>=this.itemCount)throw Error(`Requested index ${e} is outside of range 0..${this.itemCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const n=this.getSizeAndPositionOfLastMeasuredItem();let i=n.offset+n.size;for(let r=this.lastMeasuredIndex+1;r<=e;r++){const s=this.getSize(r);if(s==null||isNaN(s))throw Error(`Invalid size returned for index ${r} of value ${s}`);this.itemSizeAndPositionData[r]={offset:i,size:s},i+=s}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize}getUpdatedOffsetForIndex({align:e=fn.START,containerSize:n,currentOffset:i,targetIndex:r}){if(n<=0)return 0;const s=this.getSizeAndPositionForIndex(r),o=s.offset,l=o-n+s.size;let a;switch(e){case fn.END:a=l;break;case fn.CENTER:a=o-(n-s.size)/2;break;case fn.START:a=o;break;default:a=Math.max(l,Math.min(o,i))}const h=this.getTotalSize();return Math.max(0,Math.min(h-n,a))}getVisibleRange({containerSize:e=0,offset:n,overscanCount:i}){if(this.getTotalSize()===0)return{};const s=n+e;let o=this.findNearestItem(n);if(o===void 0)throw Error(`Invalid offset ${n} specified`);const l=this.getSizeAndPositionForIndex(o);n=l.offset+l.size;let a=o;for(;n<s&&a<this.itemCount-1;)a++,n+=this.getSizeAndPositionForIndex(a).size;return i&&(o=Math.max(0,o-i),a=Math.min(a+i,this.itemCount-1)),{start:o,stop:a}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const n=this.getSizeAndPositionOfLastMeasuredItem(),i=Math.max(0,this.lastMeasuredIndex);return n.offset>=e?this.binarySearch({high:i,low:0,offset:e}):this.exponentialSearch({index:i,offset:e})}binarySearch({low:e,high:n,offset:i}){let r=0,s=0;for(;e<=n;){if(r=e+Math.floor((n-e)/2),s=this.getSizeAndPositionForIndex(r).offset,s===i)return r;s<i?e=r+1:s>i&&(n=r-1)}return e>0?e-1:0}exponentialSearch({index:e,offset:n}){let i=1;for(;e<this.itemCount&&this.getSizeAndPositionForIndex(e).offset<n;)e+=i,i*=2;return this.binarySearch({high:Math.min(e,this.itemCount-1),low:Math.floor(e/2),offset:n})}}const Xs=t=>({}),Ti=t=>({});function Ri(t,e,n){const i=t.slice();return i[37]=e[n],i}const $s=t=>({style:t[0]&4,index:t[0]&4}),Oi=t=>({style:t[37].style,index:t[37].index}),eo=t=>({}),Li=t=>({});function Mi(t,e){let n,i;const r=e[21].item,s=Tn(r,e,e[20],Oi);return{key:t,first:null,c(){n=$t(),s&&s.c(),this.first=n},m(o,l){G(o,n,l),s&&s.m(o,l),i=!0},p(o,l){e=o,s&&s.p&&(!i||l[0]&1048580)&&On(s,r,e,e[20],i?Rn(r,e[20],l,$s):Ln(e[20]),Oi)},i(o){i||(ae(s,o),i=!0)},o(o){he(s,o),i=!1},d(o){o&&q(n),s&&s.d(o)}}}function to(t){let e,n,i,r=[],s=new Map,o,l;const a=t[21].header,h=Tn(a,t,t[20],Li);let f=Pe(t[2]);const p=d=>d[0]?d[0](d[37].index):d[37].index;for(let d=0;d<f.length;d+=1){let k=Ri(t,f,d),L=p(k);s.set(L,r[d]=Mi(L,k))}const y=t[21].footer,g=Tn(y,t,t[20],Ti);return{c(){e=E("div"),h&&h.c(),n=H(),i=E("div");for(let d=0;d<r.length;d+=1)r[d].c();o=H(),g&&g.c(),b(i,"class","virtual-list-inner svelte-dwpad5"),b(i,"style",t[4]),b(e,"class","virtual-list-wrapper svelte-dwpad5"),b(e,"style",t[3])},m(d,k){G(d,e,k),h&&h.m(e,null),_(e,n),_(e,i);for(let L=0;L<r.length;L+=1)r[L]&&r[L].m(i,null);_(e,o),g&&g.m(e,null),t[22](e),l=!0},p(d,k){h&&h.p&&(!l||k[0]&1048576)&&On(h,a,d,d[20],l?Rn(a,d[20],k,eo):Ln(d[20]),Li),k[0]&1048581&&(f=Pe(d[2]),tn(),r=ur(r,k,p,1,d,f,s,i,Br,Mi,null,Ri),nn()),(!l||k[0]&16)&&b(i,"style",d[4]),g&&g.p&&(!l||k[0]&1048576)&&On(g,y,d,d[20],l?Rn(y,d[20],k,Xs):Ln(d[20]),Ti),(!l||k[0]&8)&&b(e,"style",d[3])},i(d){if(!l){ae(h,d);for(let k=0;k<f.length;k+=1)ae(r[k]);ae(g,d),l=!0}},o(d){he(h,d);for(let k=0;k<r.length;k+=1)he(r[k]);he(g,d),l=!1},d(d){d&&q(e),h&&h.d(d);for(let k=0;k<r.length;k+=1)r[k].d();g&&g.d(d),t[22](null)}}}const no=(()=>{let t=!1;try{const e=Object.defineProperty({},"passive",{get(){return t={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return t})();function io(t,e,n){let{$$slots:i={},$$scope:r}=e,{height:s}=e,{width:o="100%"}=e,{itemCount:l}=e,{itemSize:a}=e,{estimatedItemSize:h=null}=e,{stickyIndices:f=null}=e,{getKey:p=null}=e,{scrollDirection:y=rt.VERTICAL}=e,{scrollOffset:g=null}=e,{scrollToIndex:d=null}=e,{scrollToAlignment:k=null}=e,{scrollToBehaviour:L="instant"}=e,{overscanCount:R=3}=e;const j=Mr(),U=new Qs({itemCount:l,itemSize:a,estimatedItemSize:ce()});let J=!1,Z,B=[],w={offset:g||d!=null&&B.length&&A(d)||0,scrollChangeReason:Dt.REQUESTED},u=w,c={scrollToIndex:d,scrollToAlignment:k,scrollOffset:g,itemCount:l,itemSize:a,estimatedItemSize:h},v={},C="",S="";O(),en(()=>{n(18,J=!0),Z.addEventListener("scroll",T,no),g!=null?D(g):d!=null&&D(A(d))}),Vn(()=>{J&&Z.removeEventListener("scroll",T)});function M(){if(!J)return;const I=c.scrollToIndex!==d||c.scrollToAlignment!==k,x=c.itemCount!==l||c.itemSize!==a||c.estimatedItemSize!==h;x&&(U.updateConfig({itemSize:a,itemCount:l,estimatedItemSize:ce()}),m()),c.scrollOffset!==g?n(19,w={offset:g||0,scrollChangeReason:Dt.REQUESTED}):typeof d=="number"&&(I||x)&&n(19,w={offset:A(d,k,l),scrollChangeReason:Dt.REQUESTED}),c={scrollToIndex:d,scrollToAlignment:k,scrollOffset:g,itemCount:l,itemSize:a,estimatedItemSize:h}}function N(){if(!J)return;const{offset:I,scrollChangeReason:x}=w;(u.offset!==I||u.scrollChangeReason!==x)&&O(),u.offset!==I&&x===Dt.REQUESTED&&D(I),u=w}function O(){const{offset:I}=w,{start:x,stop:te}=U.getVisibleRange({containerSize:y===rt.VERTICAL?s:o,offset:I,overscanCount:R});let ne=[];const ie=U.getTotalSize();y===rt.VERTICAL?(n(3,C=`height:${s}${typeof s=="number"?"px":""};width:${o};`),n(4,S=`flex-direction:column;height:${ie}px;`)):(n(3,C=`height:${s};width:${o}${typeof o=="number"?"px":""}`),n(4,S=`min-height:100%;width:${ie}px;`));const P=f!=null&&f.length!==0;if(P)for(let W=0;W<f.length;W++){const Q=f[W];ne.push({index:Q,style:F(Q,!0)})}if(x!==void 0&&te!==void 0){for(let W=x;W<=te;W++)P&&f.includes(W)||ne.push({index:W,style:F(W,!1)});j("itemsUpdated",{start:x,end:te})}n(2,B=ne)}function D(I){"scroll"in Z?Z.scroll({[Zs[y]]:I,behavior:L}):n(1,Z[zi[y]]=I,Z)}function m(I=0){v={},U.resetItem(I),O()}function A(I,x=k,te=l){return(I<0||I>=te)&&(I=0),U.getUpdatedOffsetForIndex({align:x,containerSize:y===rt.VERTICAL?s:o,currentOffset:w.offset||0,targetIndex:I})}function T(I){const x=V();x<0||w.offset===x||I.target!==Z||(n(19,w={offset:x,scrollChangeReason:Dt.OBSERVED}),j("afterScroll",{offset:x,event:I}))}function V(){return Z[zi[y]]}function ce(){return h||typeof a=="number"&&a||50}function F(I,x){if(v[I])return v[I];const{size:te,offset:ne}=U.getSizeAndPositionForIndex(I);let ie;return y===rt.VERTICAL?(ie=`left:0;width:100%;height:${te}px;`,x?ie+=`position:sticky;flex-grow:0;z-index:1;top:0;margin-top:${ne}px;margin-bottom:${-(ne+te)}px;`:ie+=`position:absolute;top:${ne}px;`):(ie=`top:0;width:${te}px;`,x?ie+=`position:sticky;z-index:1;left:0;margin-left:${ne}px;margin-right:${-(ne+te)}px;`:ie+=`position:absolute;height:100%;left:${ne}px;`),v[I]=ie}function ee(I){ut[I?"unshift":"push"](()=>{Z=I,n(1,Z)})}return t.$$set=I=>{"height"in I&&n(5,s=I.height),"width"in I&&n(6,o=I.width),"itemCount"in I&&n(7,l=I.itemCount),"itemSize"in I&&n(8,a=I.itemSize),"estimatedItemSize"in I&&n(9,h=I.estimatedItemSize),"stickyIndices"in I&&n(10,f=I.stickyIndices),"getKey"in I&&n(0,p=I.getKey),"scrollDirection"in I&&n(11,y=I.scrollDirection),"scrollOffset"in I&&n(12,g=I.scrollOffset),"scrollToIndex"in I&&n(13,d=I.scrollToIndex),"scrollToAlignment"in I&&n(14,k=I.scrollToAlignment),"scrollToBehaviour"in I&&n(15,L=I.scrollToBehaviour),"overscanCount"in I&&n(16,R=I.overscanCount),"$$scope"in I&&n(20,r=I.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&29568&&M(),t.$$.dirty[0]&524288&&N(),t.$$.dirty[0]&263264&&J&&m(0)},[p,Z,B,C,S,s,o,l,a,h,f,y,g,d,k,L,R,m,J,w,r,i,ee]}class ro extends Ze{constructor(e){super(),Ye(this,e,io,to,je,{height:5,width:6,itemCount:7,itemSize:8,estimatedItemSize:9,stickyIndices:10,getKey:0,scrollDirection:11,scrollOffset:12,scrollToIndex:13,scrollToAlignment:14,scrollToBehaviour:15,overscanCount:16,recomputeSizes:17},null,[-1,-1])}get height(){return this.$$.ctx[5]}set height(e){this.$$set({height:e}),Ne()}get width(){return this.$$.ctx[6]}set width(e){this.$$set({width:e}),Ne()}get itemCount(){return this.$$.ctx[7]}set itemCount(e){this.$$set({itemCount:e}),Ne()}get itemSize(){return this.$$.ctx[8]}set itemSize(e){this.$$set({itemSize:e}),Ne()}get estimatedItemSize(){return this.$$.ctx[9]}set estimatedItemSize(e){this.$$set({estimatedItemSize:e}),Ne()}get stickyIndices(){return this.$$.ctx[10]}set stickyIndices(e){this.$$set({stickyIndices:e}),Ne()}get getKey(){return this.$$.ctx[0]}set getKey(e){this.$$set({getKey:e}),Ne()}get scrollDirection(){return this.$$.ctx[11]}set scrollDirection(e){this.$$set({scrollDirection:e}),Ne()}get scrollOffset(){return this.$$.ctx[12]}set scrollOffset(e){this.$$set({scrollOffset:e}),Ne()}get scrollToIndex(){return this.$$.ctx[13]}set scrollToIndex(e){this.$$set({scrollToIndex:e}),Ne()}get scrollToAlignment(){return this.$$.ctx[14]}set scrollToAlignment(e){this.$$set({scrollToAlignment:e}),Ne()}get scrollToBehaviour(){return this.$$.ctx[15]}set scrollToBehaviour(e){this.$$set({scrollToBehaviour:e}),Ne()}get overscanCount(){return this.$$.ctx[16]}set overscanCount(e){this.$$set({overscanCount:e}),Ne()}get recomputeSizes(){return this.$$.ctx[17]}}function so(t){let e,n,i,r,s;return{c(){e=E("div"),n=E("img"),r=H(),s=E("canvas"),le(n,"width",t[4]+"px"),le(n,"height",t[5]+"px"),le(n,"object-fit","cover"),b(n,"alt",""),b(n,"aria-hidden",i=t[7]!=="cached"),b(n,"class","svelte-12dtn57"),Ue(n,"hidden",t[7]!=="cached"),le(s,"width",t[4]+"px"),le(s,"height",t[5]+"px"),le(s,"background-color","lightgrey"),b(s,"width",t[2]),b(s,"height",t[3]),b(s,"class","svelte-12dtn57"),Ue(s,"hidden",t[7]!=="live"),b(e,"class","canvasWrapper svelte-12dtn57"),le(e,"width",t[4]+"px"),le(e,"height",t[5]+"px"),Ue(e,"spinner",t[6])},m(o,l){G(o,e,l),_(e,n),t[14](n),_(e,r),_(e,s),t[15](s)},p(o,[l]){l&16&&le(n,"width",o[4]+"px"),l&32&&le(n,"height",o[5]+"px"),l&128&&i!==(i=o[7]!=="cached")&&b(n,"aria-hidden",i),l&128&&Ue(n,"hidden",o[7]!=="cached"),l&16&&le(s,"width",o[4]+"px"),l&32&&le(s,"height",o[5]+"px"),l&4&&b(s,"width",o[2]),l&8&&b(s,"height",o[3]),l&128&&Ue(s,"hidden",o[7]!=="live"),l&16&&le(e,"width",o[4]+"px"),l&32&&le(e,"height",o[5]+"px"),l&64&&Ue(e,"spinner",o[6])},i:we,o:we,d(o){o&&q(e),t[14](null),t[15](null)}}}function oo(t){try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n[n.length-1]}catch{const e=t.split("?")[0].split("/");return e[e.length-1]}}function lo(t,e,n){let{source:i}=e,{attrs:r}=e,{thumbDatasetIndex:s=void 0}=e,{thumbAspectRatio:o=1}=e,{cssSize:l=120}=e,{max_size:a=512}=e;const h="/zowser/";let f,p,y=l,g=l;o>1?g=y/o:o<1&&(y=g*o);let d=y,k=g,L=!0,R="none";const j=new AbortController;async function U(){const w=oo(i);console.log(h);const u=`${h}thumbs/${w}.jpg`,c=new Image;return c.decoding="async",c.referrerPolicy="no-referrer",new Promise(v=>{c.onload=()=>{n(7,R="cached"),n(6,L=!1),n(1,p.src=u,p),v(!0)},c.onerror=()=>v(!1),c.src=u})}async function J(){n(7,R="live");const w=await qs(i,r,s,a,j.signal);if(!w){console.warn("Thumbnail generation skipped/failed:",i);return}const{rgb:u,width:c,height:v}=w;n(2,y=c),n(3,g=v);let C=Math.max(y,g)/l;C<1&&(C=1),n(4,d=y/C),n(5,k=g/C),await Fr(),f.getContext("2d").putImageData(new ImageData(u,y,g),0,0),n(6,L=!1)}en(async()=>{await U()||await J()}),Vn(()=>j.abort());function Z(w){ut[w?"unshift":"push"](()=>{p=w,n(1,p)})}function B(w){ut[w?"unshift":"push"](()=>{f=w,n(0,f)})}return t.$$set=w=>{"source"in w&&n(8,i=w.source),"attrs"in w&&n(9,r=w.attrs),"thumbDatasetIndex"in w&&n(10,s=w.thumbDatasetIndex),"thumbAspectRatio"in w&&n(11,o=w.thumbAspectRatio),"cssSize"in w&&n(12,l=w.cssSize),"max_size"in w&&n(13,a=w.max_size)},[f,p,y,g,d,k,L,R,i,r,s,o,l,a,Z,B]}class kr extends Ze{constructor(e){super(),Ye(this,e,lo,so,je,{source:8,attrs:9,thumbDatasetIndex:10,thumbAspectRatio:11,cssSize:12,max_size:13})}}const Er="/zowser/ome-logomark.svg",ao=[{name:"vizarr",logo:"/vizarr_logo.png",href:"https://hms-dbmi.github.io/vizarr/?source="},{name:"itk-vtk-viewer",logo:"/itkvtk_logo.png",href:"https://kitware.github.io/itk-vtk-viewer/app/?rotate=false&fileToLoad="},{name:"neuroglancer",logo:"/neuroglancer.png","//":"NB: The {URL} in the href is replaced with NGFF image URL",href:"https://neuroglancer-demo.appspot.com/#!{%22layers%22:[{%22source%22:%22{URL}%22,%22name%22:%22OME-NGFF%22}]}"},{name:"Vol-E viewer",logo:"/aics_website-3d-cell-viewer.png",href:"https://volumeviewer.allencell.org/viewer?url="},{name:"napari",logo:"/napari.png",html:"<p>See <a href='https://napari.org/'>napari.org</a> for install instructions.</p><p>Then <code>napari {URL}</code>"},{name:"MoBIE",logo:"/MoBIE.jpeg",html:"<p><a href='https://github.com/mobie/mobie-viewer-fiji/'>MoBIE</a> plugin for ImageJ/Fiji. See <a href='https://omero-guides.readthedocs.io/en/latest/fiji/docs/view_mobie_zarr.html'>MoBIE guide</a> for installation. Plugins > BigDataViewer > OME ZARR > <br> Open OME ZARR from S3…. <code>{URL}</code>"}],uo={viewers:ao},zn="/zowser/vizarr_logo.png",Cr="/zowser/copy.png";function Fi(t,e,n){const i=t.slice();return i[21]=e[n],i[23]=n,i}function co(t){let e,n,i,r,s,o,l,a;function h(){return t[18](t[23])}return{c(){e=E("button"),n=E("img"),r=H(),s=E("img"),b(n,"class","viewer_icon"),$e(n.src,i=t[21].logo_path)||b(n,"src",i),b(n,"alt","Viewer Icon"),b(s,"class","smallCopyBtn"),$e(s.src,o=Cr)||b(s,"src",o),b(s,"alt","Copy Icon"),Ue(s,"shaking",t[2][t[23]]),b(e,"class","inlineButton"),b(e,"title","Copy URL")},m(f,p){G(f,e,p),_(e,n),_(e,r),_(e,s),l||(a=pe(e,"click",h),l=!0)},p(f,p){t=f,p&8&&!$e(n.src,i=t[21].logo_path)&&b(n,"src",i),p&4&&Ue(s,"shaking",t[2][t[23]])},d(f){f&&q(e),l=!1,a()}}}function fo(t){let e,n,i,r,s,o,l;function a(){return t[17](t[21])}return{c(){e=E("button"),n=E("img"),b(n,"class","viewer_icon"),$e(n.src,i=t[21].logo_path)||b(n,"src",i),b(n,"alt",r=t[21].name),b(e,"class","inlineButton"),b(e,"title",s="View "+t[1]+" in "+t[21].name)},m(h,f){G(h,e,f),_(e,n),o||(l=pe(e,"click",a),o=!0)},p(h,f){t=h,f&8&&!$e(n.src,i=t[21].logo_path)&&b(n,"src",i),f&8&&r!==(r=t[21].name)&&b(n,"alt",r),f&10&&s!==(s="View "+t[1]+" in "+t[21].name)&&b(e,"title",s)},d(h){h&&q(e),o=!1,l()}}}function Di(t){let e,n=t[21].html.replace("{URL}",t[0])+"";return{c(){e=E("div"),b(e,"class","viewer_html")},m(i,r){G(i,e,r),e.innerHTML=n},p(i,r){r&9&&n!==(n=i[21].html.replace("{URL}",i[0])+"")&&(e.innerHTML=n)},d(i){i&&q(e)}}}function Ni(t){let e,n,i;function r(a,h){return a[21].href?fo:co}let s=r(t),o=s(t),l=t[21].html&&Di(t);return{c(){e=E("div"),o.c(),n=H(),l&&l.c(),i=H(),b(e,"class","viewerItem")},m(a,h){G(a,e,h),o.m(e,null),_(e,n),l&&l.m(e,null),_(e,i)},p(a,h){s===(s=r(a))&&o?o.p(a,h):(o.d(1),o=s(a),o&&(o.c(),o.m(e,n))),a[21].html?l?l.p(a,h):(l=Di(a),l.c(),l.m(e,i)):l&&(l.d(1),l=null)},d(a){a&&q(e),o.d(),l&&l.d()}}}function Pi(t){let e,n,i;return{c(){e=E("span"),n=Y("— "),i=Y(t[8]),b(e,"class","file-info")},m(r,s){G(r,e,s),_(e,n),_(e,i)},p(r,s){s&256&&Ie(i,r[8])},d(r){r&&q(e)}}}function ho(t){let e,n,i,r,s,o,l,a,h,f,p,y,g,d,k,L,R,j,U,J,Z,B,w,u,c,v,C,S,M,N,O=Pe(t[3]),D=[];for(let A=0;A<O.length;A+=1)D[A]=Ni(Fi(t,O,A));let m=t[8]&&Pi(t);return{c(){e=E("div"),n=E("div"),i=E("div"),r=E("button"),s=E("img"),l=H(),a=E("div"),h=E("button"),h.innerHTML=`<img class="viewer_icon" src="${Er}" alt="Validator"/>`,f=H();for(let A=0;A<D.length;A+=1)D[A].c();p=H(),y=E("div"),g=E("div"),d=E("div"),k=E("img"),R=H(),j=E("span"),U=Y(t[6]),J=H(),m&&m.c(),Z=H(),B=E("div"),w=E("button"),w.textContent="↗",u=H(),c=E("button"),c.textContent="×",v=H(),C=E("iframe"),b(s,"class","viewer_icon"),$e(s.src,o=Cr)||b(s,"src",o),b(s,"alt","Copy Icon"),Ue(s,"shaking",t[2].bigCopyButton),b(r,"class","inlineButton"),b(r,"title","Copy URL"),b(i,"class","viewerItem"),b(h,"class","inlineButton"),b(h,"title","Validate NGFF"),b(a,"class","viewerItem"),b(n,"class","viewerRow"),b(e,"class","openwith"),$e(k.src,L=t[7])||b(k,"src",L),b(k,"alt",""),b(k,"class","viewer_header_logo"),b(d,"class","vh-left"),b(w,"class","external"),b(w,"title","Open externally"),b(c,"class","close"),b(c,"title","Close"),b(B,"class","popover-buttons inline"),b(g,"class","viewer-header"),$e(C.src,S=t[5])||b(C,"src",S),b(C,"frameborder","0"),b(C,"title",t[6]),b(y,"id","viewer-popover"),b(y,"popover","")},m(A,T){G(A,e,T),_(e,n),_(n,i),_(i,r),_(r,s),_(n,l),_(n,a),_(a,h),_(n,f);for(let V=0;V<D.length;V+=1)D[V]&&D[V].m(n,null);G(A,p,T),G(A,y,T),_(y,g),_(g,d),_(d,k),_(d,R),_(d,j),_(j,U),_(d,J),m&&m.m(d,null),_(g,Z),_(g,B),_(B,w),_(B,u),_(B,c),_(y,v),_(y,C),t[19](y),M||(N=[pe(r,"click",t[15]),pe(h,"click",t[16]),pe(w,"click",t[12]),pe(c,"click",t[11])],M=!0)},p(A,[T]){if(T&4&&Ue(s,"shaking",A[2].bigCopyButton),T&1551){O=Pe(A[3]);let V;for(V=0;V<O.length;V+=1){const ce=Fi(A,O,V);D[V]?D[V].p(ce,T):(D[V]=Ni(ce),D[V].c(),D[V].m(n,null))}for(;V<D.length;V+=1)D[V].d(1);D.length=O.length}T&128&&!$e(k.src,L=A[7])&&b(k,"src",L),T&64&&Ie(U,A[6]),A[8]?m?m.p(A,T):(m=Pi(A),m.c(),m.m(d,null)):m&&(m.d(1),m=null),T&32&&!$e(C.src,S=A[5])&&b(C,"src",S),T&64&&b(C,"title",A[6])},i:we,o:we,d(A){A&&(q(e),q(p),q(y)),It(D,A),m&&m.d(),t[19](null),M=!1,st(N)}}}function _o(t){try{const e=new URL(t).pathname.split("/");return decodeURIComponent(e.pop()||"")}catch{return decodeURIComponent(t.split("/").pop()||t)}}function go(t,e,n){let{source:i}=e,{dtype:r}=e,{version:s}=e,{rowData:o=void 0}=e,l={};function a(u,c){const v=document.createElement("textarea");v.value=u,document.body.appendChild(v),v.select(),document.execCommand("copy"),document.body.removeChild(v),n(2,l[c]=!0,l),setTimeout(()=>n(2,l[c]=!1,l),1e3)}let h=uo.viewers.map(u=>{let c=u.href?u.href.includes("{URL}")?u.href.replace("{URL}",i):u.href+i:void 0;const v=zn.replace("/vizarr_logo.png",u.logo);return{...u,href:c,logo_path:v}});s==="0.5"&&(h=h.filter(u=>u.name!=="itk-vtk-viewer"));let f,p="",y="",g="",d=zn,k="";function L(u,c,v=zn){p=u,n(5,y=u),n(6,g=c),n(7,d=v),n(8,k=(o==null?void 0:o.name)||_o(i)),f==null||f.showPopover()}function R(){f==null||f.hidePopover(),n(5,y="about:blank")}function j(){window.open(p,"_blank"),R()}const U=()=>a(i,"bigCopyButton"),J=()=>L(`https://ome.github.io/ome-ngff-validator/?source=${i}`,"NGFF Validator",Er),Z=u=>L(u.href,u.name,u.logo_path),B=u=>a(i,u);function w(u){ut[u?"unshift":"push"](()=>{f=u,n(4,f)})}return t.$$set=u=>{"source"in u&&n(0,i=u.source),"dtype"in u&&n(1,r=u.dtype),"version"in u&&n(13,s=u.version),"rowData"in u&&n(14,o=u.rowData)},[i,r,l,h,f,y,g,d,k,a,L,R,j,s,o,U,J,Z,B,w]}class mo extends Ze{constructor(e){super(),Ye(this,e,go,ho,je,{source:0,dtype:1,version:13,rowData:14})}}function Bi(t,e,n){const i=t.slice();return i[14]=e[n],i}function Ui(t){let e,n;return e=new kr({props:{source:t[4],attrs:t[3],max_size:2e3,thumbDatasetIndex:t[5],thumbAspectRatio:t[6]}}),{c(){Je(e.$$.fragment)},m(i,r){qe(e,i,r),n=!0},p(i,r){const s={};r&16&&(s.source=i[4]),r&8&&(s.attrs=i[3]),r&32&&(s.thumbDatasetIndex=i[5]),r&64&&(s.thumbAspectRatio=i[6]),e.$set(s)},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){Ke(e,i)}}}function ji(t){let e=t[14].toUpperCase()+"",n,i,r=t[0][`size_${t[14]}`]+"",s,o;return{c(){n=Y(e),i=Y(":"),s=Y(r),o=Y("  ")},m(l,a){G(l,n,a),G(l,i,a),G(l,s,a),G(l,o,a)},p(l,a){a&1&&r!==(r=l[0][`size_${l[14]}`]+"")&&Ie(s,r)},d(l){l&&(q(n),q(i),q(s),q(o))}}}function xi(t){let e,n=t[0][`size_${t[14]}`]!==void 0&&ji(t);return{c(){n&&n.c(),e=$t()},m(i,r){n&&n.m(i,r),G(i,e,r)},p(i,r){i[0][`size_${i[14]}`]!==void 0?n?n.p(i,r):(n=ji(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(i){i&&q(e),n&&n.d(i)}}}function po(t){let e,n,i=mn(t[0].written)+"",r;return{c(){e=E("div"),n=Y("Data size: "),r=Y(i)},m(s,o){G(s,e,o),_(e,n),_(e,r)},p(s,o){o&1&&i!==(i=mn(s[0].written)+"")&&Ie(r,i)},d(s){s&&q(e)}}}function bo(t){let e,n,i=t[0].shards+"",r;return{c(){e=E("div"),n=Y("Shard shape: "),r=Y(i)},m(s,o){G(s,e,o),_(e,n),_(e,r)},p(s,o){o&1&&i!==(i=s[0].shards+"")&&Ie(r,i)},d(s){s&&q(e)}}}function yo(t){let e,n,i=t[0].chunks+"",r;return{c(){e=E("div"),n=Y("Chunk shape: "),r=Y(i)},m(s,o){G(s,e,o),_(e,n),_(e,r)},p(s,o){o&1&&i!==(i=s[0].chunks+"")&&Ie(r,i)},d(s){s&&q(e)}}}function vo(t){let e,n,i,r,s,o,l=t[9](t[0].url)+"",a,h,f,p=(t[0].name?t[0].name.replaceAll(t[1],`<mark>${t[1]}</mark>`):"")+"",y,g,d,k=t[7].replaceAll(t[1],`<mark>${t[1]}</mark>`)+"",L,R,j,U,J,Z,B,w,u,c=t[3]&&Ui(t);R=new mo({props:{source:t[0].url,dtype:wo,version:ko}});let v=Pe(["t","c","z","y","x"]),C=[];for(let O=0;O<5;O+=1)C[O]=xi(Bi(t,v,O));function S(O,D){return O[2]=="chunk_pixels"?yo:O[2]=="shard_pixels"?bo:po}let M=S(t),N=M(t);return{c(){e=E("div"),n=E("div"),c&&c.c(),i=H(),r=E("div"),s=E("div"),o=E("strong"),h=H(),f=E("div"),g=H(),d=E("div"),L=H(),Je(R.$$.fragment),j=H(),U=E("div"),J=Y(`Image size:
      `);for(let O=0;O<5;O+=1)C[O].c();Z=H(),N.c(),b(n,"class","thumbWrapper svelte-gffxyg"),b(s,"title",a=t[0].url),b(f,"class",y=fi(t[1]==""?"hideOnSmall":"")+" svelte-gffxyg"),b(e,"class","zarr-list-item svelte-gffxyg")},m(O,D){G(O,e,D),_(e,n),c&&c.m(n,null),_(e,i),_(e,r),_(r,s),_(s,o),o.innerHTML=l,_(r,h),_(r,f),f.innerHTML=p,_(r,g),_(r,d),d.innerHTML=k,_(r,L),qe(R,r,null),_(r,j),_(r,U),_(U,J);for(let m=0;m<5;m+=1)C[m]&&C[m].m(U,null);_(r,Z),N.m(r,null),B=!0,w||(u=pe(n,"click",t[8]),w=!0)},p(O,[D]){O[3]?c?(c.p(O,D),D&8&&ae(c,1)):(c=Ui(O),c.c(),ae(c,1),c.m(n,null)):c&&(tn(),he(c,1,1,()=>{c=null}),nn()),(!B||D&1)&&l!==(l=O[9](O[0].url)+"")&&(o.innerHTML=l),(!B||D&1&&a!==(a=O[0].url))&&b(s,"title",a),(!B||D&3)&&p!==(p=(O[0].name?O[0].name.replaceAll(O[1],`<mark>${O[1]}</mark>`):"")+"")&&(f.innerHTML=p),(!B||D&2&&y!==(y=fi(O[1]==""?"hideOnSmall":"")+" svelte-gffxyg"))&&b(f,"class",y),(!B||D&130)&&k!==(k=O[7].replaceAll(O[1],`<mark>${O[1]}</mark>`)+"")&&(d.innerHTML=k);const m={};if(D&1&&(m.source=O[0].url),R.$set(m),D&1){v=Pe(["t","c","z","y","x"]);let A;for(A=0;A<5;A+=1){const T=Bi(O,v,A);C[A]?C[A].p(T,D):(C[A]=xi(T),C[A].c(),C[A].m(U,null))}for(;A<5;A+=1)C[A].d(1)}M===(M=S(O))&&N?N.p(O,D):(N.d(1),N=M(O),N&&(N.c(),N.m(r,null)))},i(O){B||(ae(c),ae(R.$$.fragment,O),B=!0)},o(O){he(c),he(R.$$.fragment,O),B=!1},d(O){O&&q(e),c&&c.d(),Ke(R),It(C,O),N.d(),w=!1,u()}}}let wo="image",ko="0.5";function Eo(t,e,n){let i,{rowData:r}=e,{textFilter:s}=e,{sortedBy:o=void 0}=e,l,a,h,f=1;const p=new AbortController;if(r.size_x&&r.size_y){let d=Math.max(r.size_x,r.size_y);for(h=0;d>256;)h+=1,d=d/2;f=r.size_x/r.size_y}function y(){console.log("Clicked on thumbnail"),We.setSelectedRow(r)}function g(d){if(s&&d.toLowerCase().includes(s.toLowerCase())){let L=d.toLowerCase(),R=s.toLowerCase(),j=L.indexOf(R),U=Math.max(0,Math.min(j,d.length-50)),J=d.substring(U,j);return J+="<mark>",J+=d.substring(j,j+R.length),J+="</mark>",J+=d.substring(j+R.length),J}return d.split("/").pop()}return en(async()=>{let d=r.url;r.series0!==void 0&&(d+="/"+r.series0);let k=await jt(d,p.signal);n(3,l=k[0]),n(4,a=k[1]),k[2]}),Vn(()=>{p.abort()}),t.$$set=d=>{"rowData"in d&&n(0,r=d.rowData),"textFilter"in d&&n(1,s=d.textFilter),"sortedBy"in d&&n(2,o=d.sortedBy)},t.$$.update=()=>{var d;t.$$.dirty&3&&n(7,i=s!=""&&((d=r.description)!=null&&d.toLowerCase().includes(s.toLowerCase()))?r.description:"")},[r,s,o,l,a,h,f,i,y,g]}class Co extends Ze{constructor(e){super(),Ye(this,e,Eo,vo,je,{rowData:0,textFilter:1,sortedBy:2})}}function Io(t){let e,n,i,r;return n=new Co({props:{rowData:t[0][t[13]],textFilter:t[1],sortedBy:t[2]}}),{c(){e=E("div"),Je(n.$$.fragment),b(e,"slot","item"),b(e,"style",i=t[12]),b(e,"class","row svelte-1xlep2t")},m(s,o){G(s,e,o),qe(n,e,null),r=!0},p(s,o){const l={};o&8193&&(l.rowData=s[0][s[13]]),o&2&&(l.textFilter=s[1]),o&4&&(l.sortedBy=s[2]),n.$set(l),(!r||o&4096&&i!==(i=s[12]))&&b(e,"style",i)},i(s){r||(ae(n.$$.fragment,s),r=!0)},o(s){he(n.$$.fragment,s),r=!1},d(s){s&&q(e),Ke(n)}}}function Ao(t){let e=!1,n=()=>{e=!1},i,r,s,o=`${t[5]}px`,l,a,h;return lt(t[8]),lt(t[9]),s=new ro({props:{width:"100%",height:t[5],itemCount:t[0].length,itemSize:160,getKey:t[6],$$slots:{item:[Io,({style:f,index:p})=>({12:f,13:p}),({style:f,index:p})=>(f?4096:0)|(p?8192:0)]},$$scope:{ctx:t}}}),s.$on("afterScroll",t[7]),{c(){r=E("div"),Je(s.$$.fragment),b(r,"class","imageListContainer svelte-1xlep2t"),le(r,"height",o)},m(f,p){G(f,r,p),qe(s,r,null),t[10](r),l=!0,a||(h=[pe(window,"resize",t[8]),pe(window,"scroll",()=>{e=!0,clearTimeout(i),i=setTimeout(n,100),t[9]()})],a=!0)},p(f,[p]){p&16&&!e&&(e=!0,clearTimeout(i),scrollTo(window.pageXOffset,f[4]),i=setTimeout(n,100));const y={};p&32&&(y.height=f[5]),p&1&&(y.itemCount=f[0].length),p&28679&&(y.$$scope={dirty:p,ctx:f}),s.$set(y),p&32&&o!==(o=`${f[5]}px`)&&le(r,"height",o)},i(f){l||(ae(s.$$.fragment,f),l=!0)},o(f){he(s.$$.fragment,f),l=!1},d(f){f&&q(r),Ke(s),t[10](null),a=!1,st(h)}}}function So(t,e,n){let i,{tableRows:r}=e,{textFilter:s}=e,{sortedBy:o=void 0}=e;function l(k){return r[k].url}let a,h=0,f=0;function p(k){let R=a.offsetTop-20;k.detail.offset-f<0&&h>R&&n(4,h-=1),f=k.detail.offset}function y(){n(5,i=window.innerHeight)}function g(){n(4,h=window.pageYOffset)}function d(k){ut[k?"unshift":"push"](()=>{a=k,n(3,a)})}return t.$$set=k=>{"tableRows"in k&&n(0,r=k.tableRows),"textFilter"in k&&n(1,s=k.textFilter),"sortedBy"in k&&n(2,o=k.sortedBy)},n(5,i=0),[r,s,o,a,h,i,l,p,y,g,d]}class zo extends Ze{constructor(e){super(),Ye(this,e,So,Ao,je,{tableRows:0,textFilter:1,sortedBy:2})}}function Vi(t){let e,n;return e=new kr({props:{source:t[1],attrs:t[0],cssSize:512,max_size:2e3,thumbDatasetIndex:t[2],thumbAspectRatio:t[3]}}),{c(){Je(e.$$.fragment)},m(i,r){qe(e,i,r),n=!0},p(i,r){const s={};r&2&&(s.source=i[1]),r&1&&(s.attrs=i[0]),r&4&&(s.thumbDatasetIndex=i[2]),r&8&&(s.thumbAspectRatio=i[3]),e.$set(s)},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){Ke(e,i)}}}function To(t){let e,n,i=t[0]&&Vi(t);return{c(){i&&i.c(),e=$t()},m(r,s){i&&i.m(r,s),G(r,e,s),n=!0},p(r,[s]){r[0]?i?(i.p(r,s),s&1&&ae(i,1)):(i=Vi(r),i.c(),ae(i,1),i.m(e.parentNode,e)):i&&(tn(),he(i,1,1,()=>{i=null}),nn())},i(r){n||(ae(i),n=!0)},o(r){he(i),n=!1},d(r){r&&q(e),i&&i.d(r)}}}function Ro(t,e,n){let{rowData:i}=e;console.log("ThumbLoader",i);let r,s,o,l=1;if(i.size_x&&i.size_y){let a=Math.max(i.size_x,i.size_y);for(o=0;a>1024;)o+=1,a=a/2;l=i.size_x/i.size_y}else o=void 0,l=1;return en(async()=>{let a=await jt(i.url);n(0,r=a[0]),n(1,s=a[1]),a[2]}),t.$$set=a=>{"rowData"in a&&n(4,i=a.rowData)},[r,s,o,l,i]}class Oo extends Ze{constructor(e){super(),Ye(this,e,Ro,To,je,{rowData:4})}}function Wi(t,e,n){const i=t.slice();return i[5]=e[n][0],i[6]=e[n][1],i}function Hi(t){let e,n;return e=new Oo({props:{rowData:t[1]}}),{c(){Je(e.$$.fragment)},m(i,r){qe(e,i,r),n=!0},p(i,r){const s={};r&2&&(s.rowData=i[1]),e.$set(s)},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){Ke(e,i)}}}function qi(t){let e,n,i=t[2]&&Hi(t);return{c(){i&&i.c(),e=$t()},m(r,s){i&&i.m(r,s),G(r,e,s),n=!0},p(r,s){r[2]?i?(i.p(r,s),s&4&&ae(i,1)):(i=Hi(r),i.c(),ae(i,1),i.m(e.parentNode,e)):i&&(tn(),he(i,1,1,()=>{i=null}),nn())},i(r){n||(ae(i),n=!0)},o(r){he(i),n=!1},d(r){r&&q(e),i&&i.d(r)}}}function Ki(t){let e,n=Pe(Object.entries(t[1])),i=[];for(let r=0;r<n.length;r+=1)i[r]=Gi(Wi(t,n,r));return{c(){e=E("table");for(let r=0;r<i.length;r+=1)i[r].c()},m(r,s){G(r,e,s);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(e,null)},p(r,s){if(s&2){n=Pe(Object.entries(r[1]));let o;for(o=0;o<n.length;o+=1){const l=Wi(r,n,o);i[o]?i[o].p(l,s):(i[o]=Gi(l),i[o].c(),i[o].m(e,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}},d(r){r&&q(e),It(i,r)}}}function Gi(t){let e,n,i=t[5]+"",r,s,o=t[6]+"",l;return{c(){e=E("tr"),n=E("td"),r=Y(i),s=E("td"),l=Y(o)},m(a,h){G(a,e,h),_(e,n),_(n,r),_(e,s),_(s,l)},p(a,h){h&2&&i!==(i=a[5]+"")&&Ie(r,i),h&2&&o!==(o=a[6]+"")&&Ie(l,o)},d(a){a&&q(e)}}}function Lo(t){let e,n,i,r,s=t[2],o,l,a,h,f=qi(t),p=t[1]&&Ki(t);return{c(){e=E("div"),n=E("button"),n.textContent="×",i=H(),r=E("div"),f.c(),o=H(),p&&p.c(),b(n,"class","close svelte-1g3sjso"),b(n,"title","Close"),b(r,"class","scrollable svelte-1g3sjso"),b(e,"id","mypopover"),b(e,"popover",""),b(e,"class","svelte-1g3sjso")},m(y,g){G(y,e,g),_(e,n),_(e,i),_(e,r),f.m(r,null),_(r,o),p&&p.m(r,null),t[4](e),l=!0,a||(h=pe(n,"click",t[3]),a=!0)},p(y,[g]){g&4&&je(s,s=y[2])?(tn(),he(f,1,1,we),nn(),f=qi(y),f.c(),ae(f,1),f.m(r,o)):f.p(y,g),y[1]?p?p.p(y,g):(p=Ki(y),p.c(),p.m(r,null)):p&&(p.d(1),p=null)},i(y){l||(ae(f),l=!0)},o(y){he(f),l=!1},d(y){y&&q(e),f.d(y),p&&p.d(),t[4](null),a=!1,h()}}}function Mo(t,e,n){let i,r,s;We.subscribeSelectedRow(a=>{console.log("Showing preview for",a),a&&(n(1,r=a),console.log("Showing Thumb preview for",a,r),n(2,s=r.url),i.showPopover())});function o(){i.hidePopover()}en(()=>{console.log("Mounted popover",i),i&&i.addEventListener("toggle",a=>{a.newState==="open"||(console.log("Popover has been hidden"),We.setSelectedRow(null))})});function l(a){ut[a?"unshift":"push"](()=>{i=a,n(0,i)})}return[i,r,s,o,l]}class Fo extends Ze{constructor(e){super(),Ye(this,e,Mo,Lo,je,{})}}const Do="/zowser/selectCaret.svg",No="/zowser/samples/sample_zarrs_hydrated.csv",Po="/zowser/ome-main-nav.svg";function Bo(t){let e,n,i,r,s,o,l,a,h,f,p,y,g;return{c(){e=E("base"),n=H(),i=E("nav"),r=E("a"),s=E("img"),l=H(),a=E("a"),h=E("h2"),h.textContent="Zowser — an OME-Zarr browser",f=H(),p=E("div"),y=H(),g=E("a"),g.textContent="About",b(e,"href",t[0]),b(s,"alt","OME Logo"),$e(s.src,o=Po)||b(s,"src",o),b(s,"class","svelte-1jru7l8"),b(r,"class","logolink svelte-1jru7l8"),b(r,"href",t[0]),b(h,"class","svelte-1jru7l8"),b(a,"href",t[0]),b(a,"class","svelte-1jru7l8"),le(p,"flex","1"),b(g,"href","about/"),b(g,"class","svelte-1jru7l8"),b(i,"class","svelte-1jru7l8")},m(d,k){G(d,e,k),G(d,n,k),G(d,i,k),_(i,r),_(r,s),_(i,l),_(i,a),_(a,h),_(i,f),_(i,p),_(i,y),_(i,g)},p:we,i:we,o:we,d(d){d&&(q(e),q(n),q(i))}}}function Uo(t){let e="/zowser/";return console.log("Nav base",e),[e]}class jo extends Ze{constructor(e){super(),Ye(this,e,Uo,Bo,je,{})}}function xo(t,e,n){const i=t.slice();return i[31]=e[n],i}function Ji(t,e,n){const i=t.slice();return i[34]=e[n],i}function Yi(t,e,n){const i=t.slice();return i[34]=e[n],i}function Zi(t,e,n){const i=t.slice();return i[31]=e[n],i}function Qi(t){let e,n=t[31]+"",i,r,s;return{c(){e=E("option"),i=Y(n),r=Y("D"),e.__value=s=t[31],Re(e,e.__value)},m(o,l){G(o,e,l),_(e,i),_(e,r)},p(o,l){l[0]&64&&n!==(n=o[31]+"")&&Ie(i,n),l[0]&64&&s!==(s=o[31])&&(e.__value=s,Re(e,e.__value))},d(o){o&&q(e)}}}function Xi(t){let e=t[13].includes(t[31]),n,i=e&&Qi(t);return{c(){i&&i.c(),n=$t()},m(r,s){i&&i.m(r,s),G(r,n,s)},p(r,s){s[0]&8256&&(e=r[13].includes(r[31])),e?i?i.p(r,s):(i=Qi(r),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(r){r&&q(n),i&&i.d(r)}}}function $i(t){let e,n=t[34]+"",i,r;return{c(){e=E("option"),i=Y(n),e.__value=r=t[1][t[34]],Re(e,e.__value)},m(s,o){G(s,e,o),_(e,i)},p(s,o){o[0]&4098&&n!==(n=s[34]+"")&&Ie(i,n),o[0]&4098&&r!==(r=s[1][s[34]])&&(e.__value=r,Re(e,e.__value))},d(s){s&&q(e)}}}function er(t,e){let n,i=e[34]+"",r,s;return{key:t,first:null,c(){n=E("option"),r=Y(i),n.__value=s=e[2][e[34]],Re(n,n.__value),this.first=n},m(o,l){G(o,n,l),_(n,r)},p(o,l){e=o,l[0]&2052&&i!==(i=e[34]+"")&&Ie(r,i),l[0]&2052&&s!==(s=e[2][e[34]])&&(n.__value=s,Re(n,n.__value))},d(o){o&&q(n)}}}function Vo(t){let e;return{c(){e=E("option"),e.textContent=`Size: ${t[31].toUpperCase()}`,e.__value="size_"+t[31],Re(e,e.__value)},m(n,i){G(n,e,i)},p:we,d(n){n&&q(e)}}}function Wo(t){let e,n,i,r,s,o,l,a,h=t[15].split("/").pop()+"",f,p,y=mn(t[8])+"",g,d,k,L,R,j,U,J,Z,B,w,u,c,v,C,S,M,N=t[3]!==""?"All Dimensions":"Dimension Count",O,D,m,A,T,V,ce,F,ee,I,x,te=t[4]==""?"Organism":"All Organisms",ne,ie,P,W,Q,ve,ue,be,$,re,Ae=t[5]==""?"Imaging Modality":"All Modalities",Se,xe,ke=[],Oe=new Map,fe,de,ze,oe,nt,Ve,et,Ge,Qe,Le,me,Xe,Me,Ot,tt,mt,pt,ti,on,ct,ni,bt,it,ii,ln=t[0].length+"",vn,ri,wn,si,oi,ft,Be,kn,li;e=new Fo({});let yt=Pe(t[6]),Fe=[];for(let z=0;z<yt.length;z+=1)Fe[z]=Xi(Zi(t,yt,z));let vt=Pe(Object.keys(t[1]).sort().filter(t[25])),De=[];for(let z=0;z<vt.length;z+=1)De[z]=$i(Yi(t,vt,z));let an=Pe(Object.keys(t[2]).sort().filter(t[27]));const ai=z=>z[34];for(let z=0;z<an.length;z+=1){let X=Ji(t,an,z),_e=ai(X);Oe.set(_e,ke[z]=er(_e,X))}let Ir=Pe(["x","y","z","c","t"]),Lt=[];for(let z=0;z<5;z+=1)Lt[z]=Vo(xo(t,Ir,z));return ct=new Ys({props:{toggleAscending:t[16],sortAscending:t[10]}}),ft=new zo({props:{tableRows:t[0],textFilter:t[14],sortedBy:t[9]}}),{c(){Je(e.$$.fragment),n=H(),i=E("main"),r=E("div"),s=E("h3"),o=E("div"),l=Y(`Showing Collection:
        `),a=E("a"),f=Y(h),p=Y(`
        (`),g=Y(y),d=Y(")"),k=H(),L=E("div"),R=E("input"),j=H(),U=E("button"),J=Y("×"),Z=H(),B=E("div"),w=E("div"),u=E("div"),c=E("div"),c.textContent="Filter by:",v=H(),C=E("div"),S=E("select"),M=E("option"),O=Y(N),D=H(),m=E("hr");for(let z=0;z<Fe.length;z+=1)Fe[z].c();A=H(),T=E("div"),V=E("button"),ce=Y("×"),F=H(),ee=E("div"),I=E("select"),x=E("option"),ne=Y(te),ie=E("hr");for(let z=0;z<De.length;z+=1)De[z].c();P=H(),W=E("div"),Q=E("button"),ve=Y("×"),ue=H(),be=E("div"),$=E("select"),re=E("option"),Se=Y(Ae),xe=E("hr");for(let z=0;z<ke.length;z+=1)ke[z].c();fe=H(),de=E("div"),ze=E("button"),oe=Y("×"),nt=H(),Ve=E("div"),et=H(),Ge=E("div"),Ge.textContent="Sort by:",Qe=H(),Le=E("div"),me=E("select"),Xe=E("option"),Xe.textContent="--",Me=E("hr");for(let z=0;z<5;z+=1)Lt[z].c();Ot=E("hr"),tt=E("option"),tt.textContent="Data Size (bytes)",mt=E("option"),mt.textContent="Chunk Size (pixels)",pt=E("option"),pt.textContent="Shard Size (pixels)",ti=H(),on=E("div"),Je(ct.$$.fragment),ni=H(),bt=E("div"),it=E("h3"),ii=Y("Showing "),vn=Y(ln),ri=Y(" out of "),wn=Y(t[7]),si=Y(" images"),oi=H(),Je(ft.$$.fragment),b(a,"href",t[15]),le(o,"font-size","90%"),le(s,"text-align","center"),b(R,"placeholder","Filter by Name or Description"),b(R,"name","textFilter"),b(R,"class","svelte-cmksur"),b(U,"title","Clear Filter"),le(U,"visibility",t[14]!==""?"visible":"hidden"),b(U,"class","svelte-cmksur"),b(L,"class","textInputWrapper svelte-cmksur"),b(r,"class","summary svelte-cmksur"),le(c,"white-space","nowrap"),M.__value="",Re(M,M.__value),b(S,"class","svelte-cmksur"),t[3]===void 0&&lt(()=>t[24].call(S)),b(V,"title","Clear Filter"),le(V,"visibility",t[3]!==""?"visible":"hidden"),b(V,"class","svelte-cmksur"),b(T,"class","svelte-cmksur"),b(C,"class","selectWrapper svelte-cmksur"),x.__value="",Re(x,x.__value),b(I,"class","svelte-cmksur"),t[4]===void 0&&lt(()=>t[26].call(I)),b(Q,"title","Clear Filter"),le(Q,"visibility",t[4]!==""?"visible":"hidden"),b(Q,"class","svelte-cmksur"),b(W,"class","svelte-cmksur"),b(ee,"class","selectWrapper svelte-cmksur"),re.__value="",Re(re,re.__value),b($,"class","svelte-cmksur"),t[5]===void 0&&lt(()=>t[28].call($)),b(ze,"title","Clear Filter"),le(ze,"visibility",t[5]!==""?"visible":"hidden"),b(ze,"class","svelte-cmksur"),b(de,"class","svelte-cmksur"),b(be,"class","selectWrapper svelte-cmksur"),b(Ve,"class","clear"),Xe.__value="",Re(Xe,Xe.__value),tt.__value="written",Re(tt,tt.__value),mt.__value="chunk_pixels",Re(mt,mt.__value),pt.__value="shard_pixels",Re(pt,pt.__value),b(me,"class","svelte-cmksur"),b(on,"class","svelte-cmksur"),b(Le,"class","selectWrapper svelte-cmksur"),b(u,"class","filters svelte-cmksur"),b(w,"class","sidebar svelte-cmksur"),le(it,"margin-left","15px"),b(it,"class","svelte-cmksur"),b(bt,"class","results svelte-cmksur"),b(B,"class","sidebarContainer svelte-cmksur"),le(i,"--form-select-bg-img","url('"+Do+"')"),b(i,"class","svelte-cmksur")},m(z,X){qe(e,z,X),G(z,n,X),G(z,i,X),_(i,r),_(r,s),_(s,o),_(o,l),_(o,a),_(a,f),_(o,p),_(o,g),_(o,d),_(r,k),_(r,L),_(L,R),Re(R,t[14]),_(L,j),_(L,U),_(U,J),_(i,Z),_(i,B),_(B,w),_(w,u),_(u,c),_(u,v),_(u,C),_(C,S),_(S,M),_(M,O),_(M,D),_(S,m);for(let _e=0;_e<Fe.length;_e+=1)Fe[_e]&&Fe[_e].m(S,null);wt(S,t[3],!0),_(C,A),_(C,T),_(T,V),_(V,ce),_(u,F),_(u,ee),_(ee,I),_(I,x),_(x,ne),_(I,ie);for(let _e=0;_e<De.length;_e+=1)De[_e]&&De[_e].m(I,null);wt(I,t[4],!0),_(ee,P),_(ee,W),_(W,Q),_(Q,ve),_(u,ue),_(u,be),_(be,$),_($,re),_(re,Se),_($,xe);for(let _e=0;_e<ke.length;_e+=1)ke[_e]&&ke[_e].m($,null);wt($,t[5],!0),_(be,fe),_(be,de),_(de,ze),_(ze,oe),_(u,nt),_(u,Ve),_(u,et),_(u,Ge),_(u,Qe),_(u,Le),_(Le,me),_(me,Xe),_(me,Me);for(let _e=0;_e<5;_e+=1)Lt[_e]&&Lt[_e].m(me,null);_(me,Ot),_(me,tt),_(me,mt),_(me,pt),_(Le,ti),_(Le,on),qe(ct,on,null),_(B,ni),_(B,bt),_(bt,it),_(it,ii),_(it,vn),_(it,ri),_(it,wn),_(it,si),_(bt,oi),qe(ft,bt,null),Be=!0,kn||(li=[pe(R,"input",t[23]),pe(R,"input",t[21]),pe(U,"click",t[21]),pe(S,"change",t[24]),pe(S,"change",t[18]),pe(V,"click",t[18]),pe(I,"change",t[26]),pe(I,"change",t[19]),pe(Q,"click",t[19]),pe($,"change",t[28]),pe($,"change",t[20]),pe(ze,"click",t[20]),pe(me,"change",t[17])],kn=!0)},p(z,X){if((!Be||X[0]&256)&&y!==(y=mn(z[8])+"")&&Ie(g,y),X[0]&16384&&R.value!==z[14]&&Re(R,z[14]),(!Be||X[0]&16384)&&le(U,"visibility",z[14]!==""?"visible":"hidden"),(!Be||X[0]&8)&&N!==(N=z[3]!==""?"All Dimensions":"Dimension Count")&&Ie(O,N),X[0]&8256){yt=Pe(z[6]);let ge;for(ge=0;ge<yt.length;ge+=1){const Mt=Zi(z,yt,ge);Fe[ge]?Fe[ge].p(Mt,X):(Fe[ge]=Xi(Mt),Fe[ge].c(),Fe[ge].m(S,null))}for(;ge<Fe.length;ge+=1)Fe[ge].d(1);Fe.length=yt.length}if(X[0]&72&&wt(S,z[3]),(!Be||X[0]&8)&&le(V,"visibility",z[3]!==""?"visible":"hidden"),(!Be||X[0]&16)&&te!==(te=z[4]==""?"Organism":"All Organisms")&&Ie(ne,te),X[0]&4098){vt=Pe(Object.keys(z[1]).sort().filter(z[25]));let ge;for(ge=0;ge<vt.length;ge+=1){const Mt=Yi(z,vt,ge);De[ge]?De[ge].p(Mt,X):(De[ge]=$i(Mt),De[ge].c(),De[ge].m(I,null))}for(;ge<De.length;ge+=1)De[ge].d(1);De.length=vt.length}X[0]&4114&&wt(I,z[4]),(!Be||X[0]&16)&&le(Q,"visibility",z[4]!==""?"visible":"hidden"),(!Be||X[0]&32)&&Ae!==(Ae=z[5]==""?"Imaging Modality":"All Modalities")&&Ie(Se,Ae),X[0]&2052&&(an=Pe(Object.keys(z[2]).sort().filter(z[27])),ke=ur(ke,X,ai,1,z,an,Oe,$,Pr,er,null,Ji)),X[0]&2084&&wt($,z[5]),(!Be||X[0]&32)&&le(ze,"visibility",z[5]!==""?"visible":"hidden");const _e={};X[0]&1024&&(_e.sortAscending=z[10]),ct.$set(_e),(!Be||X[0]&1)&&ln!==(ln=z[0].length+"")&&Ie(vn,ln),(!Be||X[0]&128)&&Ie(wn,z[7]);const un={};X[0]&1&&(un.tableRows=z[0]),X[0]&16384&&(un.textFilter=z[14]),X[0]&512&&(un.sortedBy=z[9]),ft.$set(un)},i(z){Be||(ae(e.$$.fragment,z),ae(ct.$$.fragment,z),ae(ft.$$.fragment,z),Be=!0)},o(z){he(e.$$.fragment,z),he(ct.$$.fragment,z),he(ft.$$.fragment,z),Be=!1},d(z){z&&(q(n),q(i)),Ke(e,z),It(Fe,z),It(De,z);for(let X=0;X<ke.length;X+=1)ke[X].d();It(Lt,z),Ke(ct),Ke(ft),kn=!1,st(li)}}}function Ho(t,e,n){let i,r,s,o,l,a,h,f,p,y=No,g=[],d=0,k=0,L={},R={};We.subscribe(m=>{n(0,g=B(m)),n(7,d=m.length),n(8,k=m.reduce((A,T)=>A+parseInt(T.written)||0,0))}),_r.subscribe(m=>{let A={};for(const[T,V]of Object.entries(m))A[V]=T;n(1,L=A)}),gr.subscribe(m=>{let A={};for(const[T,V]of Object.entries(m))A[V]=T;n(2,R=A)}),hr(y,We);let j="",U=!1;function J(){n(10,U=!U),We.sortTable(j,U)}function Z(m){n(9,j=m.target.value),j===""?We.sortTable("index",!0):We.sortTable(j,U)}function B(m){if(i!==""&&(m=m.filter(A=>A.dim_count==i)),r!==""&&(m=m.filter(A=>A.organismId==r)),s!=""&&(m=m.filter(A=>A.fbbiId==s)),o&&o!=""){let A=o.toLowerCase();m=m.filter(T=>{var V,ce;return T.url.toLowerCase().includes(A)||((V=T.description)==null?void 0:V.toLowerCase().includes(A))||((ce=T.name)==null?void 0:ce.toLowerCase().includes(A))})}return m}function w(m){n(3,i=m.target.value||""),n(0,g=B(We.getRows()))}function u(m){n(4,r=m.target.value||""),n(0,g=B(We.getRows()))}function c(m){n(5,s=m.target.value||""),n(0,g=B(We.getRows()))}function v(m){n(14,o=m.target.value),n(0,g=B(We.getRows()))}function C(){o=this.value,n(14,o)}function S(){i=In(this),n(3,i),n(6,a),n(22,l)}const M=m=>f.includes(L[m]);function N(){r=In(this),n(4,r),n(1,L),n(12,f),n(22,l),n(1,L),n(5,s),n(3,i)}const O=m=>p.includes(R[m]);function D(){s=In(this),n(5,s),n(2,R),n(11,p),n(22,l),n(2,R),n(4,r),n(3,i)}return t.$$.update=()=>{t.$$.dirty[0]&1&&g.some(m=>m.source),t.$$.dirty[0]&4194304&&n(6,a=Array.from(new Set(l.map(m=>String(m.dim_count)).filter(Boolean))).sort()),t.$$.dirty[0]&4194416&&n(13,h=l.length===0?a:Array.from(new Set(l.filter(m=>(r?m.organismId===r:!0)&&(s?m.fbbiId===s:!0)).map(m=>String(m.dim_count)).filter(Boolean))).sort()),t.$$.dirty[0]&4194346&&n(12,f=l.length===0?Object.values(L):Array.from(new Set(l.filter(m=>(s?m.fbbiId===s:!0)&&(i?String(m.dim_count)===i:!0)).map(m=>m.organismId).filter(Boolean)))),t.$$.dirty[0]&4194332&&n(11,p=l.length===0?Object.values(R):Array.from(new Set(l.filter(m=>(r?m.organismId===r:!0)&&(i?String(m.dim_count)===i:!0)).map(m=>m.fbbiId).filter(Boolean))))},n(3,i=""),n(4,r=""),n(5,s=""),n(14,o=""),n(22,l=We.getRows()),[g,L,R,i,r,s,a,d,k,j,U,p,f,h,o,y,J,Z,w,u,c,v,l,C,S,M,N,O,D]}class qo extends Ze{constructor(e){super(),Ye(this,e,Ho,Wo,je,{},null,[-1,-1])}}const Ko="/zowser/nfdi_rgb_Wortmarke_Zusatz_quer.png",Go="/zowser/czi-logo-chan-zuckerberg-initiative-logo.png";function Jo(t){let e,n,i;return{c(){e=E("base"),n=H(),i=E("div"),i.innerHTML=`<h2>Introduction</h2> <p>Zowser is an OME-Zarr browser based on the <a href="https://forum.image.sc/t/ome2024-ngff-challenge/97363">2024 OME-NGFF Challenge</a>, conceived at the
    <a href="https://www.openmicroscopy.org/events/ome-community-meeting-2024/">OME Annual Community Meeting</a>
    in Dundee in May 2024.</p> <h2>Acknowledgements</h2> <p>Coordination of the challenge was supported by the <a href="https://www.nfdi.de/">German National Research Data Initiative (NFDI)</a>
    and the
    <a href="https://chanzuckerberg.com/">Chan Zuckerberg Initiative</a>:</p> <table><tr><td><img src="${Ko}" alt="NFDI Logo" width="45%"/></td> <td><img src="${Go}" alt="Chan Zuckerberg Initiative Logo" width="45%"/></td></tr></table>`,b(e,"href",t[0]),b(i,"class","svelte-zlrnwt")},m(r,s){G(r,e,s),G(r,n,s),G(r,i,s)},p:we,i:we,o:we,d(r){r&&(q(e),q(n),q(i))}}}function Yo(t){return["/zowser/"]}class Zo extends Ze{constructor(e){super(),Ye(this,e,Yo,Jo,je,{})}}function Qo(t){let e,n;return e=new qo({}),{c(){Je(e.$$.fragment)},m(i,r){qe(e,i,r),n=!0},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){Ke(e,i)}}}function Xo(t){let e,n;return e=new Zo({}),{c(){Je(e.$$.fragment)},m(i,r){qe(e,i,r),n=!0},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){he(e.$$.fragment,i),n=!1},d(i){Ke(e,i)}}}function $o(t){let e,n,i,r,s,o;n=new jo({});const l=[Xo,Qo],a=[];function h(f,p){return f[0].endsWith("/about/")?0:1}return r=h(t),s=a[r]=l[r](t),{c(){e=E("div"),Je(n.$$.fragment),i=H(),s.c(),b(e,"class","app svelte-1mc4mod")},m(f,p){G(f,e,p),qe(n,e,null),_(e,i),a[r].m(e,null),o=!0},p:we,i(f){o||(ae(n.$$.fragment,f),ae(s),o=!0)},o(f){he(n.$$.fragment,f),he(s),o=!1},d(f){f&&q(e),Ke(n),a[r].d()}}}function el(t){return[window.location.pathname]}class tl extends Ze{constructor(e){super(),Ye(this,e,el,$o,je,{})}}new tl({target:document.getElementById("app")});
