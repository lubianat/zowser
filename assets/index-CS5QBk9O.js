const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/blosc-E49GQuAK.js","assets/chunk-INHXZS53-D3tQiqtZ.js","assets/gzip-CF-9a_hd.js","assets/browser-B-ZyVB-j.js","assets/lz4-BIGKWw27.js","assets/zlib-CBiqHlio.js","assets/zstd-IvP746pw.js"])))=>i.map(i=>d[i]);
var gr=Object.defineProperty;var oi=t=>{throw TypeError(t)};var mr=(t,e,n)=>e in t?gr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ne=(t,e,n)=>mr(t,typeof e!="symbol"?e+"":e,n),pn=(t,e,n)=>e.has(t)||oi("Cannot "+n);var G=(t,e,n)=>(pn(t,e,"read from private field"),n?n.call(t):e.get(t)),Ce=(t,e,n)=>e.has(t)?oi("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),pe=(t,e,n,i)=>(pn(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),bn=(t,e,n)=>(pn(t,e,"access private method"),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function ye(){}function pr(t,e){for(const n in e)t[n]=e[n];return t}function Zi(t){return t()}function li(){return Object.create(null)}function nt(t){t.forEach(Zi)}function Qi(t){return typeof t=="function"}function Pe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let tn;function Dn(t,e){return t===e?!0:(tn||(tn=document.createElement("a")),tn.href=e,t===tn.href)}function br(t){return Object.keys(t).length===0}function yr(t,...e){if(t==null){for(const i of e)i(void 0);return ye}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function rn(t){let e;return yr(t,n=>e=n)(),e}function kn(t,e,n,i){if(t){const r=Xi(t,e,n,i);return t[0](r)}}function Xi(t,e,n,i){return t[1]&&i?pr(n.ctx.slice(),t[1](i(e))):n.ctx}function En(t,e,n,i){if(t[2]&&i){const r=t[2](i(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],o=Math.max(e.dirty.length,r.length);for(let a=0;a<o;a+=1)s[a]=e.dirty[a]|r[a];return s}return e.dirty|r}return e.dirty}function Cn(t,e,n,i,r,s){if(r){const o=Xi(e,n,i,s);t.p(o,r)}}function An(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let i=0;i<n;i++)e[i]=-1;return e}return-1}function ai(t){return t??""}function d(t,e){t.appendChild(e)}function Z(t,e,n){t.insertBefore(e,n||null)}function J(t){t.parentNode&&t.parentNode.removeChild(t)}function an(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function k(t){return document.createElement(t)}function Y(t){return document.createTextNode(t)}function H(){return Y(" ")}function hn(){return Y("")}function we(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function v(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function vr(t){return Array.from(t.childNodes)}function Re(t,e){e=""+e,t.data!==e&&(t.data=e)}function Ae(t,e){t.value=e??""}function ee(t,e,n,i){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}function yt(t,e,n){for(let i=0;i<t.options.length;i+=1){const r=t.options[i];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function yn(t){const e=t.querySelector(":checked");return e&&e.__value}function je(t,e,n){t.classList.toggle(e,!!n)}function wr(t,e,{bubbles:n=!1,cancelable:i=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:i})}let Lt;function Ot(t){Lt=t}function Nn(){if(!Lt)throw new Error("Function called outside component initialization");return Lt}function Kt(t){Nn().$$.on_mount.push(t)}function Pn(t){Nn().$$.on_destroy.push(t)}function kr(){const t=Nn();return(e,n,{cancelable:i=!1}={})=>{const r=t.$$.callbacks[e];if(r){const s=wr(e,n,{cancelable:i});return r.slice().forEach(o=>{o.call(t,s)}),!s.defaultPrevented}return!0}}const kt=[],ht=[];let Et=[];const ui=[],$i=Promise.resolve();let Sn=!1;function er(){Sn||(Sn=!0,$i.then(Le))}function Er(){return er(),$i}function rt(t){Et.push(t)}const vn=new Set;let vt=0;function Le(){if(vt!==0)return;const t=Lt;do{try{for(;vt<kt.length;){const e=kt[vt];vt++,Ot(e),Cr(e.$$)}}catch(e){throw kt.length=0,vt=0,e}for(Ot(null),kt.length=0,vt=0;ht.length;)ht.pop()();for(let e=0;e<Et.length;e+=1){const n=Et[e];vn.has(n)||(vn.add(n),n())}Et.length=0}while(kt.length);for(;ui.length;)ui.pop()();Sn=!1,vn.clear(),Ot(t)}function Cr(t){if(t.fragment!==null){t.update(),nt(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(rt)}}function Ar(t){const e=[],n=[];Et.forEach(i=>t.indexOf(i)===-1?e.push(i):n.push(i)),n.forEach(i=>i()),Et=e}const sn=new Set;let ut;function Gt(){ut={r:0,c:[],p:ut}}function Jt(){ut.r||nt(ut.c),ut=ut.p}function ae(t,e){t&&t.i&&(sn.delete(t),t.i(e))}function de(t,e,n,i){if(t&&t.o){if(sn.has(t))return;sn.add(t),ut.c.push(()=>{sn.delete(t),i&&(n&&t.d(1),i())}),t.o(e)}else i&&i()}function Ge(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Sr(t,e){t.d(1),e.delete(t.key)}function Ir(t,e){de(t,1,1,()=>{e.delete(t.key)})}function tr(t,e,n,i,r,s,o,a,l,h,f,p){let b=t.length,g=s.length,m=b;const E={};for(;m--;)E[t[m].key]=m;const M=[],A=new Map,P=new Map,B=[];for(m=g;m--;){const y=p(r,s,m),c=n(y);let u=o.get(c);u?B.push(()=>u.p(y,e)):(u=h(c,y),u.c()),A.set(c,M[m]=u),c in E&&P.set(c,Math.abs(m-E[c]))}const Q=new Set,W=new Set;function q(y){ae(y,1),y.m(a,f),o.set(y.key,y),f=y.first,g--}for(;b&&g;){const y=M[g-1],c=t[b-1],u=y.key,_=c.key;y===c?(f=y.first,b--,g--):A.has(_)?!o.has(u)||Q.has(u)?q(y):W.has(_)?b--:P.get(u)>P.get(_)?(W.add(u),q(y)):(Q.add(_),b--):(l(c,o),b--)}for(;b--;){const y=t[b];A.has(y.key)||l(y,o)}for(;g;)q(M[g-1]);return nt(B),M}function Je(t){t&&t.c()}function We(t,e,n){const{fragment:i,after_update:r}=t.$$;i&&i.m(e,n),rt(()=>{const s=t.$$.on_mount.map(Zi).filter(Qi);t.$$.on_destroy?t.$$.on_destroy.push(...s):nt(s),t.$$.on_mount=[]}),r.forEach(rt)}function qe(t,e){const n=t.$$;n.fragment!==null&&(Ar(n.after_update),nt(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Tr(t,e){t.$$.dirty[0]===-1&&(kt.push(t),er(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Ye(t,e,n,i,r,s,o=null,a=[-1]){const l=Lt;Ot(t);const h=t.$$={fragment:null,ctx:[],props:s,update:ye,not_equal:r,bound:li(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:li(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(h.root);let f=!1;if(h.ctx=n?n(t,e.props||{},(p,b,...g)=>{const m=g.length?g[0]:b;return h.ctx&&r(h.ctx[p],h.ctx[p]=m)&&(!h.skip_bound&&h.bound[p]&&h.bound[p](m),f&&Tr(t,p)),b}):[],h.update(),f=!0,nt(h.before_update),h.fragment=i?i(h.ctx):!1,e.target){if(e.hydrate){const p=vr(e.target);h.fragment&&h.fragment.l(p),p.forEach(J)}else h.fragment&&h.fragment.c();e.intro&&ae(t.$$.fragment),We(t,e.target,e.anchor),Le()}Ot(l)}class Ze{constructor(){ne(this,"$$");ne(this,"$$set")}$destroy(){qe(this,1),this.$destroy=ye}$on(e,n){if(!Qi(n))return ye;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(e){this.$$set&&!br(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const zr="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(zr);const wt=[];function In(t,e=ye){let n;const i=new Set;function r(a){if(Pe(t,a)&&(t=a,n)){const l=!wt.length;for(const h of i)h[1](),wt.push(h,t);if(l){for(let h=0;h<wt.length;h+=2)wt[h][0](wt[h+1]);wt.length=0}}}function s(a){r(a(t))}function o(a,l=ye){const h=[a,l];return i.add(h),i.size===1&&(n=e(r,s)||ye),a(t),()=>{i.delete(h),i.size===0&&n&&(n(),n=null)}}return{set:r,update:s,subscribe:o}}var Rr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Or(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var nr={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){(function(n,i){t.exports=i()})(Rr,function n(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},r=!i.document&&!!i.postMessage,s=i.IS_PAPA_WORKER||!1,o={},a=0,l={parse:function(c,u){var _=(u=u||{}).dynamicTyping||!1;if(y(_)&&(u.dynamicTypingFunction=_,_={}),u.dynamicTyping=_,u.transform=!!y(u.transform)&&u.transform,u.worker&&l.WORKERS_SUPPORTED){var w=function(){if(!l.WORKERS_SUPPORTED)return!1;var L=(oe=i.URL||i.webkitURL||null,te=n.toString(),l.BLOB_URL||(l.BLOB_URL=oe.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",te,")();"],{type:"text/javascript"})))),N=new i.Worker(L),oe,te;return N.onmessage=P,N.id=a++,o[N.id]=N}();return w.userStep=u.step,w.userChunk=u.chunk,w.userComplete=u.complete,w.userError=u.error,u.step=y(u.step),u.chunk=y(u.chunk),u.complete=y(u.complete),u.error=y(u.error),delete u.worker,void w.postMessage({input:c,config:u,workerId:w.id})}var S=null;return l.NODE_STREAM_INPUT,typeof c=="string"?(c=function(L){return L.charCodeAt(0)===65279?L.slice(1):L}(c),S=u.download?new p(u):new g(u)):c.readable===!0&&y(c.read)&&y(c.on)?S=new m(u):(i.File&&c instanceof File||c instanceof Object)&&(S=new b(u)),S.stream(c)},unparse:function(c,u){var _=!1,w=!0,S=",",L=`\r
`,N='"',oe=N+N,te=!1,T=null,U=!1;(function(){if(typeof u=="object"){if(typeof u.delimiter!="string"||l.BAD_DELIMITERS.filter(function(R){return u.delimiter.indexOf(R)!==-1}).length||(S=u.delimiter),(typeof u.quotes=="boolean"||typeof u.quotes=="function"||Array.isArray(u.quotes))&&(_=u.quotes),typeof u.skipEmptyLines!="boolean"&&typeof u.skipEmptyLines!="string"||(te=u.skipEmptyLines),typeof u.newline=="string"&&(L=u.newline),typeof u.quoteChar=="string"&&(N=u.quoteChar),typeof u.header=="boolean"&&(w=u.header),Array.isArray(u.columns)){if(u.columns.length===0)throw new Error("Option columns is empty");T=u.columns}u.escapeChar!==void 0&&(oe=u.escapeChar+N),(typeof u.escapeFormulae=="boolean"||u.escapeFormulae instanceof RegExp)&&(U=u.escapeFormulae instanceof RegExp?u.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var z=new RegExp(M(N),"g");if(typeof c=="string"&&(c=JSON.parse(c)),Array.isArray(c)){if(!c.length||Array.isArray(c[0]))return _e(null,c,te);if(typeof c[0]=="object")return _e(T||Object.keys(c[0]),c,te)}else if(typeof c=="object")return typeof c.data=="string"&&(c.data=JSON.parse(c.data)),Array.isArray(c.data)&&(c.fields||(c.fields=c.meta&&c.meta.fields||T),c.fields||(c.fields=Array.isArray(c.data[0])?c.fields:typeof c.data[0]=="object"?Object.keys(c.data[0]):[]),Array.isArray(c.data[0])||typeof c.data[0]=="object"||(c.data=[c.data])),_e(c.fields||[],c.data||[],te);throw new Error("Unable to serialize unrecognized input");function _e(R,V,I){var C="";typeof R=="string"&&(R=JSON.parse(R)),typeof V=="string"&&(V=JSON.parse(V));var x=Array.isArray(R)&&0<R.length,F=!Array.isArray(V[0]);if(x&&w){for(var K=0;K<R.length;K++)0<K&&(C+=S),C+=X(R[K],K);0<V.length&&(C+=L)}for(var D=0;D<V.length;D++){var j=x?R.length:V[D].length,le=!1,me=x?Object.keys(V[D]).length===0:V[D].length===0;if(I&&!x&&(le=I==="greedy"?V[D].join("").trim()==="":V[D].length===1&&V[D][0].length===0),I==="greedy"&&x){for(var ie=[],fe=0;fe<j;fe++){var ge=F?R[fe]:fe;ie.push(V[D][ge])}le=ie.join("").trim()===""}if(!le){for(var ue=0;ue<j;ue++){0<ue&&!me&&(C+=S);var ke=x&&F?R[ue]:ue;C+=X(V[D][ke],ue)}D<V.length-1&&(!I||0<j&&!me)&&(C+=L)}}return C}function X(R,V){if(R==null)return"";if(R.constructor===Date)return JSON.stringify(R).slice(1,25);var I=!1;U&&typeof R=="string"&&U.test(R)&&(R="'"+R,I=!0);var C=R.toString().replace(z,oe);return(I=I||_===!0||typeof _=="function"&&_(R,V)||Array.isArray(_)&&_[V]||function(x,F){for(var K=0;K<F.length;K++)if(-1<x.indexOf(F[K]))return!0;return!1}(C,l.BAD_DELIMITERS)||-1<C.indexOf(S)||C.charAt(0)===" "||C.charAt(C.length-1)===" ")?N+C+N:C}}};if(l.RECORD_SEP="",l.UNIT_SEP="",l.BYTE_ORDER_MARK="\uFEFF",l.BAD_DELIMITERS=["\r",`
`,'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!r&&!!i.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=A,l.ParserHandle=E,l.NetworkStreamer=p,l.FileStreamer=b,l.StringStreamer=g,l.ReadableStreamStreamer=m,i.jQuery){var h=i.jQuery;h.fn.parse=function(c){var u=c.config||{},_=[];return this.each(function(L){if(!(h(this).prop("tagName").toUpperCase()==="INPUT"&&h(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var N=0;N<this.files.length;N++)_.push({file:this.files[N],inputElem:this,instanceConfig:h.extend({},u)})}),w(),this;function w(){if(_.length!==0){var L,N,oe,te,T=_[0];if(y(c.before)){var U=c.before(T.file,T.inputElem);if(typeof U=="object"){if(U.action==="abort")return L="AbortError",N=T.file,oe=T.inputElem,te=U.reason,void(y(c.error)&&c.error({name:L},N,oe,te));if(U.action==="skip")return void S();typeof U.config=="object"&&(T.instanceConfig=h.extend(T.instanceConfig,U.config))}else if(U==="skip")return void S()}var z=T.instanceConfig.complete;T.instanceConfig.complete=function(_e){y(z)&&z(_e,T.file,T.inputElem),S()},l.parse(T.file,T.instanceConfig)}else y(c.complete)&&c.complete()}function S(){_.splice(0,1),w()}}}function f(c){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(u){var _=W(u);_.chunkSize=parseInt(_.chunkSize),u.step||u.chunk||(_.chunkSize=null),this._handle=new E(_),(this._handle.streamer=this)._config=_}).call(this,c),this.parseChunk=function(u,_){if(this.isFirstChunk&&y(this._config.beforeFirstChunk)){var w=this._config.beforeFirstChunk(u);w!==void 0&&(u=w)}this.isFirstChunk=!1,this._halted=!1;var S=this._partialLine+u;this._partialLine="";var L=this._handle.parse(S,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var N=L.meta.cursor;this._finished||(this._partialLine=S.substring(N-this._baseIndex),this._baseIndex=N),L&&L.data&&(this._rowCount+=L.data.length);var oe=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)i.postMessage({results:L,workerId:l.WORKER_ID,finished:oe});else if(y(this._config.chunk)&&!_){if(this._config.chunk(L,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);L=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(L.data),this._completeResults.errors=this._completeResults.errors.concat(L.errors),this._completeResults.meta=L.meta),this._completed||!oe||!y(this._config.complete)||L&&L.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),oe||L&&L.meta.paused||this._nextChunk(),L}this._halted=!0},this._sendError=function(u){y(this._config.error)?this._config.error(u):s&&this._config.error&&i.postMessage({workerId:l.WORKER_ID,error:u,finished:!1})}}function p(c){var u;(c=c||{}).chunkSize||(c.chunkSize=l.RemoteChunkSize),f.call(this,c),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(_){this._input=_,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(u=new XMLHttpRequest,this._config.withCredentials&&(u.withCredentials=this._config.withCredentials),r||(u.onload=q(this._chunkLoaded,this),u.onerror=q(this._chunkError,this)),u.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var _=this._config.downloadRequestHeaders;for(var w in _)u.setRequestHeader(w,_[w])}if(this._config.chunkSize){var S=this._start+this._config.chunkSize-1;u.setRequestHeader("Range","bytes="+this._start+"-"+S)}try{u.send(this._config.downloadRequestBody)}catch(L){this._chunkError(L.message)}r&&u.status===0&&this._chunkError()}},this._chunkLoaded=function(){u.readyState===4&&(u.status<200||400<=u.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:u.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(_){var w=_.getResponseHeader("Content-Range");return w===null?-1:parseInt(w.substring(w.lastIndexOf("/")+1))}(u),this.parseChunk(u.responseText)))},this._chunkError=function(_){var w=u.statusText||_;this._sendError(new Error(w))}}function b(c){var u,_;(c=c||{}).chunkSize||(c.chunkSize=l.LocalChunkSize),f.call(this,c);var w=typeof FileReader<"u";this.stream=function(S){this._input=S,_=S.slice||S.webkitSlice||S.mozSlice,w?((u=new FileReader).onload=q(this._chunkLoaded,this),u.onerror=q(this._chunkError,this)):u=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var S=this._input;if(this._config.chunkSize){var L=Math.min(this._start+this._config.chunkSize,this._input.size);S=_.call(S,this._start,L)}var N=u.readAsText(S,this._config.encoding);w||this._chunkLoaded({target:{result:N}})},this._chunkLoaded=function(S){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(S.target.result)},this._chunkError=function(){this._sendError(u.error)}}function g(c){var u;f.call(this,c=c||{}),this.stream=function(_){return u=_,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var _,w=this._config.chunkSize;return w?(_=u.substring(0,w),u=u.substring(w)):(_=u,u=""),this._finished=!u,this.parseChunk(_)}}}function m(c){f.call(this,c=c||{});var u=[],_=!0,w=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(S){this._input=S,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){w&&u.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),u.length?this.parseChunk(u.shift()):_=!0},this._streamData=q(function(S){try{u.push(typeof S=="string"?S:S.toString(this._config.encoding)),_&&(_=!1,this._checkIsFinished(),this.parseChunk(u.shift()))}catch(L){this._streamError(L)}},this),this._streamError=q(function(S){this._streamCleanUp(),this._sendError(S)},this),this._streamEnd=q(function(){this._streamCleanUp(),w=!0,this._streamData("")},this),this._streamCleanUp=q(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function E(c){var u,_,w,S=Math.pow(2,53),L=-S,N=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,oe=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,te=this,T=0,U=0,z=!1,_e=!1,X=[],R={data:[],errors:[],meta:{}};if(y(c.step)){var V=c.step;c.step=function(D){if(R=D,x())C();else{if(C(),R.data.length===0)return;T+=D.data.length,c.preview&&T>c.preview?_.abort():(R.data=R.data[0],V(R,te))}}}function I(D){return c.skipEmptyLines==="greedy"?D.join("").trim()==="":D.length===1&&D[0].length===0}function C(){return R&&w&&(K("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),w=!1),c.skipEmptyLines&&(R.data=R.data.filter(function(D){return!I(D)})),x()&&function(){if(!R)return;function D(le,me){y(c.transformHeader)&&(le=c.transformHeader(le,me)),X.push(le)}if(Array.isArray(R.data[0])){for(var j=0;x()&&j<R.data.length;j++)R.data[j].forEach(D);R.data.splice(0,1)}else R.data.forEach(D)}(),function(){if(!R||!c.header&&!c.dynamicTyping&&!c.transform)return R;function D(le,me){var ie,fe=c.header?{}:[];for(ie=0;ie<le.length;ie++){var ge=ie,ue=le[ie];c.header&&(ge=ie>=X.length?"__parsed_extra":X[ie]),c.transform&&(ue=c.transform(ue,ge)),ue=F(ge,ue),ge==="__parsed_extra"?(fe[ge]=fe[ge]||[],fe[ge].push(ue)):fe[ge]=ue}return c.header&&(ie>X.length?K("FieldMismatch","TooManyFields","Too many fields: expected "+X.length+" fields but parsed "+ie,U+me):ie<X.length&&K("FieldMismatch","TooFewFields","Too few fields: expected "+X.length+" fields but parsed "+ie,U+me)),fe}var j=1;return!R.data.length||Array.isArray(R.data[0])?(R.data=R.data.map(D),j=R.data.length):R.data=D(R.data,0),c.header&&R.meta&&(R.meta.fields=X),U+=j,R}()}function x(){return c.header&&X.length===0}function F(D,j){return le=D,c.dynamicTypingFunction&&c.dynamicTyping[le]===void 0&&(c.dynamicTyping[le]=c.dynamicTypingFunction(le)),(c.dynamicTyping[le]||c.dynamicTyping)===!0?j==="true"||j==="TRUE"||j!=="false"&&j!=="FALSE"&&(function(me){if(N.test(me)){var ie=parseFloat(me);if(L<ie&&ie<S)return!0}return!1}(j)?parseFloat(j):oe.test(j)?new Date(j):j===""?null:j):j;var le}function K(D,j,le,me){var ie={type:D,code:j,message:le};me!==void 0&&(ie.row=me),R.errors.push(ie)}this.parse=function(D,j,le){var me=c.quoteChar||'"';if(c.newline||(c.newline=function(ge,ue){ge=ge.substring(0,1048576);var ke=new RegExp(M(ue)+"([^]*?)"+M(ue),"gm"),he=(ge=ge.replace(ke,"")).split("\r"),Se=ge.split(`
`),Me=1<Se.length&&Se[0].length<he[0].length;if(he.length===1||Me)return`
`;for(var Ie=0,ce=0;ce<he.length;ce++)he[ce][0]===`
`&&Ie++;return Ie>=he.length/2?`\r
`:"\r"}(D,me)),w=!1,c.delimiter)y(c.delimiter)&&(c.delimiter=c.delimiter(D),R.meta.delimiter=c.delimiter);else{var ie=function(ge,ue,ke,he,Se){var Me,Ie,ce,re;Se=Se||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var Qe=0;Qe<Se.length;Qe++){var se=Se[Qe],He=0,Ee=0,Xe=0;ce=void 0;for(var Ve=new A({comments:he,delimiter:se,newline:ue,preview:10}).parse(ge),xe=0;xe<Ve.data.length;xe++)if(ke&&I(Ve.data[xe]))Xe++;else{var Ke=Ve.data[xe].length;Ee+=Ke,ce!==void 0?0<Ke&&(He+=Math.abs(Ke-ce),ce=Ke):ce=Ke}0<Ve.data.length&&(Ee/=Ve.data.length-Xe),(Ie===void 0||He<=Ie)&&(re===void 0||re<Ee)&&1.99<Ee&&(Ie=He,Me=se,re=Ee)}return{successful:!!(c.delimiter=Me),bestDelimiter:Me}}(D,c.newline,c.skipEmptyLines,c.comments,c.delimitersToGuess);ie.successful?c.delimiter=ie.bestDelimiter:(w=!0,c.delimiter=l.DefaultDelimiter),R.meta.delimiter=c.delimiter}var fe=W(c);return c.preview&&c.header&&fe.preview++,u=D,_=new A(fe),R=_.parse(u,j,le),C(),z?{meta:{paused:!0}}:R||{meta:{paused:!1}}},this.paused=function(){return z},this.pause=function(){z=!0,_.abort(),u=y(c.chunk)?"":u.substring(_.getCharIndex())},this.resume=function(){te.streamer._halted?(z=!1,te.streamer.parseChunk(u,!0)):setTimeout(te.resume,3)},this.aborted=function(){return _e},this.abort=function(){_e=!0,_.abort(),R.meta.aborted=!0,y(c.complete)&&c.complete(R),u=""}}function M(c){return c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function A(c){var u,_=(c=c||{}).delimiter,w=c.newline,S=c.comments,L=c.step,N=c.preview,oe=c.fastMode,te=u=c.quoteChar===void 0||c.quoteChar===null?'"':c.quoteChar;if(c.escapeChar!==void 0&&(te=c.escapeChar),(typeof _!="string"||-1<l.BAD_DELIMITERS.indexOf(_))&&(_=","),S===_)throw new Error("Comment character same as delimiter");S===!0?S="#":(typeof S!="string"||-1<l.BAD_DELIMITERS.indexOf(S))&&(S=!1),w!==`
`&&w!=="\r"&&w!==`\r
`&&(w=`
`);var T=0,U=!1;this.parse=function(z,_e,X){if(typeof z!="string")throw new Error("Input must be a string");var R=z.length,V=_.length,I=w.length,C=S.length,x=y(L),F=[],K=[],D=[],j=T=0;if(!z)return Te();if(c.header&&!_e){var le=z.split(w)[0].split(_),me=[],ie={},fe=!1;for(var ge in le){var ue=le[ge];y(c.transformHeader)&&(ue=c.transformHeader(ue,ge));var ke=ue,he=ie[ue]||0;for(0<he&&(fe=!0,ke=ue+"_"+he),ie[ue]=he+1;me.includes(ke);)ke=ke+"_"+he;me.push(ke)}if(fe){var Se=z.split(w);Se[0]=me.join(_),z=Se.join(w)}}if(oe||oe!==!1&&z.indexOf(u)===-1){for(var Me=z.split(w),Ie=0;Ie<Me.length;Ie++){if(D=Me[Ie],T+=D.length,Ie!==Me.length-1)T+=w.length;else if(X)return Te();if(!S||D.substring(0,C)!==S){if(x){if(F=[],Xe(D.split(_)),ot(),U)return Te()}else Xe(D.split(_));if(N&&N<=Ie)return F=F.slice(0,N),Te(!0)}}return Te()}for(var ce=z.indexOf(_,T),re=z.indexOf(w,T),Qe=new RegExp(M(te)+M(u),"g"),se=z.indexOf(u,T);;)if(z[T]!==u)if(S&&D.length===0&&z.substring(T,T+C)===S){if(re===-1)return Te();T=re+I,re=z.indexOf(w,T),ce=z.indexOf(_,T)}else if(ce!==-1&&(ce<re||re===-1))D.push(z.substring(T,ce)),T=ce+V,ce=z.indexOf(_,T);else{if(re===-1)break;if(D.push(z.substring(T,re)),Ke(re+I),x&&(ot(),U))return Te();if(N&&F.length>=N)return Te(!0)}else for(se=T,T++;;){if((se=z.indexOf(u,se+1))===-1)return X||K.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:F.length,index:T}),xe();if(se===R-1)return xe(z.substring(T,se).replace(Qe,u));if(u!==te||z[se+1]!==te){if(u===te||se===0||z[se-1]!==te){ce!==-1&&ce<se+1&&(ce=z.indexOf(_,se+1)),re!==-1&&re<se+1&&(re=z.indexOf(w,se+1));var He=Ve(re===-1?ce:Math.min(ce,re));if(z.substr(se+1+He,V)===_){D.push(z.substring(T,se).replace(Qe,u)),z[T=se+1+He+V]!==u&&(se=z.indexOf(u,T)),ce=z.indexOf(_,T),re=z.indexOf(w,T);break}var Ee=Ve(re);if(z.substring(se+1+Ee,se+1+Ee+I)===w){if(D.push(z.substring(T,se).replace(Qe,u)),Ke(se+1+Ee+I),ce=z.indexOf(_,T),se=z.indexOf(u,T),x&&(ot(),U))return Te();if(N&&F.length>=N)return Te(!0);break}K.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:F.length,index:T}),se++}}else se++}return xe();function Xe(ve){F.push(ve),j=T}function Ve(ve){var Fe=0;if(ve!==-1){var $e=z.substring(se+1,ve);$e&&$e.trim()===""&&(Fe=$e.length)}return Fe}function xe(ve){return X||(ve===void 0&&(ve=z.substring(T)),D.push(ve),T=R,Xe(D),x&&ot()),Te()}function Ke(ve){T=ve,Xe(D),D=[],re=z.indexOf(w,T)}function Te(ve){return{data:F,errors:K,meta:{delimiter:_,linebreak:w,aborted:U,truncated:!!ve,cursor:j+(_e||0)}}}function ot(){L(Te()),F=[],K=[]}},this.abort=function(){U=!0},this.getCharIndex=function(){return T}}function P(c){var u=c.data,_=o[u.workerId],w=!1;if(u.error)_.userError(u.error,u.file);else if(u.results&&u.results.data){var S={abort:function(){w=!0,B(u.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Q,resume:Q};if(y(_.userStep)){for(var L=0;L<u.results.data.length&&(_.userStep({data:u.results.data[L],errors:u.results.errors,meta:u.results.meta},S),!w);L++);delete u.results}else y(_.userChunk)&&(_.userChunk(u.results,S,u.file),delete u.results)}u.finished&&!w&&B(u.workerId,u.results)}function B(c,u){var _=o[c];y(_.userComplete)&&_.userComplete(u),_.terminate(),delete o[c]}function Q(){throw new Error("Not implemented.")}function W(c){if(typeof c!="object"||c===null)return c;var u=Array.isArray(c)?[]:{};for(var _ in c)u[_]=W(c[_]);return u}function q(c,u){return function(){c.apply(u,arguments)}}function y(c){return typeof c=="function"}return s&&(i.onmessage=function(c){var u=c.data;if(l.WORKER_ID===void 0&&u&&(l.WORKER_ID=u.workerId),typeof u.input=="string")i.postMessage({workerId:l.WORKER_ID,results:l.parse(u.input,u.config),finished:!0});else if(i.File&&u.input instanceof File||u.input instanceof Object){var _=l.parse(u.input,u.config);_&&i.postMessage({workerId:l.WORKER_ID,results:_,finished:!0})}}),(p.prototype=Object.create(f.prototype)).constructor=p,(b.prototype=Object.create(f.prototype)).constructor=b,(g.prototype=Object.create(g.prototype)).constructor=g,(m.prototype=Object.create(f.prototype)).constructor=m,l})})(nr);var Lr=nr.exports;const Mr=Or(Lr);function Fr(t){const e=t.data;let n=0,i=1/0;for(let r=0;r<e.length;r++){const s=e[r];s>n&&(n=s),s<i&&(i=s)}return[i,n]}function ir(t){t.startsWith("#")&&(t=t.slice(1));const e=parseInt(t.slice(0,2),16),n=parseInt(t.slice(2,4),16),i=parseInt(t.slice(4,6),16);return[e,n,i]}const on=4,st={cyan:"#00FFFF",yellow:"#FFFF00",magenta:"#FF00FF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",white:"#FFFFFF"},Dr=[st.magenta,st.green],Nr=[st.red,st.green,st.blue],ci=Object.values(st).slice(0,-2);function Pr(t){return t<=on?Array(t).fill(!0):[...Array(on).fill(!0),...Array(t-on).fill(!1)]}function xr(t,e){let n=[];if(t==1)n=[st.white];else if(t==2)n=Dr;else if(t==3)n=Nr;else if(t<=on)n=ci.slice(0,t);else{n=Array(t).fill(st.white);const i=e.flatMap((r,s)=>r?s:[]);for(const[r,s]of i.entries())n[s]=ci[r]}return n.map(ir)}function Br(t,e,n){const i=t[0].shape,r=i[0],s=i[1],o=r*s,a=new Uint8ClampedArray(4*o).fill(0);let l=0;for(let h=0;h<o;h++){for(let f=0;f<t.length;f++){const p=n[f],b=t[f].data,g=e[f],E=(b[h]-g[0])/(g[1]-g[0]);for(let M=0;M<3;M++){const A=E*p[M]<<0;a[l*4+M]=Math.max(a[l*4+M],A)}}a[l*4+3]=255,l++}return a}function rr(t,e,n={}){Mr.parse(t,{header:!1,download:!0,skipEmptyLines:"greedy",complete:i=>{let r=["url"],s=i.data[0];s.length>1&&(r=s,i.data.shift());const o=i.data.map(g=>{const m={...n};for(let E=0;E<r.length;E++)m[r[E]]=g[E];return m});let a=o.filter(g=>{var m;return!((m=g.url)!=null&&m.endsWith(".csv"))});const l=o.filter(g=>{var m;return(m=g.url)==null?void 0:m.endsWith(".csv")}),h={};a.forEach(g=>{h[g.url]||(h[g.url]=g)}),a=Object.values(h);const f=a.reduce((g,m)=>m.wells?g+1:g,0),p=a.reduce((g,m)=>g+parseInt(m.written||0),0);let b=a.length;f>0&&(b=a.reduce((g,m)=>g+parseInt(m.images||1),0)),e.addCsv(t,l,b,f,p),e.addRows(a),l.forEach(g=>{const m=g.url;g.csv=m,rr(m,e,g)})}})}async function Ur(t){return await fetch(t).then(e=>e.json())}function un(t){if(!t)return"";const e=2;return t<1024?`${t} B`:t<1024**2?`${(t/1024).toFixed(e)} KB`:t<1024**3?`${(t/1024**2).toFixed(e)} MB`:t<1024**4?`${(t/1024**3).toFixed(e)} GB`:t<1024**5?`${(t/1024**4).toFixed(e)} TB`:`${(t/1024**5).toFixed(e)} PB`}class sr{constructor(){this.store=In({})}async lookupOntologyTerm(e){let n="",i="";e.includes("NCBITaxon")|e.includes("NCBI:txid")&&(n=e.replace("NCBI:txid",""),n=n.replace("obo:NCBITaxon_",""),i="NCBITaxon"),e.includes("FBbi")&&(n=e.replace("obo:FBbi_",""),n=n.replace("obo:FBbi:",""),n=n.replace("FBbi:",""),i="FBbi"),e.includes("NCIT_")&&(n=e.replace("NCIT_",""),i="NCIT"),e.includes("obo:MI_")&&(n=e.replace("obo:MI_",""),i="MI"),e.includes("obo:OBI_")&&(n=e.replace("obo:OBI_",""),i="OBI");let r=i+"_"+n,o=`https://www.ebi.ac.uk/ols4/api/ontologies/${i.toLowerCase()}/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252F${r}`;return(await Ur(o)).label||e}addTerms(e){let n=rn(this.store);[...new Set(e)].forEach(r=>{r&&(n[r]||(n[r]="Loading...",setTimeout(()=>{this.lookupOntologyTerm(r).then(s=>{this.addEntry(r,s)})},Math.random()*5e3)))})}addEntry(e,n){this.store.update(i=>(i[e]=n,i))}subscribe(e){return this.store.subscribe(e)}}const or=new sr,lr=new sr;class Yt extends Error{constructor(e,n={}){super(`Node not found: ${e}`,n),this.name="NodeNotFoundError"}}class xn extends Error{constructor(e){super(`Missing key: ${e}`),this.name="KeyError"}}const jr="modulepreload",Wr=function(t){return"/zowser/"+t},fi={},Tt=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));r=Promise.all(n.map(a=>{if(a=Wr(a),a in fi)return;fi[a]=!0;const l=a.endsWith(".css"),h=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${h}`))return;const f=document.createElement("link");if(f.rel=l?"stylesheet":jr,l||(f.as="script"),f.crossOrigin="",f.href=a,o&&f.setAttribute("nonce",o),document.head.appendChild(f),l)return new Promise((p,b)=>{f.addEventListener("load",p),f.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${a}`)))})}))}return r.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};var Ne;class ar{constructor(e,n,i){Ce(this,Ne);typeof e=="number"?pe(this,Ne,new Uint8Array(e)):e instanceof ArrayBuffer?pe(this,Ne,new Uint8Array(e,n,i)):pe(this,Ne,new Uint8Array(Array.from(e,r=>r?1:0)))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return G(this,Ne).byteOffset}get byteLength(){return G(this,Ne).byteLength}get buffer(){return G(this,Ne).buffer}get length(){return G(this,Ne).length}get(e){let n=G(this,Ne)[e];return typeof n=="number"?n!==0:n}set(e,n){G(this,Ne)[e]=n?1:0}fill(e){G(this,Ne).fill(e?1:0)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}Ne=new WeakMap;var Ct;class Bn{constructor(e,n,i,r){ne(this,"_data");ne(this,"chars");Ce(this,Ct);if(this.chars=e,pe(this,Ct,new TextEncoder),typeof n=="number")this._data=new Uint8Array(n*e);else if(n instanceof ArrayBuffer)r&&(r=r*e),this._data=new Uint8Array(n,i,r);else{let s=Array.from(n);this._data=new Uint8Array(s.length*e);for(let o=0;o<s.length;o++)this.set(o,s[o])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(e){const n=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);return new TextDecoder().decode(n).replace(/\x00/g,"")}set(e,n){const i=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);i.fill(0),i.set(G(this,Ct).encode(n))}fill(e){const n=G(this,Ct).encode(e);for(let i=0;i<this.length;i++)this._data.set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}Ct=new WeakMap;var ze;const Vn=class Vn{constructor(e,n,i,r){Ce(this,ze);ne(this,"chars");if(this.chars=e,typeof n=="number")pe(this,ze,new Int32Array(n*e));else if(n instanceof ArrayBuffer)r&&(r*=e),pe(this,ze,new Int32Array(n,i,r));else{const s=n,o=new Vn(e,1);pe(this,ze,new Int32Array(function*(){for(let a of s)o.set(0,a),yield*G(o,ze)}()))}}get BYTES_PER_ELEMENT(){return G(this,ze).BYTES_PER_ELEMENT*this.chars}get byteLength(){return G(this,ze).byteLength}get byteOffset(){return G(this,ze).byteOffset}get buffer(){return G(this,ze).buffer}get length(){return G(this,ze).length/this.chars}get(e){const n=this.chars*e;let i="";for(let r=0;r<this.chars;r++)i+=String.fromCodePoint(G(this,ze)[n+r]);return i.replace(/\u0000/g,"")}set(e,n){const i=this.chars*e,r=G(this,ze).subarray(i,i+this.chars);r.fill(0);for(let s=0;s<this.chars;s++)r[s]=n.codePointAt(s)??0}fill(e){this.set(0,e);let n=G(this,ze).subarray(0,this.chars);for(let i=1;i<this.length;i++)G(this,ze).set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}};ze=new WeakMap;let Mt=Vn;function Zt(t){const e=new TextDecoder().decode(t);return JSON.parse(e)}function hi(t,e){const n=e/2,i=e-1;let r=0;for(let s=0;s<t.length;s+=e)for(let o=0;o<n;o+=1)r=t[s+o],t[s+o]=t[s+i-o],t[s+i-o]=r}const qr={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float32:Float32Array,float64:Float64Array,bool:ar},Hr=/v2:([US])(\d+)/;function ur(t){if(t==="v2:object")return globalThis.Array;let e=t.match(Hr);if(e){let[,i,r]=e;return(i==="U"?Mt:Bn).bind(null,Number(r))}let n=qr[t];if(!n)throw new Error(`Unknown or unsupported data_type: ${t}`);return n}function dt(t,e){return(e==="C"?Vr:Kr)(t)}function Vr(t){const e=t.length,n=globalThis.Array(e);for(let i=e-1,r=1;i>=0;i--)n[i]=r,r*=t[i];return n}function Kr(t){const e=t.length,n=globalThis.Array(e);for(let i=0,r=1;i<e;i++)n[i]=r,r*=t[i];return n}function Gr({name:t,configuration:e}){if(t==="default"){const n=(e==null?void 0:e.separator)??"/";return i=>["c",...i].join(n)}if(t==="v2"){const n=(e==null?void 0:e.separator)??".";return i=>i.join(n)||"0"}throw new Error(`Unknown chunk key encoding: ${t}`)}function Tn(t){var n;const e=t.find(i=>i.name==="transpose");return((n=e==null?void 0:e.configuration)==null?void 0:n.order)==="F"?"F":"C"}const Jr=/^([<|>])(.*)$/;function Yr(t){if(t==="|O")return{data_type:"v2:object"};let e=t.match(Jr);if(!e)throw new Error(`Invalid dtype: ${t}`);let[,n,i]=e,r={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f4:"float32",f8:"float64"}[i]??(i.startsWith("S")||i.startsWith("U")?`v2:${i}`:void 0);if(!r)throw new Error(`Unsupported or unknown dtype: ${t}`);return n==="|"?{data_type:r}:{data_type:r,endian:n==="<"?"little":"big"}}function Zr(t,e={}){let n=[],i=Yr(t.dtype);t.order==="F"&&n.push({name:"transpose",configuration:{order:"F"}}),"endian"in i&&i.endian==="big"&&n.push({name:"bytes",configuration:{endian:"big"}});for(let{id:r,...s}of t.filters??[])n.push({name:r,configuration:s});if(t.compressor){let{id:r,...s}=t.compressor;n.push({name:r,configuration:s})}return{zarr_format:3,node_type:"array",shape:t.shape,data_type:i.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:t.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:t.dimension_separator??"."}},codecs:n,fill_value:t.fill_value,attributes:e}}function Qr(t,e={}){return{zarr_format:3,node_type:"group",attributes:e}}function Xr(t,e){if(e!=="number"&&e!=="bigint"&&e!=="boolean"&&e!=="object"&&e!=="string")return t===e;let n=t==="bool";if(e==="boolean")return n;let i=t.startsWith("v2:U")||t.startsWith("v2:S");if(e==="string")return i;let r=t==="int64"||t==="uint64";if(e==="bigint")return r;let s=t==="v2:object";return e==="object"?s:!i&&!r&&!n&&!s}function $r(t){return(t==null?void 0:t.name)==="sharding_indexed"}function cr(t){return(t.data_type==="uint64"||t.data_type==="int64")&&t.fill_value!=null?BigInt(t.fill_value):t.fill_value}const di=es();function es(){const t=new Uint32Array([305419896]);return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)[0]!==18}function _i(t){return"BYTES_PER_ELEMENT"in t?t.BYTES_PER_ELEMENT:4}var Dt,it,Nt,Pt,At;const Kn=class Kn{constructor(e,n){ne(this,"kind","array_to_bytes");Ce(this,Dt);Ce(this,it);Ce(this,Nt);Ce(this,Pt);Ce(this,At);pe(this,At,e==null?void 0:e.endian),pe(this,it,ur(n.data_type)),pe(this,Pt,n.shape),pe(this,Dt,dt(n.shape,Tn(n.codecs)));const i=new(G(this,it))(0);pe(this,Nt,i.BYTES_PER_ELEMENT)}static fromConfig(e,n){return new Kn(e,n)}encode(e){let n=new Uint8Array(e.data.buffer);return di&&G(this,At)==="big"&&hi(n,_i(G(this,it))),n}decode(e){return di&&G(this,At)==="big"&&hi(e,_i(G(this,it))),{data:new(G(this,it))(e.buffer,e.byteOffset,e.byteLength/G(this,Nt)),shape:G(this,Pt),stride:G(this,Dt)}}};Dt=new WeakMap,it=new WeakMap,Nt=new WeakMap,Pt=new WeakMap,At=new WeakMap;let cn=Kn;class Un{constructor(){ne(this,"kind","bytes_to_bytes")}static fromConfig(){return new Un}encode(e){throw new Error("Not implemented")}decode(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength-4)}}function ts(t,e){if(Number.isNaN(e))throw new Error("JsonCodec allow_nan is false but NaN was encountered during encoding.");if(e===Number.POSITIVE_INFINITY)throw new Error("JsonCodec allow_nan is false but Infinity was encountered during encoding.");if(e===Number.NEGATIVE_INFINITY)throw new Error("JsonCodec allow_nan is false but -Infinity was encountered during encoding.");return e}function ns(t,e){return e instanceof Object&&!Array.isArray(e)?Object.keys(e).sort().reduce((n,i)=>(n[i]=e[i],n),{}):e}var xt,Bt;const Gn=class Gn{constructor(e={}){ne(this,"configuration");ne(this,"kind","array_to_bytes");Ce(this,xt);Ce(this,Bt);this.configuration=e;const{encoding:n="utf-8",skipkeys:i=!1,ensure_ascii:r=!0,check_circular:s=!0,allow_nan:o=!0,sort_keys:a=!0,indent:l,strict:h=!0}=e;let f=e.separators;f||(l?f=[", ",": "]:f=[",",":"]),pe(this,xt,{encoding:n,skipkeys:i,ensure_ascii:r,check_circular:s,allow_nan:o,indent:l,separators:f,sort_keys:a}),pe(this,Bt,{strict:h})}static fromConfig(e){return new Gn(e)}encode(e){const{indent:n,encoding:i,ensure_ascii:r,check_circular:s,allow_nan:o,sort_keys:a}=G(this,xt);if(i!=="utf-8")throw new Error("JsonCodec does not yet support non-utf-8 encoding.");const l=[];if(!s)throw new Error("JsonCodec does not yet support skipping the check for circular references during encoding.");o||l.push(ts),a&&l.push(ns);const h=Array.from(e.data);h.push("|O"),h.push(e.shape);let f;l.length&&(f=(b,g)=>{let m=g;for(let E of l)m=E(b,m);return m});let p=JSON.stringify(h,f,n);return r&&(p=p.replace(/[\u007F-\uFFFF]/g,b=>{const g=`0000${b.charCodeAt(0).toString(16)}`;return`\\u${g.substring(g.length-4)}`})),new TextEncoder().encode(p)}decode(e){const{strict:n}=G(this,Bt);if(!n)throw new Error("JsonCodec does not yet support non-strict decoding.");const i=Zt(e),r=i.pop();if(i.pop(),!r)throw new Error("0D not implemented for JsonCodec.");const s=dt(r,"C");return{data:i,shape:r,stride:s}}};xt=new WeakMap,Bt=new WeakMap;let zn=Gn;function gi(t){return t instanceof ar||t instanceof Bn||t instanceof Mt?new Proxy(t,{get(n,i){return n.get(Number(i))},set(n,i,r){return n.set(Number(i),r),!0}}):t}function is(t,e){let n;return t.data instanceof Bn||t.data instanceof Mt?n=new t.constructor(t.data.length,t.data.chars):n=new t.constructor(t.data.length),{data:n,shape:t.shape,stride:dt(t.shape,e)}}function rs(t,e){let n=is(t,e),i=t.shape.length,r=t.data.length,s=Array(i).fill(0),o=gi(t.data),a=gi(n.data);for(let l=0;l<r;l++){let h=0;for(let f=0;f<i;f++)h+=s[f]*n.stride[f];a[h]=o[l],s[0]+=1;for(let f=0;f<i;f++)if(s[f]===t.shape[f]){if(f+1===i)break;s[f]=0,s[f+1]+=1}}return n}function ss(t){if(!t.stride)return"C";let e=dt(t.shape,"C");return t.stride.every((n,i)=>n===e[i])?"C":"F"}class jn{constructor(e){ne(this,"configuration");ne(this,"kind","array_to_array");this.configuration=e}static fromConfig(e){return new jn(e)}encode(e){var n,i;return ss(e)===((n=this.configuration)==null?void 0:n.order)?e:rs(e,((i=this.configuration)==null?void 0:i.order)??"C")}decode(e){return e}}var Ut,jt;const Jn=class Jn{constructor(e){ne(this,"kind","array_to_bytes");Ce(this,Ut);Ce(this,jt);pe(this,Ut,e),pe(this,jt,dt(e,"C"))}static fromConfig(e,n){return new Jn(n.shape)}encode(e){throw new Error("Method not implemented.")}decode(e){let n=new TextDecoder,i=new DataView(e.buffer),r=Array(i.getUint32(0,!0)),s=4;for(let o=0;o<r.length;o++){let a=i.getUint32(s,!0);s+=4,r[o]=n.decode(e.buffer.slice(s,s+a)),s+=a}return{data:r,shape:G(this,Ut),stride:G(this,jt)}}};Ut=new WeakMap,jt=new WeakMap;let Rn=Jn;function os(){return new Map().set("blosc",()=>Tt(()=>import("./blosc-E49GQuAK.js"),__vite__mapDeps([0,1])).then(t=>t.default)).set("gzip",()=>Tt(()=>import("./gzip-CF-9a_hd.js"),__vite__mapDeps([2,3])).then(t=>t.default)).set("lz4",()=>Tt(()=>import("./lz4-BIGKWw27.js"),__vite__mapDeps([4,1])).then(t=>t.default)).set("zlib",()=>Tt(()=>import("./zlib-CBiqHlio.js"),__vite__mapDeps([5,3])).then(t=>t.default)).set("zstd",()=>Tt(()=>import("./zstd-IvP746pw.js"),__vite__mapDeps([6,1])).then(t=>t.default)).set("transpose",()=>jn).set("bytes",()=>cn).set("crc32c",()=>Un).set("vlen-utf8",()=>Rn).set("json2",()=>zn)}const ls=os();function On(t){let e;return{async encode(n){e||(e=await mi(t));for(const r of e.array_to_array)n=await r.encode(n);let i=await e.array_to_bytes.encode(n);for(const r of e.bytes_to_bytes)i=await r.encode(i);return i},async decode(n){e||(e=await mi(t));for(let r=e.bytes_to_bytes.length-1;r>=0;r--)n=await e.bytes_to_bytes[r].decode(n);let i=await e.array_to_bytes.decode(n);for(let r=e.array_to_array.length-1;r>=0;r--)i=await e.array_to_array[r].decode(i);return i}}}async function mi(t){let e=t.codecs.map(async s=>{var a;let o=await((a=ls.get(s.name))==null?void 0:a());if(!o)throw new Error(`Unknown codec: ${s.name}`);return{Codec:o,meta:s}}),n=[],i,r=[];for await(let{Codec:s,meta:o}of e){let a=s.fromConfig(o.configuration,t);switch(a.kind){case"array_to_array":n.push(a);break;case"array_to_bytes":i=a;break;default:r.push(a)}}if(!i){if(!as(t))throw new Error(`Cannot encode ${t.data_type} to bytes without a codec`);i=cn.fromConfig({endian:"little"},t)}return{array_to_array:n,array_to_bytes:i,bytes_to_bytes:r}}function as(t){return t.data_type!=="v2:object"}const pi=18446744073709551615n;function us(t,e,n,i){if(t.store.getRange===void 0)throw new Error("Store does not support range requests");let r=t.store.getRange.bind(t.store),s=e.map((l,h)=>l/i.chunk_shape[h]),o=On({data_type:"uint64",shape:[...s,2],codecs:i.index_codecs}),a={};return async l=>{let h=l.map((P,B)=>Math.floor(P/s[B])),f=t.resolve(n(h)).path,p;if(f in a)p=a[f];else{let P=4,B=16*s.reduce((W,q)=>W*q,1),Q=await r(f,{suffixLength:B+P});p=a[f]=Q?await o.decode(Q):null}if(p===null)return;let{data:b,shape:g,stride:m}=p,E=l.map((P,B)=>P%g[B]).reduce((P,B,Q)=>P+B*m[Q],0),M=b[E],A=b[E+1];if(!(M===pi&&A===pi))return r(f,{offset:Number(M),length:Number(A)})}}class St{constructor(e,n="/"){ne(this,"store");ne(this,"path");this.store=e,this.path=n}resolve(e){let n=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new St(this.store,new URL(e,n).pathname)}}var Wt;class Wn extends St{constructor(n,i,r){super(n,i);ne(this,"kind","group");Ce(this,Wt);pe(this,Wt,r)}get attrs(){return G(this,Wt).attributes}}Wt=new WeakMap;const Rt=Symbol("zarrita.context");function cs(t){return t[Rt]}function fs(t,e){let{configuration:n}=e.codecs.find($r)??{},i={encode_chunk_key:Gr(e.chunk_key_encoding),TypedArray:ur(e.data_type),fill_value:e.fill_value};if(n){let s=Tn(n.codecs);return{...i,kind:"sharded",chunk_shape:n.chunk_shape,codec:On({data_type:e.data_type,shape:n.chunk_shape,codecs:n.codecs}),get_strides(o,a){return dt(o,a??s)},get_chunk_bytes:us(t,e.chunk_grid.configuration.chunk_shape,i.encode_chunk_key,n)}}let r=Tn(e.codecs);return{...i,kind:"regular",chunk_shape:e.chunk_grid.configuration.chunk_shape,codec:On({data_type:e.data_type,shape:e.chunk_grid.configuration.chunk_shape,codecs:e.codecs}),get_strides(s,o){return dt(s,o??r)},async get_chunk_bytes(s,o){let a=i.encode_chunk_key(s),l=t.resolve(a).path;return t.store.get(l,o)}}}var Gi,Ji,ft,Yi;let fn=(Yi=class extends(Ji=St,Gi=Rt,Ji){constructor(n,i,r){super(n,i);ne(this,"kind","array");Ce(this,ft);ne(this,Gi);pe(this,ft,{...r,fill_value:cr(r)}),this[Rt]=fs(this,r)}get attrs(){return G(this,ft).attributes}get shape(){return G(this,ft).shape}get chunks(){return this[Rt].chunk_shape}get dtype(){return G(this,ft).data_type}async getChunk(n,i){let r=this[Rt],s=await r.get_chunk_bytes(n,i);if(!s){let o=r.chunk_shape.reduce((l,h)=>l*h,1),a=new r.TypedArray(o);return a.fill(r.fill_value),{data:a,shape:r.chunk_shape,stride:r.get_strides(r.chunk_shape)}}return r.codec.decode(s)}is(n){return Xr(this.dtype,n)}},ft=new WeakMap,Yi),dn=hs();function hs(){let t=new WeakMap;function e(n){let i=t.get(n)??{v2:0,v3:0};return t.set(n,i),i}return{increment(n,i){e(n)[i]+=1},version_max(n){let i=e(n);return i.v3>i.v2?"v3":"v2"}}}async function ds(t){let e=await t.store.get(t.resolve(".zattrs").path);return e?Zt(e):{}}async function _s(t,e={}){let n="store"in t?t:new St(t),i={};return(e.attrs??!0)&&(i=await ds(n)),e.kind==="array"?bi(n,i):e.kind==="group"?yi(n,i):bi(n,i).catch(r=>{if(r instanceof Yt)return yi(n,i);throw r})}async function bi(t,e){let{path:n}=t.resolve(".zarray"),i=await t.store.get(n);if(!i)throw new Yt("v2 array",{cause:new xn(n)});return dn.increment(t.store,"v2"),new fn(t.store,t.path,Zr(Zt(i),e))}async function yi(t,e){let{path:n}=t.resolve(".zgroup"),i=await t.store.get(n);if(!i)throw new Yt("v2 group",{cause:new xn(n)});return dn.increment(t.store,"v2"),new Wn(t.store,t.path,Qr(Zt(i),e))}async function gs(t){let{store:e,path:n}=t.resolve("zarr.json"),i=await t.store.get(n);if(!i)throw new Yt("v3 array or group",{cause:new xn(n)});let r=Zt(i);return r.node_type==="array"&&(r.fill_value=cr(r)),r.node_type==="array"?new fn(e,t.path,r):new Wn(e,t.path,r)}async function ms(t,e={}){let n="store"in t?t:new St(t),i=await gs(n);if(dn.increment(n.store,"v3"),e.kind===void 0||e.kind==="array"&&i instanceof fn||e.kind==="group"&&i instanceof Wn)return i;let r=i instanceof fn?"array":"group";throw new Error(`Expected node of kind ${e.kind}, found ${r}.`)}async function ct(t,e={}){let n="store"in t?t.store:t,i=dn.version_max(n),r=i==="v2"?ct.v2:ct.v3,s=i==="v2"?ct.v3:ct.v2;return r(t,e).catch(o=>{if(o instanceof Yt)return s(t,e);throw o})}ct.v2=_s;ct.v3=ms;function*ps(t,e,n=1){e===void 0&&(e=t,t=0);for(let i=t;i<e;i+=n)yield i}function*bs(...t){if(t.length===0)return;const e=t.map(i=>i[Symbol.iterator]()),n=e.map(i=>i.next());if(n.some(i=>i.done))throw new Error("Input contains an empty iterator.");for(let i=0;;){if(n[i].done){if(e[i]=t[i][Symbol.iterator](),n[i]=e[i].next(),++i>=e.length)return}else yield n.map(({value:r})=>r),i=0;n[i]=e[i].next()}}function ys({start:t,stop:e,step:n},i){if(n===0)throw new Error("slice step cannot be zero");n=n??1;const r=n<0,[s,o]=r?[-1,i-1]:[0,i];return t===null?t=r?o:s:t<0?(t+=i,t<s&&(t=s)):t>o&&(t=o),e===null?e=r?s:o:e<0?(e+=i,e<s&&(e=s)):e>o&&(e=o),[t,e,n]}function Ln(t,e,n=null){return e===void 0&&(e=t,t=null),{start:t,stop:e,step:n}}function vs(){const t=[];return{add:e=>t.push(e()),onIdle:()=>Promise.all(t)}}class qn extends Error{constructor(e){super(e),this.name="IndexError"}}function ws(t,e){throw new qn(`too many indicies for array; expected ${e.length}, got ${t.length}`)}function ks(t){throw new qn(`index out of bounds for dimension with length ${t}`)}function Es(){throw new qn("only slices with step >= 1 are supported")}function Cs(t,e){t.length>e.length&&ws(t,e)}function As(t,e){return t=Math.trunc(t),t<0&&(t=e+t),(t>=e||t<0)&&ks(e),t}class Ss{constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){ne(this,"dim_sel");ne(this,"dim_len");ne(this,"dim_chunk_len");ne(this,"nitems");e=As(e,n),this.dim_sel=e,this.dim_len=n,this.dim_chunk_len=i,this.nitems=1}*[Symbol.iterator](){const e=Math.floor(this.dim_sel/this.dim_chunk_len),n=e*this.dim_chunk_len,i=this.dim_sel-n;yield{dim_chunk_ix:e,dim_chunk_sel:i}}}class vi{constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){ne(this,"start");ne(this,"stop");ne(this,"step");ne(this,"dim_len");ne(this,"dim_chunk_len");ne(this,"nitems");ne(this,"nchunks");const[r,s,o]=ys(e,n);this.start=r,this.stop=s,this.step=o,this.step<1&&Es(),this.dim_len=n,this.dim_chunk_len=i,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const e=Math.floor(this.start/this.dim_chunk_len),n=Math.ceil(this.stop/this.dim_chunk_len);for(const i of ps(e,n)){const r=i*this.dim_chunk_len,s=Math.min(this.dim_len,(i+1)*this.dim_chunk_len),o=s-r;let a=0,l=0;if(this.start<r){const g=(r-this.start)%this.step;g&&(l+=this.step-g),a=Math.ceil((r-this.start)/this.step)}else l=this.start-r;const h=this.stop>s?o:this.stop-r,f=[l,h,this.step],p=Math.ceil((h-l)/this.step),b=[a,a+p,1];yield{dim_chunk_ix:i,dim_chunk_sel:f,dim_out_sel:b}}}}function Is(t,e){let n=[];return t===null?n=e.map(i=>Ln(null)):Array.isArray(t)&&(n=t.map(i=>i??Ln(null))),Cs(n,e),n}class Ts{constructor({selection:e,shape:n,chunk_shape:i}){ne(this,"dim_indexers");ne(this,"shape");this.dim_indexers=Is(e,n).map((r,s)=>new(typeof r=="number"?Ss:vi)({dim_sel:r,dim_len:n[s],dim_chunk_len:i[s]})),this.shape=this.dim_indexers.filter(r=>r instanceof vi).map(r=>r.nitems)}*[Symbol.iterator](){for(const e of bs(...this.dim_indexers)){const n=e.map(r=>r.dim_chunk_ix),i=e.map(r=>"dim_out_sel"in r?{from:r.dim_chunk_sel,to:r.dim_out_sel}:{from:r.dim_chunk_sel,to:null});yield{chunk_coords:n,mapping:i}}}}function zs(t,e){return"get"in t?t.get(e):t[e]}async function Rs(t,e,n,i){var l;let r=cs(t),s=new Ts({selection:e,shape:t.shape,chunk_shape:t.chunks}),o=i.prepare(new r.TypedArray(s.shape.reduce((h,f)=>h*f,1)),s.shape,r.get_strides(s.shape,n.order)),a=((l=n.create_queue)==null?void 0:l.call(n))??vs();for(const{chunk_coords:h,mapping:f}of s)a.add(async()=>{let{data:p,shape:b,stride:g}=await t.getChunk(h,n.opts),m=i.prepare(p,b,g);i.set_from_chunk(o,m,f)});return await a.onIdle(),s.shape.length===0?zs(o.data,0):o}function Hn(t,e=0,n){let i=n??t.length-e;return{length:i,subarray(r,s=i){return Hn(t,e+r,s-r)},set(r,s=0){for(let o=0;o<r.length;o++)t[e+s+o]=r.get(o)},get(r){return t[e+r]}}}function wn(t){return globalThis.Array.isArray(t.data)?{data:Hn(t.data),stride:t.stride,bytes_per_element:1}:{data:new Uint8Array(t.data.buffer,t.data.byteOffset,t.data.byteLength),stride:t.stride,bytes_per_element:t.data.BYTES_PER_ELEMENT}}function Os(t){return"chars"in t?t.constructor.bind(null,t.chars):t.constructor}function Ls(t,e){if(globalThis.Array.isArray(t.data))return Hn([e]);let n=Os(t.data),i=new n([e]);return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}const Ms={prepare(t,e,n){return{data:t,shape:e,stride:n}},set_scalar(t,e,n){let i=wn(t);Mn(i,e,Ls(t,n),i.bytes_per_element)},set_from_chunk(t,e,n){let i=wn(t);ln(i,wn(e),i.bytes_per_element,n)}};async function Fs(t,e=null,n={}){return Rs(t,e,n,Ms)}function fr(t,e,n){return n<0&&e<t?Math.floor((t-e-1)/-n)+1:t<e?Math.floor((e-t-1)/n)+1:0}function Mn(t,e,n,i){if(e.length===0){t.data.set(n,0);return}const[r,...s]=e,[o,...a]=t.stride;if(typeof r=="number"){const b=t.data.subarray(o*r*i);Mn({data:b,stride:a},s,n,i);return}const[l,h,f]=r,p=fr(l,h,f);if(s.length===0){for(let b=0;b<p;b++)t.data.set(n,o*(l+f*b)*i);return}for(let b=0;b<p;b++){const g=t.data.subarray(o*(l+f*b)*i);Mn({data:g,stride:a},s,n,i)}}function ln(t,e,n,i){const[r,...s]=i,[o,...a]=t.stride,[l,...h]=e.stride;if(r.from===null){if(s.length===0){t.data.set(e.data.subarray(0,n),r.to*n);return}ln({data:t.data.subarray(o*r.to*n),stride:a},e,n,s);return}if(r.to===null){if(s.length===0){let A=r.from*n;t.data.set(e.data.subarray(A,A+n),0);return}ln(t,{data:e.data.subarray(l*r.from*n),stride:h},n,s);return}const[f,p,b]=r.to,[g,m,E]=r.from,M=fr(f,p,b);if(s.length===0){if(b===1&&E===1&&o===1&&l===1){let A=g*n,P=M*n;t.data.set(e.data.subarray(A,A+P),f*n);return}for(let A=0;A<M;A++){let P=l*(g+E*A)*n;t.data.set(e.data.subarray(P,P+n),o*(f+b*A)*n)}return}for(let A=0;A<M;A++)ln({data:t.data.subarray(o*(f+A*b)*n),stride:a},{data:e.data.subarray(l*(g+A*E)*n),stride:h},n,s)}function hr(t,e,n,i={}){return e!==void 0&&n!==void 0&&(i={...i,headers:{...i.headers,Range:`bytes=${e}-${e+n-1}`}}),fetch(t,i)}function Ds(t,e){return{...t,...e,headers:{...t.headers,...e.headers}}}function wi(t,e){const n=typeof t=="string"?new URL(t):t;n.pathname.endsWith("/")||(n.pathname+="/");const i=new URL(e.slice(1),n);return i.search=n.search,i}async function ki(t){if(!(t.status===404||t.status===403)){if(t.status===200||t.status===206)return new Uint8Array(await t.arrayBuffer());throw new Error(`Unexpected response status ${t.status} ${t.statusText}`)}}async function Ns(t,e,n,i){if(i)return fetch(t,{...n,headers:{...n.headers,Range:`bytes=-${e}`}});let r=await fetch(t,{...n,method:"HEAD"});if(!r.ok)return r;let s=r.headers.get("Content-Length"),o=Number(s);return hr(t,o-e,o,n)}var qt,Ht,Vt,Fn;class Ps{constructor(e,n={}){Ce(this,Vt);ne(this,"url");Ce(this,qt);Ce(this,Ht);this.url=e,pe(this,qt,n.overrides??{}),pe(this,Ht,n.useSuffixRequest??!1)}async get(e,n={}){let i=wi(this.url,e).href,r=await fetch(i,bn(this,Vt,Fn).call(this,n));return ki(r)}async getRange(e,n,i={}){let r=wi(this.url,e),s=bn(this,Vt,Fn).call(this,i),o;return"suffixLength"in n?o=await Ns(r,n.suffixLength,s,G(this,Ht)):o=await hr(r,n.offset,n.length,s),ki(o)}}qt=new WeakMap,Ht=new WeakMap,Vt=new WeakSet,Fn=function(e){return Ds(G(this,qt),e)};async function Ft(t,e){var r;let n;try{const s=await fetch(`${t}/zarr.json`,{signal:e});if(!s.ok)throw new Error(`HTTP ${s.status} for ${t}/zarr.json`);n=await s.json()}catch(s){return console.warn(`[ngffLoader] ${t}/zarr.json not found or invalid`,s.message),[void 0,t]}const i=(r=n==null?void 0:n.attributes)==null?void 0:r.ome;if(!i)return[void 0,t];if(i.multiscales)return[i,t];if(i.plate){const s=i.plate.wells[0],o=`${t}/${s.path}/0`,[a,l]=await Ft(o,e);return[a,l,i.plate]}if(i["bioformats2raw.layout"]){const s=`${t}/0`;return await Ft(s,e)}return[void 0,t]}async function xs(t,e,n,i=512,r){var Q,W,q;if(!((Q=e==null?void 0:e.multiscales)!=null&&Q.length))return null;const s=e.multiscales[0].datasets.map(y=>y.path),o=e.multiscales[0].axes.map(y=>y.name);let a=s.at(-1);n!==void 0&&n<s.length&&(a=s[n]);const l=new Ps(`${t}/${a}`),h=await ct.v3(l,{kind:"array"}),f=o.indexOf("c"),p=h.shape;if(p.at(-1)*p.at(-2)>i*i)return console.log("Thumbnail skipped, too large:",p,t),null;const b=p[f]||1,g=(W=e==null?void 0:e.omero)!=null&&W.channels?e.omero.channels.map(y=>y.active):Pr(b),m=(q=e==null?void 0:e.omero)!=null&&q.channels?e.omero.channels.map(y=>ir(y.color)):xr(b,g),E=g.reduce((y,c,u)=>c?[...y,u]:y,[]),M=y=>p.map((c,u)=>u===f?y:u>=p.length-2?Ln(0,c):parseInt(c/2)),A=await Promise.all(E.map(y=>Fs(h,M(y),{opts:{signal:r}}))),P=A.map(Fr);return{rgb:Br(A,P,m),width:p.at(-1),height:p.at(-2)}}class Bs{constructor(e="index",n=!0){this.store=In([]),this.selectedRow=In(null),this.sortColumn=e,this.sortAscending=n,this.csvFiles=[]}addCsv(e,n,i,r,s){n=n.map(a=>({...a,child_csv:[]}));let o;for(let a of this.csvFiles){if(a.url===e){o=a;break}for(let l of a.child_csv){if(l.url===e){o=l;break}for(let h of l.child_csv)if(h.url===e){o=h;break}}}o?(o.image_count=i,o.plate_count=r,o.bytes=s,o.child_csv=n):(o={url:e,image_count:i,plate_count:r,bytes:s,child_csv:n},this.csvFiles.push(o))}addRows(e){e=e.map((r,s)=>{if(r.written&&(r.written=parseFloat(r.written)),r.shape){let o=r.shape.split(",").map(l=>parseInt(l)),a;r.dimension_names?a=r.dimension_names.split(","):o.length==5&&(a=["t","c","z","y","x"]),a&&a.length==o.length&&a.forEach((l,h)=>r["size_"+l]=o[h]),r.dim_count=o.reduce((l,h)=>l+(h>1?1:0),0)}if(r.chunks){let o=r.chunks.split(",").map(a=>parseInt(a));r.chunk_pixels=o.reduce((a,l)=>a*l,1)}if(r.shards){let o=r.shards.split(",").map(a=>parseInt(a));r.shard_pixels=o.reduce((a,l)=>a*l,1)}return r.index=Math.random()*(1+s),r}),console.log("Adding rows",e),this.store.update(r=>(r.push(...e),r.sort((s,o)=>this.compareRows(s,o,!0)),r));let n=e.map(r=>r.organismId);or.addTerms(n);let i=e.map(r=>r.fbbiId);lr.addTerms(i)}populateRow(e,n){this.store.update(i=>(i=i.map(r=>(r.url===e&&(r={...r,...n}),r)),i))}async loadNgffMetadata(e){var b;const[n,i,r]=await Ft(e);let s=[],o=0,a=0,l=!1,h=!0,f={multiscales:n},p=i;if(r&&(o=r.wells.length,a=r.field_count||1),n){const g=(b=n[0])==null?void 0:b.datasets[0],m=g==null?void 0:g.path;if(m){const E=await fetch(`${i}/${m}/zarr.json`).then(M=>M.json()).catch(M=>{console.log(`----> Failed to parse ${i}/${m}/zarr.json`,M)});s=E==null?void 0:E.shape}}else console.log("No multiscales found"),l=!0,s=[0];this.populateRow(e,{image_attrs:f,image_url:p,shape:s,well_count:o,field_count:a,load_failed:l,loaded:h})}compareRows(e,n,i=!1){let r=e[this.sortColumn],s=n[this.sortColumn];if(i)return r===void 0&&(r=0),s===void 0&&(s=0),r<s?this.sortAscending?-1:1:r>s?this.sortAscending?1:-1:0;r===void 0&&(r=""),s===void 0&&(s="");let o=0;return i?o=r-s:o=r.localeCompare(s),this.sortAscending?o:-o}sortTable(e,n=!0){console.log("sortTable",e,n),this.sortColumn=e,this.sortAscending=n;let i=this.isColumnNumeric(e);this.store.update(r=>(r.sort((s,o)=>this.compareRows(s,o,i)),r))}isColumnNumeric(e){let n=rn(this.store);for(let i of n){let r=i[e];if(r!==void 0&&r!=="")return!isNaN(r)}}emptyTable(){this.store.set([])}subscribe(e){return this.store.subscribe(e)}getRows(){return rn(this.store)}getRow(e){return rn(this.store)[e]}subscribeSelectedRow(e){return this.selectedRow.subscribe(e)}setSelectedRow(e){this.selectedRow.set(e)}}const Ue=new Bs;function Us(t){let e,n,i,r,s,o;return{c(){e=k("button"),n=k("span"),n.textContent="^",i=H(),r=k("span"),r.textContent="^",v(n,"class","acc svelte-17vd65t"),je(n,"strong",t[1]),v(r,"class","dec svelte-17vd65t"),je(r,"strong",!t[1]),v(e,"class","svelte-17vd65t")},m(a,l){Z(a,e,l),d(e,n),d(e,i),d(e,r),s||(o=we(e,"click",t[2]),s=!0)},p(a,[l]){l&2&&je(n,"strong",a[1]),l&2&&je(r,"strong",!a[1])},i:ye,o:ye,d(a){a&&J(e),s=!1,o()}}}function js(t,e,n){let{toggleAscending:i}=e,{sortAscending:r}=e;const s=()=>i();return t.$$set=o=>{"toggleAscending"in o&&n(0,i=o.toggleAscending),"sortAscending"in o&&n(1,r=o.sortAscending)},[i,r,s]}class Ws extends Ze{constructor(e){super(),Ye(this,e,js,Us,Pe,{toggleAscending:0,sortAscending:1})}}const nn={AUTO:"auto",START:"start",CENTER:"center",END:"end"},tt={HORIZONTAL:"horizontal",VERTICAL:"vertical"},zt={OBSERVED:0,REQUESTED:1},qs={[tt.VERTICAL]:"top",[tt.HORIZONTAL]:"left"},Ei={[tt.VERTICAL]:"scrollTop",[tt.HORIZONTAL]:"scrollLeft"};class Hs{constructor({itemSize:e,itemCount:n,estimatedItemSize:i}){this.itemSize=e,this.itemCount=n,this.estimatedItemSize=i,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig({itemSize:e,itemCount:n,estimatedItemSize:i}){n!=null&&(this.itemCount=n),i!=null&&(this.estimatedItemSize=i),e!=null&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!=null?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.itemCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:n}=this;return typeof n=="function"?n(e):Array.isArray(n)?n[e]:n}computeTotalSizeAndPositionData(){let e=0;for(let n=0;n<this.itemCount;n++){const i=this.getSize(n),r=e;e+=i,this.itemSizeAndPositionData[n]={offset:r,size:i}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){if(e<0||e>=this.itemCount)throw Error(`Requested index ${e} is outside of range 0..${this.itemCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const n=this.getSizeAndPositionOfLastMeasuredItem();let i=n.offset+n.size;for(let r=this.lastMeasuredIndex+1;r<=e;r++){const s=this.getSize(r);if(s==null||isNaN(s))throw Error(`Invalid size returned for index ${r} of value ${s}`);this.itemSizeAndPositionData[r]={offset:i,size:s},i+=s}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize}getUpdatedOffsetForIndex({align:e=nn.START,containerSize:n,currentOffset:i,targetIndex:r}){if(n<=0)return 0;const s=this.getSizeAndPositionForIndex(r),o=s.offset,a=o-n+s.size;let l;switch(e){case nn.END:l=a;break;case nn.CENTER:l=o-(n-s.size)/2;break;case nn.START:l=o;break;default:l=Math.max(a,Math.min(o,i))}const h=this.getTotalSize();return Math.max(0,Math.min(h-n,l))}getVisibleRange({containerSize:e=0,offset:n,overscanCount:i}){if(this.getTotalSize()===0)return{};const s=n+e;let o=this.findNearestItem(n);if(o===void 0)throw Error(`Invalid offset ${n} specified`);const a=this.getSizeAndPositionForIndex(o);n=a.offset+a.size;let l=o;for(;n<s&&l<this.itemCount-1;)l++,n+=this.getSizeAndPositionForIndex(l).size;return i&&(o=Math.max(0,o-i),l=Math.min(l+i,this.itemCount-1)),{start:o,stop:l}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const n=this.getSizeAndPositionOfLastMeasuredItem(),i=Math.max(0,this.lastMeasuredIndex);return n.offset>=e?this.binarySearch({high:i,low:0,offset:e}):this.exponentialSearch({index:i,offset:e})}binarySearch({low:e,high:n,offset:i}){let r=0,s=0;for(;e<=n;){if(r=e+Math.floor((n-e)/2),s=this.getSizeAndPositionForIndex(r).offset,s===i)return r;s<i?e=r+1:s>i&&(n=r-1)}return e>0?e-1:0}exponentialSearch({index:e,offset:n}){let i=1;for(;e<this.itemCount&&this.getSizeAndPositionForIndex(e).offset<n;)e+=i,i*=2;return this.binarySearch({high:Math.min(e,this.itemCount-1),low:Math.floor(e/2),offset:n})}}const Vs=t=>({}),Ci=t=>({});function Ai(t,e,n){const i=t.slice();return i[37]=e[n],i}const Ks=t=>({style:t[0]&4,index:t[0]&4}),Si=t=>({style:t[37].style,index:t[37].index}),Gs=t=>({}),Ii=t=>({});function Ti(t,e){let n,i;const r=e[21].item,s=kn(r,e,e[20],Si);return{key:t,first:null,c(){n=hn(),s&&s.c(),this.first=n},m(o,a){Z(o,n,a),s&&s.m(o,a),i=!0},p(o,a){e=o,s&&s.p&&(!i||a[0]&1048580)&&Cn(s,r,e,e[20],i?En(r,e[20],a,Ks):An(e[20]),Si)},i(o){i||(ae(s,o),i=!0)},o(o){de(s,o),i=!1},d(o){o&&J(n),s&&s.d(o)}}}function Js(t){let e,n,i,r=[],s=new Map,o,a;const l=t[21].header,h=kn(l,t,t[20],Ii);let f=Ge(t[2]);const p=m=>m[0]?m[0](m[37].index):m[37].index;for(let m=0;m<f.length;m+=1){let E=Ai(t,f,m),M=p(E);s.set(M,r[m]=Ti(M,E))}const b=t[21].footer,g=kn(b,t,t[20],Ci);return{c(){e=k("div"),h&&h.c(),n=H(),i=k("div");for(let m=0;m<r.length;m+=1)r[m].c();o=H(),g&&g.c(),v(i,"class","virtual-list-inner svelte-dwpad5"),v(i,"style",t[4]),v(e,"class","virtual-list-wrapper svelte-dwpad5"),v(e,"style",t[3])},m(m,E){Z(m,e,E),h&&h.m(e,null),d(e,n),d(e,i);for(let M=0;M<r.length;M+=1)r[M]&&r[M].m(i,null);d(e,o),g&&g.m(e,null),t[22](e),a=!0},p(m,E){h&&h.p&&(!a||E[0]&1048576)&&Cn(h,l,m,m[20],a?En(l,m[20],E,Gs):An(m[20]),Ii),E[0]&1048581&&(f=Ge(m[2]),Gt(),r=tr(r,E,p,1,m,f,s,i,Ir,Ti,null,Ai),Jt()),(!a||E[0]&16)&&v(i,"style",m[4]),g&&g.p&&(!a||E[0]&1048576)&&Cn(g,b,m,m[20],a?En(b,m[20],E,Vs):An(m[20]),Ci),(!a||E[0]&8)&&v(e,"style",m[3])},i(m){if(!a){ae(h,m);for(let E=0;E<f.length;E+=1)ae(r[E]);ae(g,m),a=!0}},o(m){de(h,m);for(let E=0;E<r.length;E+=1)de(r[E]);de(g,m),a=!1},d(m){m&&J(e),h&&h.d(m);for(let E=0;E<r.length;E+=1)r[E].d();g&&g.d(m),t[22](null)}}}const Ys=(()=>{let t=!1;try{const e=Object.defineProperty({},"passive",{get(){return t={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return t})();function Zs(t,e,n){let{$$slots:i={},$$scope:r}=e,{height:s}=e,{width:o="100%"}=e,{itemCount:a}=e,{itemSize:l}=e,{estimatedItemSize:h=null}=e,{stickyIndices:f=null}=e,{getKey:p=null}=e,{scrollDirection:b=tt.VERTICAL}=e,{scrollOffset:g=null}=e,{scrollToIndex:m=null}=e,{scrollToAlignment:E=null}=e,{scrollToBehaviour:M="instant"}=e,{overscanCount:A=3}=e;const P=kr(),B=new Hs({itemCount:a,itemSize:l,estimatedItemSize:X()});let Q=!1,W,q=[],y={offset:g||m!=null&&q.length&&U(m)||0,scrollChangeReason:zt.REQUESTED},c=y,u={scrollToIndex:m,scrollToAlignment:E,scrollOffset:g,itemCount:a,itemSize:l,estimatedItemSize:h},_={},w="",S="";oe(),Kt(()=>{n(18,Q=!0),W.addEventListener("scroll",z,Ys),g!=null?te(g):m!=null&&te(U(m))}),Pn(()=>{Q&&W.removeEventListener("scroll",z)});function L(){if(!Q)return;const I=u.scrollToIndex!==m||u.scrollToAlignment!==E,C=u.itemCount!==a||u.itemSize!==l||u.estimatedItemSize!==h;C&&(B.updateConfig({itemSize:l,itemCount:a,estimatedItemSize:X()}),T()),u.scrollOffset!==g?n(19,y={offset:g||0,scrollChangeReason:zt.REQUESTED}):typeof m=="number"&&(I||C)&&n(19,y={offset:U(m,E,a),scrollChangeReason:zt.REQUESTED}),u={scrollToIndex:m,scrollToAlignment:E,scrollOffset:g,itemCount:a,itemSize:l,estimatedItemSize:h}}function N(){if(!Q)return;const{offset:I,scrollChangeReason:C}=y;(c.offset!==I||c.scrollChangeReason!==C)&&oe(),c.offset!==I&&C===zt.REQUESTED&&te(I),c=y}function oe(){const{offset:I}=y,{start:C,stop:x}=B.getVisibleRange({containerSize:b===tt.VERTICAL?s:o,offset:I,overscanCount:A});let F=[];const K=B.getTotalSize();b===tt.VERTICAL?(n(3,w=`height:${s}${typeof s=="number"?"px":""};width:${o};`),n(4,S=`flex-direction:column;height:${K}px;`)):(n(3,w=`height:${s};width:${o}${typeof o=="number"?"px":""}`),n(4,S=`min-height:100%;width:${K}px;`));const D=f!=null&&f.length!==0;if(D)for(let j=0;j<f.length;j++){const le=f[j];F.push({index:le,style:R(le,!0)})}if(C!==void 0&&x!==void 0){for(let j=C;j<=x;j++)D&&f.includes(j)||F.push({index:j,style:R(j,!1)});P("itemsUpdated",{start:C,end:x})}n(2,q=F)}function te(I){"scroll"in W?W.scroll({[qs[b]]:I,behavior:M}):n(1,W[Ei[b]]=I,W)}function T(I=0){_={},B.resetItem(I),oe()}function U(I,C=E,x=a){return(I<0||I>=x)&&(I=0),B.getUpdatedOffsetForIndex({align:C,containerSize:b===tt.VERTICAL?s:o,currentOffset:y.offset||0,targetIndex:I})}function z(I){const C=_e();C<0||y.offset===C||I.target!==W||(n(19,y={offset:C,scrollChangeReason:zt.OBSERVED}),P("afterScroll",{offset:C,event:I}))}function _e(){return W[Ei[b]]}function X(){return h||typeof l=="number"&&l||50}function R(I,C){if(_[I])return _[I];const{size:x,offset:F}=B.getSizeAndPositionForIndex(I);let K;return b===tt.VERTICAL?(K=`left:0;width:100%;height:${x}px;`,C?K+=`position:sticky;flex-grow:0;z-index:1;top:0;margin-top:${F}px;margin-bottom:${-(F+x)}px;`:K+=`position:absolute;top:${F}px;`):(K=`top:0;width:${x}px;`,C?K+=`position:sticky;z-index:1;left:0;margin-left:${F}px;margin-right:${-(F+x)}px;`:K+=`position:absolute;height:100%;left:${F}px;`),_[I]=K}function V(I){ht[I?"unshift":"push"](()=>{W=I,n(1,W)})}return t.$$set=I=>{"height"in I&&n(5,s=I.height),"width"in I&&n(6,o=I.width),"itemCount"in I&&n(7,a=I.itemCount),"itemSize"in I&&n(8,l=I.itemSize),"estimatedItemSize"in I&&n(9,h=I.estimatedItemSize),"stickyIndices"in I&&n(10,f=I.stickyIndices),"getKey"in I&&n(0,p=I.getKey),"scrollDirection"in I&&n(11,b=I.scrollDirection),"scrollOffset"in I&&n(12,g=I.scrollOffset),"scrollToIndex"in I&&n(13,m=I.scrollToIndex),"scrollToAlignment"in I&&n(14,E=I.scrollToAlignment),"scrollToBehaviour"in I&&n(15,M=I.scrollToBehaviour),"overscanCount"in I&&n(16,A=I.overscanCount),"$$scope"in I&&n(20,r=I.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&29568&&L(),t.$$.dirty[0]&524288&&N(),t.$$.dirty[0]&263264&&Q&&T(0)},[p,W,q,w,S,s,o,a,l,h,f,b,g,m,E,M,A,T,Q,y,r,i,V]}class Qs extends Ze{constructor(e){super(),Ye(this,e,Zs,Js,Pe,{height:5,width:6,itemCount:7,itemSize:8,estimatedItemSize:9,stickyIndices:10,getKey:0,scrollDirection:11,scrollOffset:12,scrollToIndex:13,scrollToAlignment:14,scrollToBehaviour:15,overscanCount:16,recomputeSizes:17},null,[-1,-1])}get height(){return this.$$.ctx[5]}set height(e){this.$$set({height:e}),Le()}get width(){return this.$$.ctx[6]}set width(e){this.$$set({width:e}),Le()}get itemCount(){return this.$$.ctx[7]}set itemCount(e){this.$$set({itemCount:e}),Le()}get itemSize(){return this.$$.ctx[8]}set itemSize(e){this.$$set({itemSize:e}),Le()}get estimatedItemSize(){return this.$$.ctx[9]}set estimatedItemSize(e){this.$$set({estimatedItemSize:e}),Le()}get stickyIndices(){return this.$$.ctx[10]}set stickyIndices(e){this.$$set({stickyIndices:e}),Le()}get getKey(){return this.$$.ctx[0]}set getKey(e){this.$$set({getKey:e}),Le()}get scrollDirection(){return this.$$.ctx[11]}set scrollDirection(e){this.$$set({scrollDirection:e}),Le()}get scrollOffset(){return this.$$.ctx[12]}set scrollOffset(e){this.$$set({scrollOffset:e}),Le()}get scrollToIndex(){return this.$$.ctx[13]}set scrollToIndex(e){this.$$set({scrollToIndex:e}),Le()}get scrollToAlignment(){return this.$$.ctx[14]}set scrollToAlignment(e){this.$$set({scrollToAlignment:e}),Le()}get scrollToBehaviour(){return this.$$.ctx[15]}set scrollToBehaviour(e){this.$$set({scrollToBehaviour:e}),Le()}get overscanCount(){return this.$$.ctx[16]}set overscanCount(e){this.$$set({overscanCount:e}),Le()}get recomputeSizes(){return this.$$.ctx[17]}}function Xs(t){let e,n,i,r,s;return{c(){e=k("div"),n=k("img"),r=H(),s=k("canvas"),ee(n,"width",t[4]+"px"),ee(n,"height",t[5]+"px"),ee(n,"object-fit","cover"),v(n,"alt",""),v(n,"aria-hidden",i=t[7]!=="cached"),v(n,"class","svelte-12dtn57"),je(n,"hidden",t[7]!=="cached"),ee(s,"width",t[4]+"px"),ee(s,"height",t[5]+"px"),ee(s,"background-color","lightgrey"),v(s,"width",t[2]),v(s,"height",t[3]),v(s,"class","svelte-12dtn57"),je(s,"hidden",t[7]!=="live"),v(e,"class","canvasWrapper svelte-12dtn57"),ee(e,"width",t[4]+"px"),ee(e,"height",t[5]+"px"),je(e,"spinner",t[6])},m(o,a){Z(o,e,a),d(e,n),t[14](n),d(e,r),d(e,s),t[15](s)},p(o,[a]){a&16&&ee(n,"width",o[4]+"px"),a&32&&ee(n,"height",o[5]+"px"),a&128&&i!==(i=o[7]!=="cached")&&v(n,"aria-hidden",i),a&128&&je(n,"hidden",o[7]!=="cached"),a&16&&ee(s,"width",o[4]+"px"),a&32&&ee(s,"height",o[5]+"px"),a&4&&v(s,"width",o[2]),a&8&&v(s,"height",o[3]),a&128&&je(s,"hidden",o[7]!=="live"),a&16&&ee(e,"width",o[4]+"px"),a&32&&ee(e,"height",o[5]+"px"),a&64&&je(e,"spinner",o[6])},i:ye,o:ye,d(o){o&&J(e),t[14](null),t[15](null)}}}function $s(t){try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n[n.length-1]}catch{const e=t.split("?")[0].split("/");return e[e.length-1]}}function eo(t,e,n){let{source:i}=e,{attrs:r}=e,{thumbDatasetIndex:s=void 0}=e,{thumbAspectRatio:o=1}=e,{cssSize:a=120}=e,{max_size:l=512}=e;const h="/zowser/";let f,p,b=a,g=a;o>1?g=b/o:o<1&&(b=g*o);let m=b,E=g,M=!0,A="none";const P=new AbortController;async function B(){const y=$s(i);console.log(h);const c=`${h}thumbs/${y}.jpg`,u=new Image;return u.decoding="async",u.referrerPolicy="no-referrer",new Promise(_=>{u.onload=()=>{n(7,A="cached"),n(6,M=!1),n(1,p.src=c,p),_(!0)},u.onerror=()=>_(!1),u.src=c})}async function Q(){n(7,A="live");const y=await xs(i,r,s,l,P.signal);if(!y){console.warn("Thumbnail generation skipped/failed:",i);return}const{rgb:c,width:u,height:_}=y;n(2,b=u),n(3,g=_);let w=Math.max(b,g)/a;w<1&&(w=1),n(4,m=b/w),n(5,E=g/w),await Er(),f.getContext("2d").putImageData(new ImageData(c,b,g),0,0),n(6,M=!1)}Kt(async()=>{await B()||await Q()}),Pn(()=>P.abort());function W(y){ht[y?"unshift":"push"](()=>{p=y,n(1,p)})}function q(y){ht[y?"unshift":"push"](()=>{f=y,n(0,f)})}return t.$$set=y=>{"source"in y&&n(8,i=y.source),"attrs"in y&&n(9,r=y.attrs),"thumbDatasetIndex"in y&&n(10,s=y.thumbDatasetIndex),"thumbAspectRatio"in y&&n(11,o=y.thumbAspectRatio),"cssSize"in y&&n(12,a=y.cssSize),"max_size"in y&&n(13,l=y.max_size)},[f,p,b,g,m,E,M,A,i,r,s,o,a,l,W,q]}class dr extends Ze{constructor(e){super(),Ye(this,e,eo,Xs,Pe,{source:8,attrs:9,thumbDatasetIndex:10,thumbAspectRatio:11,cssSize:12,max_size:13})}}const to="/zowser/copy.png",no="/zowser/ome-logomark.svg",io="/zowser/original-data.svg";function zi(t,e,n){const i=t.slice();return i[15]=e[n],i}function Ri(t){let e,n;return e=new dr({props:{source:t[4],attrs:t[3],max_size:2e3,thumbDatasetIndex:t[5],thumbAspectRatio:t[6]}}),{c(){Je(e.$$.fragment)},m(i,r){We(e,i,r),n=!0},p(i,r){const s={};r&16&&(s.source=i[4]),r&8&&(s.attrs=i[3]),r&32&&(s.thumbDatasetIndex=i[5]),r&64&&(s.thumbAspectRatio=i[6]),e.$set(s)},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){de(e.$$.fragment,i),n=!1},d(i){qe(e,i)}}}function Oi(t){let e,n,i,r,s,o,a,l=t[0].source+"",h,f,p=t[0].csv&&Li(t);return{c(){e=k("div"),n=k("span"),n.textContent="Data",i=H(),p&&p.c(),r=H(),s=k("span"),s.textContent="provided by",o=H(),a=k("strong"),h=Y(l),f=Y("."),v(n,"class","hideOnSmall svelte-e0c7t6"),v(s,"class","hideOnSmall svelte-e0c7t6"),ee(a,"color","grey")},m(b,g){Z(b,e,g),d(e,n),d(e,i),p&&p.m(e,null),d(e,r),d(e,s),d(e,o),d(e,a),d(a,h),d(e,f)},p(b,g){b[0].csv?p?p.p(b,g):(p=Li(b),p.c(),p.m(e,r)):p&&(p.d(1),p=null),g&1&&l!==(l=b[0].source+"")&&Re(h,l)},d(b){b&&J(e),p&&p.d()}}}function Li(t){var a;let e,n,i,r=((a=t[0].csv)==null?void 0:a.split("/").pop().replace(".csv",""))+"",s,o;return{c(){e=k("span"),e.textContent="from collection",n=H(),i=k("a"),s=Y(r),v(e,"class","hideOnSmall svelte-e0c7t6"),v(i,"title","Show collection in a new tab"),v(i,"href",o=Ni(t[0])),v(i,"target","_blank")},m(l,h){Z(l,e,h),Z(l,n,h),Z(l,i,h),d(i,s)},p(l,h){var f;h&1&&r!==(r=((f=l[0].csv)==null?void 0:f.split("/").pop().replace(".csv",""))+"")&&Re(s,r),h&1&&o!==(o=Ni(l[0]))&&v(i,"href",o)},d(l){l&&(J(e),J(n),J(i))}}}function Mi(t){let e,n,i,r,s;return{c(){e=k("a"),n=k("img"),v(n,"class","icon svelte-e0c7t6"),ee(n,"opacity","0.9"),Dn(n.src,i=io)||v(n,"src",i),v(e,"title",r="Link to original data: "+t[0].origin),v(e,"href",s=t[0].origin),v(e,"target","_blank")},m(o,a){Z(o,e,a),d(e,n)},p(o,a){a&1&&r!==(r="Link to original data: "+o[0].origin)&&v(e,"title",r),a&1&&s!==(s=o[0].origin)&&v(e,"href",s)},d(o){o&&J(e)}}}function Fi(t){let e=t[15].toUpperCase()+"",n,i,r=t[0][`size_${t[15]}`]+"",s,o;return{c(){n=Y(e),i=Y(":"),s=Y(r),o=Y("  ")},m(a,l){Z(a,n,l),Z(a,i,l),Z(a,s,l),Z(a,o,l)},p(a,l){l&1&&r!==(r=a[0][`size_${a[15]}`]+"")&&Re(s,r)},d(a){a&&(J(n),J(i),J(s),J(o))}}}function Di(t){let e,n=t[0][`size_${t[15]}`]!==void 0&&Fi(t);return{c(){n&&n.c(),e=hn()},m(i,r){n&&n.m(i,r),Z(i,e,r)},p(i,r){i[0][`size_${i[15]}`]!==void 0?n?n.p(i,r):(n=Fi(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(i){i&&J(e),n&&n.d(i)}}}function ro(t){let e,n,i=un(t[0].written)+"",r;return{c(){e=k("div"),n=Y("Data size: "),r=Y(i)},m(s,o){Z(s,e,o),d(e,n),d(e,r)},p(s,o){o&1&&i!==(i=un(s[0].written)+"")&&Re(r,i)},d(s){s&&J(e)}}}function so(t){let e,n,i=t[0].shards+"",r;return{c(){e=k("div"),n=Y("Shard shape: "),r=Y(i)},m(s,o){Z(s,e,o),d(e,n),d(e,r)},p(s,o){o&1&&i!==(i=s[0].shards+"")&&Re(r,i)},d(s){s&&J(e)}}}function oo(t){let e,n,i=t[0].chunks+"",r;return{c(){e=k("div"),n=Y("Chunk shape: "),r=Y(i)},m(s,o){Z(s,e,o),d(e,n),d(e,r)},p(s,o){o&1&&i!==(i=s[0].chunks+"")&&Re(r,i)},d(s){s&&J(e)}}}function lo(t){let e,n,i,r,s,o,a=t[10](t[0].url)+"",l,h,f,p=(t[0].name?t[0].name.replaceAll(t[1],`<mark>${t[1]}</mark>`):"")+"",b,g,m,E=t[8].replaceAll(t[1],`<mark>${t[1]}</mark>`)+"",M,A,P,B,Q,W,q,y,c,u,_,w,S,L,N,oe,te,T=t[3]&&Ri(t),U=t[0].source&&Oi(t),z=t[0].origin&&Mi(t),_e=Ge(["t","c","z","y","x"]),X=[];for(let C=0;C<5;C+=1)X[C]=Di(zi(t,_e,C));function R(C,x){return C[2]=="chunk_pixels"?oo:C[2]=="shard_pixels"?so:ro}let V=R(t),I=V(t);return{c(){e=k("div"),n=k("div"),T&&T.c(),i=H(),r=k("div"),s=k("div"),o=k("strong"),h=H(),f=k("div"),g=H(),m=k("div"),M=H(),U&&U.c(),A=H(),P=k("div"),B=k("button"),B.innerHTML=`<img class="icon svelte-e0c7t6" src="${to}"/>`,Q=H(),W=k("a"),q=k("img"),u=H(),z&&z.c(),_=H(),w=k("div"),S=Y(`Image size:
      `);for(let C=0;C<5;C+=1)X[C].c();L=H(),I.c(),v(n,"class","thumbWrapper svelte-e0c7t6"),v(s,"title",l=t[0].url),v(f,"class",b=ai(t[1]==""?"hideOnSmall":"")+" svelte-e0c7t6"),v(B,"class","no_border svelte-e0c7t6"),v(B,"title","Copy S3 URL to clipboard"),je(B,"shake",t[7]),v(q,"class","icon svelte-e0c7t6"),ee(q,"opacity","0.9"),Dn(q.src,y=no)||v(q,"src",y),v(W,"title","Validate NGFF with 'ome-ngff-validator' in new browser tab"),v(W,"target","_blank"),v(W,"href",c="https://ome.github.io/ome-ngff-validator/?source="+t[0].url),v(e,"class","zarr-list-item svelte-e0c7t6")},m(C,x){Z(C,e,x),d(e,n),T&&T.m(n,null),d(e,i),d(e,r),d(r,s),d(s,o),o.innerHTML=a,d(r,h),d(r,f),f.innerHTML=p,d(r,g),d(r,m),m.innerHTML=E,d(r,M),U&&U.m(r,null),d(r,A),d(r,P),d(P,B),d(P,Q),d(P,W),d(W,q),d(P,u),z&&z.m(P,null),d(r,_),d(r,w),d(w,S);for(let F=0;F<5;F+=1)X[F]&&X[F].m(w,null);d(r,L),I.m(r,null),N=!0,oe||(te=[we(n,"click",t[9]),we(B,"click",t[12])],oe=!0)},p(C,[x]){if(C[3]?T?(T.p(C,x),x&8&&ae(T,1)):(T=Ri(C),T.c(),ae(T,1),T.m(n,null)):T&&(Gt(),de(T,1,1,()=>{T=null}),Jt()),(!N||x&1)&&a!==(a=C[10](C[0].url)+"")&&(o.innerHTML=a),(!N||x&1&&l!==(l=C[0].url))&&v(s,"title",l),(!N||x&3)&&p!==(p=(C[0].name?C[0].name.replaceAll(C[1],`<mark>${C[1]}</mark>`):"")+"")&&(f.innerHTML=p),(!N||x&2&&b!==(b=ai(C[1]==""?"hideOnSmall":"")+" svelte-e0c7t6"))&&v(f,"class",b),(!N||x&258)&&E!==(E=C[8].replaceAll(C[1],`<mark>${C[1]}</mark>`)+"")&&(m.innerHTML=E),C[0].source?U?U.p(C,x):(U=Oi(C),U.c(),U.m(r,A)):U&&(U.d(1),U=null),(!N||x&128)&&je(B,"shake",C[7]),(!N||x&1&&c!==(c="https://ome.github.io/ome-ngff-validator/?source="+C[0].url))&&v(W,"href",c),C[0].origin?z?z.p(C,x):(z=Mi(C),z.c(),z.m(P,null)):z&&(z.d(1),z=null),x&1){_e=Ge(["t","c","z","y","x"]);let F;for(F=0;F<5;F+=1){const K=zi(C,_e,F);X[F]?X[F].p(K,x):(X[F]=Di(K),X[F].c(),X[F].m(w,null))}for(;F<5;F+=1)X[F].d(1)}V===(V=R(C))&&I?I.p(C,x):(I.d(1),I=V(C),I&&(I.c(),I.m(r,null)))},i(C){N||(ae(T),N=!0)},o(C){de(T),N=!1},d(C){C&&J(e),T&&T.d(),U&&U.d(),z&&z.d(),an(X,C),I.d(),oe=!1,nt(te)}}}function Ni(t){return window.location.origin+window.location.pathname+"?csv="+t.csv}function ao(t,e,n){let i,{rowData:r}=e,{textFilter:s}=e,{sortedBy:o=void 0}=e,a,l,h,f=1;const p=new AbortController;if(r.size_x&&r.size_y){let A=Math.max(r.size_x,r.size_y);for(h=0;A>256;)h+=1,A=A/2;f=r.size_x/r.size_y}function b(){console.log("Clicked on thumbnail"),Ue.setSelectedRow(r)}function g(A){if(s&&A.toLowerCase().includes(s.toLowerCase())){let B=A.toLowerCase(),Q=s.toLowerCase(),W=B.indexOf(Q),q=Math.max(0,Math.min(W,A.length-50)),y=A.substring(q,W);return y+="<mark>",y+=A.substring(W,W+Q.length),y+="</mark>",y+=A.substring(W+Q.length),y}return A.split("/").pop()}Kt(async()=>{let A=r.url;r.series0!==void 0&&(A+="/"+r.series0);let P=await Ft(A,p.signal);n(3,a=P[0]),n(4,l=P[1]),P[2]}),Pn(()=>{p.abort()});let m=!1;function E(A){var P=document.createElement("textarea");P.style.position="fixed",P.value=A,document.body.appendChild(P),P.focus(),P.select();let B=!1;try{B=document.execCommand("copy")}catch{console.log("Oops, unable to copy")}document.body.removeChild(P),B&&(n(7,m=!0),setTimeout(()=>n(7,m=!1),1e3))}const M=A=>E(r.url);return t.$$set=A=>{"rowData"in A&&n(0,r=A.rowData),"textFilter"in A&&n(1,s=A.textFilter),"sortedBy"in A&&n(2,o=A.sortedBy)},t.$$.update=()=>{var A;t.$$.dirty&3&&n(8,i=s!=""&&((A=r.description)!=null&&A.toLowerCase().includes(s.toLowerCase()))?r.description:"")},[r,s,o,a,l,h,f,m,i,b,g,E,M]}class uo extends Ze{constructor(e){super(),Ye(this,e,ao,lo,Pe,{rowData:0,textFilter:1,sortedBy:2})}}function co(t){let e,n,i,r;return n=new uo({props:{rowData:t[0][t[13]],textFilter:t[1],sortedBy:t[2]}}),{c(){e=k("div"),Je(n.$$.fragment),v(e,"slot","item"),v(e,"style",i=t[12]),v(e,"class","row svelte-1xlep2t")},m(s,o){Z(s,e,o),We(n,e,null),r=!0},p(s,o){const a={};o&8193&&(a.rowData=s[0][s[13]]),o&2&&(a.textFilter=s[1]),o&4&&(a.sortedBy=s[2]),n.$set(a),(!r||o&4096&&i!==(i=s[12]))&&v(e,"style",i)},i(s){r||(ae(n.$$.fragment,s),r=!0)},o(s){de(n.$$.fragment,s),r=!1},d(s){s&&J(e),qe(n)}}}function fo(t){let e=!1,n=()=>{e=!1},i,r,s,o=`${t[5]}px`,a,l,h;return rt(t[8]),rt(t[9]),s=new Qs({props:{width:"100%",height:t[5],itemCount:t[0].length,itemSize:160,getKey:t[6],$$slots:{item:[co,({style:f,index:p})=>({12:f,13:p}),({style:f,index:p})=>(f?4096:0)|(p?8192:0)]},$$scope:{ctx:t}}}),s.$on("afterScroll",t[7]),{c(){r=k("div"),Je(s.$$.fragment),v(r,"class","imageListContainer svelte-1xlep2t"),ee(r,"height",o)},m(f,p){Z(f,r,p),We(s,r,null),t[10](r),a=!0,l||(h=[we(window,"resize",t[8]),we(window,"scroll",()=>{e=!0,clearTimeout(i),i=setTimeout(n,100),t[9]()})],l=!0)},p(f,[p]){p&16&&!e&&(e=!0,clearTimeout(i),scrollTo(window.pageXOffset,f[4]),i=setTimeout(n,100));const b={};p&32&&(b.height=f[5]),p&1&&(b.itemCount=f[0].length),p&28679&&(b.$$scope={dirty:p,ctx:f}),s.$set(b),p&32&&o!==(o=`${f[5]}px`)&&ee(r,"height",o)},i(f){a||(ae(s.$$.fragment,f),a=!0)},o(f){de(s.$$.fragment,f),a=!1},d(f){f&&J(r),qe(s),t[10](null),l=!1,nt(h)}}}function ho(t,e,n){let i,{tableRows:r}=e,{textFilter:s}=e,{sortedBy:o=void 0}=e;function a(E){return r[E].url}let l,h=0,f=0;function p(E){let A=l.offsetTop-20;E.detail.offset-f<0&&h>A&&n(4,h-=1),f=E.detail.offset}function b(){n(5,i=window.innerHeight)}function g(){n(4,h=window.pageYOffset)}function m(E){ht[E?"unshift":"push"](()=>{l=E,n(3,l)})}return t.$$set=E=>{"tableRows"in E&&n(0,r=E.tableRows),"textFilter"in E&&n(1,s=E.textFilter),"sortedBy"in E&&n(2,o=E.sortedBy)},n(5,i=0),[r,s,o,l,h,i,a,p,b,g,m]}class _o extends Ze{constructor(e){super(),Ye(this,e,ho,fo,Pe,{tableRows:0,textFilter:1,sortedBy:2})}}function Pi(t){let e,n;return e=new dr({props:{source:t[1],attrs:t[0],cssSize:512,max_size:2e3,thumbDatasetIndex:t[2],thumbAspectRatio:t[3]}}),{c(){Je(e.$$.fragment)},m(i,r){We(e,i,r),n=!0},p(i,r){const s={};r&2&&(s.source=i[1]),r&1&&(s.attrs=i[0]),r&4&&(s.thumbDatasetIndex=i[2]),r&8&&(s.thumbAspectRatio=i[3]),e.$set(s)},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){de(e.$$.fragment,i),n=!1},d(i){qe(e,i)}}}function go(t){let e,n,i=t[0]&&Pi(t);return{c(){i&&i.c(),e=hn()},m(r,s){i&&i.m(r,s),Z(r,e,s),n=!0},p(r,[s]){r[0]?i?(i.p(r,s),s&1&&ae(i,1)):(i=Pi(r),i.c(),ae(i,1),i.m(e.parentNode,e)):i&&(Gt(),de(i,1,1,()=>{i=null}),Jt())},i(r){n||(ae(i),n=!0)},o(r){de(i),n=!1},d(r){r&&J(e),i&&i.d(r)}}}function mo(t,e,n){let{rowData:i}=e;console.log("ThumbLoader",i);let r,s,o,a=1;if(i.size_x&&i.size_y){let l=Math.max(i.size_x,i.size_y);for(o=0;l>1024;)o+=1,l=l/2;a=i.size_x/i.size_y}else o=void 0,a=1;return Kt(async()=>{let l=await Ft(i.url);n(0,r=l[0]),n(1,s=l[1]),l[2]}),t.$$set=l=>{"rowData"in l&&n(4,i=l.rowData)},[r,s,o,a,i]}class po extends Ze{constructor(e){super(),Ye(this,e,mo,go,Pe,{rowData:4})}}function xi(t,e,n){const i=t.slice();return i[5]=e[n][0],i[6]=e[n][1],i}function Bi(t){let e,n;return e=new po({props:{rowData:t[1]}}),{c(){Je(e.$$.fragment)},m(i,r){We(e,i,r),n=!0},p(i,r){const s={};r&2&&(s.rowData=i[1]),e.$set(s)},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){de(e.$$.fragment,i),n=!1},d(i){qe(e,i)}}}function Ui(t){let e,n,i=t[2]&&Bi(t);return{c(){i&&i.c(),e=hn()},m(r,s){i&&i.m(r,s),Z(r,e,s),n=!0},p(r,s){r[2]?i?(i.p(r,s),s&4&&ae(i,1)):(i=Bi(r),i.c(),ae(i,1),i.m(e.parentNode,e)):i&&(Gt(),de(i,1,1,()=>{i=null}),Jt())},i(r){n||(ae(i),n=!0)},o(r){de(i),n=!1},d(r){r&&J(e),i&&i.d(r)}}}function ji(t){let e,n=Ge(Object.entries(t[1])),i=[];for(let r=0;r<n.length;r+=1)i[r]=Wi(xi(t,n,r));return{c(){e=k("table");for(let r=0;r<i.length;r+=1)i[r].c()},m(r,s){Z(r,e,s);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(e,null)},p(r,s){if(s&2){n=Ge(Object.entries(r[1]));let o;for(o=0;o<n.length;o+=1){const a=xi(r,n,o);i[o]?i[o].p(a,s):(i[o]=Wi(a),i[o].c(),i[o].m(e,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}},d(r){r&&J(e),an(i,r)}}}function Wi(t){let e,n,i=t[5]+"",r,s,o=t[6]+"",a;return{c(){e=k("tr"),n=k("td"),r=Y(i),s=k("td"),a=Y(o)},m(l,h){Z(l,e,h),d(e,n),d(n,r),d(e,s),d(s,a)},p(l,h){h&2&&i!==(i=l[5]+"")&&Re(r,i),h&2&&o!==(o=l[6]+"")&&Re(a,o)},d(l){l&&J(e)}}}function bo(t){let e,n,i,r,s=t[2],o,a,l,h,f=Ui(t),p=t[1]&&ji(t);return{c(){e=k("div"),n=k("button"),n.textContent="×",i=H(),r=k("div"),f.c(),o=H(),p&&p.c(),v(n,"class","close svelte-1g3sjso"),v(n,"title","Close"),v(r,"class","scrollable svelte-1g3sjso"),v(e,"id","mypopover"),v(e,"popover",""),v(e,"class","svelte-1g3sjso")},m(b,g){Z(b,e,g),d(e,n),d(e,i),d(e,r),f.m(r,null),d(r,o),p&&p.m(r,null),t[4](e),a=!0,l||(h=we(n,"click",t[3]),l=!0)},p(b,[g]){g&4&&Pe(s,s=b[2])?(Gt(),de(f,1,1,ye),Jt(),f=Ui(b),f.c(),ae(f,1),f.m(r,o)):f.p(b,g),b[1]?p?p.p(b,g):(p=ji(b),p.c(),p.m(r,null)):p&&(p.d(1),p=null)},i(b){a||(ae(f),a=!0)},o(b){de(f),a=!1},d(b){b&&J(e),f.d(b),p&&p.d(),t[4](null),l=!1,h()}}}function yo(t,e,n){let i,r,s;Ue.subscribeSelectedRow(l=>{console.log("Showing preview for",l),l&&(n(1,r=l),console.log("Showing Thumb preview for",l,r),n(2,s=r.url),i.showPopover())});function o(){i.hidePopover()}Kt(()=>{console.log("Mounted popover",i),i&&i.addEventListener("toggle",l=>{l.newState==="open"||(console.log("Popover has been hidden"),Ue.setSelectedRow(null))})});function a(l){ht[l?"unshift":"push"](()=>{i=l,n(0,i)})}return[i,r,s,o,a]}class vo extends Ze{constructor(e){super(),Ye(this,e,yo,bo,Pe,{})}}const wo="/zowser/selectCaret.svg",ko="/zowser/samples/sample_zarrs_hydrated.csv",Eo="/zowser/ome-main-nav.svg";function Co(t){let e,n,i,r,s,o,a,l,h,f,p,b,g;return{c(){e=k("base"),n=H(),i=k("nav"),r=k("a"),s=k("img"),a=H(),l=k("a"),h=k("h2"),h.textContent="Zowser — an OME-Zarr browser",f=H(),p=k("div"),b=H(),g=k("a"),g.textContent="About",v(e,"href",t[0]),v(s,"alt","OME Logo"),Dn(s.src,o=Eo)||v(s,"src",o),v(s,"class","svelte-qxzspo"),v(r,"class","logolink svelte-qxzspo"),v(r,"href",t[0]),v(h,"class","svelte-qxzspo"),v(l,"href",t[0]),v(l,"class","svelte-qxzspo"),ee(p,"flex","1"),v(g,"href","about/"),v(g,"class","svelte-qxzspo"),v(i,"class","svelte-qxzspo")},m(m,E){Z(m,e,E),Z(m,n,E),Z(m,i,E),d(i,r),d(r,s),d(i,a),d(i,l),d(l,h),d(i,f),d(i,p),d(i,b),d(i,g)},p:ye,i:ye,o:ye,d(m){m&&(J(e),J(n),J(i))}}}function Ao(t){let e="/zowser/";return console.log("Nav base",e),[e]}class So extends Ze{constructor(e){super(),Ye(this,e,Ao,Co,Pe,{})}}function Io(t,e,n){const i=t.slice();return i[28]=e[n],i}function qi(t,e,n){const i=t.slice();return i[31]=e[n],i}function Hi(t,e,n){const i=t.slice();return i[31]=e[n],i}function Vi(t){let e,n=t[31]+"",i,r;return{c(){e=k("option"),i=Y(n),e.__value=r=t[3][t[31]],Ae(e,e.__value)},m(s,o){Z(s,e,o),d(e,i)},p(s,o){o[0]&8&&n!==(n=s[31]+"")&&Re(i,n),o[0]&8&&r!==(r=s[3][s[31]])&&(e.__value=r,Ae(e,e.__value))},d(s){s&&J(e)}}}function Ki(t,e){let n,i=e[31]+"",r,s;return{key:t,first:null,c(){n=k("option"),r=Y(i),n.__value=s=e[4][e[31]],Ae(n,n.__value),this.first=n},m(o,a){Z(o,n,a),d(n,r)},p(o,a){e=o,a[0]&16&&i!==(i=e[31]+"")&&Re(r,i),a[0]&16&&s!==(s=e[4][e[31]])&&(n.__value=s,Ae(n,n.__value))},d(o){o&&J(n)}}}function To(t){let e;return{c(){e=k("option"),e.textContent=`Size: ${t[28].toUpperCase()}`,e.__value="size_"+t[28],Ae(e,e.__value)},m(n,i){Z(n,e,i)},p:ye,d(n){n&&J(e)}}}function zo(t){let e,n,i,r,s,o,a,l,h=t[11].split("/").pop()+"",f,p,b=un(t[2])+"",g,m,E,M,A,P,B,Q,W,q,y,c,u,_,w,S,L,N=t[10]!==""?"All Dimensions":"Dimension Count",oe,te,T,U,z,_e,X,R,V,I,C,x,F,K,D=t[9]==""?"Organism":"All Organisms",j,le,me,ie,fe,ge,ue,ke,he,Se,Me=t[8]==""?"Imaging Modality":"All Modalities",Ie,ce,re=[],Qe=new Map,se,He,Ee,Xe,Ve,xe,Ke,Te,ot,ve,Fe,$e,Yn,Zn,_t,gt,mt,Qn,Qt,lt,Xn,pt,et,$n,Xt=t[0].length+"",_n,ei,gn,ti,ni,at,De,mn,ii;e=new vo({});let bt=Ge(Object.keys(t[3]).sort()),Oe=[];for(let O=0;O<bt.length;O+=1)Oe[O]=Vi(Hi(t,bt,O));let $t=Ge(Object.keys(t[4]).sort());const ri=O=>O[31];for(let O=0;O<$t.length;O+=1){let $=qi(t,$t,O),be=ri($);Qe.set(be,re[O]=Ki(be,$))}let _r=Ge(["x","y","z","c","t"]),It=[];for(let O=0;O<5;O+=1)It[O]=To(Io(t,_r,O));return lt=new Ws({props:{toggleAscending:t[12],sortAscending:t[6]}}),at=new _o({props:{tableRows:t[0],textFilter:t[7],sortedBy:t[5]}}),{c(){Je(e.$$.fragment),n=H(),i=k("main"),r=k("div"),s=k("h3"),o=k("div"),a=Y(`Showing Collection:
        `),l=k("a"),f=Y(h),p=Y(`
        (`),g=Y(b),m=Y(")"),E=H(),M=k("div"),A=k("input"),P=H(),B=k("button"),Q=Y("×"),W=H(),q=k("div"),y=k("div"),c=k("div"),u=k("div"),u.textContent="Filter by:",_=H(),w=k("div"),S=k("select"),L=k("option"),oe=Y(N),te=k("hr"),T=k("option"),T.textContent="2D",U=k("option"),U.textContent="3D",z=k("option"),z.textContent="4D",_e=k("option"),_e.textContent="5D",X=H(),R=k("div"),V=k("button"),I=Y("×"),C=H(),x=k("div"),F=k("select"),K=k("option"),j=Y(D),le=k("hr");for(let O=0;O<Oe.length;O+=1)Oe[O].c();me=H(),ie=k("div"),fe=k("button"),ge=Y("×"),ue=H(),ke=k("div"),he=k("select"),Se=k("option"),Ie=Y(Me),ce=k("hr");for(let O=0;O<re.length;O+=1)re[O].c();se=H(),He=k("div"),Ee=k("button"),Xe=Y("×"),Ve=H(),xe=k("div"),Ke=H(),Te=k("div"),Te.textContent="Sort by:",ot=H(),ve=k("div"),Fe=k("select"),$e=k("option"),$e.textContent="--",Yn=k("hr");for(let O=0;O<5;O+=1)It[O].c();Zn=k("hr"),_t=k("option"),_t.textContent="Data Size (bytes)",gt=k("option"),gt.textContent="Chunk Size (pixels)",mt=k("option"),mt.textContent="Shard Size (pixels)",Qn=H(),Qt=k("div"),Je(lt.$$.fragment),Xn=H(),pt=k("div"),et=k("h3"),$n=Y("Showing "),_n=Y(Xt),ei=Y(" out of "),gn=Y(t[1]),ti=Y(" images"),ni=H(),Je(at.$$.fragment),v(l,"href",t[11]),ee(o,"font-size","90%"),ee(s,"text-align","center"),v(A,"placeholder","Filter by Name or Description"),v(A,"name","textFilter"),v(A,"class","svelte-cmksur"),v(B,"title","Clear Filter"),ee(B,"visibility",t[7]!==""?"visible":"hidden"),v(B,"class","svelte-cmksur"),v(M,"class","textInputWrapper svelte-cmksur"),v(r,"class","summary svelte-cmksur"),ee(u,"white-space","nowrap"),L.__value="",Ae(L,L.__value),T.__value="2",Ae(T,T.__value),U.__value="3",Ae(U,U.__value),z.__value="4",Ae(z,z.__value),_e.__value="5",Ae(_e,_e.__value),v(S,"class","svelte-cmksur"),t[10]===void 0&&rt(()=>t[19].call(S)),v(V,"title","Clear Filter"),ee(V,"visibility",t[10]!==""?"visible":"hidden"),v(V,"class","svelte-cmksur"),v(R,"class","svelte-cmksur"),v(w,"class","selectWrapper svelte-cmksur"),K.__value="",Ae(K,K.__value),v(F,"class","svelte-cmksur"),t[9]===void 0&&rt(()=>t[20].call(F)),v(fe,"title","Clear Filter"),ee(fe,"visibility",t[9]!==""?"visible":"hidden"),v(fe,"class","svelte-cmksur"),v(ie,"class","svelte-cmksur"),v(x,"class","selectWrapper svelte-cmksur"),Se.__value="",Ae(Se,Se.__value),v(he,"class","svelte-cmksur"),t[8]===void 0&&rt(()=>t[21].call(he)),v(Ee,"title","Clear Filter"),ee(Ee,"visibility",t[8]!==""?"visible":"hidden"),v(Ee,"class","svelte-cmksur"),v(He,"class","svelte-cmksur"),v(ke,"class","selectWrapper svelte-cmksur"),v(xe,"class","clear"),$e.__value="",Ae($e,$e.__value),_t.__value="written",Ae(_t,_t.__value),gt.__value="chunk_pixels",Ae(gt,gt.__value),mt.__value="shard_pixels",Ae(mt,mt.__value),v(Fe,"class","svelte-cmksur"),v(Qt,"class","svelte-cmksur"),v(ve,"class","selectWrapper svelte-cmksur"),v(c,"class","filters svelte-cmksur"),v(y,"class","sidebar svelte-cmksur"),ee(et,"margin-left","15px"),v(et,"class","svelte-cmksur"),v(pt,"class","results svelte-cmksur"),v(q,"class","sidebarContainer svelte-cmksur"),ee(i,"--form-select-bg-img","url('"+wo+"')"),v(i,"class","svelte-cmksur")},m(O,$){We(e,O,$),Z(O,n,$),Z(O,i,$),d(i,r),d(r,s),d(s,o),d(o,a),d(o,l),d(l,f),d(o,p),d(o,g),d(o,m),d(r,E),d(r,M),d(M,A),Ae(A,t[7]),d(M,P),d(M,B),d(B,Q),d(i,W),d(i,q),d(q,y),d(y,c),d(c,u),d(c,_),d(c,w),d(w,S),d(S,L),d(L,oe),d(S,te),d(S,T),d(S,U),d(S,z),d(S,_e),yt(S,t[10],!0),d(w,X),d(w,R),d(R,V),d(V,I),d(c,C),d(c,x),d(x,F),d(F,K),d(K,j),d(F,le);for(let be=0;be<Oe.length;be+=1)Oe[be]&&Oe[be].m(F,null);yt(F,t[9],!0),d(x,me),d(x,ie),d(ie,fe),d(fe,ge),d(c,ue),d(c,ke),d(ke,he),d(he,Se),d(Se,Ie),d(he,ce);for(let be=0;be<re.length;be+=1)re[be]&&re[be].m(he,null);yt(he,t[8],!0),d(ke,se),d(ke,He),d(He,Ee),d(Ee,Xe),d(c,Ve),d(c,xe),d(c,Ke),d(c,Te),d(c,ot),d(c,ve),d(ve,Fe),d(Fe,$e),d(Fe,Yn);for(let be=0;be<5;be+=1)It[be]&&It[be].m(Fe,null);d(Fe,Zn),d(Fe,_t),d(Fe,gt),d(Fe,mt),d(ve,Qn),d(ve,Qt),We(lt,Qt,null),d(q,Xn),d(q,pt),d(pt,et),d(et,$n),d(et,_n),d(et,ei),d(et,gn),d(et,ti),d(pt,ni),We(at,pt,null),De=!0,mn||(ii=[we(A,"input",t[18]),we(A,"input",t[17]),we(B,"click",t[17]),we(S,"change",t[19]),we(S,"change",t[14]),we(V,"click",t[14]),we(F,"change",t[20]),we(F,"change",t[15]),we(fe,"click",t[15]),we(he,"change",t[21]),we(he,"change",t[16]),we(Ee,"click",t[16]),we(Fe,"change",t[13])],mn=!0)},p(O,$){if((!De||$[0]&4)&&b!==(b=un(O[2])+"")&&Re(g,b),$[0]&128&&A.value!==O[7]&&Ae(A,O[7]),(!De||$[0]&128)&&ee(B,"visibility",O[7]!==""?"visible":"hidden"),(!De||$[0]&1024)&&N!==(N=O[10]!==""?"All Dimensions":"Dimension Count")&&Re(oe,N),$[0]&1024&&yt(S,O[10]),(!De||$[0]&1024)&&ee(V,"visibility",O[10]!==""?"visible":"hidden"),(!De||$[0]&512)&&D!==(D=O[9]==""?"Organism":"All Organisms")&&Re(j,D),$[0]&8){bt=Ge(Object.keys(O[3]).sort());let Be;for(Be=0;Be<bt.length;Be+=1){const si=Hi(O,bt,Be);Oe[Be]?Oe[Be].p(si,$):(Oe[Be]=Vi(si),Oe[Be].c(),Oe[Be].m(F,null))}for(;Be<Oe.length;Be+=1)Oe[Be].d(1);Oe.length=bt.length}$[0]&520&&yt(F,O[9]),(!De||$[0]&512)&&ee(fe,"visibility",O[9]!==""?"visible":"hidden"),(!De||$[0]&256)&&Me!==(Me=O[8]==""?"Imaging Modality":"All Modalities")&&Re(Ie,Me),$[0]&16&&($t=Ge(Object.keys(O[4]).sort()),re=tr(re,$,ri,1,O,$t,Qe,he,Sr,Ki,null,qi)),$[0]&272&&yt(he,O[8]),(!De||$[0]&256)&&ee(Ee,"visibility",O[8]!==""?"visible":"hidden");const be={};$[0]&64&&(be.sortAscending=O[6]),lt.$set(be),(!De||$[0]&1)&&Xt!==(Xt=O[0].length+"")&&Re(_n,Xt),(!De||$[0]&2)&&Re(gn,O[1]);const en={};$[0]&1&&(en.tableRows=O[0]),$[0]&128&&(en.textFilter=O[7]),$[0]&32&&(en.sortedBy=O[5]),at.$set(en)},i(O){De||(ae(e.$$.fragment,O),ae(lt.$$.fragment,O),ae(at.$$.fragment,O),De=!0)},o(O){de(e.$$.fragment,O),de(lt.$$.fragment,O),de(at.$$.fragment,O),De=!1},d(O){O&&(J(n),J(i)),qe(e,O),an(Oe,O);for(let $=0;$<re.length;$+=1)re[$].d();an(It,O),qe(lt),qe(at),mn=!1,nt(ii)}}}function Ro(t,e,n){let i,r,s,o,a=ko,l=[],h=0,f=0,p={},b={};Ue.subscribe(_=>{n(0,l=A(_)),n(1,h=_.length),n(2,f=_.reduce((w,S)=>w+parseInt(S.written)||0,0))}),or.subscribe(_=>{let w={};for(const[S,L]of Object.entries(_))w[L]=S;n(3,p=w)}),lr.subscribe(_=>{let w={};for(const[S,L]of Object.entries(_))w[L]=S;n(4,b=w)}),rr(a,Ue);let g="",m=!1;function E(){n(6,m=!m),Ue.sortTable(g,m)}function M(_){n(5,g=_.target.value),g===""?Ue.sortTable("index",!0):Ue.sortTable(g,m)}function A(_){if(i!==""&&(_=_.filter(w=>w.dim_count==i)),r!==""&&(_=_.filter(w=>w.organismId==r)),s!=""&&(_=_.filter(w=>w.fbbiId==s)),o&&o!=""){let w=o.toLowerCase();_=_.filter(S=>{var L,N;return S.url.toLowerCase().includes(w)||((L=S.description)==null?void 0:L.toLowerCase().includes(w))||((N=S.name)==null?void 0:N.toLowerCase().includes(w))})}return _}function P(_){n(10,i=_.target.value||""),n(0,l=A(Ue.getRows()))}function B(_){n(9,r=_.target.value||""),n(0,l=A(Ue.getRows()))}function Q(_){n(8,s=_.target.value||""),n(0,l=A(Ue.getRows()))}function W(_){n(7,o=_.target.value),n(0,l=A(Ue.getRows()))}function q(){o=this.value,n(7,o)}function y(){i=yn(this),n(10,i)}function c(){r=yn(this),n(9,r),n(3,p)}function u(){s=yn(this),n(8,s),n(4,b)}return t.$$.update=()=>{t.$$.dirty[0]&1&&l.some(_=>_.source)},n(10,i=""),n(9,r=""),n(8,s=""),n(7,o=""),[l,h,f,p,b,g,m,o,s,r,i,a,E,M,P,B,Q,W,q,y,c,u]}class Oo extends Ze{constructor(e){super(),Ye(this,e,Ro,zo,Pe,{},null,[-1,-1])}}const Lo="/zowser/nfdi_rgb_Wortmarke_Zusatz_quer.png",Mo="/zowser/czi-logo-chan-zuckerberg-initiative-logo.png";function Fo(t){let e,n,i;return{c(){e=k("base"),n=H(),i=k("div"),i.innerHTML=`<h2>Introduction</h2> <p>Zowser is an OME-Zarr browser based on the <a href="https://forum.image.sc/t/ome2024-ngff-challenge/97363">2024 OME-NGFF Challenge</a>, conceived at the
    <a href="https://www.openmicroscopy.org/events/ome-community-meeting-2024/">OME Annual Community Meeting</a>
    in Dundee in May 2024.</p> <h2>Acknowledgements</h2> <p>Coordination of the challenge was supported by the <a href="https://www.nfdi.de/">German National Research Data Initiative (NFDI)</a>
    and the
    <a href="https://chanzuckerberg.com/">Chan Zuckerberg Initiative</a>:</p> <table><tr><td><img src="${Lo}" alt="NFDI Logo" width="45%"/></td> <td><img src="${Mo}" alt="Chan Zuckerberg Initiative Logo" width="45%"/></td></tr></table>`,v(e,"href",t[0]),v(i,"class","svelte-zlrnwt")},m(r,s){Z(r,e,s),Z(r,n,s),Z(r,i,s)},p:ye,i:ye,o:ye,d(r){r&&(J(e),J(n),J(i))}}}function Do(t){return["/zowser/"]}class No extends Ze{constructor(e){super(),Ye(this,e,Do,Fo,Pe,{})}}function Po(t){let e,n;return e=new Oo({}),{c(){Je(e.$$.fragment)},m(i,r){We(e,i,r),n=!0},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){de(e.$$.fragment,i),n=!1},d(i){qe(e,i)}}}function xo(t){let e,n;return e=new No({}),{c(){Je(e.$$.fragment)},m(i,r){We(e,i,r),n=!0},i(i){n||(ae(e.$$.fragment,i),n=!0)},o(i){de(e.$$.fragment,i),n=!1},d(i){qe(e,i)}}}function Bo(t){let e,n,i,r,s,o;n=new So({});const a=[xo,Po],l=[];function h(f,p){return f[0].endsWith("/about/")?0:1}return r=h(t),s=l[r]=a[r](t),{c(){e=k("div"),Je(n.$$.fragment),i=H(),s.c(),v(e,"class","app svelte-1mc4mod")},m(f,p){Z(f,e,p),We(n,e,null),d(e,i),l[r].m(e,null),o=!0},p:ye,i(f){o||(ae(n.$$.fragment,f),ae(s),o=!0)},o(f){de(n.$$.fragment,f),de(s),o=!1},d(f){f&&J(e),qe(n),l[r].d()}}}function Uo(t){return[window.location.pathname]}class jo extends Ze{constructor(e){super(),Ye(this,e,Uo,Bo,Pe,{})}}new jo({target:document.getElementById("app")});
